/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
__export(exports, {
  default: () => BartenderPlugin
});

// node_modules/fuse.js/dist/fuse.esm.js
function isArray(value) {
  return !Array.isArray ? getTag(value) === "[object Array]" : Array.isArray(value);
}
var INFINITY = 1 / 0;
function baseToString(value) {
  if (typeof value == "string") {
    return value;
  }
  let result = value + "";
  return result == "0" && 1 / value == -INFINITY ? "-0" : result;
}
function toString(value) {
  return value == null ? "" : baseToString(value);
}
function isString(value) {
  return typeof value === "string";
}
function isNumber(value) {
  return typeof value === "number";
}
function isBoolean(value) {
  return value === true || value === false || isObjectLike(value) && getTag(value) == "[object Boolean]";
}
function isObject(value) {
  return typeof value === "object";
}
function isObjectLike(value) {
  return isObject(value) && value !== null;
}
function isDefined(value) {
  return value !== void 0 && value !== null;
}
function isBlank(value) {
  return !value.trim().length;
}
function getTag(value) {
  return value == null ? value === void 0 ? "[object Undefined]" : "[object Null]" : Object.prototype.toString.call(value);
}
var INCORRECT_INDEX_TYPE = "Incorrect 'index' type";
var LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY = (key) => `Invalid value for key ${key}`;
var PATTERN_LENGTH_TOO_LARGE = (max) => `Pattern length exceeds max of ${max}.`;
var MISSING_KEY_PROPERTY = (name) => `Missing ${name} property in key`;
var INVALID_KEY_WEIGHT_VALUE = (key) => `Property 'weight' in key '${key}' must be a positive integer`;
var hasOwn = Object.prototype.hasOwnProperty;
var KeyStore = class {
  constructor(keys) {
    this._keys = [];
    this._keyMap = {};
    let totalWeight = 0;
    keys.forEach((key) => {
      let obj = createKey(key);
      totalWeight += obj.weight;
      this._keys.push(obj);
      this._keyMap[obj.id] = obj;
      totalWeight += obj.weight;
    });
    this._keys.forEach((key) => {
      key.weight /= totalWeight;
    });
  }
  get(keyId) {
    return this._keyMap[keyId];
  }
  keys() {
    return this._keys;
  }
  toJSON() {
    return JSON.stringify(this._keys);
  }
};
function createKey(key) {
  let path = null;
  let id = null;
  let src = null;
  let weight = 1;
  let getFn2 = null;
  if (isString(key) || isArray(key)) {
    src = key;
    path = createKeyPath(key);
    id = createKeyId(key);
  } else {
    if (!hasOwn.call(key, "name")) {
      throw new Error(MISSING_KEY_PROPERTY("name"));
    }
    const name = key.name;
    src = name;
    if (hasOwn.call(key, "weight")) {
      weight = key.weight;
      if (weight <= 0) {
        throw new Error(INVALID_KEY_WEIGHT_VALUE(name));
      }
    }
    path = createKeyPath(name);
    id = createKeyId(name);
    getFn2 = key.getFn;
  }
  return { path, id, weight, src, getFn: getFn2 };
}
function createKeyPath(key) {
  return isArray(key) ? key : key.split(".");
}
function createKeyId(key) {
  return isArray(key) ? key.join(".") : key;
}
function get(obj, path) {
  let list = [];
  let arr = false;
  const deepGet = (obj2, path2, index2) => {
    if (!isDefined(obj2)) {
      return;
    }
    if (!path2[index2]) {
      list.push(obj2);
    } else {
      let key = path2[index2];
      const value = obj2[key];
      if (!isDefined(value)) {
        return;
      }
      if (index2 === path2.length - 1 && (isString(value) || isNumber(value) || isBoolean(value))) {
        list.push(toString(value));
      } else if (isArray(value)) {
        arr = true;
        for (let i = 0, len = value.length; i < len; i += 1) {
          deepGet(value[i], path2, index2 + 1);
        }
      } else if (path2.length) {
        deepGet(value, path2, index2 + 1);
      }
    }
  };
  deepGet(obj, isString(path) ? path.split(".") : path, 0);
  return arr ? list : list[0];
}
var MatchOptions = {
  includeMatches: false,
  findAllMatches: false,
  minMatchCharLength: 1
};
var BasicOptions = {
  isCaseSensitive: false,
  includeScore: false,
  keys: [],
  shouldSort: true,
  sortFn: (a, b) => a.score === b.score ? a.idx < b.idx ? -1 : 1 : a.score < b.score ? -1 : 1
};
var FuzzyOptions = {
  location: 0,
  threshold: 0.6,
  distance: 100
};
var AdvancedOptions = {
  useExtendedSearch: false,
  getFn: get,
  ignoreLocation: false,
  ignoreFieldNorm: false,
  fieldNormWeight: 1
};
var Config = __spreadValues(__spreadValues(__spreadValues(__spreadValues({}, BasicOptions), MatchOptions), FuzzyOptions), AdvancedOptions);
var SPACE = /[^ ]+/g;
function norm(weight = 1, mantissa = 3) {
  const cache = new Map();
  const m = Math.pow(10, mantissa);
  return {
    get(value) {
      const numTokens = value.match(SPACE).length;
      if (cache.has(numTokens)) {
        return cache.get(numTokens);
      }
      const norm2 = 1 / Math.pow(numTokens, 0.5 * weight);
      const n = parseFloat(Math.round(norm2 * m) / m);
      cache.set(numTokens, n);
      return n;
    },
    clear() {
      cache.clear();
    }
  };
}
var FuseIndex = class {
  constructor({
    getFn: getFn2 = Config.getFn,
    fieldNormWeight = Config.fieldNormWeight
  } = {}) {
    this.norm = norm(fieldNormWeight, 3);
    this.getFn = getFn2;
    this.isCreated = false;
    this.setIndexRecords();
  }
  setSources(docs = []) {
    this.docs = docs;
  }
  setIndexRecords(records = []) {
    this.records = records;
  }
  setKeys(keys = []) {
    this.keys = keys;
    this._keysMap = {};
    keys.forEach((key, idx) => {
      this._keysMap[key.id] = idx;
    });
  }
  create() {
    if (this.isCreated || !this.docs.length) {
      return;
    }
    this.isCreated = true;
    if (isString(this.docs[0])) {
      this.docs.forEach((doc, docIndex) => {
        this._addString(doc, docIndex);
      });
    } else {
      this.docs.forEach((doc, docIndex) => {
        this._addObject(doc, docIndex);
      });
    }
    this.norm.clear();
  }
  add(doc) {
    const idx = this.size();
    if (isString(doc)) {
      this._addString(doc, idx);
    } else {
      this._addObject(doc, idx);
    }
  }
  removeAt(idx) {
    this.records.splice(idx, 1);
    for (let i = idx, len = this.size(); i < len; i += 1) {
      this.records[i].i -= 1;
    }
  }
  getValueForItemAtKeyId(item, keyId) {
    return item[this._keysMap[keyId]];
  }
  size() {
    return this.records.length;
  }
  _addString(doc, docIndex) {
    if (!isDefined(doc) || isBlank(doc)) {
      return;
    }
    let record = {
      v: doc,
      i: docIndex,
      n: this.norm.get(doc)
    };
    this.records.push(record);
  }
  _addObject(doc, docIndex) {
    let record = { i: docIndex, $: {} };
    this.keys.forEach((key, keyIndex) => {
      let value = key.getFn ? key.getFn(doc) : this.getFn(doc, key.path);
      if (!isDefined(value)) {
        return;
      }
      if (isArray(value)) {
        let subRecords = [];
        const stack = [{ nestedArrIndex: -1, value }];
        while (stack.length) {
          const { nestedArrIndex, value: value2 } = stack.pop();
          if (!isDefined(value2)) {
            continue;
          }
          if (isString(value2) && !isBlank(value2)) {
            let subRecord = {
              v: value2,
              i: nestedArrIndex,
              n: this.norm.get(value2)
            };
            subRecords.push(subRecord);
          } else if (isArray(value2)) {
            value2.forEach((item, k) => {
              stack.push({
                nestedArrIndex: k,
                value: item
              });
            });
          } else
            ;
        }
        record.$[keyIndex] = subRecords;
      } else if (isString(value) && !isBlank(value)) {
        let subRecord = {
          v: value,
          n: this.norm.get(value)
        };
        record.$[keyIndex] = subRecord;
      }
    });
    this.records.push(record);
  }
  toJSON() {
    return {
      keys: this.keys,
      records: this.records
    };
  }
};
function createIndex(keys, docs, { getFn: getFn2 = Config.getFn, fieldNormWeight = Config.fieldNormWeight } = {}) {
  const myIndex = new FuseIndex({ getFn: getFn2, fieldNormWeight });
  myIndex.setKeys(keys.map(createKey));
  myIndex.setSources(docs);
  myIndex.create();
  return myIndex;
}
function parseIndex(data, { getFn: getFn2 = Config.getFn, fieldNormWeight = Config.fieldNormWeight } = {}) {
  const { keys, records } = data;
  const myIndex = new FuseIndex({ getFn: getFn2, fieldNormWeight });
  myIndex.setKeys(keys);
  myIndex.setIndexRecords(records);
  return myIndex;
}
function computeScore$1(pattern, {
  errors = 0,
  currentLocation = 0,
  expectedLocation = 0,
  distance = Config.distance,
  ignoreLocation = Config.ignoreLocation
} = {}) {
  const accuracy = errors / pattern.length;
  if (ignoreLocation) {
    return accuracy;
  }
  const proximity = Math.abs(expectedLocation - currentLocation);
  if (!distance) {
    return proximity ? 1 : accuracy;
  }
  return accuracy + proximity / distance;
}
function convertMaskToIndices(matchmask = [], minMatchCharLength = Config.minMatchCharLength) {
  let indices = [];
  let start = -1;
  let end = -1;
  let i = 0;
  for (let len = matchmask.length; i < len; i += 1) {
    let match = matchmask[i];
    if (match && start === -1) {
      start = i;
    } else if (!match && start !== -1) {
      end = i - 1;
      if (end - start + 1 >= minMatchCharLength) {
        indices.push([start, end]);
      }
      start = -1;
    }
  }
  if (matchmask[i - 1] && i - start >= minMatchCharLength) {
    indices.push([start, i - 1]);
  }
  return indices;
}
var MAX_BITS = 32;
function search(text, pattern, patternAlphabet, {
  location = Config.location,
  distance = Config.distance,
  threshold = Config.threshold,
  findAllMatches = Config.findAllMatches,
  minMatchCharLength = Config.minMatchCharLength,
  includeMatches = Config.includeMatches,
  ignoreLocation = Config.ignoreLocation
} = {}) {
  if (pattern.length > MAX_BITS) {
    throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));
  }
  const patternLen = pattern.length;
  const textLen = text.length;
  const expectedLocation = Math.max(0, Math.min(location, textLen));
  let currentThreshold = threshold;
  let bestLocation = expectedLocation;
  const computeMatches = minMatchCharLength > 1 || includeMatches;
  const matchMask = computeMatches ? Array(textLen) : [];
  let index2;
  while ((index2 = text.indexOf(pattern, bestLocation)) > -1) {
    let score = computeScore$1(pattern, {
      currentLocation: index2,
      expectedLocation,
      distance,
      ignoreLocation
    });
    currentThreshold = Math.min(score, currentThreshold);
    bestLocation = index2 + patternLen;
    if (computeMatches) {
      let i = 0;
      while (i < patternLen) {
        matchMask[index2 + i] = 1;
        i += 1;
      }
    }
  }
  bestLocation = -1;
  let lastBitArr = [];
  let finalScore = 1;
  let binMax = patternLen + textLen;
  const mask = 1 << patternLen - 1;
  for (let i = 0; i < patternLen; i += 1) {
    let binMin = 0;
    let binMid = binMax;
    while (binMin < binMid) {
      const score2 = computeScore$1(pattern, {
        errors: i,
        currentLocation: expectedLocation + binMid,
        expectedLocation,
        distance,
        ignoreLocation
      });
      if (score2 <= currentThreshold) {
        binMin = binMid;
      } else {
        binMax = binMid;
      }
      binMid = Math.floor((binMax - binMin) / 2 + binMin);
    }
    binMax = binMid;
    let start = Math.max(1, expectedLocation - binMid + 1);
    let finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;
    let bitArr = Array(finish + 2);
    bitArr[finish + 1] = (1 << i) - 1;
    for (let j = finish; j >= start; j -= 1) {
      let currentLocation = j - 1;
      let charMatch = patternAlphabet[text.charAt(currentLocation)];
      if (computeMatches) {
        matchMask[currentLocation] = +!!charMatch;
      }
      bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;
      if (i) {
        bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
      }
      if (bitArr[j] & mask) {
        finalScore = computeScore$1(pattern, {
          errors: i,
          currentLocation,
          expectedLocation,
          distance,
          ignoreLocation
        });
        if (finalScore <= currentThreshold) {
          currentThreshold = finalScore;
          bestLocation = currentLocation;
          if (bestLocation <= expectedLocation) {
            break;
          }
          start = Math.max(1, 2 * expectedLocation - bestLocation);
        }
      }
    }
    const score = computeScore$1(pattern, {
      errors: i + 1,
      currentLocation: expectedLocation,
      expectedLocation,
      distance,
      ignoreLocation
    });
    if (score > currentThreshold) {
      break;
    }
    lastBitArr = bitArr;
  }
  const result = {
    isMatch: bestLocation >= 0,
    score: Math.max(1e-3, finalScore)
  };
  if (computeMatches) {
    const indices = convertMaskToIndices(matchMask, minMatchCharLength);
    if (!indices.length) {
      result.isMatch = false;
    } else if (includeMatches) {
      result.indices = indices;
    }
  }
  return result;
}
function createPatternAlphabet(pattern) {
  let mask = {};
  for (let i = 0, len = pattern.length; i < len; i += 1) {
    const char = pattern.charAt(i);
    mask[char] = (mask[char] || 0) | 1 << len - i - 1;
  }
  return mask;
}
var BitapSearch = class {
  constructor(pattern, {
    location = Config.location,
    threshold = Config.threshold,
    distance = Config.distance,
    includeMatches = Config.includeMatches,
    findAllMatches = Config.findAllMatches,
    minMatchCharLength = Config.minMatchCharLength,
    isCaseSensitive = Config.isCaseSensitive,
    ignoreLocation = Config.ignoreLocation
  } = {}) {
    this.options = {
      location,
      threshold,
      distance,
      includeMatches,
      findAllMatches,
      minMatchCharLength,
      isCaseSensitive,
      ignoreLocation
    };
    this.pattern = isCaseSensitive ? pattern : pattern.toLowerCase();
    this.chunks = [];
    if (!this.pattern.length) {
      return;
    }
    const addChunk = (pattern2, startIndex) => {
      this.chunks.push({
        pattern: pattern2,
        alphabet: createPatternAlphabet(pattern2),
        startIndex
      });
    };
    const len = this.pattern.length;
    if (len > MAX_BITS) {
      let i = 0;
      const remainder = len % MAX_BITS;
      const end = len - remainder;
      while (i < end) {
        addChunk(this.pattern.substr(i, MAX_BITS), i);
        i += MAX_BITS;
      }
      if (remainder) {
        const startIndex = len - MAX_BITS;
        addChunk(this.pattern.substr(startIndex), startIndex);
      }
    } else {
      addChunk(this.pattern, 0);
    }
  }
  searchIn(text) {
    const { isCaseSensitive, includeMatches } = this.options;
    if (!isCaseSensitive) {
      text = text.toLowerCase();
    }
    if (this.pattern === text) {
      let result2 = {
        isMatch: true,
        score: 0
      };
      if (includeMatches) {
        result2.indices = [[0, text.length - 1]];
      }
      return result2;
    }
    const {
      location,
      distance,
      threshold,
      findAllMatches,
      minMatchCharLength,
      ignoreLocation
    } = this.options;
    let allIndices = [];
    let totalScore = 0;
    let hasMatches = false;
    this.chunks.forEach(({ pattern, alphabet, startIndex }) => {
      const { isMatch, score, indices } = search(text, pattern, alphabet, {
        location: location + startIndex,
        distance,
        threshold,
        findAllMatches,
        minMatchCharLength,
        includeMatches,
        ignoreLocation
      });
      if (isMatch) {
        hasMatches = true;
      }
      totalScore += score;
      if (isMatch && indices) {
        allIndices = [...allIndices, ...indices];
      }
    });
    let result = {
      isMatch: hasMatches,
      score: hasMatches ? totalScore / this.chunks.length : 1
    };
    if (hasMatches && includeMatches) {
      result.indices = allIndices;
    }
    return result;
  }
};
var BaseMatch = class {
  constructor(pattern) {
    this.pattern = pattern;
  }
  static isMultiMatch(pattern) {
    return getMatch(pattern, this.multiRegex);
  }
  static isSingleMatch(pattern) {
    return getMatch(pattern, this.singleRegex);
  }
  search() {
  }
};
function getMatch(pattern, exp) {
  const matches2 = pattern.match(exp);
  return matches2 ? matches2[1] : null;
}
var ExactMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "exact";
  }
  static get multiRegex() {
    return /^="(.*)"$/;
  }
  static get singleRegex() {
    return /^=(.*)$/;
  }
  search(text) {
    const isMatch = text === this.pattern;
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices: [0, this.pattern.length - 1]
    };
  }
};
var InverseExactMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "inverse-exact";
  }
  static get multiRegex() {
    return /^!"(.*)"$/;
  }
  static get singleRegex() {
    return /^!(.*)$/;
  }
  search(text) {
    const index2 = text.indexOf(this.pattern);
    const isMatch = index2 === -1;
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices: [0, text.length - 1]
    };
  }
};
var PrefixExactMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "prefix-exact";
  }
  static get multiRegex() {
    return /^\^"(.*)"$/;
  }
  static get singleRegex() {
    return /^\^(.*)$/;
  }
  search(text) {
    const isMatch = text.startsWith(this.pattern);
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices: [0, this.pattern.length - 1]
    };
  }
};
var InversePrefixExactMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "inverse-prefix-exact";
  }
  static get multiRegex() {
    return /^!\^"(.*)"$/;
  }
  static get singleRegex() {
    return /^!\^(.*)$/;
  }
  search(text) {
    const isMatch = !text.startsWith(this.pattern);
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices: [0, text.length - 1]
    };
  }
};
var SuffixExactMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "suffix-exact";
  }
  static get multiRegex() {
    return /^"(.*)"\$$/;
  }
  static get singleRegex() {
    return /^(.*)\$$/;
  }
  search(text) {
    const isMatch = text.endsWith(this.pattern);
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices: [text.length - this.pattern.length, text.length - 1]
    };
  }
};
var InverseSuffixExactMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "inverse-suffix-exact";
  }
  static get multiRegex() {
    return /^!"(.*)"\$$/;
  }
  static get singleRegex() {
    return /^!(.*)\$$/;
  }
  search(text) {
    const isMatch = !text.endsWith(this.pattern);
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices: [0, text.length - 1]
    };
  }
};
var FuzzyMatch = class extends BaseMatch {
  constructor(pattern, {
    location = Config.location,
    threshold = Config.threshold,
    distance = Config.distance,
    includeMatches = Config.includeMatches,
    findAllMatches = Config.findAllMatches,
    minMatchCharLength = Config.minMatchCharLength,
    isCaseSensitive = Config.isCaseSensitive,
    ignoreLocation = Config.ignoreLocation
  } = {}) {
    super(pattern);
    this._bitapSearch = new BitapSearch(pattern, {
      location,
      threshold,
      distance,
      includeMatches,
      findAllMatches,
      minMatchCharLength,
      isCaseSensitive,
      ignoreLocation
    });
  }
  static get type() {
    return "fuzzy";
  }
  static get multiRegex() {
    return /^"(.*)"$/;
  }
  static get singleRegex() {
    return /^(.*)$/;
  }
  search(text) {
    return this._bitapSearch.searchIn(text);
  }
};
var IncludeMatch = class extends BaseMatch {
  constructor(pattern) {
    super(pattern);
  }
  static get type() {
    return "include";
  }
  static get multiRegex() {
    return /^'"(.*)"$/;
  }
  static get singleRegex() {
    return /^'(.*)$/;
  }
  search(text) {
    let location = 0;
    let index2;
    const indices = [];
    const patternLen = this.pattern.length;
    while ((index2 = text.indexOf(this.pattern, location)) > -1) {
      location = index2 + patternLen;
      indices.push([index2, location - 1]);
    }
    const isMatch = !!indices.length;
    return {
      isMatch,
      score: isMatch ? 0 : 1,
      indices
    };
  }
};
var searchers = [
  ExactMatch,
  IncludeMatch,
  PrefixExactMatch,
  InversePrefixExactMatch,
  InverseSuffixExactMatch,
  SuffixExactMatch,
  InverseExactMatch,
  FuzzyMatch
];
var searchersLen = searchers.length;
var SPACE_RE = / +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;
var OR_TOKEN = "|";
function parseQuery(pattern, options = {}) {
  return pattern.split(OR_TOKEN).map((item) => {
    let query = item.trim().split(SPACE_RE).filter((item2) => item2 && !!item2.trim());
    let results = [];
    for (let i = 0, len = query.length; i < len; i += 1) {
      const queryItem = query[i];
      let found = false;
      let idx = -1;
      while (!found && ++idx < searchersLen) {
        const searcher = searchers[idx];
        let token = searcher.isMultiMatch(queryItem);
        if (token) {
          results.push(new searcher(token, options));
          found = true;
        }
      }
      if (found) {
        continue;
      }
      idx = -1;
      while (++idx < searchersLen) {
        const searcher = searchers[idx];
        let token = searcher.isSingleMatch(queryItem);
        if (token) {
          results.push(new searcher(token, options));
          break;
        }
      }
    }
    return results;
  });
}
var MultiMatchSet = new Set([FuzzyMatch.type, IncludeMatch.type]);
var ExtendedSearch = class {
  constructor(pattern, {
    isCaseSensitive = Config.isCaseSensitive,
    includeMatches = Config.includeMatches,
    minMatchCharLength = Config.minMatchCharLength,
    ignoreLocation = Config.ignoreLocation,
    findAllMatches = Config.findAllMatches,
    location = Config.location,
    threshold = Config.threshold,
    distance = Config.distance
  } = {}) {
    this.query = null;
    this.options = {
      isCaseSensitive,
      includeMatches,
      minMatchCharLength,
      findAllMatches,
      ignoreLocation,
      location,
      threshold,
      distance
    };
    this.pattern = isCaseSensitive ? pattern : pattern.toLowerCase();
    this.query = parseQuery(this.pattern, this.options);
  }
  static condition(_, options) {
    return options.useExtendedSearch;
  }
  searchIn(text) {
    const query = this.query;
    if (!query) {
      return {
        isMatch: false,
        score: 1
      };
    }
    const { includeMatches, isCaseSensitive } = this.options;
    text = isCaseSensitive ? text : text.toLowerCase();
    let numMatches = 0;
    let allIndices = [];
    let totalScore = 0;
    for (let i = 0, qLen = query.length; i < qLen; i += 1) {
      const searchers2 = query[i];
      allIndices.length = 0;
      numMatches = 0;
      for (let j = 0, pLen = searchers2.length; j < pLen; j += 1) {
        const searcher = searchers2[j];
        const { isMatch, indices, score } = searcher.search(text);
        if (isMatch) {
          numMatches += 1;
          totalScore += score;
          if (includeMatches) {
            const type = searcher.constructor.type;
            if (MultiMatchSet.has(type)) {
              allIndices = [...allIndices, ...indices];
            } else {
              allIndices.push(indices);
            }
          }
        } else {
          totalScore = 0;
          numMatches = 0;
          allIndices.length = 0;
          break;
        }
      }
      if (numMatches) {
        let result = {
          isMatch: true,
          score: totalScore / numMatches
        };
        if (includeMatches) {
          result.indices = allIndices;
        }
        return result;
      }
    }
    return {
      isMatch: false,
      score: 1
    };
  }
};
var registeredSearchers = [];
function register(...args) {
  registeredSearchers.push(...args);
}
function createSearcher(pattern, options) {
  for (let i = 0, len = registeredSearchers.length; i < len; i += 1) {
    let searcherClass = registeredSearchers[i];
    if (searcherClass.condition(pattern, options)) {
      return new searcherClass(pattern, options);
    }
  }
  return new BitapSearch(pattern, options);
}
var LogicalOperator = {
  AND: "$and",
  OR: "$or"
};
var KeyType = {
  PATH: "$path",
  PATTERN: "$val"
};
var isExpression = (query) => !!(query[LogicalOperator.AND] || query[LogicalOperator.OR]);
var isPath = (query) => !!query[KeyType.PATH];
var isLeaf = (query) => !isArray(query) && isObject(query) && !isExpression(query);
var convertToExplicit = (query) => ({
  [LogicalOperator.AND]: Object.keys(query).map((key) => ({
    [key]: query[key]
  }))
});
function parse(query, options, { auto = true } = {}) {
  const next = (query2) => {
    let keys = Object.keys(query2);
    const isQueryPath = isPath(query2);
    if (!isQueryPath && keys.length > 1 && !isExpression(query2)) {
      return next(convertToExplicit(query2));
    }
    if (isLeaf(query2)) {
      const key = isQueryPath ? query2[KeyType.PATH] : keys[0];
      const pattern = isQueryPath ? query2[KeyType.PATTERN] : query2[key];
      if (!isString(pattern)) {
        throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(key));
      }
      const obj = {
        keyId: createKeyId(key),
        pattern
      };
      if (auto) {
        obj.searcher = createSearcher(pattern, options);
      }
      return obj;
    }
    let node = {
      children: [],
      operator: keys[0]
    };
    keys.forEach((key) => {
      const value = query2[key];
      if (isArray(value)) {
        value.forEach((item) => {
          node.children.push(next(item));
        });
      }
    });
    return node;
  };
  if (!isExpression(query)) {
    query = convertToExplicit(query);
  }
  return next(query);
}
function computeScore(results, { ignoreFieldNorm = Config.ignoreFieldNorm }) {
  results.forEach((result) => {
    let totalScore = 1;
    result.matches.forEach(({ key, norm: norm2, score }) => {
      const weight = key ? key.weight : null;
      totalScore *= Math.pow(score === 0 && weight ? Number.EPSILON : score, (weight || 1) * (ignoreFieldNorm ? 1 : norm2));
    });
    result.score = totalScore;
  });
}
function transformMatches(result, data) {
  const matches2 = result.matches;
  data.matches = [];
  if (!isDefined(matches2)) {
    return;
  }
  matches2.forEach((match) => {
    if (!isDefined(match.indices) || !match.indices.length) {
      return;
    }
    const { indices, value } = match;
    let obj = {
      indices,
      value
    };
    if (match.key) {
      obj.key = match.key.src;
    }
    if (match.idx > -1) {
      obj.refIndex = match.idx;
    }
    data.matches.push(obj);
  });
}
function transformScore(result, data) {
  data.score = result.score;
}
function format(results, docs, {
  includeMatches = Config.includeMatches,
  includeScore = Config.includeScore
} = {}) {
  const transformers = [];
  if (includeMatches)
    transformers.push(transformMatches);
  if (includeScore)
    transformers.push(transformScore);
  return results.map((result) => {
    const { idx } = result;
    const data = {
      item: docs[idx],
      refIndex: idx
    };
    if (transformers.length) {
      transformers.forEach((transformer) => {
        transformer(result, data);
      });
    }
    return data;
  });
}
var Fuse = class {
  constructor(docs, options = {}, index2) {
    this.options = __spreadValues(__spreadValues({}, Config), options);
    if (this.options.useExtendedSearch && false) {
      throw new Error(EXTENDED_SEARCH_UNAVAILABLE);
    }
    this._keyStore = new KeyStore(this.options.keys);
    this.setCollection(docs, index2);
  }
  setCollection(docs, index2) {
    this._docs = docs;
    if (index2 && !(index2 instanceof FuseIndex)) {
      throw new Error(INCORRECT_INDEX_TYPE);
    }
    this._myIndex = index2 || createIndex(this.options.keys, this._docs, {
      getFn: this.options.getFn,
      fieldNormWeight: this.options.fieldNormWeight
    });
  }
  add(doc) {
    if (!isDefined(doc)) {
      return;
    }
    this._docs.push(doc);
    this._myIndex.add(doc);
  }
  remove(predicate = () => false) {
    const results = [];
    for (let i = 0, len = this._docs.length; i < len; i += 1) {
      const doc = this._docs[i];
      if (predicate(doc, i)) {
        this.removeAt(i);
        i -= 1;
        len -= 1;
        results.push(doc);
      }
    }
    return results;
  }
  removeAt(idx) {
    this._docs.splice(idx, 1);
    this._myIndex.removeAt(idx);
  }
  getIndex() {
    return this._myIndex;
  }
  search(query, { limit = -1 } = {}) {
    const {
      includeMatches,
      includeScore,
      shouldSort,
      sortFn,
      ignoreFieldNorm
    } = this.options;
    let results = isString(query) ? isString(this._docs[0]) ? this._searchStringList(query) : this._searchObjectList(query) : this._searchLogical(query);
    computeScore(results, { ignoreFieldNorm });
    if (shouldSort) {
      results.sort(sortFn);
    }
    if (isNumber(limit) && limit > -1) {
      results = results.slice(0, limit);
    }
    return format(results, this._docs, {
      includeMatches,
      includeScore
    });
  }
  _searchStringList(query) {
    const searcher = createSearcher(query, this.options);
    const { records } = this._myIndex;
    const results = [];
    records.forEach(({ v: text, i: idx, n: norm2 }) => {
      if (!isDefined(text)) {
        return;
      }
      const { isMatch, score, indices } = searcher.searchIn(text);
      if (isMatch) {
        results.push({
          item: text,
          idx,
          matches: [{ score, value: text, norm: norm2, indices }]
        });
      }
    });
    return results;
  }
  _searchLogical(query) {
    const expression = parse(query, this.options);
    const evaluate = (node, item, idx) => {
      if (!node.children) {
        const { keyId, searcher } = node;
        const matches2 = this._findMatches({
          key: this._keyStore.get(keyId),
          value: this._myIndex.getValueForItemAtKeyId(item, keyId),
          searcher
        });
        if (matches2 && matches2.length) {
          return [
            {
              idx,
              item,
              matches: matches2
            }
          ];
        }
        return [];
      }
      const res = [];
      for (let i = 0, len = node.children.length; i < len; i += 1) {
        const child = node.children[i];
        const result = evaluate(child, item, idx);
        if (result.length) {
          res.push(...result);
        } else if (node.operator === LogicalOperator.AND) {
          return [];
        }
      }
      return res;
    };
    const records = this._myIndex.records;
    const resultMap = {};
    const results = [];
    records.forEach(({ $: item, i: idx }) => {
      if (isDefined(item)) {
        let expResults = evaluate(expression, item, idx);
        if (expResults.length) {
          if (!resultMap[idx]) {
            resultMap[idx] = { idx, item, matches: [] };
            results.push(resultMap[idx]);
          }
          expResults.forEach(({ matches: matches2 }) => {
            resultMap[idx].matches.push(...matches2);
          });
        }
      }
    });
    return results;
  }
  _searchObjectList(query) {
    const searcher = createSearcher(query, this.options);
    const { keys, records } = this._myIndex;
    const results = [];
    records.forEach(({ $: item, i: idx }) => {
      if (!isDefined(item)) {
        return;
      }
      let matches2 = [];
      keys.forEach((key, keyIndex) => {
        matches2.push(...this._findMatches({
          key,
          value: item[keyIndex],
          searcher
        }));
      });
      if (matches2.length) {
        results.push({
          idx,
          item,
          matches: matches2
        });
      }
    });
    return results;
  }
  _findMatches({ key, value, searcher }) {
    if (!isDefined(value)) {
      return [];
    }
    let matches2 = [];
    if (isArray(value)) {
      value.forEach(({ v: text, i: idx, n: norm2 }) => {
        if (!isDefined(text)) {
          return;
        }
        const { isMatch, score, indices } = searcher.searchIn(text);
        if (isMatch) {
          matches2.push({
            score,
            key,
            value: text,
            idx,
            norm: norm2,
            indices
          });
        }
      });
    } else {
      const { v: text, n: norm2 } = value;
      const { isMatch, score, indices } = searcher.searchIn(text);
      if (isMatch) {
        matches2.push({ score, key, value: text, norm: norm2, indices });
      }
    }
    return matches2;
  }
};
Fuse.version = "6.6.2";
Fuse.createIndex = createIndex;
Fuse.parseIndex = parseIndex;
Fuse.config = Config;
{
  Fuse.parseQuery = parse;
}
{
  register(ExtendedSearch);
}

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/main.ts
var import_obsidian4 = __toModule(require("obsidian"));

// node_modules/sortablejs/modular/sortable.esm.js
function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);
  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) {
      symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
    }
    keys.push.apply(keys, symbols);
  }
  return keys;
}
function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};
    if (i % 2) {
      ownKeys(Object(source), true).forEach(function(key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }
  return target;
}
function _typeof(obj) {
  "@babel/helpers - typeof";
  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof = function(obj2) {
      return typeof obj2;
    };
  } else {
    _typeof = function(obj2) {
      return obj2 && typeof Symbol === "function" && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
    };
  }
  return _typeof(obj);
}
function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}
function _extends() {
  _extends = Object.assign || function(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }
    return target;
  };
  return _extends.apply(this, arguments);
}
function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null)
    return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;
  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0)
      continue;
    target[key] = source[key];
  }
  return target;
}
function _objectWithoutProperties(source, excluded) {
  if (source == null)
    return {};
  var target = _objectWithoutPropertiesLoose(source, excluded);
  var key, i;
  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0)
        continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key))
        continue;
      target[key] = source[key];
    }
  }
  return target;
}
function _toConsumableArray(arr) {
  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}
function _arrayWithoutHoles(arr) {
  if (Array.isArray(arr))
    return _arrayLikeToArray(arr);
}
function _iterableToArray(iter) {
  if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null)
    return Array.from(iter);
}
function _unsupportedIterableToArray(o, minLen) {
  if (!o)
    return;
  if (typeof o === "string")
    return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor)
    n = o.constructor.name;
  if (n === "Map" || n === "Set")
    return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
    return _arrayLikeToArray(o, minLen);
}
function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length)
    len = arr.length;
  for (var i = 0, arr2 = new Array(len); i < len; i++)
    arr2[i] = arr[i];
  return arr2;
}
function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
var version = "1.15.1";
function userAgent(pattern) {
  if (typeof window !== "undefined" && window.navigator) {
    return !!/* @__PURE__ */ navigator.userAgent.match(pattern);
  }
}
var IE11OrLess = userAgent(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i);
var Edge = userAgent(/Edge/i);
var FireFox = userAgent(/firefox/i);
var Safari = userAgent(/safari/i) && !userAgent(/chrome/i) && !userAgent(/android/i);
var IOS = userAgent(/iP(ad|od|hone)/i);
var ChromeForAndroid = userAgent(/chrome/i) && userAgent(/android/i);
var captureMode = {
  capture: false,
  passive: false
};
function on(el, event, fn) {
  el.addEventListener(event, fn, !IE11OrLess && captureMode);
}
function off(el, event, fn) {
  el.removeEventListener(event, fn, !IE11OrLess && captureMode);
}
function matches(el, selector) {
  if (!selector)
    return;
  selector[0] === ">" && (selector = selector.substring(1));
  if (el) {
    try {
      if (el.matches) {
        return el.matches(selector);
      } else if (el.msMatchesSelector) {
        return el.msMatchesSelector(selector);
      } else if (el.webkitMatchesSelector) {
        return el.webkitMatchesSelector(selector);
      }
    } catch (_) {
      return false;
    }
  }
  return false;
}
function getParentOrHost(el) {
  return el.host && el !== document && el.host.nodeType ? el.host : el.parentNode;
}
function closest(el, selector, ctx, includeCTX) {
  if (el) {
    ctx = ctx || document;
    do {
      if (selector != null && (selector[0] === ">" ? el.parentNode === ctx && matches(el, selector) : matches(el, selector)) || includeCTX && el === ctx) {
        return el;
      }
      if (el === ctx)
        break;
    } while (el = getParentOrHost(el));
  }
  return null;
}
var R_SPACE = /\s+/g;
function toggleClass(el, name, state) {
  if (el && name) {
    if (el.classList) {
      el.classList[state ? "add" : "remove"](name);
    } else {
      var className = (" " + el.className + " ").replace(R_SPACE, " ").replace(" " + name + " ", " ");
      el.className = (className + (state ? " " + name : "")).replace(R_SPACE, " ");
    }
  }
}
function css(el, prop, val) {
  var style = el && el.style;
  if (style) {
    if (val === void 0) {
      if (document.defaultView && document.defaultView.getComputedStyle) {
        val = document.defaultView.getComputedStyle(el, "");
      } else if (el.currentStyle) {
        val = el.currentStyle;
      }
      return prop === void 0 ? val : val[prop];
    } else {
      if (!(prop in style) && prop.indexOf("webkit") === -1) {
        prop = "-webkit-" + prop;
      }
      style[prop] = val + (typeof val === "string" ? "" : "px");
    }
  }
}
function matrix(el, selfOnly) {
  var appliedTransforms = "";
  if (typeof el === "string") {
    appliedTransforms = el;
  } else {
    do {
      var transform = css(el, "transform");
      if (transform && transform !== "none") {
        appliedTransforms = transform + " " + appliedTransforms;
      }
    } while (!selfOnly && (el = el.parentNode));
  }
  var matrixFn = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix;
  return matrixFn && new matrixFn(appliedTransforms);
}
function find(ctx, tagName, iterator) {
  if (ctx) {
    var list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;
    if (iterator) {
      for (; i < n; i++) {
        iterator(list[i], i);
      }
    }
    return list;
  }
  return [];
}
function getWindowScrollingElement() {
  var scrollingElement = document.scrollingElement;
  if (scrollingElement) {
    return scrollingElement;
  } else {
    return document.documentElement;
  }
}
function getRect(el, relativeToContainingBlock, relativeToNonStaticParent, undoScale, container) {
  if (!el.getBoundingClientRect && el !== window)
    return;
  var elRect, top, left, bottom, right, height, width;
  if (el !== window && el.parentNode && el !== getWindowScrollingElement()) {
    elRect = el.getBoundingClientRect();
    top = elRect.top;
    left = elRect.left;
    bottom = elRect.bottom;
    right = elRect.right;
    height = elRect.height;
    width = elRect.width;
  } else {
    top = 0;
    left = 0;
    bottom = window.innerHeight;
    right = window.innerWidth;
    height = window.innerHeight;
    width = window.innerWidth;
  }
  if ((relativeToContainingBlock || relativeToNonStaticParent) && el !== window) {
    container = container || el.parentNode;
    if (!IE11OrLess) {
      do {
        if (container && container.getBoundingClientRect && (css(container, "transform") !== "none" || relativeToNonStaticParent && css(container, "position") !== "static")) {
          var containerRect = container.getBoundingClientRect();
          top -= containerRect.top + parseInt(css(container, "border-top-width"));
          left -= containerRect.left + parseInt(css(container, "border-left-width"));
          bottom = top + elRect.height;
          right = left + elRect.width;
          break;
        }
      } while (container = container.parentNode);
    }
  }
  if (undoScale && el !== window) {
    var elMatrix = matrix(container || el), scaleX = elMatrix && elMatrix.a, scaleY = elMatrix && elMatrix.d;
    if (elMatrix) {
      top /= scaleY;
      left /= scaleX;
      width /= scaleX;
      height /= scaleY;
      bottom = top + height;
      right = left + width;
    }
  }
  return {
    top,
    left,
    bottom,
    right,
    width,
    height
  };
}
function getContentRect(el) {
  var rect = getRect(el);
  var paddingLeft = parseInt(css(el, "padding-left")), paddingTop = parseInt(css(el, "padding-top")), paddingRight = parseInt(css(el, "padding-right")), paddingBottom = parseInt(css(el, "padding-bottom"));
  rect.top += paddingTop + parseInt(css(el, "border-top-width"));
  rect.left += paddingLeft + parseInt(css(el, "border-left-width"));
  rect.width = el.clientWidth - paddingLeft - paddingRight;
  rect.height = el.clientHeight - paddingTop - paddingBottom;
  rect.bottom = rect.top + rect.height;
  rect.right = rect.left + rect.width;
  return rect;
}
function isScrolledPast(el, elSide, parentSide) {
  var parent = getParentAutoScrollElement(el, true), elSideVal = getRect(el)[elSide];
  while (parent) {
    var parentSideVal = getRect(parent)[parentSide], visible = void 0;
    if (parentSide === "top" || parentSide === "left") {
      visible = elSideVal >= parentSideVal;
    } else {
      visible = elSideVal <= parentSideVal;
    }
    if (!visible)
      return parent;
    if (parent === getWindowScrollingElement())
      break;
    parent = getParentAutoScrollElement(parent, false);
  }
  return false;
}
function getChild(el, childNum, options, includeDragEl) {
  var currentChild = 0, i = 0, children = el.children;
  while (i < children.length) {
    if (children[i].style.display !== "none" && children[i] !== Sortable.ghost && (includeDragEl || children[i] !== Sortable.dragged) && closest(children[i], options.draggable, el, false)) {
      if (currentChild === childNum) {
        return children[i];
      }
      currentChild++;
    }
    i++;
  }
  return null;
}
function lastChild(el, selector) {
  var last = el.lastElementChild;
  while (last && (last === Sortable.ghost || css(last, "display") === "none" || selector && !matches(last, selector))) {
    last = last.previousElementSibling;
  }
  return last || null;
}
function index(el, selector) {
  var index2 = 0;
  if (!el || !el.parentNode) {
    return -1;
  }
  while (el = el.previousElementSibling) {
    if (el.nodeName.toUpperCase() !== "TEMPLATE" && el !== Sortable.clone && (!selector || matches(el, selector))) {
      index2++;
    }
  }
  return index2;
}
function getRelativeScrollOffset(el) {
  var offsetLeft = 0, offsetTop = 0, winScroller = getWindowScrollingElement();
  if (el) {
    do {
      var elMatrix = matrix(el), scaleX = elMatrix.a, scaleY = elMatrix.d;
      offsetLeft += el.scrollLeft * scaleX;
      offsetTop += el.scrollTop * scaleY;
    } while (el !== winScroller && (el = el.parentNode));
  }
  return [offsetLeft, offsetTop];
}
function indexOfObject(arr, obj) {
  for (var i in arr) {
    if (!arr.hasOwnProperty(i))
      continue;
    for (var key in obj) {
      if (obj.hasOwnProperty(key) && obj[key] === arr[i][key])
        return Number(i);
    }
  }
  return -1;
}
function getParentAutoScrollElement(el, includeSelf) {
  if (!el || !el.getBoundingClientRect)
    return getWindowScrollingElement();
  var elem = el;
  var gotSelf = false;
  do {
    if (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {
      var elemCSS = css(elem);
      if (elem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == "auto" || elemCSS.overflowX == "scroll") || elem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == "auto" || elemCSS.overflowY == "scroll")) {
        if (!elem.getBoundingClientRect || elem === document.body)
          return getWindowScrollingElement();
        if (gotSelf || includeSelf)
          return elem;
        gotSelf = true;
      }
    }
  } while (elem = elem.parentNode);
  return getWindowScrollingElement();
}
function extend(dst, src) {
  if (dst && src) {
    for (var key in src) {
      if (src.hasOwnProperty(key)) {
        dst[key] = src[key];
      }
    }
  }
  return dst;
}
function isRectEqual(rect1, rect2) {
  return Math.round(rect1.top) === Math.round(rect2.top) && Math.round(rect1.left) === Math.round(rect2.left) && Math.round(rect1.height) === Math.round(rect2.height) && Math.round(rect1.width) === Math.round(rect2.width);
}
var _throttleTimeout;
function throttle(callback, ms) {
  return function() {
    if (!_throttleTimeout) {
      var args = arguments, _this = this;
      if (args.length === 1) {
        callback.call(_this, args[0]);
      } else {
        callback.apply(_this, args);
      }
      _throttleTimeout = setTimeout(function() {
        _throttleTimeout = void 0;
      }, ms);
    }
  };
}
function cancelThrottle() {
  clearTimeout(_throttleTimeout);
  _throttleTimeout = void 0;
}
function scrollBy(el, x, y) {
  el.scrollLeft += x;
  el.scrollTop += y;
}
function clone(el) {
  var Polymer = window.Polymer;
  var $ = window.jQuery || window.Zepto;
  if (Polymer && Polymer.dom) {
    return Polymer.dom(el).cloneNode(true);
  } else if ($) {
    return $(el).clone(true)[0];
  } else {
    return el.cloneNode(true);
  }
}
function setRect(el, rect) {
  css(el, "position", "absolute");
  css(el, "top", rect.top);
  css(el, "left", rect.left);
  css(el, "width", rect.width);
  css(el, "height", rect.height);
}
function unsetRect(el) {
  css(el, "position", "");
  css(el, "top", "");
  css(el, "left", "");
  css(el, "width", "");
  css(el, "height", "");
}
var expando = "Sortable" + new Date().getTime();
function AnimationStateManager() {
  var animationStates = [], animationCallbackId;
  return {
    captureAnimationState: function captureAnimationState() {
      animationStates = [];
      if (!this.options.animation)
        return;
      var children = [].slice.call(this.el.children);
      children.forEach(function(child) {
        if (css(child, "display") === "none" || child === Sortable.ghost)
          return;
        animationStates.push({
          target: child,
          rect: getRect(child)
        });
        var fromRect = _objectSpread2({}, animationStates[animationStates.length - 1].rect);
        if (child.thisAnimationDuration) {
          var childMatrix = matrix(child, true);
          if (childMatrix) {
            fromRect.top -= childMatrix.f;
            fromRect.left -= childMatrix.e;
          }
        }
        child.fromRect = fromRect;
      });
    },
    addAnimationState: function addAnimationState(state) {
      animationStates.push(state);
    },
    removeAnimationState: function removeAnimationState(target) {
      animationStates.splice(indexOfObject(animationStates, {
        target
      }), 1);
    },
    animateAll: function animateAll(callback) {
      var _this = this;
      if (!this.options.animation) {
        clearTimeout(animationCallbackId);
        if (typeof callback === "function")
          callback();
        return;
      }
      var animating = false, animationTime = 0;
      animationStates.forEach(function(state) {
        var time = 0, target = state.target, fromRect = target.fromRect, toRect = getRect(target), prevFromRect = target.prevFromRect, prevToRect = target.prevToRect, animatingRect = state.rect, targetMatrix = matrix(target, true);
        if (targetMatrix) {
          toRect.top -= targetMatrix.f;
          toRect.left -= targetMatrix.e;
        }
        target.toRect = toRect;
        if (target.thisAnimationDuration) {
          if (isRectEqual(prevFromRect, toRect) && !isRectEqual(fromRect, toRect) && (animatingRect.top - toRect.top) / (animatingRect.left - toRect.left) === (fromRect.top - toRect.top) / (fromRect.left - toRect.left)) {
            time = calculateRealTime(animatingRect, prevFromRect, prevToRect, _this.options);
          }
        }
        if (!isRectEqual(toRect, fromRect)) {
          target.prevFromRect = fromRect;
          target.prevToRect = toRect;
          if (!time) {
            time = _this.options.animation;
          }
          _this.animate(target, animatingRect, toRect, time);
        }
        if (time) {
          animating = true;
          animationTime = Math.max(animationTime, time);
          clearTimeout(target.animationResetTimer);
          target.animationResetTimer = setTimeout(function() {
            target.animationTime = 0;
            target.prevFromRect = null;
            target.fromRect = null;
            target.prevToRect = null;
            target.thisAnimationDuration = null;
          }, time);
          target.thisAnimationDuration = time;
        }
      });
      clearTimeout(animationCallbackId);
      if (!animating) {
        if (typeof callback === "function")
          callback();
      } else {
        animationCallbackId = setTimeout(function() {
          if (typeof callback === "function")
            callback();
        }, animationTime);
      }
      animationStates = [];
    },
    animate: function animate(target, currentRect, toRect, duration) {
      if (duration) {
        css(target, "transition", "");
        css(target, "transform", "");
        var elMatrix = matrix(this.el), scaleX = elMatrix && elMatrix.a, scaleY = elMatrix && elMatrix.d, translateX = (currentRect.left - toRect.left) / (scaleX || 1), translateY = (currentRect.top - toRect.top) / (scaleY || 1);
        target.animatingX = !!translateX;
        target.animatingY = !!translateY;
        css(target, "transform", "translate3d(" + translateX + "px," + translateY + "px,0)");
        this.forRepaintDummy = repaint(target);
        css(target, "transition", "transform " + duration + "ms" + (this.options.easing ? " " + this.options.easing : ""));
        css(target, "transform", "translate3d(0,0,0)");
        typeof target.animated === "number" && clearTimeout(target.animated);
        target.animated = setTimeout(function() {
          css(target, "transition", "");
          css(target, "transform", "");
          target.animated = false;
          target.animatingX = false;
          target.animatingY = false;
        }, duration);
      }
    }
  };
}
function repaint(target) {
  return target.offsetWidth;
}
function calculateRealTime(animatingRect, fromRect, toRect, options) {
  return Math.sqrt(Math.pow(fromRect.top - animatingRect.top, 2) + Math.pow(fromRect.left - animatingRect.left, 2)) / Math.sqrt(Math.pow(fromRect.top - toRect.top, 2) + Math.pow(fromRect.left - toRect.left, 2)) * options.animation;
}
var plugins = [];
var defaults = {
  initializeByDefault: true
};
var PluginManager = {
  mount: function mount(plugin) {
    for (var option2 in defaults) {
      if (defaults.hasOwnProperty(option2) && !(option2 in plugin)) {
        plugin[option2] = defaults[option2];
      }
    }
    plugins.forEach(function(p) {
      if (p.pluginName === plugin.pluginName) {
        throw "Sortable: Cannot mount plugin ".concat(plugin.pluginName, " more than once");
      }
    });
    plugins.push(plugin);
  },
  pluginEvent: function pluginEvent(eventName, sortable, evt) {
    var _this = this;
    this.eventCanceled = false;
    evt.cancel = function() {
      _this.eventCanceled = true;
    };
    var eventNameGlobal = eventName + "Global";
    plugins.forEach(function(plugin) {
      if (!sortable[plugin.pluginName])
        return;
      if (sortable[plugin.pluginName][eventNameGlobal]) {
        sortable[plugin.pluginName][eventNameGlobal](_objectSpread2({
          sortable
        }, evt));
      }
      if (sortable.options[plugin.pluginName] && sortable[plugin.pluginName][eventName]) {
        sortable[plugin.pluginName][eventName](_objectSpread2({
          sortable
        }, evt));
      }
    });
  },
  initializePlugins: function initializePlugins(sortable, el, defaults2, options) {
    plugins.forEach(function(plugin) {
      var pluginName = plugin.pluginName;
      if (!sortable.options[pluginName] && !plugin.initializeByDefault)
        return;
      var initialized = new plugin(sortable, el, sortable.options);
      initialized.sortable = sortable;
      initialized.options = sortable.options;
      sortable[pluginName] = initialized;
      _extends(defaults2, initialized.defaults);
    });
    for (var option2 in sortable.options) {
      if (!sortable.options.hasOwnProperty(option2))
        continue;
      var modified = this.modifyOption(sortable, option2, sortable.options[option2]);
      if (typeof modified !== "undefined") {
        sortable.options[option2] = modified;
      }
    }
  },
  getEventProperties: function getEventProperties(name, sortable) {
    var eventProperties = {};
    plugins.forEach(function(plugin) {
      if (typeof plugin.eventProperties !== "function")
        return;
      _extends(eventProperties, plugin.eventProperties.call(sortable[plugin.pluginName], name));
    });
    return eventProperties;
  },
  modifyOption: function modifyOption(sortable, name, value) {
    var modifiedValue;
    plugins.forEach(function(plugin) {
      if (!sortable[plugin.pluginName])
        return;
      if (plugin.optionListeners && typeof plugin.optionListeners[name] === "function") {
        modifiedValue = plugin.optionListeners[name].call(sortable[plugin.pluginName], value);
      }
    });
    return modifiedValue;
  }
};
function dispatchEvent(_ref) {
  var sortable = _ref.sortable, rootEl2 = _ref.rootEl, name = _ref.name, targetEl = _ref.targetEl, cloneEl2 = _ref.cloneEl, toEl = _ref.toEl, fromEl = _ref.fromEl, oldIndex2 = _ref.oldIndex, newIndex2 = _ref.newIndex, oldDraggableIndex2 = _ref.oldDraggableIndex, newDraggableIndex2 = _ref.newDraggableIndex, originalEvent = _ref.originalEvent, putSortable2 = _ref.putSortable, extraEventProperties = _ref.extraEventProperties;
  sortable = sortable || rootEl2 && rootEl2[expando];
  if (!sortable)
    return;
  var evt, options = sortable.options, onName = "on" + name.charAt(0).toUpperCase() + name.substr(1);
  if (window.CustomEvent && !IE11OrLess && !Edge) {
    evt = new CustomEvent(name, {
      bubbles: true,
      cancelable: true
    });
  } else {
    evt = document.createEvent("Event");
    evt.initEvent(name, true, true);
  }
  evt.to = toEl || rootEl2;
  evt.from = fromEl || rootEl2;
  evt.item = targetEl || rootEl2;
  evt.clone = cloneEl2;
  evt.oldIndex = oldIndex2;
  evt.newIndex = newIndex2;
  evt.oldDraggableIndex = oldDraggableIndex2;
  evt.newDraggableIndex = newDraggableIndex2;
  evt.originalEvent = originalEvent;
  evt.pullMode = putSortable2 ? putSortable2.lastPutMode : void 0;
  var allEventProperties = _objectSpread2(_objectSpread2({}, extraEventProperties), PluginManager.getEventProperties(name, sortable));
  for (var option2 in allEventProperties) {
    evt[option2] = allEventProperties[option2];
  }
  if (rootEl2) {
    rootEl2.dispatchEvent(evt);
  }
  if (options[onName]) {
    options[onName].call(sortable, evt);
  }
}
var _excluded = ["evt"];
var pluginEvent2 = function pluginEvent3(eventName, sortable) {
  var _ref = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {}, originalEvent = _ref.evt, data = _objectWithoutProperties(_ref, _excluded);
  PluginManager.pluginEvent.bind(Sortable)(eventName, sortable, _objectSpread2({
    dragEl,
    parentEl,
    ghostEl,
    rootEl,
    nextEl,
    lastDownEl,
    cloneEl,
    cloneHidden,
    dragStarted: moved,
    putSortable,
    activeSortable: Sortable.active,
    originalEvent,
    oldIndex,
    oldDraggableIndex,
    newIndex,
    newDraggableIndex,
    hideGhostForTarget: _hideGhostForTarget,
    unhideGhostForTarget: _unhideGhostForTarget,
    cloneNowHidden: function cloneNowHidden() {
      cloneHidden = true;
    },
    cloneNowShown: function cloneNowShown() {
      cloneHidden = false;
    },
    dispatchSortableEvent: function dispatchSortableEvent(name) {
      _dispatchEvent({
        sortable,
        name,
        originalEvent
      });
    }
  }, data));
};
function _dispatchEvent(info) {
  dispatchEvent(_objectSpread2({
    putSortable,
    cloneEl,
    targetEl: dragEl,
    rootEl,
    oldIndex,
    oldDraggableIndex,
    newIndex,
    newDraggableIndex
  }, info));
}
var dragEl;
var parentEl;
var ghostEl;
var rootEl;
var nextEl;
var lastDownEl;
var cloneEl;
var cloneHidden;
var oldIndex;
var newIndex;
var oldDraggableIndex;
var newDraggableIndex;
var activeGroup;
var putSortable;
var awaitingDragStarted = false;
var ignoreNextClick = false;
var sortables = [];
var tapEvt;
var touchEvt;
var lastDx;
var lastDy;
var tapDistanceLeft;
var tapDistanceTop;
var moved;
var lastTarget;
var lastDirection;
var pastFirstInvertThresh = false;
var isCircumstantialInvert = false;
var targetMoveDistance;
var ghostRelativeParent;
var ghostRelativeParentInitialScroll = [];
var _silent = false;
var savedInputChecked = [];
var documentExists = typeof document !== "undefined";
var PositionGhostAbsolutely = IOS;
var CSSFloatProperty = Edge || IE11OrLess ? "cssFloat" : "float";
var supportDraggable = documentExists && !ChromeForAndroid && !IOS && "draggable" in document.createElement("div");
var supportCssPointerEvents = function() {
  if (!documentExists)
    return;
  if (IE11OrLess) {
    return false;
  }
  var el = document.createElement("x");
  el.style.cssText = "pointer-events:auto";
  return el.style.pointerEvents === "auto";
}();
var _detectDirection = function _detectDirection2(el, options) {
  var elCSS = css(el), elWidth = parseInt(elCSS.width) - parseInt(elCSS.paddingLeft) - parseInt(elCSS.paddingRight) - parseInt(elCSS.borderLeftWidth) - parseInt(elCSS.borderRightWidth), child1 = getChild(el, 0, options), child2 = getChild(el, 1, options), firstChildCSS = child1 && css(child1), secondChildCSS = child2 && css(child2), firstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + getRect(child1).width, secondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + getRect(child2).width;
  if (elCSS.display === "flex") {
    return elCSS.flexDirection === "column" || elCSS.flexDirection === "column-reverse" ? "vertical" : "horizontal";
  }
  if (elCSS.display === "grid") {
    return elCSS.gridTemplateColumns.split(" ").length <= 1 ? "vertical" : "horizontal";
  }
  if (child1 && firstChildCSS["float"] && firstChildCSS["float"] !== "none") {
    var touchingSideChild2 = firstChildCSS["float"] === "left" ? "left" : "right";
    return child2 && (secondChildCSS.clear === "both" || secondChildCSS.clear === touchingSideChild2) ? "vertical" : "horizontal";
  }
  return child1 && (firstChildCSS.display === "block" || firstChildCSS.display === "flex" || firstChildCSS.display === "table" || firstChildCSS.display === "grid" || firstChildWidth >= elWidth && elCSS[CSSFloatProperty] === "none" || child2 && elCSS[CSSFloatProperty] === "none" && firstChildWidth + secondChildWidth > elWidth) ? "vertical" : "horizontal";
};
var _dragElInRowColumn = function _dragElInRowColumn2(dragRect, targetRect, vertical) {
  var dragElS1Opp = vertical ? dragRect.left : dragRect.top, dragElS2Opp = vertical ? dragRect.right : dragRect.bottom, dragElOppLength = vertical ? dragRect.width : dragRect.height, targetS1Opp = vertical ? targetRect.left : targetRect.top, targetS2Opp = vertical ? targetRect.right : targetRect.bottom, targetOppLength = vertical ? targetRect.width : targetRect.height;
  return dragElS1Opp === targetS1Opp || dragElS2Opp === targetS2Opp || dragElS1Opp + dragElOppLength / 2 === targetS1Opp + targetOppLength / 2;
};
var _detectNearestEmptySortable = function _detectNearestEmptySortable2(x, y) {
  var ret;
  sortables.some(function(sortable) {
    var threshold = sortable[expando].options.emptyInsertThreshold;
    if (!threshold || lastChild(sortable))
      return;
    var rect = getRect(sortable), insideHorizontally = x >= rect.left - threshold && x <= rect.right + threshold, insideVertically = y >= rect.top - threshold && y <= rect.bottom + threshold;
    if (insideHorizontally && insideVertically) {
      return ret = sortable;
    }
  });
  return ret;
};
var _prepareGroup = function _prepareGroup2(options) {
  function toFn(value, pull) {
    return function(to, from, dragEl2, evt) {
      var sameGroup = to.options.group.name && from.options.group.name && to.options.group.name === from.options.group.name;
      if (value == null && (pull || sameGroup)) {
        return true;
      } else if (value == null || value === false) {
        return false;
      } else if (pull && value === "clone") {
        return value;
      } else if (typeof value === "function") {
        return toFn(value(to, from, dragEl2, evt), pull)(to, from, dragEl2, evt);
      } else {
        var otherGroup = (pull ? to : from).options.group.name;
        return value === true || typeof value === "string" && value === otherGroup || value.join && value.indexOf(otherGroup) > -1;
      }
    };
  }
  var group = {};
  var originalGroup = options.group;
  if (!originalGroup || _typeof(originalGroup) != "object") {
    originalGroup = {
      name: originalGroup
    };
  }
  group.name = originalGroup.name;
  group.checkPull = toFn(originalGroup.pull, true);
  group.checkPut = toFn(originalGroup.put);
  group.revertClone = originalGroup.revertClone;
  options.group = group;
};
var _hideGhostForTarget = function _hideGhostForTarget2() {
  if (!supportCssPointerEvents && ghostEl) {
    css(ghostEl, "display", "none");
  }
};
var _unhideGhostForTarget = function _unhideGhostForTarget2() {
  if (!supportCssPointerEvents && ghostEl) {
    css(ghostEl, "display", "");
  }
};
if (documentExists && !ChromeForAndroid) {
  document.addEventListener("click", function(evt) {
    if (ignoreNextClick) {
      evt.preventDefault();
      evt.stopPropagation && evt.stopPropagation();
      evt.stopImmediatePropagation && evt.stopImmediatePropagation();
      ignoreNextClick = false;
      return false;
    }
  }, true);
}
var nearestEmptyInsertDetectEvent = function nearestEmptyInsertDetectEvent2(evt) {
  if (dragEl) {
    evt = evt.touches ? evt.touches[0] : evt;
    var nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);
    if (nearest) {
      var event = {};
      for (var i in evt) {
        if (evt.hasOwnProperty(i)) {
          event[i] = evt[i];
        }
      }
      event.target = event.rootEl = nearest;
      event.preventDefault = void 0;
      event.stopPropagation = void 0;
      nearest[expando]._onDragOver(event);
    }
  }
};
var _checkOutsideTargetEl = function _checkOutsideTargetEl2(evt) {
  if (dragEl) {
    dragEl.parentNode[expando]._isOutsideThisEl(evt.target);
  }
};
function Sortable(el, options) {
  if (!(el && el.nodeType && el.nodeType === 1)) {
    throw "Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(el));
  }
  this.el = el;
  this.options = options = _extends({}, options);
  el[expando] = this;
  var defaults2 = {
    group: null,
    sort: true,
    disabled: false,
    store: null,
    handle: null,
    draggable: /^[uo]l$/i.test(el.nodeName) ? ">li" : ">*",
    swapThreshold: 1,
    invertSwap: false,
    invertedSwapThreshold: null,
    removeCloneOnHide: true,
    direction: function direction() {
      return _detectDirection(el, this.options);
    },
    ghostClass: "sortable-ghost",
    chosenClass: "sortable-chosen",
    dragClass: "sortable-drag",
    ignore: "a, img",
    filter: null,
    preventOnFilter: true,
    animation: 0,
    easing: null,
    setData: function setData(dataTransfer, dragEl2) {
      dataTransfer.setData("Text", dragEl2.textContent);
    },
    dropBubble: false,
    dragoverBubble: false,
    dataIdAttr: "data-id",
    delay: 0,
    delayOnTouchOnly: false,
    touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1,
    forceFallback: false,
    fallbackClass: "sortable-fallback",
    fallbackOnBody: false,
    fallbackTolerance: 0,
    fallbackOffset: {
      x: 0,
      y: 0
    },
    supportPointer: Sortable.supportPointer !== false && "PointerEvent" in window && !Safari,
    emptyInsertThreshold: 5
  };
  PluginManager.initializePlugins(this, el, defaults2);
  for (var name in defaults2) {
    !(name in options) && (options[name] = defaults2[name]);
  }
  _prepareGroup(options);
  for (var fn in this) {
    if (fn.charAt(0) === "_" && typeof this[fn] === "function") {
      this[fn] = this[fn].bind(this);
    }
  }
  this.nativeDraggable = options.forceFallback ? false : supportDraggable;
  if (this.nativeDraggable) {
    this.options.touchStartThreshold = 1;
  }
  if (options.supportPointer) {
    on(el, "pointerdown", this._onTapStart);
  } else {
    on(el, "mousedown", this._onTapStart);
    on(el, "touchstart", this._onTapStart);
  }
  if (this.nativeDraggable) {
    on(el, "dragover", this);
    on(el, "dragenter", this);
  }
  sortables.push(this.el);
  options.store && options.store.get && this.sort(options.store.get(this) || []);
  _extends(this, AnimationStateManager());
}
Sortable.prototype = {
  constructor: Sortable,
  _isOutsideThisEl: function _isOutsideThisEl(target) {
    if (!this.el.contains(target) && target !== this.el) {
      lastTarget = null;
    }
  },
  _getDirection: function _getDirection(evt, target) {
    return typeof this.options.direction === "function" ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;
  },
  _onTapStart: function _onTapStart(evt) {
    if (!evt.cancelable)
      return;
    var _this = this, el = this.el, options = this.options, preventOnFilter = options.preventOnFilter, type = evt.type, touch = evt.touches && evt.touches[0] || evt.pointerType && evt.pointerType === "touch" && evt, target = (touch || evt).target, originalTarget = evt.target.shadowRoot && (evt.path && evt.path[0] || evt.composedPath && evt.composedPath()[0]) || target, filter = options.filter;
    _saveInputCheckedState(el);
    if (dragEl) {
      return;
    }
    if (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {
      return;
    }
    if (originalTarget.isContentEditable) {
      return;
    }
    if (!this.nativeDraggable && Safari && target && target.tagName.toUpperCase() === "SELECT") {
      return;
    }
    target = closest(target, options.draggable, el, false);
    if (target && target.animated) {
      return;
    }
    if (lastDownEl === target) {
      return;
    }
    oldIndex = index(target);
    oldDraggableIndex = index(target, options.draggable);
    if (typeof filter === "function") {
      if (filter.call(this, evt, target, this)) {
        _dispatchEvent({
          sortable: _this,
          rootEl: originalTarget,
          name: "filter",
          targetEl: target,
          toEl: el,
          fromEl: el
        });
        pluginEvent2("filter", _this, {
          evt
        });
        preventOnFilter && evt.cancelable && evt.preventDefault();
        return;
      }
    } else if (filter) {
      filter = filter.split(",").some(function(criteria) {
        criteria = closest(originalTarget, criteria.trim(), el, false);
        if (criteria) {
          _dispatchEvent({
            sortable: _this,
            rootEl: criteria,
            name: "filter",
            targetEl: target,
            fromEl: el,
            toEl: el
          });
          pluginEvent2("filter", _this, {
            evt
          });
          return true;
        }
      });
      if (filter) {
        preventOnFilter && evt.cancelable && evt.preventDefault();
        return;
      }
    }
    if (options.handle && !closest(originalTarget, options.handle, el, false)) {
      return;
    }
    this._prepareDragStart(evt, touch, target);
  },
  _prepareDragStart: function _prepareDragStart(evt, touch, target) {
    var _this = this, el = _this.el, options = _this.options, ownerDocument = el.ownerDocument, dragStartFn;
    if (target && !dragEl && target.parentNode === el) {
      var dragRect = getRect(target);
      rootEl = el;
      dragEl = target;
      parentEl = dragEl.parentNode;
      nextEl = dragEl.nextSibling;
      lastDownEl = target;
      activeGroup = options.group;
      Sortable.dragged = dragEl;
      tapEvt = {
        target: dragEl,
        clientX: (touch || evt).clientX,
        clientY: (touch || evt).clientY
      };
      tapDistanceLeft = tapEvt.clientX - dragRect.left;
      tapDistanceTop = tapEvt.clientY - dragRect.top;
      this._lastX = (touch || evt).clientX;
      this._lastY = (touch || evt).clientY;
      dragEl.style["will-change"] = "all";
      dragStartFn = function dragStartFn2() {
        pluginEvent2("delayEnded", _this, {
          evt
        });
        if (Sortable.eventCanceled) {
          _this._onDrop();
          return;
        }
        _this._disableDelayedDragEvents();
        if (!FireFox && _this.nativeDraggable) {
          dragEl.draggable = true;
        }
        _this._triggerDragStart(evt, touch);
        _dispatchEvent({
          sortable: _this,
          name: "choose",
          originalEvent: evt
        });
        toggleClass(dragEl, options.chosenClass, true);
      };
      options.ignore.split(",").forEach(function(criteria) {
        find(dragEl, criteria.trim(), _disableDraggable);
      });
      on(ownerDocument, "dragover", nearestEmptyInsertDetectEvent);
      on(ownerDocument, "mousemove", nearestEmptyInsertDetectEvent);
      on(ownerDocument, "touchmove", nearestEmptyInsertDetectEvent);
      on(ownerDocument, "mouseup", _this._onDrop);
      on(ownerDocument, "touchend", _this._onDrop);
      on(ownerDocument, "touchcancel", _this._onDrop);
      if (FireFox && this.nativeDraggable) {
        this.options.touchStartThreshold = 4;
        dragEl.draggable = true;
      }
      pluginEvent2("delayStart", this, {
        evt
      });
      if (options.delay && (!options.delayOnTouchOnly || touch) && (!this.nativeDraggable || !(Edge || IE11OrLess))) {
        if (Sortable.eventCanceled) {
          this._onDrop();
          return;
        }
        on(ownerDocument, "mouseup", _this._disableDelayedDrag);
        on(ownerDocument, "touchend", _this._disableDelayedDrag);
        on(ownerDocument, "touchcancel", _this._disableDelayedDrag);
        on(ownerDocument, "mousemove", _this._delayedDragTouchMoveHandler);
        on(ownerDocument, "touchmove", _this._delayedDragTouchMoveHandler);
        options.supportPointer && on(ownerDocument, "pointermove", _this._delayedDragTouchMoveHandler);
        _this._dragStartTimer = setTimeout(dragStartFn, options.delay);
      } else {
        dragStartFn();
      }
    }
  },
  _delayedDragTouchMoveHandler: function _delayedDragTouchMoveHandler(e) {
    var touch = e.touches ? e.touches[0] : e;
    if (Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1))) {
      this._disableDelayedDrag();
    }
  },
  _disableDelayedDrag: function _disableDelayedDrag() {
    dragEl && _disableDraggable(dragEl);
    clearTimeout(this._dragStartTimer);
    this._disableDelayedDragEvents();
  },
  _disableDelayedDragEvents: function _disableDelayedDragEvents() {
    var ownerDocument = this.el.ownerDocument;
    off(ownerDocument, "mouseup", this._disableDelayedDrag);
    off(ownerDocument, "touchend", this._disableDelayedDrag);
    off(ownerDocument, "touchcancel", this._disableDelayedDrag);
    off(ownerDocument, "mousemove", this._delayedDragTouchMoveHandler);
    off(ownerDocument, "touchmove", this._delayedDragTouchMoveHandler);
    off(ownerDocument, "pointermove", this._delayedDragTouchMoveHandler);
  },
  _triggerDragStart: function _triggerDragStart(evt, touch) {
    touch = touch || evt.pointerType == "touch" && evt;
    if (!this.nativeDraggable || touch) {
      if (this.options.supportPointer) {
        on(document, "pointermove", this._onTouchMove);
      } else if (touch) {
        on(document, "touchmove", this._onTouchMove);
      } else {
        on(document, "mousemove", this._onTouchMove);
      }
    } else {
      on(dragEl, "dragend", this);
      on(rootEl, "dragstart", this._onDragStart);
    }
    try {
      if (document.selection) {
        _nextTick(function() {
          document.selection.empty();
        });
      } else {
        window.getSelection().removeAllRanges();
      }
    } catch (err) {
    }
  },
  _dragStarted: function _dragStarted(fallback, evt) {
    awaitingDragStarted = false;
    if (rootEl && dragEl) {
      pluginEvent2("dragStarted", this, {
        evt
      });
      if (this.nativeDraggable) {
        on(document, "dragover", _checkOutsideTargetEl);
      }
      var options = this.options;
      !fallback && toggleClass(dragEl, options.dragClass, false);
      toggleClass(dragEl, options.ghostClass, true);
      Sortable.active = this;
      fallback && this._appendGhost();
      _dispatchEvent({
        sortable: this,
        name: "start",
        originalEvent: evt
      });
    } else {
      this._nulling();
    }
  },
  _emulateDragOver: function _emulateDragOver() {
    if (touchEvt) {
      this._lastX = touchEvt.clientX;
      this._lastY = touchEvt.clientY;
      _hideGhostForTarget();
      var target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);
      var parent = target;
      while (target && target.shadowRoot) {
        target = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);
        if (target === parent)
          break;
        parent = target;
      }
      dragEl.parentNode[expando]._isOutsideThisEl(target);
      if (parent) {
        do {
          if (parent[expando]) {
            var inserted = void 0;
            inserted = parent[expando]._onDragOver({
              clientX: touchEvt.clientX,
              clientY: touchEvt.clientY,
              target,
              rootEl: parent
            });
            if (inserted && !this.options.dragoverBubble) {
              break;
            }
          }
          target = parent;
        } while (parent = parent.parentNode);
      }
      _unhideGhostForTarget();
    }
  },
  _onTouchMove: function _onTouchMove(evt) {
    if (tapEvt) {
      var options = this.options, fallbackTolerance = options.fallbackTolerance, fallbackOffset = options.fallbackOffset, touch = evt.touches ? evt.touches[0] : evt, ghostMatrix = ghostEl && matrix(ghostEl, true), scaleX = ghostEl && ghostMatrix && ghostMatrix.a, scaleY = ghostEl && ghostMatrix && ghostMatrix.d, relativeScrollOffset = PositionGhostAbsolutely && ghostRelativeParent && getRelativeScrollOffset(ghostRelativeParent), dx = (touch.clientX - tapEvt.clientX + fallbackOffset.x) / (scaleX || 1) + (relativeScrollOffset ? relativeScrollOffset[0] - ghostRelativeParentInitialScroll[0] : 0) / (scaleX || 1), dy = (touch.clientY - tapEvt.clientY + fallbackOffset.y) / (scaleY || 1) + (relativeScrollOffset ? relativeScrollOffset[1] - ghostRelativeParentInitialScroll[1] : 0) / (scaleY || 1);
      if (!Sortable.active && !awaitingDragStarted) {
        if (fallbackTolerance && Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) < fallbackTolerance) {
          return;
        }
        this._onDragStart(evt, true);
      }
      if (ghostEl) {
        if (ghostMatrix) {
          ghostMatrix.e += dx - (lastDx || 0);
          ghostMatrix.f += dy - (lastDy || 0);
        } else {
          ghostMatrix = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            e: dx,
            f: dy
          };
        }
        var cssMatrix = "matrix(".concat(ghostMatrix.a, ",").concat(ghostMatrix.b, ",").concat(ghostMatrix.c, ",").concat(ghostMatrix.d, ",").concat(ghostMatrix.e, ",").concat(ghostMatrix.f, ")");
        css(ghostEl, "webkitTransform", cssMatrix);
        css(ghostEl, "mozTransform", cssMatrix);
        css(ghostEl, "msTransform", cssMatrix);
        css(ghostEl, "transform", cssMatrix);
        lastDx = dx;
        lastDy = dy;
        touchEvt = touch;
      }
      evt.cancelable && evt.preventDefault();
    }
  },
  _appendGhost: function _appendGhost() {
    if (!ghostEl) {
      var container = this.options.fallbackOnBody ? document.body : rootEl, rect = getRect(dragEl, true, PositionGhostAbsolutely, true, container), options = this.options;
      if (PositionGhostAbsolutely) {
        ghostRelativeParent = container;
        while (css(ghostRelativeParent, "position") === "static" && css(ghostRelativeParent, "transform") === "none" && ghostRelativeParent !== document) {
          ghostRelativeParent = ghostRelativeParent.parentNode;
        }
        if (ghostRelativeParent !== document.body && ghostRelativeParent !== document.documentElement) {
          if (ghostRelativeParent === document)
            ghostRelativeParent = getWindowScrollingElement();
          rect.top += ghostRelativeParent.scrollTop;
          rect.left += ghostRelativeParent.scrollLeft;
        } else {
          ghostRelativeParent = getWindowScrollingElement();
        }
        ghostRelativeParentInitialScroll = getRelativeScrollOffset(ghostRelativeParent);
      }
      ghostEl = dragEl.cloneNode(true);
      toggleClass(ghostEl, options.ghostClass, false);
      toggleClass(ghostEl, options.fallbackClass, true);
      toggleClass(ghostEl, options.dragClass, true);
      css(ghostEl, "transition", "");
      css(ghostEl, "transform", "");
      css(ghostEl, "box-sizing", "border-box");
      css(ghostEl, "margin", 0);
      css(ghostEl, "top", rect.top);
      css(ghostEl, "left", rect.left);
      css(ghostEl, "width", rect.width);
      css(ghostEl, "height", rect.height);
      css(ghostEl, "opacity", "0.8");
      css(ghostEl, "position", PositionGhostAbsolutely ? "absolute" : "fixed");
      css(ghostEl, "zIndex", "100000");
      css(ghostEl, "pointerEvents", "none");
      Sortable.ghost = ghostEl;
      container.appendChild(ghostEl);
      css(ghostEl, "transform-origin", tapDistanceLeft / parseInt(ghostEl.style.width) * 100 + "% " + tapDistanceTop / parseInt(ghostEl.style.height) * 100 + "%");
    }
  },
  _onDragStart: function _onDragStart(evt, fallback) {
    var _this = this;
    var dataTransfer = evt.dataTransfer;
    var options = _this.options;
    pluginEvent2("dragStart", this, {
      evt
    });
    if (Sortable.eventCanceled) {
      this._onDrop();
      return;
    }
    pluginEvent2("setupClone", this);
    if (!Sortable.eventCanceled) {
      cloneEl = clone(dragEl);
      cloneEl.removeAttribute("id");
      cloneEl.draggable = false;
      cloneEl.style["will-change"] = "";
      this._hideClone();
      toggleClass(cloneEl, this.options.chosenClass, false);
      Sortable.clone = cloneEl;
    }
    _this.cloneId = _nextTick(function() {
      pluginEvent2("clone", _this);
      if (Sortable.eventCanceled)
        return;
      if (!_this.options.removeCloneOnHide) {
        rootEl.insertBefore(cloneEl, dragEl);
      }
      _this._hideClone();
      _dispatchEvent({
        sortable: _this,
        name: "clone"
      });
    });
    !fallback && toggleClass(dragEl, options.dragClass, true);
    if (fallback) {
      ignoreNextClick = true;
      _this._loopId = setInterval(_this._emulateDragOver, 50);
    } else {
      off(document, "mouseup", _this._onDrop);
      off(document, "touchend", _this._onDrop);
      off(document, "touchcancel", _this._onDrop);
      if (dataTransfer) {
        dataTransfer.effectAllowed = "move";
        options.setData && options.setData.call(_this, dataTransfer, dragEl);
      }
      on(document, "drop", _this);
      css(dragEl, "transform", "translateZ(0)");
    }
    awaitingDragStarted = true;
    _this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback, evt));
    on(document, "selectstart", _this);
    moved = true;
    if (Safari) {
      css(document.body, "user-select", "none");
    }
  },
  _onDragOver: function _onDragOver(evt) {
    var el = this.el, target = evt.target, dragRect, targetRect, revert, options = this.options, group = options.group, activeSortable = Sortable.active, isOwner = activeGroup === group, canSort = options.sort, fromSortable = putSortable || activeSortable, vertical, _this = this, completedFired = false;
    if (_silent)
      return;
    function dragOverEvent(name, extra) {
      pluginEvent2(name, _this, _objectSpread2({
        evt,
        isOwner,
        axis: vertical ? "vertical" : "horizontal",
        revert,
        dragRect,
        targetRect,
        canSort,
        fromSortable,
        target,
        completed,
        onMove: function onMove(target2, after2) {
          return _onMove(rootEl, el, dragEl, dragRect, target2, getRect(target2), evt, after2);
        },
        changed
      }, extra));
    }
    function capture() {
      dragOverEvent("dragOverAnimationCapture");
      _this.captureAnimationState();
      if (_this !== fromSortable) {
        fromSortable.captureAnimationState();
      }
    }
    function completed(insertion) {
      dragOverEvent("dragOverCompleted", {
        insertion
      });
      if (insertion) {
        if (isOwner) {
          activeSortable._hideClone();
        } else {
          activeSortable._showClone(_this);
        }
        if (_this !== fromSortable) {
          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);
          toggleClass(dragEl, options.ghostClass, true);
        }
        if (putSortable !== _this && _this !== Sortable.active) {
          putSortable = _this;
        } else if (_this === Sortable.active && putSortable) {
          putSortable = null;
        }
        if (fromSortable === _this) {
          _this._ignoreWhileAnimating = target;
        }
        _this.animateAll(function() {
          dragOverEvent("dragOverAnimationComplete");
          _this._ignoreWhileAnimating = null;
        });
        if (_this !== fromSortable) {
          fromSortable.animateAll();
          fromSortable._ignoreWhileAnimating = null;
        }
      }
      if (target === dragEl && !dragEl.animated || target === el && !target.animated) {
        lastTarget = null;
      }
      if (!options.dragoverBubble && !evt.rootEl && target !== document) {
        dragEl.parentNode[expando]._isOutsideThisEl(evt.target);
        !insertion && nearestEmptyInsertDetectEvent(evt);
      }
      !options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();
      return completedFired = true;
    }
    function changed() {
      newIndex = index(dragEl);
      newDraggableIndex = index(dragEl, options.draggable);
      _dispatchEvent({
        sortable: _this,
        name: "change",
        toEl: el,
        newIndex,
        newDraggableIndex,
        originalEvent: evt
      });
    }
    if (evt.preventDefault !== void 0) {
      evt.cancelable && evt.preventDefault();
    }
    target = closest(target, options.draggable, el, true);
    dragOverEvent("dragOver");
    if (Sortable.eventCanceled)
      return completedFired;
    if (dragEl.contains(evt.target) || target.animated && target.animatingX && target.animatingY || _this._ignoreWhileAnimating === target) {
      return completed(false);
    }
    ignoreNextClick = false;
    if (activeSortable && !options.disabled && (isOwner ? canSort || (revert = parentEl !== rootEl) : putSortable === this || (this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) && group.checkPut(this, activeSortable, dragEl, evt))) {
      vertical = this._getDirection(evt, target) === "vertical";
      dragRect = getRect(dragEl);
      dragOverEvent("dragOverValid");
      if (Sortable.eventCanceled)
        return completedFired;
      if (revert) {
        parentEl = rootEl;
        capture();
        this._hideClone();
        dragOverEvent("revert");
        if (!Sortable.eventCanceled) {
          if (nextEl) {
            rootEl.insertBefore(dragEl, nextEl);
          } else {
            rootEl.appendChild(dragEl);
          }
        }
        return completed(true);
      }
      var elLastChild = lastChild(el, options.draggable);
      if (!elLastChild || _ghostIsLast(evt, vertical, this) && !elLastChild.animated) {
        if (elLastChild === dragEl) {
          return completed(false);
        }
        if (elLastChild && el === evt.target) {
          target = elLastChild;
        }
        if (target) {
          targetRect = getRect(target);
        }
        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {
          capture();
          if (elLastChild && elLastChild.nextSibling) {
            el.insertBefore(dragEl, elLastChild.nextSibling);
          } else {
            el.appendChild(dragEl);
          }
          parentEl = el;
          changed();
          return completed(true);
        }
      } else if (elLastChild && _ghostIsFirst(evt, vertical, this)) {
        var firstChild = getChild(el, 0, options, true);
        if (firstChild === dragEl) {
          return completed(false);
        }
        target = firstChild;
        targetRect = getRect(target);
        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, false) !== false) {
          capture();
          el.insertBefore(dragEl, firstChild);
          parentEl = el;
          changed();
          return completed(true);
        }
      } else if (target.parentNode === el) {
        targetRect = getRect(target);
        var direction = 0, targetBeforeFirstSwap, differentLevel = dragEl.parentNode !== el, differentRowCol = !_dragElInRowColumn(dragEl.animated && dragEl.toRect || dragRect, target.animated && target.toRect || targetRect, vertical), side1 = vertical ? "top" : "left", scrolledPastTop = isScrolledPast(target, "top", "top") || isScrolledPast(dragEl, "top", "top"), scrollBefore = scrolledPastTop ? scrolledPastTop.scrollTop : void 0;
        if (lastTarget !== target) {
          targetBeforeFirstSwap = targetRect[side1];
          pastFirstInvertThresh = false;
          isCircumstantialInvert = !differentRowCol && options.invertSwap || differentLevel;
        }
        direction = _getSwapDirection(evt, target, targetRect, vertical, differentRowCol ? 1 : options.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold, isCircumstantialInvert, lastTarget === target);
        var sibling;
        if (direction !== 0) {
          var dragIndex = index(dragEl);
          do {
            dragIndex -= direction;
            sibling = parentEl.children[dragIndex];
          } while (sibling && (css(sibling, "display") === "none" || sibling === ghostEl));
        }
        if (direction === 0 || sibling === target) {
          return completed(false);
        }
        lastTarget = target;
        lastDirection = direction;
        var nextSibling = target.nextElementSibling, after = false;
        after = direction === 1;
        var moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);
        if (moveVector !== false) {
          if (moveVector === 1 || moveVector === -1) {
            after = moveVector === 1;
          }
          _silent = true;
          setTimeout(_unsilent, 30);
          capture();
          if (after && !nextSibling) {
            el.appendChild(dragEl);
          } else {
            target.parentNode.insertBefore(dragEl, after ? nextSibling : target);
          }
          if (scrolledPastTop) {
            scrollBy(scrolledPastTop, 0, scrollBefore - scrolledPastTop.scrollTop);
          }
          parentEl = dragEl.parentNode;
          if (targetBeforeFirstSwap !== void 0 && !isCircumstantialInvert) {
            targetMoveDistance = Math.abs(targetBeforeFirstSwap - getRect(target)[side1]);
          }
          changed();
          return completed(true);
        }
      }
      if (el.contains(dragEl)) {
        return completed(false);
      }
    }
    return false;
  },
  _ignoreWhileAnimating: null,
  _offMoveEvents: function _offMoveEvents() {
    off(document, "mousemove", this._onTouchMove);
    off(document, "touchmove", this._onTouchMove);
    off(document, "pointermove", this._onTouchMove);
    off(document, "dragover", nearestEmptyInsertDetectEvent);
    off(document, "mousemove", nearestEmptyInsertDetectEvent);
    off(document, "touchmove", nearestEmptyInsertDetectEvent);
  },
  _offUpEvents: function _offUpEvents() {
    var ownerDocument = this.el.ownerDocument;
    off(ownerDocument, "mouseup", this._onDrop);
    off(ownerDocument, "touchend", this._onDrop);
    off(ownerDocument, "pointerup", this._onDrop);
    off(ownerDocument, "touchcancel", this._onDrop);
    off(document, "selectstart", this);
  },
  _onDrop: function _onDrop(evt) {
    var el = this.el, options = this.options;
    newIndex = index(dragEl);
    newDraggableIndex = index(dragEl, options.draggable);
    pluginEvent2("drop", this, {
      evt
    });
    parentEl = dragEl && dragEl.parentNode;
    newIndex = index(dragEl);
    newDraggableIndex = index(dragEl, options.draggable);
    if (Sortable.eventCanceled) {
      this._nulling();
      return;
    }
    awaitingDragStarted = false;
    isCircumstantialInvert = false;
    pastFirstInvertThresh = false;
    clearInterval(this._loopId);
    clearTimeout(this._dragStartTimer);
    _cancelNextTick(this.cloneId);
    _cancelNextTick(this._dragStartId);
    if (this.nativeDraggable) {
      off(document, "drop", this);
      off(el, "dragstart", this._onDragStart);
    }
    this._offMoveEvents();
    this._offUpEvents();
    if (Safari) {
      css(document.body, "user-select", "");
    }
    css(dragEl, "transform", "");
    if (evt) {
      if (moved) {
        evt.cancelable && evt.preventDefault();
        !options.dropBubble && evt.stopPropagation();
      }
      ghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);
      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== "clone") {
        cloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);
      }
      if (dragEl) {
        if (this.nativeDraggable) {
          off(dragEl, "dragend", this);
        }
        _disableDraggable(dragEl);
        dragEl.style["will-change"] = "";
        if (moved && !awaitingDragStarted) {
          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);
        }
        toggleClass(dragEl, this.options.chosenClass, false);
        _dispatchEvent({
          sortable: this,
          name: "unchoose",
          toEl: parentEl,
          newIndex: null,
          newDraggableIndex: null,
          originalEvent: evt
        });
        if (rootEl !== parentEl) {
          if (newIndex >= 0) {
            _dispatchEvent({
              rootEl: parentEl,
              name: "add",
              toEl: parentEl,
              fromEl: rootEl,
              originalEvent: evt
            });
            _dispatchEvent({
              sortable: this,
              name: "remove",
              toEl: parentEl,
              originalEvent: evt
            });
            _dispatchEvent({
              rootEl: parentEl,
              name: "sort",
              toEl: parentEl,
              fromEl: rootEl,
              originalEvent: evt
            });
            _dispatchEvent({
              sortable: this,
              name: "sort",
              toEl: parentEl,
              originalEvent: evt
            });
          }
          putSortable && putSortable.save();
        } else {
          if (newIndex !== oldIndex) {
            if (newIndex >= 0) {
              _dispatchEvent({
                sortable: this,
                name: "update",
                toEl: parentEl,
                originalEvent: evt
              });
              _dispatchEvent({
                sortable: this,
                name: "sort",
                toEl: parentEl,
                originalEvent: evt
              });
            }
          }
        }
        if (Sortable.active) {
          if (newIndex == null || newIndex === -1) {
            newIndex = oldIndex;
            newDraggableIndex = oldDraggableIndex;
          }
          _dispatchEvent({
            sortable: this,
            name: "end",
            toEl: parentEl,
            originalEvent: evt
          });
          this.save();
        }
      }
    }
    this._nulling();
  },
  _nulling: function _nulling() {
    pluginEvent2("nulling", this);
    rootEl = dragEl = parentEl = ghostEl = nextEl = cloneEl = lastDownEl = cloneHidden = tapEvt = touchEvt = moved = newIndex = newDraggableIndex = oldIndex = oldDraggableIndex = lastTarget = lastDirection = putSortable = activeGroup = Sortable.dragged = Sortable.ghost = Sortable.clone = Sortable.active = null;
    savedInputChecked.forEach(function(el) {
      el.checked = true;
    });
    savedInputChecked.length = lastDx = lastDy = 0;
  },
  handleEvent: function handleEvent(evt) {
    switch (evt.type) {
      case "drop":
      case "dragend":
        this._onDrop(evt);
        break;
      case "dragenter":
      case "dragover":
        if (dragEl) {
          this._onDragOver(evt);
          _globalDragOver(evt);
        }
        break;
      case "selectstart":
        evt.preventDefault();
        break;
    }
  },
  toArray: function toArray() {
    var order = [], el, children = this.el.children, i = 0, n = children.length, options = this.options;
    for (; i < n; i++) {
      el = children[i];
      if (closest(el, options.draggable, this.el, false)) {
        order.push(el.getAttribute(options.dataIdAttr) || _generateId(el));
      }
    }
    return order;
  },
  sort: function sort(order, useAnimation) {
    var items = {}, rootEl2 = this.el;
    this.toArray().forEach(function(id, i) {
      var el = rootEl2.children[i];
      if (closest(el, this.options.draggable, rootEl2, false)) {
        items[id] = el;
      }
    }, this);
    useAnimation && this.captureAnimationState();
    order.forEach(function(id) {
      if (items[id]) {
        rootEl2.removeChild(items[id]);
        rootEl2.appendChild(items[id]);
      }
    });
    useAnimation && this.animateAll();
  },
  save: function save() {
    var store = this.options.store;
    store && store.set && store.set(this);
  },
  closest: function closest$1(el, selector) {
    return closest(el, selector || this.options.draggable, this.el, false);
  },
  option: function option(name, value) {
    var options = this.options;
    if (value === void 0) {
      return options[name];
    } else {
      var modifiedValue = PluginManager.modifyOption(this, name, value);
      if (typeof modifiedValue !== "undefined") {
        options[name] = modifiedValue;
      } else {
        options[name] = value;
      }
      if (name === "group") {
        _prepareGroup(options);
      }
    }
  },
  destroy: function destroy() {
    pluginEvent2("destroy", this);
    var el = this.el;
    el[expando] = null;
    off(el, "mousedown", this._onTapStart);
    off(el, "touchstart", this._onTapStart);
    off(el, "pointerdown", this._onTapStart);
    if (this.nativeDraggable) {
      off(el, "dragover", this);
      off(el, "dragenter", this);
    }
    Array.prototype.forEach.call(el.querySelectorAll("[draggable]"), function(el2) {
      el2.removeAttribute("draggable");
    });
    this._onDrop();
    this._disableDelayedDragEvents();
    sortables.splice(sortables.indexOf(this.el), 1);
    this.el = el = null;
  },
  _hideClone: function _hideClone() {
    if (!cloneHidden) {
      pluginEvent2("hideClone", this);
      if (Sortable.eventCanceled)
        return;
      css(cloneEl, "display", "none");
      if (this.options.removeCloneOnHide && cloneEl.parentNode) {
        cloneEl.parentNode.removeChild(cloneEl);
      }
      cloneHidden = true;
    }
  },
  _showClone: function _showClone(putSortable2) {
    if (putSortable2.lastPutMode !== "clone") {
      this._hideClone();
      return;
    }
    if (cloneHidden) {
      pluginEvent2("showClone", this);
      if (Sortable.eventCanceled)
        return;
      if (dragEl.parentNode == rootEl && !this.options.group.revertClone) {
        rootEl.insertBefore(cloneEl, dragEl);
      } else if (nextEl) {
        rootEl.insertBefore(cloneEl, nextEl);
      } else {
        rootEl.appendChild(cloneEl);
      }
      if (this.options.group.revertClone) {
        this.animate(dragEl, cloneEl);
      }
      css(cloneEl, "display", "");
      cloneHidden = false;
    }
  }
};
function _globalDragOver(evt) {
  if (evt.dataTransfer) {
    evt.dataTransfer.dropEffect = "move";
  }
  evt.cancelable && evt.preventDefault();
}
function _onMove(fromEl, toEl, dragEl2, dragRect, targetEl, targetRect, originalEvent, willInsertAfter) {
  var evt, sortable = fromEl[expando], onMoveFn = sortable.options.onMove, retVal;
  if (window.CustomEvent && !IE11OrLess && !Edge) {
    evt = new CustomEvent("move", {
      bubbles: true,
      cancelable: true
    });
  } else {
    evt = document.createEvent("Event");
    evt.initEvent("move", true, true);
  }
  evt.to = toEl;
  evt.from = fromEl;
  evt.dragged = dragEl2;
  evt.draggedRect = dragRect;
  evt.related = targetEl || toEl;
  evt.relatedRect = targetRect || getRect(toEl);
  evt.willInsertAfter = willInsertAfter;
  evt.originalEvent = originalEvent;
  fromEl.dispatchEvent(evt);
  if (onMoveFn) {
    retVal = onMoveFn.call(sortable, evt, originalEvent);
  }
  return retVal;
}
function _disableDraggable(el) {
  el.draggable = false;
}
function _unsilent() {
  _silent = false;
}
function _ghostIsFirst(evt, vertical, sortable) {
  var firstElRect = getRect(getChild(sortable.el, 0, sortable.options, true));
  var sortableContentRect = getContentRect(sortable.el);
  var spacer = 10;
  return vertical ? evt.clientX < sortableContentRect.left - spacer || evt.clientY < firstElRect.top && evt.clientX < firstElRect.right : evt.clientY < sortableContentRect.top - spacer || evt.clientY < firstElRect.bottom && evt.clientX < firstElRect.left;
}
function _ghostIsLast(evt, vertical, sortable) {
  var lastElRect = getRect(lastChild(sortable.el, sortable.options.draggable));
  var sortableContentRect = getContentRect(sortable.el);
  var spacer = 10;
  return vertical ? evt.clientX > sortableContentRect.right + spacer || evt.clientY > lastElRect.bottom && evt.clientX > lastElRect.left : evt.clientY > sortableContentRect.bottom + spacer || evt.clientX > lastElRect.right && evt.clientY > lastElRect.top;
}
function _getSwapDirection(evt, target, targetRect, vertical, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {
  var mouseOnAxis = vertical ? evt.clientY : evt.clientX, targetLength = vertical ? targetRect.height : targetRect.width, targetS1 = vertical ? targetRect.top : targetRect.left, targetS2 = vertical ? targetRect.bottom : targetRect.right, invert = false;
  if (!invertSwap) {
    if (isLastTarget && targetMoveDistance < targetLength * swapThreshold) {
      if (!pastFirstInvertThresh && (lastDirection === 1 ? mouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2 : mouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2)) {
        pastFirstInvertThresh = true;
      }
      if (!pastFirstInvertThresh) {
        if (lastDirection === 1 ? mouseOnAxis < targetS1 + targetMoveDistance : mouseOnAxis > targetS2 - targetMoveDistance) {
          return -lastDirection;
        }
      } else {
        invert = true;
      }
    } else {
      if (mouseOnAxis > targetS1 + targetLength * (1 - swapThreshold) / 2 && mouseOnAxis < targetS2 - targetLength * (1 - swapThreshold) / 2) {
        return _getInsertDirection(target);
      }
    }
  }
  invert = invert || invertSwap;
  if (invert) {
    if (mouseOnAxis < targetS1 + targetLength * invertedSwapThreshold / 2 || mouseOnAxis > targetS2 - targetLength * invertedSwapThreshold / 2) {
      return mouseOnAxis > targetS1 + targetLength / 2 ? 1 : -1;
    }
  }
  return 0;
}
function _getInsertDirection(target) {
  if (index(dragEl) < index(target)) {
    return 1;
  } else {
    return -1;
  }
}
function _generateId(el) {
  var str = el.tagName + el.className + el.src + el.href + el.textContent, i = str.length, sum = 0;
  while (i--) {
    sum += str.charCodeAt(i);
  }
  return sum.toString(36);
}
function _saveInputCheckedState(root) {
  savedInputChecked.length = 0;
  var inputs = root.getElementsByTagName("input");
  var idx = inputs.length;
  while (idx--) {
    var el = inputs[idx];
    el.checked && savedInputChecked.push(el);
  }
}
function _nextTick(fn) {
  return setTimeout(fn, 0);
}
function _cancelNextTick(id) {
  return clearTimeout(id);
}
if (documentExists) {
  on(document, "touchmove", function(evt) {
    if ((Sortable.active || awaitingDragStarted) && evt.cancelable) {
      evt.preventDefault();
    }
  });
}
Sortable.utils = {
  on,
  off,
  css,
  find,
  is: function is(el, selector) {
    return !!closest(el, selector, el, false);
  },
  extend,
  throttle,
  closest,
  toggleClass,
  clone,
  index,
  nextTick: _nextTick,
  cancelNextTick: _cancelNextTick,
  detectDirection: _detectDirection,
  getChild
};
Sortable.get = function(element) {
  return element[expando];
};
Sortable.mount = function() {
  for (var _len = arguments.length, plugins2 = new Array(_len), _key = 0; _key < _len; _key++) {
    plugins2[_key] = arguments[_key];
  }
  if (plugins2[0].constructor === Array)
    plugins2 = plugins2[0];
  plugins2.forEach(function(plugin) {
    if (!plugin.prototype || !plugin.prototype.constructor) {
      throw "Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(plugin));
    }
    if (plugin.utils)
      Sortable.utils = _objectSpread2(_objectSpread2({}, Sortable.utils), plugin.utils);
    PluginManager.mount(plugin);
  });
};
Sortable.create = function(el, options) {
  return new Sortable(el, options);
};
Sortable.version = version;
var autoScrolls = [];
var scrollEl;
var scrollRootEl;
var scrolling = false;
var lastAutoScrollX;
var lastAutoScrollY;
var touchEvt$1;
var pointerElemChangedInterval;
function AutoScrollPlugin() {
  function AutoScroll() {
    this.defaults = {
      scroll: true,
      forceAutoScrollFallback: false,
      scrollSensitivity: 30,
      scrollSpeed: 10,
      bubbleScroll: true
    };
    for (var fn in this) {
      if (fn.charAt(0) === "_" && typeof this[fn] === "function") {
        this[fn] = this[fn].bind(this);
      }
    }
  }
  AutoScroll.prototype = {
    dragStarted: function dragStarted2(_ref) {
      var originalEvent = _ref.originalEvent;
      if (this.sortable.nativeDraggable) {
        on(document, "dragover", this._handleAutoScroll);
      } else {
        if (this.options.supportPointer) {
          on(document, "pointermove", this._handleFallbackAutoScroll);
        } else if (originalEvent.touches) {
          on(document, "touchmove", this._handleFallbackAutoScroll);
        } else {
          on(document, "mousemove", this._handleFallbackAutoScroll);
        }
      }
    },
    dragOverCompleted: function dragOverCompleted(_ref2) {
      var originalEvent = _ref2.originalEvent;
      if (!this.options.dragOverBubble && !originalEvent.rootEl) {
        this._handleAutoScroll(originalEvent);
      }
    },
    drop: function drop3() {
      if (this.sortable.nativeDraggable) {
        off(document, "dragover", this._handleAutoScroll);
      } else {
        off(document, "pointermove", this._handleFallbackAutoScroll);
        off(document, "touchmove", this._handleFallbackAutoScroll);
        off(document, "mousemove", this._handleFallbackAutoScroll);
      }
      clearPointerElemChangedInterval();
      clearAutoScrolls();
      cancelThrottle();
    },
    nulling: function nulling() {
      touchEvt$1 = scrollRootEl = scrollEl = scrolling = pointerElemChangedInterval = lastAutoScrollX = lastAutoScrollY = null;
      autoScrolls.length = 0;
    },
    _handleFallbackAutoScroll: function _handleFallbackAutoScroll(evt) {
      this._handleAutoScroll(evt, true);
    },
    _handleAutoScroll: function _handleAutoScroll(evt, fallback) {
      var _this = this;
      var x = (evt.touches ? evt.touches[0] : evt).clientX, y = (evt.touches ? evt.touches[0] : evt).clientY, elem = document.elementFromPoint(x, y);
      touchEvt$1 = evt;
      if (fallback || this.options.forceAutoScrollFallback || Edge || IE11OrLess || Safari) {
        autoScroll(evt, this.options, elem, fallback);
        var ogElemScroller = getParentAutoScrollElement(elem, true);
        if (scrolling && (!pointerElemChangedInterval || x !== lastAutoScrollX || y !== lastAutoScrollY)) {
          pointerElemChangedInterval && clearPointerElemChangedInterval();
          pointerElemChangedInterval = setInterval(function() {
            var newElem = getParentAutoScrollElement(document.elementFromPoint(x, y), true);
            if (newElem !== ogElemScroller) {
              ogElemScroller = newElem;
              clearAutoScrolls();
            }
            autoScroll(evt, _this.options, newElem, fallback);
          }, 10);
          lastAutoScrollX = x;
          lastAutoScrollY = y;
        }
      } else {
        if (!this.options.bubbleScroll || getParentAutoScrollElement(elem, true) === getWindowScrollingElement()) {
          clearAutoScrolls();
          return;
        }
        autoScroll(evt, this.options, getParentAutoScrollElement(elem, false), false);
      }
    }
  };
  return _extends(AutoScroll, {
    pluginName: "scroll",
    initializeByDefault: true
  });
}
function clearAutoScrolls() {
  autoScrolls.forEach(function(autoScroll2) {
    clearInterval(autoScroll2.pid);
  });
  autoScrolls = [];
}
function clearPointerElemChangedInterval() {
  clearInterval(pointerElemChangedInterval);
}
var autoScroll = throttle(function(evt, options, rootEl2, isFallback) {
  if (!options.scroll)
    return;
  var x = (evt.touches ? evt.touches[0] : evt).clientX, y = (evt.touches ? evt.touches[0] : evt).clientY, sens = options.scrollSensitivity, speed = options.scrollSpeed, winScroller = getWindowScrollingElement();
  var scrollThisInstance = false, scrollCustomFn;
  if (scrollRootEl !== rootEl2) {
    scrollRootEl = rootEl2;
    clearAutoScrolls();
    scrollEl = options.scroll;
    scrollCustomFn = options.scrollFn;
    if (scrollEl === true) {
      scrollEl = getParentAutoScrollElement(rootEl2, true);
    }
  }
  var layersOut = 0;
  var currentParent = scrollEl;
  do {
    var el = currentParent, rect = getRect(el), top = rect.top, bottom = rect.bottom, left = rect.left, right = rect.right, width = rect.width, height = rect.height, canScrollX = void 0, canScrollY = void 0, scrollWidth = el.scrollWidth, scrollHeight = el.scrollHeight, elCSS = css(el), scrollPosX = el.scrollLeft, scrollPosY = el.scrollTop;
    if (el === winScroller) {
      canScrollX = width < scrollWidth && (elCSS.overflowX === "auto" || elCSS.overflowX === "scroll" || elCSS.overflowX === "visible");
      canScrollY = height < scrollHeight && (elCSS.overflowY === "auto" || elCSS.overflowY === "scroll" || elCSS.overflowY === "visible");
    } else {
      canScrollX = width < scrollWidth && (elCSS.overflowX === "auto" || elCSS.overflowX === "scroll");
      canScrollY = height < scrollHeight && (elCSS.overflowY === "auto" || elCSS.overflowY === "scroll");
    }
    var vx = canScrollX && (Math.abs(right - x) <= sens && scrollPosX + width < scrollWidth) - (Math.abs(left - x) <= sens && !!scrollPosX);
    var vy = canScrollY && (Math.abs(bottom - y) <= sens && scrollPosY + height < scrollHeight) - (Math.abs(top - y) <= sens && !!scrollPosY);
    if (!autoScrolls[layersOut]) {
      for (var i = 0; i <= layersOut; i++) {
        if (!autoScrolls[i]) {
          autoScrolls[i] = {};
        }
      }
    }
    if (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {
      autoScrolls[layersOut].el = el;
      autoScrolls[layersOut].vx = vx;
      autoScrolls[layersOut].vy = vy;
      clearInterval(autoScrolls[layersOut].pid);
      if (vx != 0 || vy != 0) {
        scrollThisInstance = true;
        autoScrolls[layersOut].pid = setInterval(function() {
          if (isFallback && this.layer === 0) {
            Sortable.active._onTouchMove(touchEvt$1);
          }
          var scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;
          var scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;
          if (typeof scrollCustomFn === "function") {
            if (scrollCustomFn.call(Sortable.dragged.parentNode[expando], scrollOffsetX, scrollOffsetY, evt, touchEvt$1, autoScrolls[this.layer].el) !== "continue") {
              return;
            }
          }
          scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);
        }.bind({
          layer: layersOut
        }), 24);
      }
    }
    layersOut++;
  } while (options.bubbleScroll && currentParent !== winScroller && (currentParent = getParentAutoScrollElement(currentParent, false)));
  scrolling = scrollThisInstance;
}, 30);
var drop = function drop2(_ref) {
  var originalEvent = _ref.originalEvent, putSortable2 = _ref.putSortable, dragEl2 = _ref.dragEl, activeSortable = _ref.activeSortable, dispatchSortableEvent = _ref.dispatchSortableEvent, hideGhostForTarget = _ref.hideGhostForTarget, unhideGhostForTarget = _ref.unhideGhostForTarget;
  if (!originalEvent)
    return;
  var toSortable = putSortable2 || activeSortable;
  hideGhostForTarget();
  var touch = originalEvent.changedTouches && originalEvent.changedTouches.length ? originalEvent.changedTouches[0] : originalEvent;
  var target = document.elementFromPoint(touch.clientX, touch.clientY);
  unhideGhostForTarget();
  if (toSortable && !toSortable.el.contains(target)) {
    dispatchSortableEvent("spill");
    this.onSpill({
      dragEl: dragEl2,
      putSortable: putSortable2
    });
  }
};
function Revert() {
}
Revert.prototype = {
  startIndex: null,
  dragStart: function dragStart(_ref2) {
    var oldDraggableIndex2 = _ref2.oldDraggableIndex;
    this.startIndex = oldDraggableIndex2;
  },
  onSpill: function onSpill(_ref3) {
    var dragEl2 = _ref3.dragEl, putSortable2 = _ref3.putSortable;
    this.sortable.captureAnimationState();
    if (putSortable2) {
      putSortable2.captureAnimationState();
    }
    var nextSibling = getChild(this.sortable.el, this.startIndex, this.options);
    if (nextSibling) {
      this.sortable.el.insertBefore(dragEl2, nextSibling);
    } else {
      this.sortable.el.appendChild(dragEl2);
    }
    this.sortable.animateAll();
    if (putSortable2) {
      putSortable2.animateAll();
    }
  },
  drop
};
_extends(Revert, {
  pluginName: "revertOnSpill"
});
function Remove() {
}
Remove.prototype = {
  onSpill: function onSpill2(_ref4) {
    var dragEl2 = _ref4.dragEl, putSortable2 = _ref4.putSortable;
    var parentSortable = putSortable2 || this.sortable;
    parentSortable.captureAnimationState();
    dragEl2.parentNode && dragEl2.parentNode.removeChild(dragEl2);
    parentSortable.animateAll();
  },
  drop
};
_extends(Remove, {
  pluginName: "removeOnSpill"
});
var multiDragElements = [];
var multiDragClones = [];
var lastMultiDragSelect;
var multiDragSortable;
var initialFolding = false;
var folding = false;
var dragStarted = false;
var dragEl$1;
var clonesFromRect;
var clonesHidden;
function MultiDragPlugin() {
  function MultiDrag(sortable) {
    for (var fn in this) {
      if (fn.charAt(0) === "_" && typeof this[fn] === "function") {
        this[fn] = this[fn].bind(this);
      }
    }
    if (!sortable.options.avoidImplicitDeselect) {
      if (sortable.options.supportPointer) {
        on(document, "pointerup", this._deselectMultiDrag);
      } else {
        on(document, "mouseup", this._deselectMultiDrag);
        on(document, "touchend", this._deselectMultiDrag);
      }
    }
    on(document, "keydown", this._checkKeyDown);
    on(document, "keyup", this._checkKeyUp);
    this.defaults = {
      selectedClass: "sortable-selected",
      multiDragKey: null,
      avoidImplicitDeselect: false,
      setData: function setData(dataTransfer, dragEl2) {
        var data = "";
        if (multiDragElements.length && multiDragSortable === sortable) {
          multiDragElements.forEach(function(multiDragElement, i) {
            data += (!i ? "" : ", ") + multiDragElement.textContent;
          });
        } else {
          data = dragEl2.textContent;
        }
        dataTransfer.setData("Text", data);
      }
    };
  }
  MultiDrag.prototype = {
    multiDragKeyDown: false,
    isMultiDrag: false,
    delayStartGlobal: function delayStartGlobal(_ref) {
      var dragged = _ref.dragEl;
      dragEl$1 = dragged;
    },
    delayEnded: function delayEnded() {
      this.isMultiDrag = ~multiDragElements.indexOf(dragEl$1);
    },
    setupClone: function setupClone(_ref2) {
      var sortable = _ref2.sortable, cancel = _ref2.cancel;
      if (!this.isMultiDrag)
        return;
      for (var i = 0; i < multiDragElements.length; i++) {
        multiDragClones.push(clone(multiDragElements[i]));
        multiDragClones[i].sortableIndex = multiDragElements[i].sortableIndex;
        multiDragClones[i].draggable = false;
        multiDragClones[i].style["will-change"] = "";
        toggleClass(multiDragClones[i], this.options.selectedClass, false);
        multiDragElements[i] === dragEl$1 && toggleClass(multiDragClones[i], this.options.chosenClass, false);
      }
      sortable._hideClone();
      cancel();
    },
    clone: function clone2(_ref3) {
      var sortable = _ref3.sortable, rootEl2 = _ref3.rootEl, dispatchSortableEvent = _ref3.dispatchSortableEvent, cancel = _ref3.cancel;
      if (!this.isMultiDrag)
        return;
      if (!this.options.removeCloneOnHide) {
        if (multiDragElements.length && multiDragSortable === sortable) {
          insertMultiDragClones(true, rootEl2);
          dispatchSortableEvent("clone");
          cancel();
        }
      }
    },
    showClone: function showClone(_ref4) {
      var cloneNowShown = _ref4.cloneNowShown, rootEl2 = _ref4.rootEl, cancel = _ref4.cancel;
      if (!this.isMultiDrag)
        return;
      insertMultiDragClones(false, rootEl2);
      multiDragClones.forEach(function(clone2) {
        css(clone2, "display", "");
      });
      cloneNowShown();
      clonesHidden = false;
      cancel();
    },
    hideClone: function hideClone(_ref5) {
      var _this = this;
      var sortable = _ref5.sortable, cloneNowHidden = _ref5.cloneNowHidden, cancel = _ref5.cancel;
      if (!this.isMultiDrag)
        return;
      multiDragClones.forEach(function(clone2) {
        css(clone2, "display", "none");
        if (_this.options.removeCloneOnHide && clone2.parentNode) {
          clone2.parentNode.removeChild(clone2);
        }
      });
      cloneNowHidden();
      clonesHidden = true;
      cancel();
    },
    dragStartGlobal: function dragStartGlobal(_ref6) {
      var sortable = _ref6.sortable;
      if (!this.isMultiDrag && multiDragSortable) {
        multiDragSortable.multiDrag._deselectMultiDrag();
      }
      multiDragElements.forEach(function(multiDragElement) {
        multiDragElement.sortableIndex = index(multiDragElement);
      });
      multiDragElements = multiDragElements.sort(function(a, b) {
        return a.sortableIndex - b.sortableIndex;
      });
      dragStarted = true;
    },
    dragStarted: function dragStarted2(_ref7) {
      var _this2 = this;
      var sortable = _ref7.sortable;
      if (!this.isMultiDrag)
        return;
      if (this.options.sort) {
        sortable.captureAnimationState();
        if (this.options.animation) {
          multiDragElements.forEach(function(multiDragElement) {
            if (multiDragElement === dragEl$1)
              return;
            css(multiDragElement, "position", "absolute");
          });
          var dragRect = getRect(dragEl$1, false, true, true);
          multiDragElements.forEach(function(multiDragElement) {
            if (multiDragElement === dragEl$1)
              return;
            setRect(multiDragElement, dragRect);
          });
          folding = true;
          initialFolding = true;
        }
      }
      sortable.animateAll(function() {
        folding = false;
        initialFolding = false;
        if (_this2.options.animation) {
          multiDragElements.forEach(function(multiDragElement) {
            unsetRect(multiDragElement);
          });
        }
        if (_this2.options.sort) {
          removeMultiDragElements();
        }
      });
    },
    dragOver: function dragOver(_ref8) {
      var target = _ref8.target, completed = _ref8.completed, cancel = _ref8.cancel;
      if (folding && ~multiDragElements.indexOf(target)) {
        completed(false);
        cancel();
      }
    },
    revert: function revert(_ref9) {
      var fromSortable = _ref9.fromSortable, rootEl2 = _ref9.rootEl, sortable = _ref9.sortable, dragRect = _ref9.dragRect;
      if (multiDragElements.length > 1) {
        multiDragElements.forEach(function(multiDragElement) {
          sortable.addAnimationState({
            target: multiDragElement,
            rect: folding ? getRect(multiDragElement) : dragRect
          });
          unsetRect(multiDragElement);
          multiDragElement.fromRect = dragRect;
          fromSortable.removeAnimationState(multiDragElement);
        });
        folding = false;
        insertMultiDragElements(!this.options.removeCloneOnHide, rootEl2);
      }
    },
    dragOverCompleted: function dragOverCompleted(_ref10) {
      var sortable = _ref10.sortable, isOwner = _ref10.isOwner, insertion = _ref10.insertion, activeSortable = _ref10.activeSortable, parentEl2 = _ref10.parentEl, putSortable2 = _ref10.putSortable;
      var options = this.options;
      if (insertion) {
        if (isOwner) {
          activeSortable._hideClone();
        }
        initialFolding = false;
        if (options.animation && multiDragElements.length > 1 && (folding || !isOwner && !activeSortable.options.sort && !putSortable2)) {
          var dragRectAbsolute = getRect(dragEl$1, false, true, true);
          multiDragElements.forEach(function(multiDragElement) {
            if (multiDragElement === dragEl$1)
              return;
            setRect(multiDragElement, dragRectAbsolute);
            parentEl2.appendChild(multiDragElement);
          });
          folding = true;
        }
        if (!isOwner) {
          if (!folding) {
            removeMultiDragElements();
          }
          if (multiDragElements.length > 1) {
            var clonesHiddenBefore = clonesHidden;
            activeSortable._showClone(sortable);
            if (activeSortable.options.animation && !clonesHidden && clonesHiddenBefore) {
              multiDragClones.forEach(function(clone2) {
                activeSortable.addAnimationState({
                  target: clone2,
                  rect: clonesFromRect
                });
                clone2.fromRect = clonesFromRect;
                clone2.thisAnimationDuration = null;
              });
            }
          } else {
            activeSortable._showClone(sortable);
          }
        }
      }
    },
    dragOverAnimationCapture: function dragOverAnimationCapture(_ref11) {
      var dragRect = _ref11.dragRect, isOwner = _ref11.isOwner, activeSortable = _ref11.activeSortable;
      multiDragElements.forEach(function(multiDragElement) {
        multiDragElement.thisAnimationDuration = null;
      });
      if (activeSortable.options.animation && !isOwner && activeSortable.multiDrag.isMultiDrag) {
        clonesFromRect = _extends({}, dragRect);
        var dragMatrix = matrix(dragEl$1, true);
        clonesFromRect.top -= dragMatrix.f;
        clonesFromRect.left -= dragMatrix.e;
      }
    },
    dragOverAnimationComplete: function dragOverAnimationComplete() {
      if (folding) {
        folding = false;
        removeMultiDragElements();
      }
    },
    drop: function drop3(_ref12) {
      var evt = _ref12.originalEvent, rootEl2 = _ref12.rootEl, parentEl2 = _ref12.parentEl, sortable = _ref12.sortable, dispatchSortableEvent = _ref12.dispatchSortableEvent, oldIndex2 = _ref12.oldIndex, putSortable2 = _ref12.putSortable;
      var toSortable = putSortable2 || this.sortable;
      if (!evt)
        return;
      var options = this.options, children = parentEl2.children;
      if (!dragStarted) {
        if (options.multiDragKey && !this.multiDragKeyDown) {
          this._deselectMultiDrag();
        }
        toggleClass(dragEl$1, options.selectedClass, !~multiDragElements.indexOf(dragEl$1));
        if (!~multiDragElements.indexOf(dragEl$1)) {
          multiDragElements.push(dragEl$1);
          dispatchEvent({
            sortable,
            rootEl: rootEl2,
            name: "select",
            targetEl: dragEl$1,
            originalEvent: evt
          });
          if (evt.shiftKey && lastMultiDragSelect && sortable.el.contains(lastMultiDragSelect)) {
            var lastIndex = index(lastMultiDragSelect), currentIndex = index(dragEl$1);
            if (~lastIndex && ~currentIndex && lastIndex !== currentIndex) {
              var n, i;
              if (currentIndex > lastIndex) {
                i = lastIndex;
                n = currentIndex;
              } else {
                i = currentIndex;
                n = lastIndex + 1;
              }
              for (; i < n; i++) {
                if (~multiDragElements.indexOf(children[i]))
                  continue;
                toggleClass(children[i], options.selectedClass, true);
                multiDragElements.push(children[i]);
                dispatchEvent({
                  sortable,
                  rootEl: rootEl2,
                  name: "select",
                  targetEl: children[i],
                  originalEvent: evt
                });
              }
            }
          } else {
            lastMultiDragSelect = dragEl$1;
          }
          multiDragSortable = toSortable;
        } else {
          multiDragElements.splice(multiDragElements.indexOf(dragEl$1), 1);
          lastMultiDragSelect = null;
          dispatchEvent({
            sortable,
            rootEl: rootEl2,
            name: "deselect",
            targetEl: dragEl$1,
            originalEvent: evt
          });
        }
      }
      if (dragStarted && this.isMultiDrag) {
        folding = false;
        if ((parentEl2[expando].options.sort || parentEl2 !== rootEl2) && multiDragElements.length > 1) {
          var dragRect = getRect(dragEl$1), multiDragIndex = index(dragEl$1, ":not(." + this.options.selectedClass + ")");
          if (!initialFolding && options.animation)
            dragEl$1.thisAnimationDuration = null;
          toSortable.captureAnimationState();
          if (!initialFolding) {
            if (options.animation) {
              dragEl$1.fromRect = dragRect;
              multiDragElements.forEach(function(multiDragElement) {
                multiDragElement.thisAnimationDuration = null;
                if (multiDragElement !== dragEl$1) {
                  var rect = folding ? getRect(multiDragElement) : dragRect;
                  multiDragElement.fromRect = rect;
                  toSortable.addAnimationState({
                    target: multiDragElement,
                    rect
                  });
                }
              });
            }
            removeMultiDragElements();
            multiDragElements.forEach(function(multiDragElement) {
              if (children[multiDragIndex]) {
                parentEl2.insertBefore(multiDragElement, children[multiDragIndex]);
              } else {
                parentEl2.appendChild(multiDragElement);
              }
              multiDragIndex++;
            });
            if (oldIndex2 === index(dragEl$1)) {
              var update = false;
              multiDragElements.forEach(function(multiDragElement) {
                if (multiDragElement.sortableIndex !== index(multiDragElement)) {
                  update = true;
                  return;
                }
              });
              if (update) {
                dispatchSortableEvent("update");
                dispatchSortableEvent("sort");
              }
            }
          }
          multiDragElements.forEach(function(multiDragElement) {
            unsetRect(multiDragElement);
          });
          toSortable.animateAll();
        }
        multiDragSortable = toSortable;
      }
      if (rootEl2 === parentEl2 || putSortable2 && putSortable2.lastPutMode !== "clone") {
        multiDragClones.forEach(function(clone2) {
          clone2.parentNode && clone2.parentNode.removeChild(clone2);
        });
      }
    },
    nullingGlobal: function nullingGlobal() {
      this.isMultiDrag = dragStarted = false;
      multiDragClones.length = 0;
    },
    destroyGlobal: function destroyGlobal() {
      this._deselectMultiDrag();
      off(document, "pointerup", this._deselectMultiDrag);
      off(document, "mouseup", this._deselectMultiDrag);
      off(document, "touchend", this._deselectMultiDrag);
      off(document, "keydown", this._checkKeyDown);
      off(document, "keyup", this._checkKeyUp);
    },
    _deselectMultiDrag: function _deselectMultiDrag(evt) {
      if (typeof dragStarted !== "undefined" && dragStarted)
        return;
      if (multiDragSortable !== this.sortable)
        return;
      if (evt && closest(evt.target, this.options.draggable, this.sortable.el, false))
        return;
      if (evt && evt.button !== 0)
        return;
      while (multiDragElements.length) {
        var el = multiDragElements[0];
        toggleClass(el, this.options.selectedClass, false);
        multiDragElements.shift();
        dispatchEvent({
          sortable: this.sortable,
          rootEl: this.sortable.el,
          name: "deselect",
          targetEl: el,
          originalEvent: evt
        });
      }
    },
    _checkKeyDown: function _checkKeyDown(evt) {
      if (evt.key === this.options.multiDragKey) {
        this.multiDragKeyDown = true;
      }
    },
    _checkKeyUp: function _checkKeyUp(evt) {
      if (evt.key === this.options.multiDragKey) {
        this.multiDragKeyDown = false;
      }
    }
  };
  return _extends(MultiDrag, {
    pluginName: "multiDrag",
    utils: {
      select: function select(el) {
        var sortable = el.parentNode[expando];
        if (!sortable || !sortable.options.multiDrag || ~multiDragElements.indexOf(el))
          return;
        if (multiDragSortable && multiDragSortable !== sortable) {
          multiDragSortable.multiDrag._deselectMultiDrag();
          multiDragSortable = sortable;
        }
        toggleClass(el, sortable.options.selectedClass, true);
        multiDragElements.push(el);
      },
      deselect: function deselect(el) {
        var sortable = el.parentNode[expando], index2 = multiDragElements.indexOf(el);
        if (!sortable || !sortable.options.multiDrag || !~index2)
          return;
        toggleClass(el, sortable.options.selectedClass, false);
        multiDragElements.splice(index2, 1);
      }
    },
    eventProperties: function eventProperties() {
      var _this3 = this;
      var oldIndicies = [], newIndicies = [];
      multiDragElements.forEach(function(multiDragElement) {
        oldIndicies.push({
          multiDragElement,
          index: multiDragElement.sortableIndex
        });
        var newIndex2;
        if (folding && multiDragElement !== dragEl$1) {
          newIndex2 = -1;
        } else if (folding) {
          newIndex2 = index(multiDragElement, ":not(." + _this3.options.selectedClass + ")");
        } else {
          newIndex2 = index(multiDragElement);
        }
        newIndicies.push({
          multiDragElement,
          index: newIndex2
        });
      });
      return {
        items: _toConsumableArray(multiDragElements),
        clones: [].concat(multiDragClones),
        oldIndicies,
        newIndicies
      };
    },
    optionListeners: {
      multiDragKey: function multiDragKey(key) {
        key = key.toLowerCase();
        if (key === "ctrl") {
          key = "Control";
        } else if (key.length > 1) {
          key = key.charAt(0).toUpperCase() + key.substr(1);
        }
        return key;
      }
    }
  });
}
function insertMultiDragElements(clonesInserted, rootEl2) {
  multiDragElements.forEach(function(multiDragElement, i) {
    var target = rootEl2.children[multiDragElement.sortableIndex + (clonesInserted ? Number(i) : 0)];
    if (target) {
      rootEl2.insertBefore(multiDragElement, target);
    } else {
      rootEl2.appendChild(multiDragElement);
    }
  });
}
function insertMultiDragClones(elementsInserted, rootEl2) {
  multiDragClones.forEach(function(clone2, i) {
    var target = rootEl2.children[clone2.sortableIndex + (elementsInserted ? Number(i) : 0)];
    if (target) {
      rootEl2.insertBefore(clone2, target);
    } else {
      rootEl2.appendChild(clone2);
    }
  });
}
function removeMultiDragElements() {
  multiDragElements.forEach(function(multiDragElement) {
    if (multiDragElement === dragEl$1)
      return;
    multiDragElement.parentNode && multiDragElement.parentNode.removeChild(multiDragElement);
  });
}
Sortable.mount(new AutoScrollPlugin());
Sortable.mount(Remove, Revert);
var sortable_esm_default = Sortable;

// src/file-explorer/custom-sort.ts
var import_obsidian = __toModule(require("obsidian"));
var Collator = new Intl.Collator(void 0, {
  usage: "sort",
  sensitivity: "base",
  numeric: true
}).compare;
var Translate = i18next.t.bind(i18next);
var SortGlyph = "up-and-down-arrows";
var sortOptionStrings = {
  alphabetical: "plugins.file-explorer.label-sort-a-to-z",
  alphabeticalReverse: "plugins.file-explorer.label-sort-z-to-a",
  byModifiedTime: "plugins.file-explorer.label-sort-new-to-old",
  byModifiedTimeReverse: "plugins.file-explorer.label-sort-old-to-new",
  byCreatedTime: "plugins.file-explorer.label-sort-created-new-to-old",
  byCreatedTimeReverse: "plugins.file-explorer.label-sort-created-old-to-new",
  custom: "Custom"
};
var sortOptionGroups = [
  ["alphabetical", "alphabeticalReverse"],
  ["byModifiedTime", "byModifiedTimeReverse"],
  ["byCreatedTime", "byCreatedTimeReverse"],
  ["custom"]
];
var folderSort = function(order, foldersOnBottom) {
  let fileExplorer = this.view, folderContents = this.file.children.slice();
  folderContents.sort(function(firstEl, secondEl) {
    let firstIsFolder, secondIsFolder;
    if (foldersOnBottom && ((firstIsFolder = firstEl instanceof import_obsidian.TFolder) || (secondIsFolder = secondEl instanceof import_obsidian.TFolder))) {
      return firstIsFolder && !secondIsFolder ? 1 : secondIsFolder && !firstIsFolder ? -1 : Collator(firstEl.name, secondEl.name);
    } else {
      if (!order)
        return Collator(firstEl.name, secondEl.name);
      const index1 = order.indexOf(firstEl.path);
      const index2 = order.indexOf(secondEl.path);
      return (index1 > -1 ? index1 : Infinity) - (index2 > -1 ? index2 : Infinity);
    }
  });
  const items = folderContents.map((child) => fileExplorer.fileItems[child.path]).filter((f) => f);
  if (import_obsidian.requireApiVersion && (0, import_obsidian.requireApiVersion)("0.15.0")) {
    this.vChildren.setChildren(items);
  } else {
    this.children = items;
  }
};
var addSortButton = function(sorterArray, sortOption, sorter, currentSort) {
  let plugin = this;
  console.log("currentSort", currentSort());
  let sortEl = this.addNavButton(SortGlyph, Translate("plugins.file-explorer.action-change-sort"), function(event) {
    event.preventDefault();
    let menu = new import_obsidian.Menu(plugin.app);
    for (let currentSortOption = currentSort(), groupIndex = 0, _sortOptionGroups = sortOptionGroups; groupIndex < _sortOptionGroups.length; groupIndex++) {
      for (let addMenuItem = function(_sortOption) {
        let label = Translate(sortOptionStrings[_sortOption]);
        menu.addItem(function(item) {
          return item.setTitle(label).setActive(_sortOption === currentSortOption).onClick(function() {
            if (_sortOption !== currentSortOption) {
              sortEl.setAttribute("data-sort-method", _sortOption);
              plugin.app.workspace.trigger("file-explorer-sort-change", _sortOption);
            }
            sorter(_sortOption);
          });
        });
      }, itemIndex = 0, sortOptionGroup = _sortOptionGroups[groupIndex]; itemIndex < sortOptionGroup.length; itemIndex++) {
        addMenuItem(sortOptionGroup[itemIndex]);
      }
      menu.addSeparator();
    }
    menu.showAtMouseEvent(event);
  });
  setTimeout(() => {
    sortEl.setAttribute("data-sort-method", sorter(currentSort()));
  }, 100);
  this.addNavButton("three-horizontal-bars", "Drag to rearrange", function(event) {
    event.preventDefault();
    let value = !this.hasClass("is-active");
    this.toggleClass("is-active", value);
    plugin.app.workspace.trigger("file-explorer-draggable-change", value);
  }).addClass("drag-to-rearrange");
  this.addNavButton("search", "Filter items", function(event) {
    var _a, _b;
    event.preventDefault();
    let value = !this.hasClass("is-active");
    this.toggleClass("is-active", value);
    let filterEl = document.body.querySelector('.workspace-leaf-content[data-type="file-explorer"] .search-input-container > input');
    if (filterEl && !value) {
      (_a = filterEl.parentElement) == null ? void 0 : _a.hide();
      filterEl.value = "";
      filterEl.dispatchEvent(new Event("input"));
    } else {
      (_b = filterEl == null ? void 0 : filterEl.parentElement) == null ? void 0 : _b.show();
      filterEl == null ? void 0 : filterEl.focus();
    }
    plugin.app.workspace.trigger("file-explorer-draggable-change", value);
  });
  return sortEl;
};

// src/settings/settings.ts
var import_obsidian2 = __toModule(require("obsidian"));
var DEFAULT_SETTINGS = {
  statusBarOrder: [],
  ribbonBarOrder: [],
  fileExplorerOrder: {},
  actionBarOrder: {},
  autoHide: false,
  autoHideDelay: 2e3,
  dragDelay: 200
};
var SettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  hide() {
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Auto Collapse").setDesc("Automatically hide ribbon and status bar items once your mouse leaves the icon container").addToggle((toggle) => toggle.setValue(this.plugin.settings.autoHide).onChange((value) => {
      this.plugin.settings.autoHide = value;
      this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Auto Collapse Delay").setDesc("How long to wait before auto collapsing hidden icons on the ribbon and status bar").addText((textfield) => {
      textfield.setPlaceholder(String(2e3));
      textfield.inputEl.type = "number";
      textfield.setValue(String(this.plugin.settings.autoHideDelay));
      textfield.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.autoHideDelay = Number(value);
        this.plugin.saveSettings();
      }));
    });
    new import_obsidian2.Setting(containerEl).setName("Drag Start Delay (ms)").setDesc("How long to wait before triggering the drag behavior after clicking. \u26A0\uFE0F Requires an app restart.").addText((textfield) => {
      textfield.setPlaceholder(String(200));
      textfield.inputEl.type = "number";
      textfield.setValue(String(this.plugin.settings.dragDelay));
      textfield.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.dragDelay = Number(value);
        this.plugin.saveSettings();
      }));
    });
  }
};

// src/utils.ts
var import_obsidian3 = __toModule(require("obsidian"));
function getPreviousSiblings(el, filter) {
  var sibs = [];
  while (el = el.previousSibling) {
    if (el.nodeType === 3)
      continue;
    if (!filter || filter(el))
      sibs.push(el);
  }
  return sibs;
}
function getNextSiblings(el, filter) {
  var sibs = [];
  while (el = el.nextSibling) {
    if (el.nodeType === 3)
      continue;
    if (!filter || filter(el))
      sibs.push(el);
  }
  return sibs;
}
function generateId(el, options) {
  var _a, _b;
  let classes = (options == null ? void 0 : options.useClass) ? Array.from(el.classList).filter((c) => !c.startsWith("is-")).sort().join(" ") : "";
  let str = ((options == null ? void 0 : options.useTag) ? el.tagName : "") + ((options == null ? void 0 : options.useClass) ? classes : "") + ((options == null ? void 0 : options.useText) ? el.textContent : "") + ((options == null ? void 0 : options.useAria) ? el.getAttr("aria-label") : "") + ((options == null ? void 0 : options.useIcon) ? (_b = (_a = el.querySelector("svg")) == null ? void 0 : _a.className) == null ? void 0 : _b.baseVal : "");
  return cyrb53(str);
}
var cyrb53 = function(str, seed = 0) {
  let h1 = 3735928559 ^ seed, h2 = 1103547991 ^ seed;
  for (let i = 0, ch; i < str.length; i++) {
    ch = str.charCodeAt(i);
    h1 = Math.imul(h1 ^ ch, 2654435761);
    h2 = Math.imul(h2 ^ ch, 1597334677);
  }
  h1 = Math.imul(h1 ^ h1 >>> 16, 2246822507) ^ Math.imul(h2 ^ h2 >>> 13, 3266489909);
  h2 = Math.imul(h2 ^ h2 >>> 16, 2246822507) ^ Math.imul(h1 ^ h1 >>> 13, 3266489909);
  return 4294967296 * (2097151 & h2) + (h1 >>> 0).toString();
};
function reorderArray(array, from, to, on2 = 1) {
  return array.splice(to, 0, ...array.splice(from, on2)), array;
}
var getItems = (items) => {
  let children = [];
  const supportsVirtualChildren = import_obsidian3.requireApiVersion && (0, import_obsidian3.requireApiVersion)("0.15.0");
  let _items;
  if (supportsVirtualChildren) {
    _items = items.reduce((res, item) => {
      var _a;
      if ((_a = item.vChildren) == null ? void 0 : _a._children) {
        children = [...children, ...item.vChildren._children];
      } else {
        res.push(item);
      }
      return res;
    }, []).concat(children.length ? getItems(children) : children);
  } else {
    _items = items.reduce((res, item) => {
      if (item.children) {
        children = [...children, ...item.children];
      } else {
        res.push(item);
      }
      return res;
    }, []).concat(children.length ? getItems(children) : children);
  }
  return _items;
};
var highlight = (fuseSearchResult, highlightClassName = "suggestion-highlight") => {
  const set = (obj, path, value) => {
    const pathValue = path.split(".");
    let i;
    for (i = 0; i < pathValue.length - 1; i++) {
      obj = obj[pathValue[i]];
    }
    obj[pathValue[i]] = value;
  };
  const generateHighlightedText = (inputText, regions = []) => {
    let result = regions.reduce((str, [start, end]) => {
      str[start] = `<span class="${highlightClassName}">${str[start]}`;
      str[end] = `${str[end]}</span>`;
      return str;
    }, inputText.split("")).join("");
    return result;
  };
  return fuseSearchResult.filter(({ matches: matches2 }) => matches2 && matches2.length).map(({ item, matches: matches2 }) => {
    const highlightedItem = __spreadValues({}, item);
    matches2.forEach((match) => {
      var _a;
      if (!highlightedItem.innerEl.origContent)
        highlightedItem.innerEl.origContent = highlightedItem.innerEl.textContent;
      set(highlightedItem, "innerEl.innerHTML", generateHighlightedText(match.value, match.indices));
      (_a = highlightedItem.innerEl) == null ? void 0 : _a.addClass("has-matches");
    });
    return highlightedItem;
  });
};
function removeExt(obj) {
  if (typeof obj === "string" || obj instanceof String) {
    return obj.replace(/.md$/, "");
  }
  return obj;
}
function getFn(obj, path) {
  var value = Fuse.config.getFn(obj, path);
  if (Array.isArray(value)) {
    return value.map((el) => removeExt(el));
  }
  return removeExt(value);
}

// src/main.ts
sortable_esm_default.mount(new MultiDragPlugin());
var DRAG_DELAY = import_obsidian4.Platform.isMobile ? 200 : 200;
var ANIMATION_DURATION = 500;
var BartenderPlugin = class extends import_obsidian4.Plugin {
  constructor() {
    super(...arguments);
    this.fileExplorerFilter = function() {
      var _a, _b, _c, _d, _e;
      const supportsVirtualChildren = import_obsidian4.requireApiVersion && (0, import_obsidian4.requireApiVersion)("0.15.0");
      let fileExplorer = (_a = this == null ? void 0 : this.rootEl) == null ? void 0 : _a.fileExplorer;
      if (!fileExplorer)
        return;
      const _children = supportsVirtualChildren ? (_b = this.rootEl) == null ? void 0 : _b.vChildren._children : (_c = this.rootEl) == null ? void 0 : _c.children;
      if (!_children)
        return;
      if (((_d = this.filter) == null ? void 0 : _d.length) >= 1) {
        if (!this.filtered) {
          this.rootEl._children = _children;
          this.filtered = true;
        }
        const options = {
          includeScore: true,
          includeMatches: true,
          useExtendedSearch: true,
          getFn,
          threshold: 0.1,
          ignoreLocation: true,
          keys: ["file.path"]
        };
        let flattenedItems = getItems(this.rootEl._children);
        const fuse = new Fuse(flattenedItems, options);
        const maxResults = 200;
        let results = fuse.search(this.filter).slice(0, maxResults);
        if (supportsVirtualChildren) {
          this.rootEl.vChildren._children = highlight(results);
        } else {
          this.rootEl.children = highlight(results);
        }
      } else if (((_e = this.filter) == null ? void 0 : _e.length) < 1 && this.filtered) {
        if (this.rootEl._children) {
          if (supportsVirtualChildren) {
            this.rootEl.vChildren._children = this.rootEl._children;
          } else {
            this.rootEl.children = this.rootEl._children;
          }
        }
        let flattenedItems = getItems(this.rootEl._children);
        flattenedItems.map((match) => {
          if (match.innerEl.origContent) {
            match.innerEl.setText(match.innerEl.origContent);
            delete match.innerEl.origContent;
            match.innerEl.removeClass("has-matches");
          }
        });
        this.filtered = false;
      }
    };
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.registerMonkeyPatches();
      this.registerEventHandlers();
      this.registerSettingsTab();
      this.initialize();
    });
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
  patchFileExplorerFolder() {
    let plugin = this;
    let leaf = this.app.workspace.getLeaf(true);
    let fileExplorer = this.app.viewRegistry.viewByType["file-explorer"](leaf);
    let tmpFolder = new import_obsidian4.TFolder(import_obsidian4.Vault, "");
    let Folder = fileExplorer.createFolderDom(tmpFolder).constructor;
    this.register(around(Folder.prototype, {
      sort(old) {
        return function(...args) {
          var _a;
          let order = plugin.settings.fileExplorerOrder[this.file.path];
          if (((_a = this.view) == null ? void 0 : _a.sortOrder) === "custom") {
            return folderSort.call(this, order, ...args);
          } else {
            return old.call(this, ...args);
          }
        };
      }
    }));
    leaf.detach();
  }
  initialize() {
    this.app.workspace.onLayoutReady(() => {
      this.patchFileExplorerFolder();
      setTimeout(() => {
        if (import_obsidian4.Platform.isDesktop) {
          this.setStatusBarSorter();
          if (import_obsidian4.requireApiVersion && !(0, import_obsidian4.requireApiVersion)("0.15.3")) {
            let left = this.app.workspace.leftSplit.children;
            let right = this.app.workspace.rightSplit.children;
            left.concat(right).forEach((child) => {
              if (child.hasOwnProperty("tabsInnerEl") && !child.iconSorter) {
                child.iconSorter = this.setTabBarSorter(child.tabsInnerEl, child);
              }
            });
          }
        }
        this.setFileExplorerSorter();
        this.setRibbonBarSorter();
        this.app.workspace.iterateRootLeaves((leaf) => {
          var _a, _b;
          if (((_a = leaf == null ? void 0 : leaf.view) == null ? void 0 : _a.hasOwnProperty("actionsEl")) && !((_b = leaf == null ? void 0 : leaf.view) == null ? void 0 : _b.hasOwnProperty("iconSorter"))) {
            leaf.view.iconSorter = this.setViewActionSorter(leaf.view.actionsEl, leaf.view);
          }
        });
      }, import_obsidian4.Platform.isMobile ? 3e3 : 400);
    });
  }
  registerSettingsTab() {
    this.settingsTab = new SettingTab(this.app, this);
    this.addSettingTab(this.settingsTab);
  }
  clearFileExplorerFilter() {
    const fileExplorer = this.getFileExplorer();
    let fileExplorerFilterEl = document.body.querySelector('.workspace-leaf-content[data-type="file-explorer"] .search-input-container > input');
    fileExplorerFilterEl && (fileExplorerFilterEl.value = "");
    fileExplorer.dom.infinityScroll.filter = "";
    fileExplorer.dom.infinityScroll.compute();
  }
  registerEventHandlers() {
    this.registerEvent(this.app.workspace.on("file-explorer-draggable-change", (value) => {
      this.toggleFileExplorerSorters(value);
    }));
    this.registerEvent(this.app.workspace.on("file-explorer-sort-change", (sortMethod) => {
      if (sortMethod === "custom") {
        setTimeout(() => {
          this.setFileExplorerSorter();
        }, 10);
      } else {
        this.cleanupFileExplorerSorters();
      }
    }));
    this.registerEvent(this.app.workspace.on("file-explorer-load", (fileExplorer) => {
      setTimeout(() => {
        this.setFileExplorerSorter(fileExplorer);
      }, 1e3);
    }));
    this.registerEvent(this.app.workspace.on("bartender-leaf-split", (originLeaf, newLeaf) => {
      let element = newLeaf.tabsInnerEl;
      if (newLeaf.type === "tabs" && newLeaf instanceof import_obsidian4.WorkspaceTabs) {
        if (import_obsidian4.requireApiVersion && !(0, import_obsidian4.requireApiVersion)("0.15.3")) {
          this.setTabBarSorter(element, newLeaf);
        }
      }
    }));
    this.registerEvent(this.app.workspace.on("ribbon-bar-updated", () => {
      setTimeout(() => {
        if (this.settings.ribbonBarOrder && this.ribbonBarSorter) {
          this.setElementIDs(this.ribbonBarSorter.el, { useClass: true, useAria: true, useIcon: true });
          this.ribbonBarSorter.sort(this.settings.ribbonBarOrder);
        }
      }, 0);
    }));
    this.registerEvent(this.app.workspace.on("status-bar-updated", () => {
      setTimeout(() => {
        if (this.settings.statusBarOrder && this.statusBarSorter) {
          this.setElementIDs(this.statusBarSorter.el, { useClass: true, useIcon: true });
          this.statusBarSorter.sort(this.settings.statusBarOrder);
        }
      }, 0);
    }));
  }
  registerMonkeyPatches() {
    const plugin = this;
    this.register(around(this.app.viewRegistry.constructor.prototype, {
      registerView(old) {
        return function(type, viewCreator, ...args) {
          plugin.app.workspace.trigger("view-registered", type, viewCreator);
          return old.call(this, type, viewCreator, ...args);
        };
      }
    }));
    if (!this.app.workspace.layoutReady) {
      let eventRef = this.app.workspace.on("view-registered", (type, viewCreator) => {
        if (type !== "file-explorer")
          return;
        this.app.workspace.offref(eventRef);
        let leaf = new import_obsidian4.WorkspaceLeaf(plugin.app);
        let fileExplorer = viewCreator(leaf);
        this.patchFileExplorer(fileExplorer);
      });
    } else {
      let fileExplorer = this.getFileExplorer();
      this.patchFileExplorer(fileExplorer);
    }
    this.register(around(import_obsidian4.View.prototype, {
      onunload(old) {
        return function(...args) {
          try {
            if (this.iconSorter) {
              this.iconSorter.destroy();
              this.iconSorter = null;
            }
          } catch (e) {
          }
          return old.call(this, ...args);
        };
      },
      onload(old) {
        return function(...args) {
          setTimeout(() => {
            if (this.app.workspace.layoutReady) {
              try {
                if (!(this.leaf.parentSplit instanceof import_obsidian4.WorkspaceTabs)) {
                  if (this.hasOwnProperty("actionsEl") && !this.iconSorter) {
                    this.iconSorter = plugin.setViewActionSorter(this.actionsEl, this);
                  }
                }
              } catch (e) {
              }
            }
          }, 200);
          return old.call(this, ...args);
        };
      }
    }));
    if (import_obsidian4.Platform.isDesktop) {
      this.register(around(HTMLDivElement.prototype, {
        addEventListener(old) {
          return function(type, listener, options) {
            if (type === "mousedown" && listener instanceof Function && this.hasClass("workspace-tab-header")) {
              let origListener = listener;
              listener = (event) => {
                if (event instanceof MouseEvent && ((event == null ? void 0 : event.altKey) || (event == null ? void 0 : event.metaKey)))
                  return;
                else
                  origListener(event);
              };
            }
            const result = old.call(this, type, listener, options);
            return result;
          };
        }
      }));
    }
    this.register(around(import_obsidian4.Workspace.prototype, {
      splitLeaf(old) {
        return function(source, newLeaf, direction, before, ...args) {
          let result = old.call(this, source, newLeaf, direction, before, ...args);
          this.trigger("bartender-leaf-split", source, newLeaf);
          return result;
        };
      },
      changeLayout(old) {
        return function(workspace, ...args) {
          return __async(this, null, function* () {
            let result = yield old.call(this, workspace, ...args);
            this.trigger("bartender-workspace-change");
            return result;
          });
        };
      }
    }));
    this.register(around(import_obsidian4.Plugin.prototype, {
      addStatusBarItem(old) {
        return function(...args) {
          const result = old.call(this, ...args);
          this.app.workspace.trigger("status-bar-updated");
          return result;
        };
      },
      addRibbonIcon(old) {
        return function(...args) {
          const result = old.call(this, ...args);
          this.app.workspace.trigger("ribbon-bar-updated");
          return result;
        };
      }
    }));
  }
  patchFileExplorer(fileExplorer) {
    var _a, _b;
    let plugin = this;
    if (fileExplorer) {
      let InfinityScroll = (_b = (_a = fileExplorer.tree) == null ? void 0 : _a.infinityScroll) == null ? void 0 : _b.constructor;
      this.register(() => this.clearFileExplorerFilter());
      this.register(around(InfinityScroll.prototype, {
        compute(old) {
          return function(...args) {
            try {
              if (this.scrollEl.hasClass("nav-files-container")) {
                plugin.fileExplorerFilter.call(this);
              }
            } catch (err) {
              console.log(err);
            }
            const result = old.call(this, ...args);
            return result;
          };
        }
      }));
      this.register(around(fileExplorer.headerDom.constructor.prototype, {
        addSortButton(old) {
          return function(...args) {
            var _a2, _b2, _c;
            if (((_c = (_b2 = (_a2 = this.navHeaderEl) == null ? void 0 : _a2.parentElement) == null ? void 0 : _b2.dataset) == null ? void 0 : _c.type) === "file-explorer") {
              plugin.setFileExplorerFilter(this);
              return addSortButton.call(this, ...args);
            } else {
              return old.call(this, ...args);
            }
          };
        }
      }));
    }
  }
  insertSeparator(selector, className, rtl, glyphSize = 16) {
    let elements = document.body.querySelectorAll(selector);
    elements.forEach((el) => {
      let getSiblings = rtl ? getPreviousSiblings : getNextSiblings;
      if (el) {
        let separator = el.createDiv(`${className} separator`);
        rtl && el.prepend(separator);
        let glyphEl = separator.createDiv("glyph");
        let glyphName = "plus-with-circle";
        (0, import_obsidian4.setIcon)(glyphEl, glyphName, glyphSize);
        separator.addClass("is-collapsed");
        this.register(() => separator.detach());
        let hideTimeout;
        separator.onClickEvent((event) => {
          if (separator.hasClass("is-collapsed")) {
            Array.from(el.children).forEach((el2) => el2.removeClass("is-hidden"));
            separator.removeClass("is-collapsed");
          } else {
            getSiblings(separator).forEach((el2) => el2.addClass("is-hidden"));
            separator.addClass("is-collapsed");
          }
        });
        el.onmouseenter = (ev) => {
          hideTimeout && clearTimeout(hideTimeout);
        };
        el.onmouseleave = (ev) => {
          if (this.settings.autoHide) {
            hideTimeout = setTimeout(() => {
              getSiblings(separator).forEach((el2) => el2.addClass("is-hidden"));
              separator.addClass("is-collapsed");
            }, this.settings.autoHideDelay);
          }
        };
        setTimeout(() => {
          getSiblings(separator).forEach((el2) => el2.addClass("is-hidden"));
          separator.addClass("is-collapsed");
        }, 0);
      }
    });
  }
  setElementIDs(parentEl2, options) {
    Array.from(parentEl2.children).forEach((child) => {
      if (child instanceof HTMLElement) {
        if (!child.getAttribute("data-id")) {
          child.setAttribute("data-id", generateId(child, options));
        }
      }
    });
  }
  setTabBarSorter(element, leaf) {
    this.setElementIDs(element, { useClass: true, useIcon: true });
    let sorter = sortable_esm_default.create(element, {
      group: "leftTabBar",
      dataIdAttr: "data-id",
      chosenClass: "bt-sortable-chosen",
      delay: import_obsidian4.Platform.isMobile ? 200 : this.settings.dragDelay,
      dropBubble: false,
      dragoverBubble: false,
      animation: ANIMATION_DURATION,
      onChoose: () => {
        var _a;
        return (_a = element.parentElement) == null ? void 0 : _a.addClass("is-dragging");
      },
      onUnchoose: () => {
        var _a;
        return (_a = element.parentElement) == null ? void 0 : _a.removeClass("is-dragging");
      },
      onStart: () => {
        var _a;
        document.body.addClass("is-dragging");
        (_a = element.querySelector(".separator")) == null ? void 0 : _a.removeClass("is-collapsed");
        Array.from(element.children).forEach((el) => el.removeClass("is-hidden"));
      },
      onEnd: (event) => {
        document.body.removeClass("is-dragging");
        if (event.oldIndex !== void 0 && event.newIndex !== void 0) {
          reorderArray(leaf.children, event.oldIndex, event.newIndex);
          leaf.currentTab = event.newIndex;
          leaf.recomputeChildrenDimensions();
        }
        this.app.workspace.requestSaveLayout();
      }
    });
    return sorter;
  }
  setStatusBarSorter() {
    let el = document.body.querySelector("body > div.app-container > div.status-bar");
    if (el) {
      this.setElementIDs(el, { useClass: true, useAria: true, useIcon: true });
      this.statusBarSorter = sortable_esm_default.create(el, {
        group: "statusBar",
        dataIdAttr: "data-id",
        chosenClass: "bt-sortable-chosen",
        delay: import_obsidian4.Platform.isMobile ? 200 : this.settings.dragDelay,
        animation: ANIMATION_DURATION,
        onChoose: () => {
          Array.from(el.children).forEach((el2) => el2.removeClass("is-hidden"));
        },
        onStart: () => {
          var _a;
          (_a = el.querySelector(".separator")) == null ? void 0 : _a.removeClass("is-collapsed");
          Array.from(el.children).forEach((el2) => el2.removeClass("is-hidden"));
        },
        store: {
          get: (sortable) => {
            return this.settings.statusBarOrder;
          },
          set: (s) => {
            this.settings.statusBarOrder = s.toArray();
            this.saveSettings();
          }
        }
      });
    }
  }
  setViewActionSorter(el, view) {
    this.setElementIDs(el, { useClass: true, useIcon: true });
    let hasSorter = Object.values(el).find((value) => value == null ? void 0 : value.hasOwnProperty("nativeDraggable"));
    if (hasSorter)
      return void 0;
    let viewType = (view == null ? void 0 : view.getViewType()) || "unknown";
    let sortable = new sortable_esm_default(el, {
      group: "actionBar",
      dataIdAttr: "data-id",
      chosenClass: "bt-sortable-chosen",
      delay: import_obsidian4.Platform.isMobile ? 200 : this.settings.dragDelay,
      sort: true,
      animation: ANIMATION_DURATION,
      onStart: () => {
        var _a;
        (_a = el.querySelector(".separator")) == null ? void 0 : _a.removeClass("is-collapsed");
        Array.from(el.children).forEach((el2) => el2.removeClass("is-hidden"));
      },
      store: {
        get: () => {
          return this.settings.actionBarOrder[viewType];
        },
        set: (s) => {
          this.settings.actionBarOrder[viewType] = s.toArray();
          this.saveSettings();
        }
      }
    });
    return sortable;
  }
  setRibbonBarSorter() {
    let el = document.body.querySelector("body > div.app-container div.side-dock-actions");
    if (el) {
      this.setElementIDs(el, { useClass: true, useAria: true, useIcon: true });
      this.ribbonBarSorter = sortable_esm_default.create(el, {
        group: "ribbonBar",
        dataIdAttr: "data-id",
        delay: import_obsidian4.Platform.isMobile ? 200 : this.settings.dragDelay,
        chosenClass: "bt-sortable-chosen",
        animation: ANIMATION_DURATION,
        onChoose: () => {
          Array.from(el.children).forEach((el2) => el2.removeClass("is-hidden"));
        },
        onStart: () => {
          var _a;
          (_a = el.querySelector(".separator")) == null ? void 0 : _a.removeClass("is-collapsed");
          Array.from(el.children).forEach((el2) => el2.removeClass("is-hidden"));
        },
        store: {
          get: (sortable) => {
            return this.settings.ribbonBarOrder;
          },
          set: (s) => {
            this.settings.ribbonBarOrder = s.toArray();
            this.saveSettings();
          }
        }
      });
    }
  }
  setFileExplorerFilter(headerDom) {
    let fileExplorerNav = headerDom.navHeaderEl;
    if (fileExplorerNav) {
      let fileExplorerFilter = fileExplorerNav.createDiv("search-input-container");
      fileExplorerNav.insertAdjacentElement("afterend", fileExplorerFilter);
      let fileExplorerFilterInput = fileExplorerFilter.createEl("input");
      fileExplorerFilterInput.placeholder = "Type to filter...";
      fileExplorerFilterInput.type = "text";
      fileExplorerFilter.hide();
      let filterScope = new import_obsidian4.Scope(this.app.scope);
      fileExplorerFilterInput.onfocus = () => {
        this.app.keymap.pushScope(filterScope);
      };
      fileExplorerFilterInput.onblur = () => {
        this.app.keymap.popScope(filterScope);
      };
      fileExplorerFilterInput.oninput = (ev) => {
        let fileExplorer = this.getFileExplorer();
        if (ev.target instanceof HTMLInputElement) {
          if (ev.target.value.length) {
            clearButtonEl.show();
          } else {
            clearButtonEl.hide();
          }
          fileExplorer.dom.infinityScroll.filter = ev.target.value;
        }
        fileExplorer.dom.infinityScroll.compute();
      };
      let clearButtonEl = fileExplorerFilter.createDiv("search-input-clear-button", function(el) {
        el.addEventListener("click", function() {
          fileExplorerFilterInput.value = "", clearButtonEl.hide();
          fileExplorerFilterInput.focus();
          fileExplorerFilterInput.dispatchEvent(new Event("input"));
        }), el.hide();
      });
    }
  }
  setFileExplorerSorter(fileExplorer) {
    var _a;
    if (!fileExplorer)
      fileExplorer = this.getFileExplorer();
    if (!fileExplorer || fileExplorer.sortOrder !== "custom" || fileExplorer.hasCustomSorter)
      return;
    let roots = this.getRootFolders(fileExplorer);
    if (!roots || !roots.length)
      return;
    for (let root of roots) {
      let el = root == null ? void 0 : root.childrenEl;
      if (!el)
        continue;
      let draggedItems;
      fileExplorer.hasCustomSorter = true;
      let dragEnabled = ((_a = document.body.querySelector("div.nav-action-button.drag-to-rearrange")) == null ? void 0 : _a.hasClass("is-active")) ? true : false;
      root.sorter = sortable_esm_default.create(el, {
        group: "fileExplorer" + root.file.path,
        forceFallback: true,
        multiDrag: true,
        multiDragKey: "alt",
        chosenClass: "bt-sortable-chosen",
        delay: 0,
        disabled: !dragEnabled,
        sort: dragEnabled,
        animation: ANIMATION_DURATION,
        onStart: (evt) => {
          if (evt.items.length) {
            draggedItems = evt.items;
          } else {
            draggedItems = [evt.item];
          }
        },
        onMove: (evt) => {
          var _a2;
          const supportsVirtualChildren = import_obsidian4.requireApiVersion && (0, import_obsidian4.requireApiVersion)("0.15.0");
          let _children = supportsVirtualChildren ? (_a2 = root.vChildren) == null ? void 0 : _a2._children : root.children;
          if (!_children || !(draggedItems == null ? void 0 : draggedItems.length))
            return;
          let children = _children.map((child) => child.el);
          let adjacentEl = evt.related;
          let targetIndex = children.indexOf(adjacentEl);
          let firstItem = draggedItems.first();
          let firstItemIndex = children.indexOf(firstItem);
          let _draggedItems = draggedItems.slice();
          if (firstItemIndex > targetIndex)
            _draggedItems.reverse();
          for (let item of _draggedItems) {
            let itemIndex = children.indexOf(item);
            _children = reorderArray(_children, itemIndex, targetIndex);
            children = reorderArray(children, itemIndex, targetIndex);
          }
          this.settings.fileExplorerOrder[root.file.path] = _children.map((child) => child.file.path);
          this.saveSettings();
        },
        onEnd: (evt) => {
          var _a2;
          draggedItems = [];
          (_a2 = document.querySelector("body>div.drag-ghost")) == null ? void 0 : _a2.detach();
        }
      });
    }
  }
  getFileExplorer() {
    var _a, _b;
    let fileExplorer = (_b = (_a = this.app.workspace.getLeavesOfType("file-explorer")) == null ? void 0 : _a.first()) == null ? void 0 : _b.view;
    return fileExplorer;
  }
  getRootFolders(fileExplorer) {
    var _a, _b;
    if (!fileExplorer)
      fileExplorer = this.getFileExplorer();
    if (!fileExplorer)
      return;
    let root = (_b = (_a = fileExplorer.tree) == null ? void 0 : _a.infinityScroll) == null ? void 0 : _b.rootEl;
    let roots = root && this.traverseRoots(root);
    return roots;
  }
  traverseRoots(root, items) {
    var _a, _b;
    if (!items)
      items = [root];
    const supportsVirtualChildren = import_obsidian4.requireApiVersion && (0, import_obsidian4.requireApiVersion)("0.15.0");
    const _children = supportsVirtualChildren ? (_a = root.vChildren) == null ? void 0 : _a._children : root.children;
    for (let child of _children || []) {
      if (child.children || ((_b = child.vChildren) == null ? void 0 : _b._children)) {
        items.push(child);
      }
      this.traverseRoots(child, items);
    }
    return items;
  }
  toggleFileExplorerSorters(enable) {
    let fileExplorer = this.getFileExplorer();
    let roots = this.getRootFolders(fileExplorer);
    if (roots == null ? void 0 : roots.length) {
      for (let root of roots) {
        if (root.sorter) {
          root.sorter.option("sort", enable);
          root.sorter.option("disabled", !enable);
        }
      }
    }
  }
  cleanupFileExplorerSorters() {
    let fileExplorer = this.getFileExplorer();
    let roots = this.getRootFolders(fileExplorer);
    if (roots == null ? void 0 : roots.length) {
      for (let root of roots) {
        if (root.sorter) {
          root.sorter.destroy();
          delete root.sorter;
          Object.keys(root.childrenEl).forEach((key) => key.startsWith("Sortable") && delete root.childrenEl[key]);
          root.childrenEl.querySelectorAll("div.nav-file-title").forEach((el) => el.draggable = true);
          root.childrenEl.querySelectorAll("div.nav-folder-title").forEach((el) => el.draggable = true);
        }
      }
    }
    delete fileExplorer.hasCustomSorter;
    if (this.app.vault.getConfig("fileSortOrder") === "custom") {
      fileExplorer.setSortOrder("alphabetical");
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.statusBarSorter) == null ? void 0 : _a.destroy();
    (_b = this.ribbonBarSorter) == null ? void 0 : _b.destroy();
    this.app.workspace.iterateAllLeaves((leaf) => {
      var _a2, _b2, _c;
      let sorterParent;
      if ((sorterParent = (leaf == null ? void 0 : leaf.iconSorter) ? leaf : false) || (sorterParent = ((_a2 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _a2.iconSorter) ? leaf.view : false) || (sorterParent = (leaf == null ? void 0 : leaf.parentSplit) instanceof import_obsidian4.WorkspaceTabs && ((_b2 = leaf == null ? void 0 : leaf.parentSplit) == null ? void 0 : _b2.iconSorter) ? leaf == null ? void 0 : leaf.parentSplit : false)) {
        try {
          (_c = sorterParent.iconSorter) == null ? void 0 : _c.destroy();
        } catch (err) {
        } finally {
          delete sorterParent.iconSorter;
        }
      }
    });
    this.cleanupFileExplorerSorters();
  }
};
/**!
 * Sortable 1.15.1
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vY29kZXNwYWNlL29ic2lkaWFuLWJhcnRlbmRlci1wci9zcmMvbWFpbi50cyIsICIuLi8uLi8uLi8uLi9jb2Rlc3BhY2Uvb2JzaWRpYW4tYmFydGVuZGVyLXByL25vZGVfbW9kdWxlcy9mdXNlLmpzL2Rpc3QvZnVzZS5lc20uanMiLCAiLi4vLi4vLi4vLi4vY29kZXNwYWNlL29ic2lkaWFuLWJhcnRlbmRlci1wci9ub2RlX21vZHVsZXMvbW9ua2V5LWFyb3VuZC9tanMvaW5kZXguanMiLCAiLi4vLi4vLi4vLi4vY29kZXNwYWNlL29ic2lkaWFuLWJhcnRlbmRlci1wci9ub2RlX21vZHVsZXMvc29ydGFibGVqcy9tb2R1bGFyL3NvcnRhYmxlLmVzbS5qcyIsICIuLi8uLi8uLi8uLi9jb2Rlc3BhY2Uvb2JzaWRpYW4tYmFydGVuZGVyLXByL3NyYy9maWxlLWV4cGxvcmVyL2N1c3RvbS1zb3J0LnRzIiwgIi4uLy4uLy4uLy4uL2NvZGVzcGFjZS9vYnNpZGlhbi1iYXJ0ZW5kZXItcHIvc3JjL3NldHRpbmdzL3NldHRpbmdzLnRzIiwgIi4uLy4uLy4uLy4uL2NvZGVzcGFjZS9vYnNpZGlhbi1iYXJ0ZW5kZXItcHIvc3JjL3V0aWxzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgRnVzZSBmcm9tIFwiZnVzZS5qc1wiO1xyXG5pbXBvcnQgeyBhcm91bmQgfSBmcm9tIFwibW9ua2V5LWFyb3VuZFwiO1xyXG5pbXBvcnQge1xyXG4gIENoaWxkRWxlbWVudCxcclxuICBDb21wb25lbnQsXHJcbiAgRmlsZUV4cGxvcmVySGVhZGVyLFxyXG4gIEZpbGVFeHBsb3JlclZpZXcsXHJcbiAgUGxhdGZvcm0sXHJcbiAgUGx1Z2luLFxyXG4gIFJvb3RFbGVtZW50cyxcclxuICBTY29wZSxcclxuICBzZXRJY29uLFxyXG4gIFNwbGl0RGlyZWN0aW9uLFxyXG4gIFRGb2xkZXIsXHJcbiAgVmF1bHQsXHJcbiAgVmlldyxcclxuICBWaWV3Q3JlYXRvcixcclxuICBXb3Jrc3BhY2UsXHJcbiAgV29ya3NwYWNlSXRlbSxcclxuICBXb3Jrc3BhY2VMZWFmLFxyXG4gIFdvcmtzcGFjZVNwbGl0LFxyXG4gIFdvcmtzcGFjZVRhYnMsXHJcbiAgcmVxdWlyZUFwaVZlcnNpb24sXHJcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5pbXBvcnQgU29ydGFibGUsIHsgTXVsdGlEcmFnIH0gZnJvbSBcInNvcnRhYmxlanNcIjtcclxuaW1wb3J0IHsgYWRkU29ydEJ1dHRvbiwgZm9sZGVyU29ydCB9IGZyb20gXCIuL2ZpbGUtZXhwbG9yZXIvY3VzdG9tLXNvcnRcIjtcclxuaW1wb3J0IHsgQmFydGVuZGVyU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MsIFNldHRpbmdUYWIgfSBmcm9tIFwiLi9zZXR0aW5ncy9zZXR0aW5nc1wiO1xyXG5pbXBvcnQge1xyXG4gIGdlbmVyYXRlSWQsXHJcbiAgR2VuZXJhdGVJZE9wdGlvbnMsXHJcbiAgZ2V0Rm4sXHJcbiAgZ2V0SXRlbXMsXHJcbiAgZ2V0TmV4dFNpYmxpbmdzLFxyXG4gIGdldFByZXZpb3VzU2libGluZ3MsXHJcbiAgaGlnaGxpZ2h0LFxyXG4gIHJlb3JkZXJBcnJheSxcclxufSBmcm9tIFwiLi91dGlsc1wiO1xyXG5cclxuU29ydGFibGUubW91bnQobmV3IE11bHRpRHJhZygpKTtcclxuXHJcbmNvbnN0IFNUQVRVU19CQVJfU0VMRUNUT1IgPSBcImJvZHkgPiBkaXYuYXBwLWNvbnRhaW5lciBkaXYuc3RhdHVzLWJhclwiO1xyXG5jb25zdCBSSUJCT05fQkFSX1NFTEVDVE9SID0gXCJib2R5ID4gZGl2LmFwcC1jb250YWluZXIgZGl2LnNpZGUtZG9jay1hY3Rpb25zXCI7XHJcbmNvbnN0IERSQUdfREVMQVkgPSBQbGF0Zm9ybS5pc01vYmlsZSA/IDIwMCA6IDIwMDtcclxuY29uc3QgQU5JTUFUSU9OX0RVUkFUSU9OID0gNTAwO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFydGVuZGVyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICBzdGF0dXNCYXJTb3J0ZXI6IFNvcnRhYmxlO1xyXG4gIHJpYmJvbkJhclNvcnRlcjogU29ydGFibGU7XHJcbiAgZmlsZVNvcnRlcjogU29ydGFibGU7XHJcbiAgc2VwYXJhdG9yOiBIVE1MRWxlbWVudDtcclxuICBzZXR0aW5nczogQmFydGVuZGVyU2V0dGluZ3M7XHJcbiAgc2V0dGluZ3NUYWI6IFNldHRpbmdUYWI7XHJcblxyXG4gIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyTW9ua2V5UGF0Y2hlcygpO1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50SGFuZGxlcnMoKTtcclxuICAgIHRoaXMucmVnaXN0ZXJTZXR0aW5nc1RhYigpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgfVxyXG5cclxuICBwYXRjaEZpbGVFeHBsb3JlckZvbGRlcigpIHtcclxuICAgIGxldCBwbHVnaW4gPSB0aGlzO1xyXG4gICAgbGV0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcclxuICAgIGxldCBmaWxlRXhwbG9yZXIgPSB0aGlzLmFwcC52aWV3UmVnaXN0cnkudmlld0J5VHlwZVtcImZpbGUtZXhwbG9yZXJcIl0obGVhZikgYXMgRmlsZUV4cGxvcmVyVmlldztcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGxldCB0bXBGb2xkZXIgPSBuZXcgVEZvbGRlcihWYXVsdCwgXCJcIik7XHJcbiAgICBsZXQgRm9sZGVyID0gZmlsZUV4cGxvcmVyLmNyZWF0ZUZvbGRlckRvbSh0bXBGb2xkZXIpLmNvbnN0cnVjdG9yO1xyXG4gICAgdGhpcy5yZWdpc3RlcihcclxuICAgICAgYXJvdW5kKEZvbGRlci5wcm90b3R5cGUsIHtcclxuICAgICAgICBzb3J0KG9sZDogYW55KSB7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueVtdKSB7XHJcbiAgICAgICAgICAgIGxldCBvcmRlciA9IHBsdWdpbi5zZXR0aW5ncy5maWxlRXhwbG9yZXJPcmRlclt0aGlzLmZpbGUucGF0aF07XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZpZXc/LnNvcnRPcmRlciA9PT0gXCJjdXN0b21cIikge1xyXG4gICAgICAgICAgICAgIHJldHVybiBmb2xkZXJTb3J0LmNhbGwodGhpcywgb3JkZXIsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHJldHVybiBvbGQuY2FsbCh0aGlzLCAuLi5hcmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICAgIGxlYWYuZGV0YWNoKCk7XHJcbiAgfVxyXG5cclxuICBpbml0aWFsaXplKCkge1xyXG4gICAgdGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG4gICAgICB0aGlzLnBhdGNoRmlsZUV4cGxvcmVyRm9sZGVyKCk7XHJcbiAgICAgIHNldFRpbWVvdXQoXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgaWYgKFBsYXRmb3JtLmlzRGVza3RvcCkge1xyXG4gICAgICAgICAgICAvLyBhZGQgc29ydGVyIHRvIHRoZSBzdGF0dXMgYmFyXHJcbiAgICAgICAgICAgIC8vIHRoaXMuaW5zZXJ0U2VwYXJhdG9yKFNUQVRVU19CQVJfU0VMRUNUT1IsIFwic3RhdHVzLWJhci1pdGVtXCIsIHRydWUsIDE2KTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0dXNCYXJTb3J0ZXIoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGFkZCBzb3J0ZXIgdG8gdGhlIHNpZGViYXIgdGFic1xyXG4gICAgICAgICAgICBpZiAocmVxdWlyZUFwaVZlcnNpb24gJiYgIXJlcXVpcmVBcGlWZXJzaW9uKFwiMC4xNS4zXCIpKSB7XHJcbiAgICAgICAgICAgICAgbGV0IGxlZnQgPSAodGhpcy5hcHAud29ya3NwYWNlLmxlZnRTcGxpdCBhcyBXb3Jrc3BhY2VTcGxpdCkuY2hpbGRyZW47XHJcbiAgICAgICAgICAgICAgbGV0IHJpZ2h0ID0gKHRoaXMuYXBwLndvcmtzcGFjZS5yaWdodFNwbGl0IGFzIFdvcmtzcGFjZVNwbGl0KS5jaGlsZHJlbjtcclxuICAgICAgICAgICAgICBsZWZ0LmNvbmNhdChyaWdodCkuZm9yRWFjaChjaGlsZCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuaGFzT3duUHJvcGVydHkoXCJ0YWJzSW5uZXJFbFwiKSAmJiAhY2hpbGQuaWNvblNvcnRlcikge1xyXG4gICAgICAgICAgICAgICAgICBjaGlsZC5pY29uU29ydGVyID0gdGhpcy5zZXRUYWJCYXJTb3J0ZXIoY2hpbGQudGFic0lubmVyRWwsIGNoaWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIGFkZCBmaWxlIGV4cGxvcmVyIHNvcnRlclxyXG4gICAgICAgICAgdGhpcy5zZXRGaWxlRXhwbG9yZXJTb3J0ZXIoKTtcclxuXHJcbiAgICAgICAgICAvLyBhZGQgc29ydGVyIHRvIHRoZSBsZWZ0IHNpZGViYXIgcmliYm9uXHJcbiAgICAgICAgICAvLyB0aGlzLmluc2VydFNlcGFyYXRvcihSSUJCT05fQkFSX1NFTEVDVE9SLCBcInNpZGUtZG9jay1yaWJib24tYWN0aW9uXCIsIGZhbHNlLCAxOCk7XHJcbiAgICAgICAgICB0aGlzLnNldFJpYmJvbkJhclNvcnRlcigpO1xyXG5cclxuICAgICAgICAgIC8vIGFkZCBzb3J0ZXIgdG8gYWxsIHZpZXcgYWN0aW9ucyBpY29uIGdyb3Vwc1xyXG4gICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVSb290TGVhdmVzKGxlYWYgPT4ge1xyXG4gICAgICAgICAgICBpZiAobGVhZj8udmlldz8uaGFzT3duUHJvcGVydHkoXCJhY3Rpb25zRWxcIikgJiYgIWxlYWY/LnZpZXc/Lmhhc093blByb3BlcnR5KFwiaWNvblNvcnRlclwiKSkge1xyXG4gICAgICAgICAgICAgIGxlYWYudmlldy5pY29uU29ydGVyID0gdGhpcy5zZXRWaWV3QWN0aW9uU29ydGVyKGxlYWYudmlldy5hY3Rpb25zRWwsIGxlYWYudmlldyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgUGxhdGZvcm0uaXNNb2JpbGUgPyAzMDAwIDogNDAwXHJcbiAgICAgICk7IC8vIGdpdmUgdGltZSBmb3IgcGx1Z2lucyBsaWtlIEN1c3RvbWl6YWJsZSBQYWdlIEhlYWRlciB0byBhZGQgdGhlaXIgaWNvbnNcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVnaXN0ZXJTZXR0aW5nc1RhYigpIHtcclxuICAgIHRoaXMuc2V0dGluZ3NUYWIgPSBuZXcgU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcyk7XHJcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nc1RhYik7XHJcbiAgfVxyXG5cclxuICBjbGVhckZpbGVFeHBsb3JlckZpbHRlcigpIHtcclxuICAgIGNvbnN0IGZpbGVFeHBsb3JlciA9IHRoaXMuZ2V0RmlsZUV4cGxvcmVyKCk7XHJcbiAgICBsZXQgZmlsZUV4cGxvcmVyRmlsdGVyRWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBudWxsID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnLndvcmtzcGFjZS1sZWFmLWNvbnRlbnRbZGF0YS10eXBlPVwiZmlsZS1leHBsb3JlclwiXSAuc2VhcmNoLWlucHV0LWNvbnRhaW5lciA+IGlucHV0J1xyXG4gICAgKTtcclxuICAgIGZpbGVFeHBsb3JlckZpbHRlckVsICYmIChmaWxlRXhwbG9yZXJGaWx0ZXJFbC52YWx1ZSA9IFwiXCIpO1xyXG4gICAgZmlsZUV4cGxvcmVyLmRvbS5pbmZpbml0eVNjcm9sbC5maWx0ZXIgPSBcIlwiO1xyXG4gICAgZmlsZUV4cGxvcmVyLmRvbS5pbmZpbml0eVNjcm9sbC5jb21wdXRlKCk7XHJcbiAgfVxyXG5cclxuICBmaWxlRXhwbG9yZXJGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBzdXBwb3J0c1ZpcnR1YWxDaGlsZHJlbiA9IHJlcXVpcmVBcGlWZXJzaW9uICYmIHJlcXVpcmVBcGlWZXJzaW9uKFwiMC4xNS4wXCIpO1xyXG4gICAgbGV0IGZpbGVFeHBsb3JlciA9IHRoaXM/LnJvb3RFbD8uZmlsZUV4cGxvcmVyO1xyXG4gICAgaWYgKCFmaWxlRXhwbG9yZXIpIHJldHVybjtcclxuICAgIGNvbnN0IF9jaGlsZHJlbiA9IHN1cHBvcnRzVmlydHVhbENoaWxkcmVuID8gdGhpcy5yb290RWw/LnZDaGlsZHJlbi5fY2hpbGRyZW4gOiB0aGlzLnJvb3RFbD8uY2hpbGRyZW47XHJcbiAgICBpZiAoIV9jaGlsZHJlbikgcmV0dXJuO1xyXG4gICAgaWYgKHRoaXMuZmlsdGVyPy5sZW5ndGggPj0gMSkge1xyXG4gICAgICBpZiAoIXRoaXMuZmlsdGVyZWQpIHtcclxuICAgICAgICB0aGlzLnJvb3RFbC5fY2hpbGRyZW4gPSBfY2hpbGRyZW47XHJcbiAgICAgICAgdGhpcy5maWx0ZXJlZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICBpbmNsdWRlU2NvcmU6IHRydWUsXHJcbiAgICAgICAgaW5jbHVkZU1hdGNoZXM6IHRydWUsXHJcbiAgICAgICAgdXNlRXh0ZW5kZWRTZWFyY2g6IHRydWUsXHJcbiAgICAgICAgZ2V0Rm46IGdldEZuLFxyXG4gICAgICAgIHRocmVzaG9sZDogMC4xLFxyXG4gICAgICAgIGlnbm9yZUxvY2F0aW9uOiB0cnVlLFxyXG4gICAgICAgIGtleXM6IFtcImZpbGUucGF0aFwiXSxcclxuICAgICAgfTtcclxuICAgICAgbGV0IGZsYXR0ZW5lZEl0ZW1zID0gZ2V0SXRlbXModGhpcy5yb290RWwuX2NoaWxkcmVuKTtcclxuICAgICAgY29uc3QgZnVzZSA9IG5ldyBGdXNlKGZsYXR0ZW5lZEl0ZW1zLCBvcHRpb25zKTtcclxuICAgICAgY29uc3QgbWF4UmVzdWx0cyA9IDIwMDtcclxuICAgICAgbGV0IHJlc3VsdHMgPSBmdXNlLnNlYXJjaCh0aGlzLmZpbHRlcikuc2xpY2UoMCwgbWF4UmVzdWx0cyk7XHJcbiAgICAgIGlmIChzdXBwb3J0c1ZpcnR1YWxDaGlsZHJlbikge1xyXG4gICAgICAgIHRoaXMucm9vdEVsLnZDaGlsZHJlbi5fY2hpbGRyZW4gPSBoaWdobGlnaHQocmVzdWx0cyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5yb290RWwuY2hpbGRyZW4gPSBoaWdobGlnaHQocmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAodGhpcy5maWx0ZXI/Lmxlbmd0aCA8IDEgJiYgdGhpcy5maWx0ZXJlZCkge1xyXG4gICAgICBpZiAodGhpcy5yb290RWwuX2NoaWxkcmVuKSB7XHJcbiAgICAgICAgaWYgKHN1cHBvcnRzVmlydHVhbENoaWxkcmVuKSB7XHJcbiAgICAgICAgICB0aGlzLnJvb3RFbC52Q2hpbGRyZW4uX2NoaWxkcmVuID0gdGhpcy5yb290RWwuX2NoaWxkcmVuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLnJvb3RFbC5jaGlsZHJlbiA9IHRoaXMucm9vdEVsLl9jaGlsZHJlbjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBmbGF0dGVuZWRJdGVtcyA9IGdldEl0ZW1zKHRoaXMucm9vdEVsLl9jaGlsZHJlbik7XHJcbiAgICAgIGZsYXR0ZW5lZEl0ZW1zLm1hcCgobWF0Y2g6IENoaWxkRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlmICgoPGFueT5tYXRjaCkuaW5uZXJFbC5vcmlnQ29udGVudCkge1xyXG4gICAgICAgICAgbWF0Y2guaW5uZXJFbC5zZXRUZXh0KCg8YW55Pm1hdGNoKS5pbm5lckVsLm9yaWdDb250ZW50KTtcclxuICAgICAgICAgIGRlbGV0ZSAoPGFueT5tYXRjaCkuaW5uZXJFbC5vcmlnQ29udGVudDtcclxuICAgICAgICAgIG1hdGNoLmlubmVyRWwucmVtb3ZlQ2xhc3MoXCJoYXMtbWF0Y2hlc1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGhpcy5maWx0ZXJlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJlZ2lzdGVyRXZlbnRIYW5kbGVycygpIHtcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1leHBsb3Jlci1kcmFnZ2FibGUtY2hhbmdlXCIsIHZhbHVlID0+IHtcclxuICAgICAgICB0aGlzLnRvZ2dsZUZpbGVFeHBsb3JlclNvcnRlcnModmFsdWUpO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1leHBsb3Jlci1zb3J0LWNoYW5nZVwiLCAoc29ydE1ldGhvZDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgaWYgKHNvcnRNZXRob2QgPT09IFwiY3VzdG9tXCIpIHtcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldEZpbGVFeHBsb3JlclNvcnRlcigpO1xyXG4gICAgICAgICAgfSwgMTApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmNsZWFudXBGaWxlRXhwbG9yZXJTb3J0ZXJzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1leHBsb3Jlci1sb2FkXCIsIChmaWxlRXhwbG9yZXI6IEZpbGVFeHBsb3JlclZpZXcpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuc2V0RmlsZUV4cGxvcmVyU29ydGVyKGZpbGVFeHBsb3Jlcik7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJiYXJ0ZW5kZXItbGVhZi1zcGxpdFwiLCAob3JpZ2luTGVhZjogV29ya3NwYWNlSXRlbSwgbmV3TGVhZjogV29ya3NwYWNlSXRlbSkgPT4ge1xyXG4gICAgICAgIGxldCBlbGVtZW50OiBIVE1MRWxlbWVudCA9IG5ld0xlYWYudGFic0lubmVyRWwgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKG5ld0xlYWYudHlwZSA9PT0gXCJ0YWJzXCIgJiYgbmV3TGVhZiBpbnN0YW5jZW9mIFdvcmtzcGFjZVRhYnMpIHtcclxuICAgICAgICAgIGlmIChyZXF1aXJlQXBpVmVyc2lvbiAmJiAhcmVxdWlyZUFwaVZlcnNpb24oXCIwLjE1LjNcIikpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRUYWJCYXJTb3J0ZXIoZWxlbWVudCwgbmV3TGVhZik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbihcInJpYmJvbi1iYXItdXBkYXRlZFwiLCAoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5yaWJib25CYXJPcmRlciAmJiB0aGlzLnJpYmJvbkJhclNvcnRlcikge1xyXG4gICAgICAgICAgICB0aGlzLnNldEVsZW1lbnRJRHModGhpcy5yaWJib25CYXJTb3J0ZXIuZWwsIHsgdXNlQ2xhc3M6IHRydWUsIHVzZUFyaWE6IHRydWUsIHVzZUljb246IHRydWUgfSk7XHJcbiAgICAgICAgICAgIHRoaXMucmliYm9uQmFyU29ydGVyLnNvcnQodGhpcy5zZXR0aW5ncy5yaWJib25CYXJPcmRlcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJzdGF0dXMtYmFyLXVwZGF0ZWRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc3RhdHVzQmFyT3JkZXIgJiYgdGhpcy5zdGF0dXNCYXJTb3J0ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRFbGVtZW50SURzKHRoaXMuc3RhdHVzQmFyU29ydGVyLmVsLCB7IHVzZUNsYXNzOiB0cnVlLCB1c2VJY29uOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXR1c0JhclNvcnRlci5zb3J0KHRoaXMuc2V0dGluZ3Muc3RhdHVzQmFyT3JkZXIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyTW9ua2V5UGF0Y2hlcygpIHtcclxuICAgIGNvbnN0IHBsdWdpbiA9IHRoaXM7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICBhcm91bmQodGhpcy5hcHAudmlld1JlZ2lzdHJ5LmNvbnN0cnVjdG9yLnByb3RvdHlwZSwge1xyXG4gICAgICAgIHJlZ2lzdGVyVmlldyhvbGQ6IGFueSkge1xyXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0eXBlOiBzdHJpbmcsIHZpZXdDcmVhdG9yOiBWaWV3Q3JlYXRvciwgLi4uYXJnczogdW5rbm93bltdKSB7XHJcbiAgICAgICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLnRyaWdnZXIoXCJ2aWV3LXJlZ2lzdGVyZWRcIiwgdHlwZSwgdmlld0NyZWF0b3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gb2xkLmNhbGwodGhpcywgdHlwZSwgdmlld0NyZWF0b3IsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICAgIC8vIFRoaXMgY2F0Y2hlcyB0aGUgaW5pdGlhbCBGRSB2aWV3IHJlZ2lzdHJhdGlvbiBzbyB0aGF0IHdlIGNhbiBwYXRjaCB0aGUgc29ydCBidXR0b24gY3JlYXRpb24gbG9naWMgYmVmb3JlXHJcbiAgICAvLyB0aGUgYnV0dG9uIGlzIGNyZWF0ZWRcclxuICAgIC8vIFRPRE86IEFkZCBjb25kaXRpb25hbCBsb2dpYyB0byBwYXRjaCB0aGUgc29ydCBidXR0b24gZXZlbiBpZiB3ZSBkb24ndCBjYXRjaCB0aGUgaW5pdGlhbCBzdGFydHVwXHJcbiAgICAvLyAxKSBJZiBsYXlvdXQgcmVhZHksIGdldCB0aGUgZXhpc3RpbmcgRkUgaW5zdGFuY2UsIGNyZWF0ZSBhIHBhdGNoZWQgYnV0dG9uLCBhbmQgaGlkZSB0aGUgZXhpc3RpbmcgYnV0dG9uXHJcbiAgICAvLyAyKSBQYXRjaCBgYWRkU29ydEJ1dHRvbmAgdG8gZW1pdCBhbiBldmVudFxyXG4gICAgLy8gMykgT24gZXZlbnQsXHJcbiAgICBpZiAoIXRoaXMuYXBwLndvcmtzcGFjZS5sYXlvdXRSZWFkeSkge1xyXG4gICAgICBsZXQgZXZlbnRSZWYgPSB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJ2aWV3LXJlZ2lzdGVyZWRcIiwgKHR5cGU6IHN0cmluZywgdmlld0NyZWF0b3I6IFZpZXdDcmVhdG9yKSA9PiB7XHJcbiAgICAgICAgaWYgKHR5cGUgIT09IFwiZmlsZS1leHBsb3JlclwiKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9mZnJlZihldmVudFJlZik7XHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZSB3ZSBuZWVkIGEgbGVhZiBiZWZvcmUgYW55IGxlYWZzIGV4aXN0cyBpbiB0aGUgd29ya3NwYWNlLCBzbyB3ZSBjcmVhdGUgb25lIGZyb20gc2NyYXRjaFxyXG4gICAgICAgIGxldCBsZWFmID0gbmV3IFdvcmtzcGFjZUxlYWYocGx1Z2luLmFwcCk7XHJcbiAgICAgICAgbGV0IGZpbGVFeHBsb3JlciA9IHZpZXdDcmVhdG9yKGxlYWYpIGFzIEZpbGVFeHBsb3JlclZpZXc7XHJcbiAgICAgICAgdGhpcy5wYXRjaEZpbGVFeHBsb3JlcihmaWxlRXhwbG9yZXIpO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBmaWxlRXhwbG9yZXIgPSB0aGlzLmdldEZpbGVFeHBsb3JlcigpO1xyXG4gICAgICB0aGlzLnBhdGNoRmlsZUV4cGxvcmVyKGZpbGVFeHBsb3Jlcik7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICBhcm91bmQoVmlldy5wcm90b3R5cGUsIHtcclxuICAgICAgICBvbnVubG9hZChvbGQ6IGFueSkge1xyXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgaWYgKHRoaXMuaWNvblNvcnRlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pY29uU29ydGVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaWNvblNvcnRlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGNhdGNoIHt9XHJcbiAgICAgICAgICAgIHJldHVybiBvbGQuY2FsbCh0aGlzLCAuLi5hcmdzKTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbmxvYWQob2xkOiBhbnkpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5hcHAud29ya3NwYWNlLmxheW91dFJlYWR5KSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmxlYWYucGFyZW50U3BsaXQgaW5zdGFuY2VvZiBXb3Jrc3BhY2VUYWJzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KFwiYWN0aW9uc0VsXCIpICYmICF0aGlzLmljb25Tb3J0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWNvblNvcnRlciA9IHBsdWdpbi5zZXRWaWV3QWN0aW9uU29ydGVyKHRoaXMuYWN0aW9uc0VsLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gY2F0Y2gge31cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDIwMCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gb2xkLmNhbGwodGhpcywgLi4uYXJncyk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gICAgaWYgKFBsYXRmb3JtLmlzRGVza3RvcCkge1xyXG4gICAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICAgIGFyb3VuZChIVE1MRGl2RWxlbWVudC5wcm90b3R5cGUsIHtcclxuICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIob2xkOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChcclxuICAgICAgICAgICAgICB0eXBlOiBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXJPckV2ZW50TGlzdGVuZXJPYmplY3QsXHJcbiAgICAgICAgICAgICAgb3B0aW9ucz86IGJvb2xlYW4gfCBBZGRFdmVudExpc3RlbmVyT3B0aW9uc1xyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJtb3VzZWRvd25cIiAmJiBsaXN0ZW5lciBpbnN0YW5jZW9mIEZ1bmN0aW9uICYmIHRoaXMuaGFzQ2xhc3MoXCJ3b3Jrc3BhY2UtdGFiLWhlYWRlclwiKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IG9yaWdMaXN0ZW5lciA9IGxpc3RlbmVyO1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIgPSBldmVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgKGV2ZW50Py5hbHRLZXkgfHwgZXZlbnQ/Lm1ldGFLZXkpKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgIGVsc2Ugb3JpZ0xpc3RlbmVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG9sZC5jYWxsKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yZWdpc3RlcihcclxuICAgICAgYXJvdW5kKFdvcmtzcGFjZS5wcm90b3R5cGUsIHtcclxuICAgICAgICBzcGxpdExlYWYob2xkOiBhbnkpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoXHJcbiAgICAgICAgICAgIHNvdXJjZTogV29ya3NwYWNlSXRlbSxcclxuICAgICAgICAgICAgbmV3TGVhZjogV29ya3NwYWNlSXRlbSxcclxuICAgICAgICAgICAgZGlyZWN0aW9uPzogU3BsaXREaXJlY3Rpb24sXHJcbiAgICAgICAgICAgIGJlZm9yZT86IGJvb2xlYW4sXHJcbiAgICAgICAgICAgIC4uLmFyZ3NcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gb2xkLmNhbGwodGhpcywgc291cmNlLCBuZXdMZWFmLCBkaXJlY3Rpb24sIGJlZm9yZSwgLi4uYXJncyk7XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImJhcnRlbmRlci1sZWFmLXNwbGl0XCIsIHNvdXJjZSwgbmV3TGVhZik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2hhbmdlTGF5b3V0KG9sZDogYW55KSB7XHJcbiAgICAgICAgICByZXR1cm4gYXN5bmMgZnVuY3Rpb24gKHdvcmtzcGFjZTogYW55LCAuLi5hcmdzKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBvbGQuY2FsbCh0aGlzLCB3b3Jrc3BhY2UsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJiYXJ0ZW5kZXItd29ya3NwYWNlLWNoYW5nZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICBhcm91bmQoUGx1Z2luLnByb3RvdHlwZSwge1xyXG4gICAgICAgIGFkZFN0YXR1c0Jhckl0ZW0ob2xkOiBhbnkpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncyk6IEhUTUxFbGVtZW50IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gb2xkLmNhbGwodGhpcywgLi4uYXJncyk7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS50cmlnZ2VyKFwic3RhdHVzLWJhci11cGRhdGVkXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFkZFJpYmJvbkljb24ob2xkOiBhbnkpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncyk6IEhUTUxFbGVtZW50IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gb2xkLmNhbGwodGhpcywgLi4uYXJncyk7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS50cmlnZ2VyKFwicmliYm9uLWJhci11cGRhdGVkXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHBhdGNoRmlsZUV4cGxvcmVyKGZpbGVFeHBsb3JlcjogRmlsZUV4cGxvcmVyVmlldykge1xyXG4gICAgbGV0IHBsdWdpbiA9IHRoaXM7XHJcbiAgICBpZiAoZmlsZUV4cGxvcmVyKSB7XHJcbiAgICAgIGxldCBJbmZpbml0eVNjcm9sbCA9IGZpbGVFeHBsb3Jlci50cmVlPy5pbmZpbml0eVNjcm9sbD8uY29uc3RydWN0b3I7XHJcbiAgICAgIC8vIHJlZ2lzdGVyIGNsZWFyIGZpcnN0IHNvIHRoYXQgaXQgZ2V0cyBjYWxsZWQgZmlyc3Qgb251bmxvYWRcclxuICAgICAgdGhpcy5yZWdpc3RlcigoKSA9PiB0aGlzLmNsZWFyRmlsZUV4cGxvcmVyRmlsdGVyKCkpO1xyXG4gICAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICAgIGFyb3VuZChJbmZpbml0eVNjcm9sbC5wcm90b3R5cGUsIHtcclxuICAgICAgICAgIGNvbXB1dGUob2xkOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzOiBhbnlbXSkge1xyXG4gICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxFbC5oYXNDbGFzcyhcIm5hdi1maWxlcy1jb250YWluZXJcIikpIHtcclxuICAgICAgICAgICAgICAgICAgcGx1Z2luLmZpbGVFeHBsb3JlckZpbHRlci5jYWxsKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBvbGQuY2FsbCh0aGlzLCAuLi5hcmdzKTtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICAgIGFyb3VuZChmaWxlRXhwbG9yZXIuaGVhZGVyRG9tLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwge1xyXG4gICAgICAgICAgYWRkU29ydEJ1dHRvbihvbGQ6IGFueSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueVtdKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHRoaXMubmF2SGVhZGVyRWw/LnBhcmVudEVsZW1lbnQ/LmRhdGFzZXQ/LnR5cGUgPT09IFwiZmlsZS1leHBsb3JlclwiKSB7XHJcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0RmlsZUV4cGxvcmVyRmlsdGVyKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFkZFNvcnRCdXR0b24uY2FsbCh0aGlzLCAuLi5hcmdzKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9sZC5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGluc2VydFNlcGFyYXRvcihzZWxlY3Rvcjogc3RyaW5nLCBjbGFzc05hbWU6IHN0cmluZywgcnRsOiBCb29sZWFuLCBnbHlwaFNpemU6IG51bWJlciA9IDE2KSB7XHJcbiAgICBsZXQgZWxlbWVudHMgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xyXG4gICAgZWxlbWVudHMuZm9yRWFjaCgoZWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcbiAgICAgIGxldCBnZXRTaWJsaW5ncyA9IHJ0bCA/IGdldFByZXZpb3VzU2libGluZ3MgOiBnZXROZXh0U2libGluZ3M7XHJcbiAgICAgIGlmIChlbCkge1xyXG4gICAgICAgIGxldCBzZXBhcmF0b3IgPSBlbC5jcmVhdGVEaXYoYCR7Y2xhc3NOYW1lfSBzZXBhcmF0b3JgKTtcclxuICAgICAgICBydGwgJiYgZWwucHJlcGVuZChzZXBhcmF0b3IpO1xyXG4gICAgICAgIGxldCBnbHlwaEVsID0gc2VwYXJhdG9yLmNyZWF0ZURpdihcImdseXBoXCIpO1xyXG4gICAgICAgIGxldCBnbHlwaE5hbWUgPSBcInBsdXMtd2l0aC1jaXJjbGVcIjsgLy8gdGhpcyBnZXRzIHJlcGxhY2VkIHVzaW5nIENTU1xyXG4gICAgICAgIC8vIFRPRE86IEhhbmRsZSBtb2JpbGUgaWNvbiBzaXplIGRpZmZlcmVuY2VzP1xyXG4gICAgICAgIHNldEljb24oZ2x5cGhFbCwgZ2x5cGhOYW1lLCBnbHlwaFNpemUpO1xyXG4gICAgICAgIHNlcGFyYXRvci5hZGRDbGFzcyhcImlzLWNvbGxhcHNlZFwiKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKCgpID0+IHNlcGFyYXRvci5kZXRhY2goKSk7XHJcbiAgICAgICAgbGV0IGhpZGVUaW1lb3V0OiBOb2RlSlMuVGltZW91dDtcclxuICAgICAgICBzZXBhcmF0b3Iub25DbGlja0V2ZW50KChldmVudDogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHNlcGFyYXRvci5oYXNDbGFzcyhcImlzLWNvbGxhcHNlZFwiKSkge1xyXG4gICAgICAgICAgICBBcnJheS5mcm9tKGVsLmNoaWxkcmVuKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZUNsYXNzKFwiaXMtaGlkZGVuXCIpKTtcclxuICAgICAgICAgICAgc2VwYXJhdG9yLnJlbW92ZUNsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2V0U2libGluZ3Moc2VwYXJhdG9yKS5mb3JFYWNoKGVsID0+IGVsLmFkZENsYXNzKFwiaXMtaGlkZGVuXCIpKTtcclxuICAgICAgICAgICAgc2VwYXJhdG9yLmFkZENsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGVsLm9ubW91c2VlbnRlciA9IGV2ID0+IHtcclxuICAgICAgICAgIGhpZGVUaW1lb3V0ICYmIGNsZWFyVGltZW91dChoaWRlVGltZW91dCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbC5vbm1vdXNlbGVhdmUgPSBldiA9PiB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5hdXRvSGlkZSkge1xyXG4gICAgICAgICAgICBoaWRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGdldFNpYmxpbmdzKHNlcGFyYXRvcikuZm9yRWFjaChlbCA9PiBlbC5hZGRDbGFzcyhcImlzLWhpZGRlblwiKSk7XHJcbiAgICAgICAgICAgICAgc2VwYXJhdG9yLmFkZENsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xyXG4gICAgICAgICAgICB9LCB0aGlzLnNldHRpbmdzLmF1dG9IaWRlRGVsYXkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBnZXRTaWJsaW5ncyhzZXBhcmF0b3IpLmZvckVhY2goZWwgPT4gZWwuYWRkQ2xhc3MoXCJpcy1oaWRkZW5cIikpO1xyXG4gICAgICAgICAgc2VwYXJhdG9yLmFkZENsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldEVsZW1lbnRJRHMocGFyZW50RWw6IEhUTUxFbGVtZW50LCBvcHRpb25zOiBHZW5lcmF0ZUlkT3B0aW9ucykge1xyXG4gICAgQXJyYXkuZnJvbShwYXJlbnRFbC5jaGlsZHJlbikuZm9yRWFjaChjaGlsZCA9PiB7XHJcbiAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFjaGlsZC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpKSB7XHJcbiAgICAgICAgICBjaGlsZC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGdlbmVyYXRlSWQoY2hpbGQsIG9wdGlvbnMpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0VGFiQmFyU29ydGVyKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBsZWFmOiBXb3Jrc3BhY2VUYWJzKSB7XHJcbiAgICB0aGlzLnNldEVsZW1lbnRJRHMoZWxlbWVudCwgeyB1c2VDbGFzczogdHJ1ZSwgdXNlSWNvbjogdHJ1ZSB9KTtcclxuICAgIGxldCBzb3J0ZXIgPSBTb3J0YWJsZS5jcmVhdGUoZWxlbWVudCwge1xyXG4gICAgICBncm91cDogXCJsZWZ0VGFiQmFyXCIsXHJcbiAgICAgIGRhdGFJZEF0dHI6IFwiZGF0YS1pZFwiLFxyXG4gICAgICBjaG9zZW5DbGFzczogXCJidC1zb3J0YWJsZS1jaG9zZW5cIixcclxuICAgICAgZGVsYXk6IFBsYXRmb3JtLmlzTW9iaWxlID8gMjAwIDogdGhpcy5zZXR0aW5ncy5kcmFnRGVsYXksXHJcbiAgICAgIGRyb3BCdWJibGU6IGZhbHNlLFxyXG4gICAgICBkcmFnb3ZlckJ1YmJsZTogZmFsc2UsXHJcbiAgICAgIGFuaW1hdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OLFxyXG4gICAgICBvbkNob29zZTogKCkgPT4gZWxlbWVudC5wYXJlbnRFbGVtZW50Py5hZGRDbGFzcyhcImlzLWRyYWdnaW5nXCIpLFxyXG4gICAgICBvblVuY2hvb3NlOiAoKSA9PiBlbGVtZW50LnBhcmVudEVsZW1lbnQ/LnJlbW92ZUNsYXNzKFwiaXMtZHJhZ2dpbmdcIiksXHJcbiAgICAgIG9uU3RhcnQ6ICgpID0+IHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZENsYXNzKFwiaXMtZHJhZ2dpbmdcIik7XHJcbiAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlcGFyYXRvclwiKT8ucmVtb3ZlQ2xhc3MoXCJpcy1jb2xsYXBzZWRcIik7XHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50LmNoaWxkcmVuKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZUNsYXNzKFwiaXMtaGlkZGVuXCIpKTtcclxuICAgICAgfSxcclxuICAgICAgb25FbmQ6IGV2ZW50ID0+IHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKFwiaXMtZHJhZ2dpbmdcIik7XHJcbiAgICAgICAgaWYgKGV2ZW50Lm9sZEluZGV4ICE9PSB1bmRlZmluZWQgJiYgZXZlbnQubmV3SW5kZXggIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgcmVvcmRlckFycmF5KGxlYWYuY2hpbGRyZW4sIGV2ZW50Lm9sZEluZGV4LCBldmVudC5uZXdJbmRleCk7XHJcbiAgICAgICAgICBsZWFmLmN1cnJlbnRUYWIgPSBldmVudC5uZXdJbmRleDtcclxuICAgICAgICAgIGxlYWYucmVjb21wdXRlQ2hpbGRyZW5EaW1lbnNpb25zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXF1ZXN0U2F2ZUxheW91dCgpO1xyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gc29ydGVyO1xyXG4gIH1cclxuXHJcbiAgc2V0U3RhdHVzQmFyU29ydGVyKCkge1xyXG4gICAgbGV0IGVsID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKFwiYm9keSA+IGRpdi5hcHAtY29udGFpbmVyID4gZGl2LnN0YXR1cy1iYXJcIikgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICBpZiAoZWwpIHtcclxuICAgICAgdGhpcy5zZXRFbGVtZW50SURzKGVsLCB7IHVzZUNsYXNzOiB0cnVlLCB1c2VBcmlhOiB0cnVlLCB1c2VJY29uOiB0cnVlIH0pO1xyXG4gICAgICB0aGlzLnN0YXR1c0JhclNvcnRlciA9IFNvcnRhYmxlLmNyZWF0ZShlbCwge1xyXG4gICAgICAgIGdyb3VwOiBcInN0YXR1c0JhclwiLFxyXG4gICAgICAgIGRhdGFJZEF0dHI6IFwiZGF0YS1pZFwiLFxyXG4gICAgICAgIGNob3NlbkNsYXNzOiBcImJ0LXNvcnRhYmxlLWNob3NlblwiLFxyXG4gICAgICAgIGRlbGF5OiBQbGF0Zm9ybS5pc01vYmlsZSA/IDIwMCA6IHRoaXMuc2V0dGluZ3MuZHJhZ0RlbGF5LFxyXG4gICAgICAgIGFuaW1hdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OLFxyXG4gICAgICAgIG9uQ2hvb3NlOiAoKSA9PiB7XHJcbiAgICAgICAgICBBcnJheS5mcm9tKGVsLmNoaWxkcmVuKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZUNsYXNzKFwiaXMtaGlkZGVuXCIpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uU3RhcnQ6ICgpID0+IHtcclxuICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoXCIuc2VwYXJhdG9yXCIpPy5yZW1vdmVDbGFzcyhcImlzLWNvbGxhcHNlZFwiKTtcclxuICAgICAgICAgIEFycmF5LmZyb20oZWwuY2hpbGRyZW4pLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlQ2xhc3MoXCJpcy1oaWRkZW5cIikpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RvcmU6IHtcclxuICAgICAgICAgIGdldDogc29ydGFibGUgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5zdGF0dXNCYXJPcmRlcjtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZXQ6IHMgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnN0YXR1c0Jhck9yZGVyID0gcy50b0FycmF5KCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0Vmlld0FjdGlvblNvcnRlcihlbDogSFRNTEVsZW1lbnQsIHZpZXc6IFZpZXcpOiBTb3J0YWJsZSB8IHVuZGVmaW5lZCB7XHJcbiAgICB0aGlzLnNldEVsZW1lbnRJRHMoZWwsIHsgdXNlQ2xhc3M6IHRydWUsIHVzZUljb246IHRydWUgfSk7XHJcbiAgICBsZXQgaGFzU29ydGVyID0gT2JqZWN0LnZhbHVlcyhlbCkuZmluZCh2YWx1ZSA9PiB2YWx1ZT8uaGFzT3duUHJvcGVydHkoXCJuYXRpdmVEcmFnZ2FibGVcIikpO1xyXG4gICAgaWYgKGhhc1NvcnRlcikgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIGxldCB2aWV3VHlwZSA9IHZpZXc/LmdldFZpZXdUeXBlKCkgfHwgXCJ1bmtub3duXCI7XHJcbiAgICBsZXQgc29ydGFibGUgPSBuZXcgU29ydGFibGUoZWwsIHtcclxuICAgICAgZ3JvdXA6IFwiYWN0aW9uQmFyXCIsXHJcbiAgICAgIGRhdGFJZEF0dHI6IFwiZGF0YS1pZFwiLFxyXG4gICAgICBjaG9zZW5DbGFzczogXCJidC1zb3J0YWJsZS1jaG9zZW5cIixcclxuICAgICAgZGVsYXk6IFBsYXRmb3JtLmlzTW9iaWxlID8gMjAwIDogdGhpcy5zZXR0aW5ncy5kcmFnRGVsYXksXHJcbiAgICAgIHNvcnQ6IHRydWUsXHJcbiAgICAgIGFuaW1hdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OLFxyXG4gICAgICBvblN0YXJ0OiAoKSA9PiB7XHJcbiAgICAgICAgZWwucXVlcnlTZWxlY3RvcihcIi5zZXBhcmF0b3JcIik/LnJlbW92ZUNsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xyXG4gICAgICAgIEFycmF5LmZyb20oZWwuY2hpbGRyZW4pLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlQ2xhc3MoXCJpcy1oaWRkZW5cIikpO1xyXG4gICAgICB9LFxyXG4gICAgICBzdG9yZToge1xyXG4gICAgICAgIGdldDogKCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuYWN0aW9uQmFyT3JkZXJbdmlld1R5cGVdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBzID0+IHtcclxuICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYWN0aW9uQmFyT3JkZXJbdmlld1R5cGVdID0gcy50b0FycmF5KCk7XHJcbiAgICAgICAgICB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzb3J0YWJsZTtcclxuICB9XHJcblxyXG4gIHNldFJpYmJvbkJhclNvcnRlcigpIHtcclxuICAgIGxldCBlbCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcihcImJvZHkgPiBkaXYuYXBwLWNvbnRhaW5lciBkaXYuc2lkZS1kb2NrLWFjdGlvbnNcIikgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICBpZiAoZWwpIHtcclxuICAgICAgdGhpcy5zZXRFbGVtZW50SURzKGVsLCB7IHVzZUNsYXNzOiB0cnVlLCB1c2VBcmlhOiB0cnVlLCB1c2VJY29uOiB0cnVlIH0pO1xyXG4gICAgICB0aGlzLnJpYmJvbkJhclNvcnRlciA9IFNvcnRhYmxlLmNyZWF0ZShlbCwge1xyXG4gICAgICAgIGdyb3VwOiBcInJpYmJvbkJhclwiLFxyXG4gICAgICAgIGRhdGFJZEF0dHI6IFwiZGF0YS1pZFwiLFxyXG4gICAgICAgIGRlbGF5OiBQbGF0Zm9ybS5pc01vYmlsZSA/IDIwMCA6IHRoaXMuc2V0dGluZ3MuZHJhZ0RlbGF5LFxyXG4gICAgICAgIGNob3NlbkNsYXNzOiBcImJ0LXNvcnRhYmxlLWNob3NlblwiLFxyXG4gICAgICAgIGFuaW1hdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OLFxyXG4gICAgICAgIG9uQ2hvb3NlOiAoKSA9PiB7XHJcbiAgICAgICAgICBBcnJheS5mcm9tKGVsLmNoaWxkcmVuKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZUNsYXNzKFwiaXMtaGlkZGVuXCIpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uU3RhcnQ6ICgpID0+IHtcclxuICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoXCIuc2VwYXJhdG9yXCIpPy5yZW1vdmVDbGFzcyhcImlzLWNvbGxhcHNlZFwiKTtcclxuICAgICAgICAgIEFycmF5LmZyb20oZWwuY2hpbGRyZW4pLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlQ2xhc3MoXCJpcy1oaWRkZW5cIikpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RvcmU6IHtcclxuICAgICAgICAgIGdldDogc29ydGFibGUgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5yaWJib25CYXJPcmRlcjtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZXQ6IHMgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJpYmJvbkJhck9yZGVyID0gcy50b0FycmF5KCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RmlsZUV4cGxvcmVyRmlsdGVyKGhlYWRlckRvbTogRmlsZUV4cGxvcmVySGVhZGVyKSB7XHJcbiAgICBsZXQgZmlsZUV4cGxvcmVyTmF2ID0gaGVhZGVyRG9tLm5hdkhlYWRlckVsO1xyXG4gICAgaWYgKGZpbGVFeHBsb3Jlck5hdikge1xyXG4gICAgICBsZXQgZmlsZUV4cGxvcmVyRmlsdGVyID0gZmlsZUV4cGxvcmVyTmF2LmNyZWF0ZURpdihcInNlYXJjaC1pbnB1dC1jb250YWluZXJcIik7XHJcbiAgICAgIGZpbGVFeHBsb3Jlck5hdi5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJhZnRlcmVuZFwiLCBmaWxlRXhwbG9yZXJGaWx0ZXIpO1xyXG4gICAgICBsZXQgZmlsZUV4cGxvcmVyRmlsdGVySW5wdXQgPSBmaWxlRXhwbG9yZXJGaWx0ZXIuY3JlYXRlRWwoXCJpbnB1dFwiKTtcclxuICAgICAgZmlsZUV4cGxvcmVyRmlsdGVySW5wdXQucGxhY2Vob2xkZXIgPSBcIlR5cGUgdG8gZmlsdGVyLi4uXCI7XHJcbiAgICAgIGZpbGVFeHBsb3JlckZpbHRlcklucHV0LnR5cGUgPSBcInRleHRcIjtcclxuICAgICAgZmlsZUV4cGxvcmVyRmlsdGVyLmhpZGUoKTtcclxuICAgICAgbGV0IGZpbHRlclNjb3BlID0gbmV3IFNjb3BlKHRoaXMuYXBwLnNjb3BlKTtcclxuICAgICAgZmlsZUV4cGxvcmVyRmlsdGVySW5wdXQub25mb2N1cyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmFwcC5rZXltYXAucHVzaFNjb3BlKGZpbHRlclNjb3BlKTtcclxuICAgICAgfVxyXG4gICAgICBmaWxlRXhwbG9yZXJGaWx0ZXJJbnB1dC5vbmJsdXIgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5hcHAua2V5bWFwLnBvcFNjb3BlKGZpbHRlclNjb3BlKTtcclxuICAgICAgfVxyXG4gICAgICBmaWxlRXhwbG9yZXJGaWx0ZXJJbnB1dC5vbmlucHV0ID0gKGV2OiBJbnB1dEV2ZW50KSA9PiB7XHJcbiAgICAgICAgbGV0IGZpbGVFeHBsb3JlciA9IHRoaXMuZ2V0RmlsZUV4cGxvcmVyKCk7XHJcbiAgICAgICAgaWYgKGV2LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICAgIGlmIChldi50YXJnZXQudmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNsZWFyQnV0dG9uRWwuc2hvdygpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2xlYXJCdXR0b25FbC5oaWRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmaWxlRXhwbG9yZXIuZG9tLmluZmluaXR5U2Nyb2xsLmZpbHRlciA9IGV2LnRhcmdldC52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmlsZUV4cGxvcmVyLmRvbS5pbmZpbml0eVNjcm9sbC5jb21wdXRlKCk7XHJcbiAgICAgIH07XHJcbiAgICAgIGxldCBjbGVhckJ1dHRvbkVsID0gZmlsZUV4cGxvcmVyRmlsdGVyLmNyZWF0ZURpdihcInNlYXJjaC1pbnB1dC1jbGVhci1idXR0b25cIiwgZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIChmaWxlRXhwbG9yZXJGaWx0ZXJJbnB1dC52YWx1ZSA9IFwiXCIpLCBjbGVhckJ1dHRvbkVsLmhpZGUoKTtcclxuICAgICAgICAgIGZpbGVFeHBsb3JlckZpbHRlcklucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgICBmaWxlRXhwbG9yZXJGaWx0ZXJJbnB1dC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImlucHV0XCIpKTtcclxuICAgICAgICB9KSxcclxuICAgICAgICAgIGVsLmhpZGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRGaWxlRXhwbG9yZXJTb3J0ZXIoZmlsZUV4cGxvcmVyPzogRmlsZUV4cGxvcmVyVmlldykge1xyXG4gICAgLy8gVE9ETzogUmVnaXN0ZXIgc29ydGVyIG9uIG5ldyBmb2xkZXIgY3JlYXRpb25cclxuICAgIC8vIFRPRE86IFVucmVnaXN0ZXIgc29ydGVyIG9uIGZvbGRlciBkZWxldGlvblxyXG4gICAgaWYgKCFmaWxlRXhwbG9yZXIpIGZpbGVFeHBsb3JlciA9IHRoaXMuZ2V0RmlsZUV4cGxvcmVyKCk7XHJcbiAgICBpZiAoIWZpbGVFeHBsb3JlciB8fCBmaWxlRXhwbG9yZXIuc29ydE9yZGVyICE9PSBcImN1c3RvbVwiIHx8IGZpbGVFeHBsb3Jlci5oYXNDdXN0b21Tb3J0ZXIpIHJldHVybjtcclxuICAgIGxldCByb290cyA9IHRoaXMuZ2V0Um9vdEZvbGRlcnMoZmlsZUV4cGxvcmVyKTtcclxuICAgIGlmICghcm9vdHMgfHwgIXJvb3RzLmxlbmd0aCkgcmV0dXJuO1xyXG4gICAgZm9yIChsZXQgcm9vdCBvZiByb290cykge1xyXG4gICAgICBsZXQgZWwgPSByb290Py5jaGlsZHJlbkVsO1xyXG4gICAgICBpZiAoIWVsKSBjb250aW51ZTtcclxuICAgICAgbGV0IGRyYWdnZWRJdGVtczogSFRNTEVsZW1lbnRbXTtcclxuICAgICAgZmlsZUV4cGxvcmVyLmhhc0N1c3RvbVNvcnRlciA9IHRydWU7XHJcbiAgICAgIGxldCBkcmFnRW5hYmxlZCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcihcImRpdi5uYXYtYWN0aW9uLWJ1dHRvbi5kcmFnLXRvLXJlYXJyYW5nZVwiKT8uaGFzQ2xhc3MoXCJpcy1hY3RpdmVcIilcclxuICAgICAgICA/IHRydWVcclxuICAgICAgICA6IGZhbHNlO1xyXG4gICAgICByb290LnNvcnRlciA9IFNvcnRhYmxlLmNyZWF0ZShlbCEsIHtcclxuICAgICAgICBncm91cDogXCJmaWxlRXhwbG9yZXJcIiArIHJvb3QuZmlsZS5wYXRoLFxyXG4gICAgICAgIGZvcmNlRmFsbGJhY2s6IHRydWUsXHJcbiAgICAgICAgbXVsdGlEcmFnOiB0cnVlLFxyXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICBtdWx0aURyYWdLZXk6IFwiYWx0XCIsXHJcbiAgICAgICAgLy8gc2VsZWN0ZWRDbGFzczogXCJpcy1zZWxlY3RlZFwiLFxyXG4gICAgICAgIGNob3NlbkNsYXNzOiBcImJ0LXNvcnRhYmxlLWNob3NlblwiLFxyXG4gICAgICAgIGRlbGF5OiAwLFxyXG4gICAgICAgIGRpc2FibGVkOiAhZHJhZ0VuYWJsZWQsXHJcbiAgICAgICAgc29ydDogZHJhZ0VuYWJsZWQsIC8vIGluaXQgd2l0aCBkcmFnZ2luZyBkaXNhYmxlZC4gdGhlIG5hdiBiYXIgYnV0dG9uIHdpbGwgdG9nZ2xlIG9uL29mZlxyXG4gICAgICAgIGFuaW1hdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OLFxyXG4gICAgICAgIG9uU3RhcnQ6IGV2dCA9PiB7XHJcbiAgICAgICAgICBpZiAoZXZ0Lml0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBkcmFnZ2VkSXRlbXMgPSBldnQuaXRlbXM7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkcmFnZ2VkSXRlbXMgPSBbZXZ0Lml0ZW1dO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25Nb3ZlOiBldnQgPT4ge1xyXG4gICAgICAgICAgLy8gVE9ETzogUmVmYWN0b3IgdGhpc1xyXG4gICAgICAgICAgLy8gUmVzcG9uc2libGUgZm9yIHVwZGF0aW5nIHRoZSBpbnRlcm5hbCBPYnNpZGlhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSBmaWxlIGl0ZW0gb3JkZXJcclxuICAgICAgICAgIC8vIFdpdGhvdXQgdGhpcyBsb2dpYywgcmVvcmRlcmluZyBpcyBlcGhlbWVyYWwgYW5kIHdpbGwgYmUgdW5kb25lIGJ5IE9iaXNpZGlhbidzIG5hdGl2ZSBwcm9jZXNzZXNcclxuICAgICAgICAgIGNvbnN0IHN1cHBvcnRzVmlydHVhbENoaWxkcmVuID0gcmVxdWlyZUFwaVZlcnNpb24gJiYgcmVxdWlyZUFwaVZlcnNpb24oXCIwLjE1LjBcIik7XHJcbiAgICAgICAgICBsZXQgX2NoaWxkcmVuID0gc3VwcG9ydHNWaXJ0dWFsQ2hpbGRyZW4gPyByb290LnZDaGlsZHJlbj8uX2NoaWxkcmVuIDogcm9vdC5jaGlsZHJlbjtcclxuICAgICAgICAgIGlmICghX2NoaWxkcmVuIHx8ICFkcmFnZ2VkSXRlbXM/Lmxlbmd0aCkgcmV0dXJuO1xyXG4gICAgICAgICAgbGV0IGNoaWxkcmVuID0gX2NoaWxkcmVuLm1hcChjaGlsZCA9PiBjaGlsZC5lbCk7XHJcbiAgICAgICAgICBsZXQgYWRqYWNlbnRFbCA9IGV2dC5yZWxhdGVkO1xyXG4gICAgICAgICAgbGV0IHRhcmdldEluZGV4ID0gY2hpbGRyZW4uaW5kZXhPZihhZGphY2VudEVsKTtcclxuICAgICAgICAgIGxldCBmaXJzdEl0ZW0gPSBkcmFnZ2VkSXRlbXMuZmlyc3QoKTtcclxuICAgICAgICAgIGxldCBmaXJzdEl0ZW1JbmRleCA9IGNoaWxkcmVuLmluZGV4T2YoZmlyc3RJdGVtISk7XHJcbiAgICAgICAgICBsZXQgX2RyYWdnZWRJdGVtcyA9IGRyYWdnZWRJdGVtcy5zbGljZSgpO1xyXG4gICAgICAgICAgaWYgKGZpcnN0SXRlbUluZGV4ID4gdGFyZ2V0SW5kZXgpIF9kcmFnZ2VkSXRlbXMucmV2ZXJzZSgpO1xyXG4gICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBfZHJhZ2dlZEl0ZW1zKSB7XHJcbiAgICAgICAgICAgIGxldCBpdGVtSW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKGl0ZW0pO1xyXG4gICAgICAgICAgICBfY2hpbGRyZW4gPSByZW9yZGVyQXJyYXkoX2NoaWxkcmVuLCBpdGVtSW5kZXgsIHRhcmdldEluZGV4KTtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSByZW9yZGVyQXJyYXkoY2hpbGRyZW4sIGl0ZW1JbmRleCwgdGFyZ2V0SW5kZXgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5maWxlRXhwbG9yZXJPcmRlcltyb290LmZpbGUucGF0aF0gPSBfY2hpbGRyZW4ubWFwKGNoaWxkID0+IGNoaWxkLmZpbGUucGF0aCk7XHJcbiAgICAgICAgICB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgLy8gcmV0dXJuICFhZGphY2VudEVsLmhhc0NsYXNzKFwibmF2LWZvbGRlclwiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRW5kOiBldnQgPT4ge1xyXG4gICAgICAgICAgZHJhZ2dlZEl0ZW1zID0gW107XHJcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keT5kaXYuZHJhZy1naG9zdFwiKT8uZGV0YWNoKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRGaWxlRXhwbG9yZXIoKSB7XHJcbiAgICBsZXQgZmlsZUV4cGxvcmVyOiBGaWxlRXhwbG9yZXJWaWV3IHwgdW5kZWZpbmVkID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShcImZpbGUtZXhwbG9yZXJcIik/LmZpcnN0KClcclxuICAgICAgPy52aWV3IGFzIHVua25vd24gYXMgRmlsZUV4cGxvcmVyVmlldztcclxuICAgIHJldHVybiBmaWxlRXhwbG9yZXI7XHJcbiAgfVxyXG5cclxuICBnZXRSb290Rm9sZGVycyhmaWxlRXhwbG9yZXI/OiBGaWxlRXhwbG9yZXJWaWV3KTogW1Jvb3RFbGVtZW50cyB8IENoaWxkRWxlbWVudF0gfCB1bmRlZmluZWQge1xyXG4gICAgaWYgKCFmaWxlRXhwbG9yZXIpIGZpbGVFeHBsb3JlciA9IHRoaXMuZ2V0RmlsZUV4cGxvcmVyKCk7XHJcbiAgICBpZiAoIWZpbGVFeHBsb3JlcikgcmV0dXJuO1xyXG4gICAgbGV0IHJvb3QgPSBmaWxlRXhwbG9yZXIudHJlZT8uaW5maW5pdHlTY3JvbGw/LnJvb3RFbDtcclxuICAgIGxldCByb290cyA9IHJvb3QgJiYgdGhpcy50cmF2ZXJzZVJvb3RzKHJvb3QpO1xyXG4gICAgcmV0dXJuIHJvb3RzO1xyXG4gIH1cclxuXHJcbiAgdHJhdmVyc2VSb290cyhyb290OiBSb290RWxlbWVudHMgfCBDaGlsZEVsZW1lbnQsIGl0ZW1zPzogW1Jvb3RFbGVtZW50cyB8IENoaWxkRWxlbWVudF0pIHtcclxuICAgIGlmICghaXRlbXMpIGl0ZW1zID0gW3Jvb3RdO1xyXG4gICAgY29uc3Qgc3VwcG9ydHNWaXJ0dWFsQ2hpbGRyZW4gPSByZXF1aXJlQXBpVmVyc2lvbiAmJiByZXF1aXJlQXBpVmVyc2lvbihcIjAuMTUuMFwiKTtcclxuICAgIGNvbnN0IF9jaGlsZHJlbiA9IHN1cHBvcnRzVmlydHVhbENoaWxkcmVuID8gcm9vdC52Q2hpbGRyZW4/Ll9jaGlsZHJlbiA6IHJvb3QuY2hpbGRyZW47XHJcbiAgICBmb3IgKGxldCBjaGlsZCBvZiBfY2hpbGRyZW4gfHwgW10pIHtcclxuICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuIHx8IGNoaWxkLnZDaGlsZHJlbj8uX2NoaWxkcmVuKSB7XHJcbiAgICAgICAgaXRlbXMucHVzaChjaGlsZCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy50cmF2ZXJzZVJvb3RzKGNoaWxkLCBpdGVtcyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaXRlbXM7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVGaWxlRXhwbG9yZXJTb3J0ZXJzKGVuYWJsZTogYm9vbGVhbikge1xyXG4gICAgbGV0IGZpbGVFeHBsb3JlciA9IHRoaXMuZ2V0RmlsZUV4cGxvcmVyKCk7XHJcbiAgICBsZXQgcm9vdHMgPSB0aGlzLmdldFJvb3RGb2xkZXJzKGZpbGVFeHBsb3Jlcik7XHJcbiAgICBpZiAocm9vdHM/Lmxlbmd0aCkge1xyXG4gICAgICBmb3IgKGxldCByb290IG9mIHJvb3RzKSB7XHJcbiAgICAgICAgaWYgKHJvb3Quc29ydGVyKSB7XHJcbiAgICAgICAgICByb290LnNvcnRlci5vcHRpb24oXCJzb3J0XCIsIGVuYWJsZSk7XHJcbiAgICAgICAgICByb290LnNvcnRlci5vcHRpb24oXCJkaXNhYmxlZFwiLCAhZW5hYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsZWFudXBGaWxlRXhwbG9yZXJTb3J0ZXJzKCkge1xyXG4gICAgbGV0IGZpbGVFeHBsb3JlciA9IHRoaXMuZ2V0RmlsZUV4cGxvcmVyKCk7XHJcbiAgICBsZXQgcm9vdHMgPSB0aGlzLmdldFJvb3RGb2xkZXJzKGZpbGVFeHBsb3Jlcik7XHJcbiAgICBpZiAocm9vdHM/Lmxlbmd0aCkge1xyXG4gICAgICBmb3IgKGxldCByb290IG9mIHJvb3RzKSB7XHJcbiAgICAgICAgaWYgKHJvb3Quc29ydGVyKSB7XHJcbiAgICAgICAgICByb290LnNvcnRlci5kZXN0cm95KCk7XHJcbiAgICAgICAgICBkZWxldGUgcm9vdC5zb3J0ZXI7XHJcbiAgICAgICAgICBPYmplY3Qua2V5cyhyb290LmNoaWxkcmVuRWwhKS5mb3JFYWNoKFxyXG4gICAgICAgICAgICBrZXkgPT4ga2V5LnN0YXJ0c1dpdGgoXCJTb3J0YWJsZVwiKSAmJiBkZWxldGUgKHJvb3QuY2hpbGRyZW5FbCBhcyBhbnkpW2tleV1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICAvLyBzb3J0YWJsZS5kZXN0cm95IHJlbW92ZXMgYWxsIG9mIHRoZSBkcmFnZ2JsZSBhdHRyaWJ1dGVzIDooIHNvIHdlIHB1dCB0aGVtIGJhY2tcclxuICAgICAgICAgIHJvb3RcclxuICAgICAgICAgICAgLmNoaWxkcmVuRWwhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJkaXYubmF2LWZpbGUtdGl0bGVcIilcclxuICAgICAgICAgICAgLmZvckVhY2goKGVsOiBIVE1MRGl2RWxlbWVudCkgPT4gKGVsLmRyYWdnYWJsZSA9IHRydWUpKTtcclxuICAgICAgICAgIHJvb3RcclxuICAgICAgICAgICAgLmNoaWxkcmVuRWwhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJkaXYubmF2LWZvbGRlci10aXRsZVwiKVxyXG4gICAgICAgICAgICAuZm9yRWFjaCgoZWw6IEhUTUxEaXZFbGVtZW50KSA9PiAoZWwuZHJhZ2dhYmxlID0gdHJ1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGVsZXRlIGZpbGVFeHBsb3Jlci5oYXNDdXN0b21Tb3J0ZXI7XHJcblxyXG4gICAgLy8gdW5zZXQgXCJjdXN0b21cIiBmaWxlIGV4cGxvcmVyIHNvcnRcclxuICAgIGlmICh0aGlzLmFwcC52YXVsdC5nZXRDb25maWcoXCJmaWxlU29ydE9yZGVyXCIpID09PSBcImN1c3RvbVwiKSB7XHJcbiAgICAgIGZpbGVFeHBsb3Jlci5zZXRTb3J0T3JkZXIoXCJhbHBoYWJldGljYWxcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbnVubG9hZCgpOiB2b2lkIHtcclxuICAgIHRoaXMuc3RhdHVzQmFyU29ydGVyPy5kZXN0cm95KCk7XHJcbiAgICB0aGlzLnJpYmJvbkJhclNvcnRlcj8uZGVzdHJveSgpO1xyXG4gICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMobGVhZiA9PiB7XHJcbiAgICAgIGxldCBzb3J0ZXJQYXJlbnQ6IFZpZXcgfCBXb3Jrc3BhY2VUYWJzIHwgV29ya3NwYWNlTGVhZiB8IGJvb2xlYW47XHJcbiAgICAgIGlmIChcclxuICAgICAgICAoc29ydGVyUGFyZW50ID0gbGVhZj8uaWNvblNvcnRlciA/IGxlYWYgOiBmYWxzZSkgfHxcclxuICAgICAgICAoc29ydGVyUGFyZW50ID0gbGVhZj8udmlldz8uaWNvblNvcnRlciA/IGxlYWYudmlldyA6IGZhbHNlKSB8fFxyXG4gICAgICAgIChzb3J0ZXJQYXJlbnQgPVxyXG4gICAgICAgICAgbGVhZj8ucGFyZW50U3BsaXQgaW5zdGFuY2VvZiBXb3Jrc3BhY2VUYWJzICYmIGxlYWY/LnBhcmVudFNwbGl0Py5pY29uU29ydGVyID8gbGVhZj8ucGFyZW50U3BsaXQgOiBmYWxzZSlcclxuICAgICAgKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHNvcnRlclBhcmVudC5pY29uU29ydGVyPy5kZXN0cm95KCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgIGRlbGV0ZSBzb3J0ZXJQYXJlbnQuaWNvblNvcnRlcjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGNsZWFuIHVwIGZpbGUgZXhwbG9yZXIgc29ydGVyc1xyXG4gICAgdGhpcy5jbGVhbnVwRmlsZUV4cGxvcmVyU29ydGVycygpO1xyXG4gIH1cclxufVxyXG4iLCAiLyoqXG4gKiBGdXNlLmpzIHY2LjYuMiAtIExpZ2h0d2VpZ2h0IGZ1enp5LXNlYXJjaCAoaHR0cDovL2Z1c2Vqcy5pbylcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMjIgS2lybyBSaXNrIChodHRwOi8va2lyby5tZSlcbiAqIEFsbCBSaWdodHMgUmVzZXJ2ZWQuIEFwYWNoZSBTb2Z0d2FyZSBMaWNlbnNlIDIuMFxuICpcbiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICovXG5cbmZ1bmN0aW9uIGlzQXJyYXkodmFsdWUpIHtcbiAgcmV0dXJuICFBcnJheS5pc0FycmF5XG4gICAgPyBnZXRUYWcodmFsdWUpID09PSAnW29iamVjdCBBcnJheV0nXG4gICAgOiBBcnJheS5pc0FycmF5KHZhbHVlKVxufVxuXG4vLyBBZGFwdGVkIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9sb2Rhc2gvbG9kYXNoL2Jsb2IvbWFzdGVyLy5pbnRlcm5hbC9iYXNlVG9TdHJpbmcuanNcbmNvbnN0IElORklOSVRZID0gMSAvIDA7XG5mdW5jdGlvbiBiYXNlVG9TdHJpbmcodmFsdWUpIHtcbiAgLy8gRXhpdCBlYXJseSBmb3Igc3RyaW5ncyB0byBhdm9pZCBhIHBlcmZvcm1hbmNlIGhpdCBpbiBzb21lIGVudmlyb25tZW50cy5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB2YWx1ZVxuICB9XG4gIGxldCByZXN1bHQgPSB2YWx1ZSArICcnO1xuICByZXR1cm4gcmVzdWx0ID09ICcwJyAmJiAxIC8gdmFsdWUgPT0gLUlORklOSVRZID8gJy0wJyA6IHJlc3VsdFxufVxuXG5mdW5jdGlvbiB0b1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICcnIDogYmFzZVRvU3RyaW5nKHZhbHVlKVxufVxuXG5mdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJ1xufVxuXG5mdW5jdGlvbiBpc051bWJlcih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJ1xufVxuXG4vLyBBZGFwdGVkIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9sb2Rhc2gvbG9kYXNoL2Jsb2IvbWFzdGVyL2lzQm9vbGVhbi5qc1xuZnVuY3Rpb24gaXNCb29sZWFuKHZhbHVlKSB7XG4gIHJldHVybiAoXG4gICAgdmFsdWUgPT09IHRydWUgfHxcbiAgICB2YWx1ZSA9PT0gZmFsc2UgfHxcbiAgICAoaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBnZXRUYWcodmFsdWUpID09ICdbb2JqZWN0IEJvb2xlYW5dJylcbiAgKVxufVxuXG5mdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0J1xufVxuXG4vLyBDaGVja3MgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZS5cbmZ1bmN0aW9uIGlzT2JqZWN0TGlrZSh2YWx1ZSkge1xuICByZXR1cm4gaXNPYmplY3QodmFsdWUpICYmIHZhbHVlICE9PSBudWxsXG59XG5cbmZ1bmN0aW9uIGlzRGVmaW5lZCh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbFxufVxuXG5mdW5jdGlvbiBpc0JsYW5rKHZhbHVlKSB7XG4gIHJldHVybiAhdmFsdWUudHJpbSgpLmxlbmd0aFxufVxuXG4vLyBHZXRzIHRoZSBgdG9TdHJpbmdUYWdgIG9mIGB2YWx1ZWAuXG4vLyBBZGFwdGVkIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9sb2Rhc2gvbG9kYXNoL2Jsb2IvbWFzdGVyLy5pbnRlcm5hbC9nZXRUYWcuanNcbmZ1bmN0aW9uIGdldFRhZyh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgPT0gbnVsbFxuICAgID8gdmFsdWUgPT09IHVuZGVmaW5lZFxuICAgICAgPyAnW29iamVjdCBVbmRlZmluZWRdJ1xuICAgICAgOiAnW29iamVjdCBOdWxsXSdcbiAgICA6IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSlcbn1cblxuY29uc3QgRVhURU5ERURfU0VBUkNIX1VOQVZBSUxBQkxFID0gJ0V4dGVuZGVkIHNlYXJjaCBpcyBub3QgYXZhaWxhYmxlJztcblxuY29uc3QgSU5DT1JSRUNUX0lOREVYX1RZUEUgPSBcIkluY29ycmVjdCAnaW5kZXgnIHR5cGVcIjtcblxuY29uc3QgTE9HSUNBTF9TRUFSQ0hfSU5WQUxJRF9RVUVSWV9GT1JfS0VZID0gKGtleSkgPT5cbiAgYEludmFsaWQgdmFsdWUgZm9yIGtleSAke2tleX1gO1xuXG5jb25zdCBQQVRURVJOX0xFTkdUSF9UT09fTEFSR0UgPSAobWF4KSA9PlxuICBgUGF0dGVybiBsZW5ndGggZXhjZWVkcyBtYXggb2YgJHttYXh9LmA7XG5cbmNvbnN0IE1JU1NJTkdfS0VZX1BST1BFUlRZID0gKG5hbWUpID0+IGBNaXNzaW5nICR7bmFtZX0gcHJvcGVydHkgaW4ga2V5YDtcblxuY29uc3QgSU5WQUxJRF9LRVlfV0VJR0hUX1ZBTFVFID0gKGtleSkgPT5cbiAgYFByb3BlcnR5ICd3ZWlnaHQnIGluIGtleSAnJHtrZXl9JyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlcmA7XG5cbmNvbnN0IGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbmNsYXNzIEtleVN0b3JlIHtcbiAgY29uc3RydWN0b3Ioa2V5cykge1xuICAgIHRoaXMuX2tleXMgPSBbXTtcbiAgICB0aGlzLl9rZXlNYXAgPSB7fTtcblxuICAgIGxldCB0b3RhbFdlaWdodCA9IDA7XG5cbiAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgbGV0IG9iaiA9IGNyZWF0ZUtleShrZXkpO1xuXG4gICAgICB0b3RhbFdlaWdodCArPSBvYmoud2VpZ2h0O1xuXG4gICAgICB0aGlzLl9rZXlzLnB1c2gob2JqKTtcbiAgICAgIHRoaXMuX2tleU1hcFtvYmouaWRdID0gb2JqO1xuXG4gICAgICB0b3RhbFdlaWdodCArPSBvYmoud2VpZ2h0O1xuICAgIH0pO1xuXG4gICAgLy8gTm9ybWFsaXplIHdlaWdodHMgc28gdGhhdCB0aGVpciBzdW0gaXMgZXF1YWwgdG8gMVxuICAgIHRoaXMuX2tleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBrZXkud2VpZ2h0IC89IHRvdGFsV2VpZ2h0O1xuICAgIH0pO1xuICB9XG4gIGdldChrZXlJZCkge1xuICAgIHJldHVybiB0aGlzLl9rZXlNYXBba2V5SWRdXG4gIH1cbiAga2V5cygpIHtcbiAgICByZXR1cm4gdGhpcy5fa2V5c1xuICB9XG4gIHRvSlNPTigpIHtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5fa2V5cylcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVLZXkoa2V5KSB7XG4gIGxldCBwYXRoID0gbnVsbDtcbiAgbGV0IGlkID0gbnVsbDtcbiAgbGV0IHNyYyA9IG51bGw7XG4gIGxldCB3ZWlnaHQgPSAxO1xuICBsZXQgZ2V0Rm4gPSBudWxsO1xuXG4gIGlmIChpc1N0cmluZyhrZXkpIHx8IGlzQXJyYXkoa2V5KSkge1xuICAgIHNyYyA9IGtleTtcbiAgICBwYXRoID0gY3JlYXRlS2V5UGF0aChrZXkpO1xuICAgIGlkID0gY3JlYXRlS2V5SWQoa2V5KTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoIWhhc093bi5jYWxsKGtleSwgJ25hbWUnKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKE1JU1NJTkdfS0VZX1BST1BFUlRZKCduYW1lJykpXG4gICAgfVxuXG4gICAgY29uc3QgbmFtZSA9IGtleS5uYW1lO1xuICAgIHNyYyA9IG5hbWU7XG5cbiAgICBpZiAoaGFzT3duLmNhbGwoa2V5LCAnd2VpZ2h0JykpIHtcbiAgICAgIHdlaWdodCA9IGtleS53ZWlnaHQ7XG5cbiAgICAgIGlmICh3ZWlnaHQgPD0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSU5WQUxJRF9LRVlfV0VJR0hUX1ZBTFVFKG5hbWUpKVxuICAgICAgfVxuICAgIH1cblxuICAgIHBhdGggPSBjcmVhdGVLZXlQYXRoKG5hbWUpO1xuICAgIGlkID0gY3JlYXRlS2V5SWQobmFtZSk7XG4gICAgZ2V0Rm4gPSBrZXkuZ2V0Rm47XG4gIH1cblxuICByZXR1cm4geyBwYXRoLCBpZCwgd2VpZ2h0LCBzcmMsIGdldEZuIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlS2V5UGF0aChrZXkpIHtcbiAgcmV0dXJuIGlzQXJyYXkoa2V5KSA/IGtleSA6IGtleS5zcGxpdCgnLicpXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUtleUlkKGtleSkge1xuICByZXR1cm4gaXNBcnJheShrZXkpID8ga2V5LmpvaW4oJy4nKSA6IGtleVxufVxuXG5mdW5jdGlvbiBnZXQob2JqLCBwYXRoKSB7XG4gIGxldCBsaXN0ID0gW107XG4gIGxldCBhcnIgPSBmYWxzZTtcblxuICBjb25zdCBkZWVwR2V0ID0gKG9iaiwgcGF0aCwgaW5kZXgpID0+IHtcbiAgICBpZiAoIWlzRGVmaW5lZChvYmopKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKCFwYXRoW2luZGV4XSkge1xuICAgICAgLy8gSWYgdGhlcmUncyBubyBwYXRoIGxlZnQsIHdlJ3ZlIGFycml2ZWQgYXQgdGhlIG9iamVjdCB3ZSBjYXJlIGFib3V0LlxuICAgICAgbGlzdC5wdXNoKG9iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBrZXkgPSBwYXRoW2luZGV4XTtcblxuICAgICAgY29uc3QgdmFsdWUgPSBvYmpba2V5XTtcblxuICAgICAgaWYgKCFpc0RlZmluZWQodmFsdWUpKSB7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICAvLyBJZiB3ZSdyZSBhdCB0aGUgbGFzdCB2YWx1ZSBpbiB0aGUgcGF0aCwgYW5kIGlmIGl0J3MgYSBzdHJpbmcvbnVtYmVyL2Jvb2wsXG4gICAgICAvLyBhZGQgaXQgdG8gdGhlIGxpc3RcbiAgICAgIGlmIChcbiAgICAgICAgaW5kZXggPT09IHBhdGgubGVuZ3RoIC0gMSAmJlxuICAgICAgICAoaXNTdHJpbmcodmFsdWUpIHx8IGlzTnVtYmVyKHZhbHVlKSB8fCBpc0Jvb2xlYW4odmFsdWUpKVxuICAgICAgKSB7XG4gICAgICAgIGxpc3QucHVzaCh0b1N0cmluZyh2YWx1ZSkpO1xuICAgICAgfSBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBhcnIgPSB0cnVlO1xuICAgICAgICAvLyBTZWFyY2ggZWFjaCBpdGVtIGluIHRoZSBhcnJheS5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHZhbHVlLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgZGVlcEdldCh2YWx1ZVtpXSwgcGF0aCwgaW5kZXggKyAxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChwYXRoLmxlbmd0aCkge1xuICAgICAgICAvLyBBbiBvYmplY3QuIFJlY3Vyc2UgZnVydGhlci5cbiAgICAgICAgZGVlcEdldCh2YWx1ZSwgcGF0aCwgaW5kZXggKyAxKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgKHNpbmNlIHBhdGggdXNlZCB0byBiZSBhIHN0cmluZylcbiAgZGVlcEdldChvYmosIGlzU3RyaW5nKHBhdGgpID8gcGF0aC5zcGxpdCgnLicpIDogcGF0aCwgMCk7XG5cbiAgcmV0dXJuIGFyciA/IGxpc3QgOiBsaXN0WzBdXG59XG5cbmNvbnN0IE1hdGNoT3B0aW9ucyA9IHtcbiAgLy8gV2hldGhlciB0aGUgbWF0Y2hlcyBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdCBzZXQuIFdoZW4gYHRydWVgLCBlYWNoIHJlY29yZCBpbiB0aGUgcmVzdWx0XG4gIC8vIHNldCB3aWxsIGluY2x1ZGUgdGhlIGluZGljZXMgb2YgdGhlIG1hdGNoZWQgY2hhcmFjdGVycy5cbiAgLy8gVGhlc2UgY2FuIGNvbnNlcXVlbnRseSBiZSB1c2VkIGZvciBoaWdobGlnaHRpbmcgcHVycG9zZXMuXG4gIGluY2x1ZGVNYXRjaGVzOiBmYWxzZSxcbiAgLy8gV2hlbiBgdHJ1ZWAsIHRoZSBtYXRjaGluZyBmdW5jdGlvbiB3aWxsIGNvbnRpbnVlIHRvIHRoZSBlbmQgb2YgYSBzZWFyY2ggcGF0dGVybiBldmVuIGlmXG4gIC8vIGEgcGVyZmVjdCBtYXRjaCBoYXMgYWxyZWFkeSBiZWVuIGxvY2F0ZWQgaW4gdGhlIHN0cmluZy5cbiAgZmluZEFsbE1hdGNoZXM6IGZhbHNlLFxuICAvLyBNaW5pbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIHRoYXQgbXVzdCBiZSBtYXRjaGVkIGJlZm9yZSBhIHJlc3VsdCBpcyBjb25zaWRlcmVkIGEgbWF0Y2hcbiAgbWluTWF0Y2hDaGFyTGVuZ3RoOiAxXG59O1xuXG5jb25zdCBCYXNpY09wdGlvbnMgPSB7XG4gIC8vIFdoZW4gYHRydWVgLCB0aGUgYWxnb3JpdGhtIGNvbnRpbnVlcyBzZWFyY2hpbmcgdG8gdGhlIGVuZCBvZiB0aGUgaW5wdXQgZXZlbiBpZiBhIHBlcmZlY3RcbiAgLy8gbWF0Y2ggaXMgZm91bmQgYmVmb3JlIHRoZSBlbmQgb2YgdGhlIHNhbWUgaW5wdXQuXG4gIGlzQ2FzZVNlbnNpdGl2ZTogZmFsc2UsXG4gIC8vIFdoZW4gdHJ1ZSwgdGhlIG1hdGNoaW5nIGZ1bmN0aW9uIHdpbGwgY29udGludWUgdG8gdGhlIGVuZCBvZiBhIHNlYXJjaCBwYXR0ZXJuIGV2ZW4gaWZcbiAgaW5jbHVkZVNjb3JlOiBmYWxzZSxcbiAgLy8gTGlzdCBvZiBwcm9wZXJ0aWVzIHRoYXQgd2lsbCBiZSBzZWFyY2hlZC4gVGhpcyBhbHNvIHN1cHBvcnRzIG5lc3RlZCBwcm9wZXJ0aWVzLlxuICBrZXlzOiBbXSxcbiAgLy8gV2hldGhlciB0byBzb3J0IHRoZSByZXN1bHQgbGlzdCwgYnkgc2NvcmVcbiAgc2hvdWxkU29ydDogdHJ1ZSxcbiAgLy8gRGVmYXVsdCBzb3J0IGZ1bmN0aW9uOiBzb3J0IGJ5IGFzY2VuZGluZyBzY29yZSwgYXNjZW5kaW5nIGluZGV4XG4gIHNvcnRGbjogKGEsIGIpID0+XG4gICAgYS5zY29yZSA9PT0gYi5zY29yZSA/IChhLmlkeCA8IGIuaWR4ID8gLTEgOiAxKSA6IGEuc2NvcmUgPCBiLnNjb3JlID8gLTEgOiAxXG59O1xuXG5jb25zdCBGdXp6eU9wdGlvbnMgPSB7XG4gIC8vIEFwcHJveGltYXRlbHkgd2hlcmUgaW4gdGhlIHRleHQgaXMgdGhlIHBhdHRlcm4gZXhwZWN0ZWQgdG8gYmUgZm91bmQ/XG4gIGxvY2F0aW9uOiAwLFxuICAvLyBBdCB3aGF0IHBvaW50IGRvZXMgdGhlIG1hdGNoIGFsZ29yaXRobSBnaXZlIHVwLiBBIHRocmVzaG9sZCBvZiAnMC4wJyByZXF1aXJlcyBhIHBlcmZlY3QgbWF0Y2hcbiAgLy8gKG9mIGJvdGggbGV0dGVycyBhbmQgbG9jYXRpb24pLCBhIHRocmVzaG9sZCBvZiAnMS4wJyB3b3VsZCBtYXRjaCBhbnl0aGluZy5cbiAgdGhyZXNob2xkOiAwLjYsXG4gIC8vIERldGVybWluZXMgaG93IGNsb3NlIHRoZSBtYXRjaCBtdXN0IGJlIHRvIHRoZSBmdXp6eSBsb2NhdGlvbiAoc3BlY2lmaWVkIGFib3ZlKS5cbiAgLy8gQW4gZXhhY3QgbGV0dGVyIG1hdGNoIHdoaWNoIGlzICdkaXN0YW5jZScgY2hhcmFjdGVycyBhd2F5IGZyb20gdGhlIGZ1enp5IGxvY2F0aW9uXG4gIC8vIHdvdWxkIHNjb3JlIGFzIGEgY29tcGxldGUgbWlzbWF0Y2guIEEgZGlzdGFuY2Ugb2YgJzAnIHJlcXVpcmVzIHRoZSBtYXRjaCBiZSBhdFxuICAvLyB0aGUgZXhhY3QgbG9jYXRpb24gc3BlY2lmaWVkLCBhIHRocmVzaG9sZCBvZiAnMTAwMCcgd291bGQgcmVxdWlyZSBhIHBlcmZlY3QgbWF0Y2hcbiAgLy8gdG8gYmUgd2l0aGluIDgwMCBjaGFyYWN0ZXJzIG9mIHRoZSBmdXp6eSBsb2NhdGlvbiB0byBiZSBmb3VuZCB1c2luZyBhIDAuOCB0aHJlc2hvbGQuXG4gIGRpc3RhbmNlOiAxMDBcbn07XG5cbmNvbnN0IEFkdmFuY2VkT3B0aW9ucyA9IHtcbiAgLy8gV2hlbiBgdHJ1ZWAsIGl0IGVuYWJsZXMgdGhlIHVzZSBvZiB1bml4LWxpa2Ugc2VhcmNoIGNvbW1hbmRzXG4gIHVzZUV4dGVuZGVkU2VhcmNoOiBmYWxzZSxcbiAgLy8gVGhlIGdldCBmdW5jdGlvbiB0byB1c2Ugd2hlbiBmZXRjaGluZyBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICAvLyBUaGUgZGVmYXVsdCB3aWxsIHNlYXJjaCBuZXN0ZWQgcGF0aHMgKmllIGZvby5iYXIuYmF6KlxuICBnZXRGbjogZ2V0LFxuICAvLyBXaGVuIGB0cnVlYCwgc2VhcmNoIHdpbGwgaWdub3JlIGBsb2NhdGlvbmAgYW5kIGBkaXN0YW5jZWAsIHNvIGl0IHdvbid0IG1hdHRlclxuICAvLyB3aGVyZSBpbiB0aGUgc3RyaW5nIHRoZSBwYXR0ZXJuIGFwcGVhcnMuXG4gIC8vIE1vcmUgaW5mbzogaHR0cHM6Ly9mdXNlanMuaW8vY29uY2VwdHMvc2NvcmluZy10aGVvcnkuaHRtbCNmdXp6aW5lc3Mtc2NvcmVcbiAgaWdub3JlTG9jYXRpb246IGZhbHNlLFxuICAvLyBXaGVuIGB0cnVlYCwgdGhlIGNhbGN1bGF0aW9uIGZvciB0aGUgcmVsZXZhbmNlIHNjb3JlICh1c2VkIGZvciBzb3J0aW5nKSB3aWxsXG4gIC8vIGlnbm9yZSB0aGUgZmllbGQtbGVuZ3RoIG5vcm0uXG4gIC8vIE1vcmUgaW5mbzogaHR0cHM6Ly9mdXNlanMuaW8vY29uY2VwdHMvc2NvcmluZy10aGVvcnkuaHRtbCNmaWVsZC1sZW5ndGgtbm9ybVxuICBpZ25vcmVGaWVsZE5vcm06IGZhbHNlLFxuICAvLyBUaGUgd2VpZ2h0IHRvIGRldGVybWluZSBob3cgbXVjaCBmaWVsZCBsZW5ndGggbm9ybSBlZmZlY3RzIHNjb3JpbmcuXG4gIGZpZWxkTm9ybVdlaWdodDogMVxufTtcblxudmFyIENvbmZpZyA9IHtcbiAgLi4uQmFzaWNPcHRpb25zLFxuICAuLi5NYXRjaE9wdGlvbnMsXG4gIC4uLkZ1enp5T3B0aW9ucyxcbiAgLi4uQWR2YW5jZWRPcHRpb25zXG59O1xuXG5jb25zdCBTUEFDRSA9IC9bXiBdKy9nO1xuXG4vLyBGaWVsZC1sZW5ndGggbm9ybTogdGhlIHNob3J0ZXIgdGhlIGZpZWxkLCB0aGUgaGlnaGVyIHRoZSB3ZWlnaHQuXG4vLyBTZXQgdG8gMyBkZWNpbWFscyB0byByZWR1Y2UgaW5kZXggc2l6ZS5cbmZ1bmN0aW9uIG5vcm0od2VpZ2h0ID0gMSwgbWFudGlzc2EgPSAzKSB7XG4gIGNvbnN0IGNhY2hlID0gbmV3IE1hcCgpO1xuICBjb25zdCBtID0gTWF0aC5wb3coMTAsIG1hbnRpc3NhKTtcblxuICByZXR1cm4ge1xuICAgIGdldCh2YWx1ZSkge1xuICAgICAgY29uc3QgbnVtVG9rZW5zID0gdmFsdWUubWF0Y2goU1BBQ0UpLmxlbmd0aDtcblxuICAgICAgaWYgKGNhY2hlLmhhcyhudW1Ub2tlbnMpKSB7XG4gICAgICAgIHJldHVybiBjYWNoZS5nZXQobnVtVG9rZW5zKVxuICAgICAgfVxuXG4gICAgICAvLyBEZWZhdWx0IGZ1bmN0aW9uIGlzIDEvc3FydCh4KSwgd2VpZ2h0IG1ha2VzIHRoYXQgdmFyaWFibGVcbiAgICAgIGNvbnN0IG5vcm0gPSAxIC8gTWF0aC5wb3cobnVtVG9rZW5zLCAwLjUgKiB3ZWlnaHQpO1xuXG4gICAgICAvLyBJbiBwbGFjZSBvZiBgdG9GaXhlZChtYW50aXNzYSlgLCBmb3IgZmFzdGVyIGNvbXB1dGF0aW9uXG4gICAgICBjb25zdCBuID0gcGFyc2VGbG9hdChNYXRoLnJvdW5kKG5vcm0gKiBtKSAvIG0pO1xuXG4gICAgICBjYWNoZS5zZXQobnVtVG9rZW5zLCBuKTtcblxuICAgICAgcmV0dXJuIG5cbiAgICB9LFxuICAgIGNsZWFyKCkge1xuICAgICAgY2FjaGUuY2xlYXIoKTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgRnVzZUluZGV4IHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGdldEZuID0gQ29uZmlnLmdldEZuLFxuICAgIGZpZWxkTm9ybVdlaWdodCA9IENvbmZpZy5maWVsZE5vcm1XZWlnaHRcbiAgfSA9IHt9KSB7XG4gICAgdGhpcy5ub3JtID0gbm9ybShmaWVsZE5vcm1XZWlnaHQsIDMpO1xuICAgIHRoaXMuZ2V0Rm4gPSBnZXRGbjtcbiAgICB0aGlzLmlzQ3JlYXRlZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5zZXRJbmRleFJlY29yZHMoKTtcbiAgfVxuICBzZXRTb3VyY2VzKGRvY3MgPSBbXSkge1xuICAgIHRoaXMuZG9jcyA9IGRvY3M7XG4gIH1cbiAgc2V0SW5kZXhSZWNvcmRzKHJlY29yZHMgPSBbXSkge1xuICAgIHRoaXMucmVjb3JkcyA9IHJlY29yZHM7XG4gIH1cbiAgc2V0S2V5cyhrZXlzID0gW10pIHtcbiAgICB0aGlzLmtleXMgPSBrZXlzO1xuICAgIHRoaXMuX2tleXNNYXAgPSB7fTtcbiAgICBrZXlzLmZvckVhY2goKGtleSwgaWR4KSA9PiB7XG4gICAgICB0aGlzLl9rZXlzTWFwW2tleS5pZF0gPSBpZHg7XG4gICAgfSk7XG4gIH1cbiAgY3JlYXRlKCkge1xuICAgIGlmICh0aGlzLmlzQ3JlYXRlZCB8fCAhdGhpcy5kb2NzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5pc0NyZWF0ZWQgPSB0cnVlO1xuXG4gICAgLy8gTGlzdCBpcyBBcnJheTxTdHJpbmc+XG4gICAgaWYgKGlzU3RyaW5nKHRoaXMuZG9jc1swXSkpIHtcbiAgICAgIHRoaXMuZG9jcy5mb3JFYWNoKChkb2MsIGRvY0luZGV4KSA9PiB7XG4gICAgICAgIHRoaXMuX2FkZFN0cmluZyhkb2MsIGRvY0luZGV4KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBMaXN0IGlzIEFycmF5PE9iamVjdD5cbiAgICAgIHRoaXMuZG9jcy5mb3JFYWNoKChkb2MsIGRvY0luZGV4KSA9PiB7XG4gICAgICAgIHRoaXMuX2FkZE9iamVjdChkb2MsIGRvY0luZGV4KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMubm9ybS5jbGVhcigpO1xuICB9XG4gIC8vIEFkZHMgYSBkb2MgdG8gdGhlIGVuZCBvZiB0aGUgaW5kZXhcbiAgYWRkKGRvYykge1xuICAgIGNvbnN0IGlkeCA9IHRoaXMuc2l6ZSgpO1xuXG4gICAgaWYgKGlzU3RyaW5nKGRvYykpIHtcbiAgICAgIHRoaXMuX2FkZFN0cmluZyhkb2MsIGlkeCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2FkZE9iamVjdChkb2MsIGlkeCk7XG4gICAgfVxuICB9XG4gIC8vIFJlbW92ZXMgdGhlIGRvYyBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9mIHRoZSBpbmRleFxuICByZW1vdmVBdChpZHgpIHtcbiAgICB0aGlzLnJlY29yZHMuc3BsaWNlKGlkeCwgMSk7XG5cbiAgICAvLyBDaGFuZ2UgcmVmIGluZGV4IG9mIGV2ZXJ5IHN1YnNxdWVudCBkb2NcbiAgICBmb3IgKGxldCBpID0gaWR4LCBsZW4gPSB0aGlzLnNpemUoKTsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICB0aGlzLnJlY29yZHNbaV0uaSAtPSAxO1xuICAgIH1cbiAgfVxuICBnZXRWYWx1ZUZvckl0ZW1BdEtleUlkKGl0ZW0sIGtleUlkKSB7XG4gICAgcmV0dXJuIGl0ZW1bdGhpcy5fa2V5c01hcFtrZXlJZF1dXG4gIH1cbiAgc2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5yZWNvcmRzLmxlbmd0aFxuICB9XG4gIF9hZGRTdHJpbmcoZG9jLCBkb2NJbmRleCkge1xuICAgIGlmICghaXNEZWZpbmVkKGRvYykgfHwgaXNCbGFuayhkb2MpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBsZXQgcmVjb3JkID0ge1xuICAgICAgdjogZG9jLFxuICAgICAgaTogZG9jSW5kZXgsXG4gICAgICBuOiB0aGlzLm5vcm0uZ2V0KGRvYylcbiAgICB9O1xuXG4gICAgdGhpcy5yZWNvcmRzLnB1c2gocmVjb3JkKTtcbiAgfVxuICBfYWRkT2JqZWN0KGRvYywgZG9jSW5kZXgpIHtcbiAgICBsZXQgcmVjb3JkID0geyBpOiBkb2NJbmRleCwgJDoge30gfTtcblxuICAgIC8vIEl0ZXJhdGUgb3ZlciBldmVyeSBrZXkgKGkuZSwgcGF0aCksIGFuZCBmZXRjaCB0aGUgdmFsdWUgYXQgdGhhdCBrZXlcbiAgICB0aGlzLmtleXMuZm9yRWFjaCgoa2V5LCBrZXlJbmRleCkgPT4ge1xuICAgICAgbGV0IHZhbHVlID0ga2V5LmdldEZuID8ga2V5LmdldEZuKGRvYykgOiB0aGlzLmdldEZuKGRvYywga2V5LnBhdGgpO1xuXG4gICAgICBpZiAoIWlzRGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBsZXQgc3ViUmVjb3JkcyA9IFtdO1xuICAgICAgICBjb25zdCBzdGFjayA9IFt7IG5lc3RlZEFyckluZGV4OiAtMSwgdmFsdWUgfV07XG5cbiAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgIGNvbnN0IHsgbmVzdGVkQXJySW5kZXgsIHZhbHVlIH0gPSBzdGFjay5wb3AoKTtcblxuICAgICAgICAgIGlmICghaXNEZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaXNTdHJpbmcodmFsdWUpICYmICFpc0JsYW5rKHZhbHVlKSkge1xuICAgICAgICAgICAgbGV0IHN1YlJlY29yZCA9IHtcbiAgICAgICAgICAgICAgdjogdmFsdWUsXG4gICAgICAgICAgICAgIGk6IG5lc3RlZEFyckluZGV4LFxuICAgICAgICAgICAgICBuOiB0aGlzLm5vcm0uZ2V0KHZhbHVlKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc3ViUmVjb3Jkcy5wdXNoKHN1YlJlY29yZCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgdmFsdWUuZm9yRWFjaCgoaXRlbSwgaykgPT4ge1xuICAgICAgICAgICAgICBzdGFjay5wdXNoKHtcbiAgICAgICAgICAgICAgICBuZXN0ZWRBcnJJbmRleDogayxcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSA7XG4gICAgICAgIH1cbiAgICAgICAgcmVjb3JkLiRba2V5SW5kZXhdID0gc3ViUmVjb3JkcztcbiAgICAgIH0gZWxzZSBpZiAoaXNTdHJpbmcodmFsdWUpICYmICFpc0JsYW5rKHZhbHVlKSkge1xuICAgICAgICBsZXQgc3ViUmVjb3JkID0ge1xuICAgICAgICAgIHY6IHZhbHVlLFxuICAgICAgICAgIG46IHRoaXMubm9ybS5nZXQodmFsdWUpXG4gICAgICAgIH07XG5cbiAgICAgICAgcmVjb3JkLiRba2V5SW5kZXhdID0gc3ViUmVjb3JkO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5yZWNvcmRzLnB1c2gocmVjb3JkKTtcbiAgfVxuICB0b0pTT04oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGtleXM6IHRoaXMua2V5cyxcbiAgICAgIHJlY29yZHM6IHRoaXMucmVjb3Jkc1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVJbmRleChcbiAga2V5cyxcbiAgZG9jcyxcbiAgeyBnZXRGbiA9IENvbmZpZy5nZXRGbiwgZmllbGROb3JtV2VpZ2h0ID0gQ29uZmlnLmZpZWxkTm9ybVdlaWdodCB9ID0ge31cbikge1xuICBjb25zdCBteUluZGV4ID0gbmV3IEZ1c2VJbmRleCh7IGdldEZuLCBmaWVsZE5vcm1XZWlnaHQgfSk7XG4gIG15SW5kZXguc2V0S2V5cyhrZXlzLm1hcChjcmVhdGVLZXkpKTtcbiAgbXlJbmRleC5zZXRTb3VyY2VzKGRvY3MpO1xuICBteUluZGV4LmNyZWF0ZSgpO1xuICByZXR1cm4gbXlJbmRleFxufVxuXG5mdW5jdGlvbiBwYXJzZUluZGV4KFxuICBkYXRhLFxuICB7IGdldEZuID0gQ29uZmlnLmdldEZuLCBmaWVsZE5vcm1XZWlnaHQgPSBDb25maWcuZmllbGROb3JtV2VpZ2h0IH0gPSB7fVxuKSB7XG4gIGNvbnN0IHsga2V5cywgcmVjb3JkcyB9ID0gZGF0YTtcbiAgY29uc3QgbXlJbmRleCA9IG5ldyBGdXNlSW5kZXgoeyBnZXRGbiwgZmllbGROb3JtV2VpZ2h0IH0pO1xuICBteUluZGV4LnNldEtleXMoa2V5cyk7XG4gIG15SW5kZXguc2V0SW5kZXhSZWNvcmRzKHJlY29yZHMpO1xuICByZXR1cm4gbXlJbmRleFxufVxuXG5mdW5jdGlvbiBjb21wdXRlU2NvcmUkMShcbiAgcGF0dGVybixcbiAge1xuICAgIGVycm9ycyA9IDAsXG4gICAgY3VycmVudExvY2F0aW9uID0gMCxcbiAgICBleHBlY3RlZExvY2F0aW9uID0gMCxcbiAgICBkaXN0YW5jZSA9IENvbmZpZy5kaXN0YW5jZSxcbiAgICBpZ25vcmVMb2NhdGlvbiA9IENvbmZpZy5pZ25vcmVMb2NhdGlvblxuICB9ID0ge31cbikge1xuICBjb25zdCBhY2N1cmFjeSA9IGVycm9ycyAvIHBhdHRlcm4ubGVuZ3RoO1xuXG4gIGlmIChpZ25vcmVMb2NhdGlvbikge1xuICAgIHJldHVybiBhY2N1cmFjeVxuICB9XG5cbiAgY29uc3QgcHJveGltaXR5ID0gTWF0aC5hYnMoZXhwZWN0ZWRMb2NhdGlvbiAtIGN1cnJlbnRMb2NhdGlvbik7XG5cbiAgaWYgKCFkaXN0YW5jZSkge1xuICAgIC8vIERvZGdlIGRpdmlkZSBieSB6ZXJvIGVycm9yLlxuICAgIHJldHVybiBwcm94aW1pdHkgPyAxLjAgOiBhY2N1cmFjeVxuICB9XG5cbiAgcmV0dXJuIGFjY3VyYWN5ICsgcHJveGltaXR5IC8gZGlzdGFuY2Vcbn1cblxuZnVuY3Rpb24gY29udmVydE1hc2tUb0luZGljZXMoXG4gIG1hdGNobWFzayA9IFtdLFxuICBtaW5NYXRjaENoYXJMZW5ndGggPSBDb25maWcubWluTWF0Y2hDaGFyTGVuZ3RoXG4pIHtcbiAgbGV0IGluZGljZXMgPSBbXTtcbiAgbGV0IHN0YXJ0ID0gLTE7XG4gIGxldCBlbmQgPSAtMTtcbiAgbGV0IGkgPSAwO1xuXG4gIGZvciAobGV0IGxlbiA9IG1hdGNobWFzay5sZW5ndGg7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgIGxldCBtYXRjaCA9IG1hdGNobWFza1tpXTtcbiAgICBpZiAobWF0Y2ggJiYgc3RhcnQgPT09IC0xKSB7XG4gICAgICBzdGFydCA9IGk7XG4gICAgfSBlbHNlIGlmICghbWF0Y2ggJiYgc3RhcnQgIT09IC0xKSB7XG4gICAgICBlbmQgPSBpIC0gMTtcbiAgICAgIGlmIChlbmQgLSBzdGFydCArIDEgPj0gbWluTWF0Y2hDaGFyTGVuZ3RoKSB7XG4gICAgICAgIGluZGljZXMucHVzaChbc3RhcnQsIGVuZF0pO1xuICAgICAgfVxuICAgICAgc3RhcnQgPSAtMTtcbiAgICB9XG4gIH1cblxuICAvLyAoaS0xIC0gc3RhcnQpICsgMSA9PiBpIC0gc3RhcnRcbiAgaWYgKG1hdGNobWFza1tpIC0gMV0gJiYgaSAtIHN0YXJ0ID49IG1pbk1hdGNoQ2hhckxlbmd0aCkge1xuICAgIGluZGljZXMucHVzaChbc3RhcnQsIGkgLSAxXSk7XG4gIH1cblxuICByZXR1cm4gaW5kaWNlc1xufVxuXG4vLyBNYWNoaW5lIHdvcmQgc2l6ZVxuY29uc3QgTUFYX0JJVFMgPSAzMjtcblxuZnVuY3Rpb24gc2VhcmNoKFxuICB0ZXh0LFxuICBwYXR0ZXJuLFxuICBwYXR0ZXJuQWxwaGFiZXQsXG4gIHtcbiAgICBsb2NhdGlvbiA9IENvbmZpZy5sb2NhdGlvbixcbiAgICBkaXN0YW5jZSA9IENvbmZpZy5kaXN0YW5jZSxcbiAgICB0aHJlc2hvbGQgPSBDb25maWcudGhyZXNob2xkLFxuICAgIGZpbmRBbGxNYXRjaGVzID0gQ29uZmlnLmZpbmRBbGxNYXRjaGVzLFxuICAgIG1pbk1hdGNoQ2hhckxlbmd0aCA9IENvbmZpZy5taW5NYXRjaENoYXJMZW5ndGgsXG4gICAgaW5jbHVkZU1hdGNoZXMgPSBDb25maWcuaW5jbHVkZU1hdGNoZXMsXG4gICAgaWdub3JlTG9jYXRpb24gPSBDb25maWcuaWdub3JlTG9jYXRpb25cbiAgfSA9IHt9XG4pIHtcbiAgaWYgKHBhdHRlcm4ubGVuZ3RoID4gTUFYX0JJVFMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoUEFUVEVSTl9MRU5HVEhfVE9PX0xBUkdFKE1BWF9CSVRTKSlcbiAgfVxuXG4gIGNvbnN0IHBhdHRlcm5MZW4gPSBwYXR0ZXJuLmxlbmd0aDtcbiAgLy8gU2V0IHN0YXJ0aW5nIGxvY2F0aW9uIGF0IGJlZ2lubmluZyB0ZXh0IGFuZCBpbml0aWFsaXplIHRoZSBhbHBoYWJldC5cbiAgY29uc3QgdGV4dExlbiA9IHRleHQubGVuZ3RoO1xuICAvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlbiBsb2NhdGlvbiA+IHRleHQubGVuZ3RoXG4gIGNvbnN0IGV4cGVjdGVkTG9jYXRpb24gPSBNYXRoLm1heCgwLCBNYXRoLm1pbihsb2NhdGlvbiwgdGV4dExlbikpO1xuICAvLyBIaWdoZXN0IHNjb3JlIGJleW9uZCB3aGljaCB3ZSBnaXZlIHVwLlxuICBsZXQgY3VycmVudFRocmVzaG9sZCA9IHRocmVzaG9sZDtcbiAgLy8gSXMgdGhlcmUgYSBuZWFyYnkgZXhhY3QgbWF0Y2g/IChzcGVlZHVwKVxuICBsZXQgYmVzdExvY2F0aW9uID0gZXhwZWN0ZWRMb2NhdGlvbjtcblxuICAvLyBQZXJmb3JtYW5jZTogb25seSBjb21wdXRlciBtYXRjaGVzIHdoZW4gdGhlIG1pbk1hdGNoQ2hhckxlbmd0aCA+IDFcbiAgLy8gT1IgaWYgYGluY2x1ZGVNYXRjaGVzYCBpcyB0cnVlLlxuICBjb25zdCBjb21wdXRlTWF0Y2hlcyA9IG1pbk1hdGNoQ2hhckxlbmd0aCA+IDEgfHwgaW5jbHVkZU1hdGNoZXM7XG4gIC8vIEEgbWFzayBvZiB0aGUgbWF0Y2hlcywgdXNlZCBmb3IgYnVpbGRpbmcgdGhlIGluZGljZXNcbiAgY29uc3QgbWF0Y2hNYXNrID0gY29tcHV0ZU1hdGNoZXMgPyBBcnJheSh0ZXh0TGVuKSA6IFtdO1xuXG4gIGxldCBpbmRleDtcblxuICAvLyBHZXQgYWxsIGV4YWN0IG1hdGNoZXMsIGhlcmUgZm9yIHNwZWVkIHVwXG4gIHdoaWxlICgoaW5kZXggPSB0ZXh0LmluZGV4T2YocGF0dGVybiwgYmVzdExvY2F0aW9uKSkgPiAtMSkge1xuICAgIGxldCBzY29yZSA9IGNvbXB1dGVTY29yZSQxKHBhdHRlcm4sIHtcbiAgICAgIGN1cnJlbnRMb2NhdGlvbjogaW5kZXgsXG4gICAgICBleHBlY3RlZExvY2F0aW9uLFxuICAgICAgZGlzdGFuY2UsXG4gICAgICBpZ25vcmVMb2NhdGlvblxuICAgIH0pO1xuXG4gICAgY3VycmVudFRocmVzaG9sZCA9IE1hdGgubWluKHNjb3JlLCBjdXJyZW50VGhyZXNob2xkKTtcbiAgICBiZXN0TG9jYXRpb24gPSBpbmRleCArIHBhdHRlcm5MZW47XG5cbiAgICBpZiAoY29tcHV0ZU1hdGNoZXMpIHtcbiAgICAgIGxldCBpID0gMDtcbiAgICAgIHdoaWxlIChpIDwgcGF0dGVybkxlbikge1xuICAgICAgICBtYXRjaE1hc2tbaW5kZXggKyBpXSA9IDE7XG4gICAgICAgIGkgKz0gMTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBSZXNldCB0aGUgYmVzdCBsb2NhdGlvblxuICBiZXN0TG9jYXRpb24gPSAtMTtcblxuICBsZXQgbGFzdEJpdEFyciA9IFtdO1xuICBsZXQgZmluYWxTY29yZSA9IDE7XG4gIGxldCBiaW5NYXggPSBwYXR0ZXJuTGVuICsgdGV4dExlbjtcblxuICBjb25zdCBtYXNrID0gMSA8PCAocGF0dGVybkxlbiAtIDEpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0dGVybkxlbjsgaSArPSAxKSB7XG4gICAgLy8gU2NhbiBmb3IgdGhlIGJlc3QgbWF0Y2g7IGVhY2ggaXRlcmF0aW9uIGFsbG93cyBmb3Igb25lIG1vcmUgZXJyb3IuXG4gICAgLy8gUnVuIGEgYmluYXJ5IHNlYXJjaCB0byBkZXRlcm1pbmUgaG93IGZhciBmcm9tIHRoZSBtYXRjaCBsb2NhdGlvbiB3ZSBjYW4gc3RyYXlcbiAgICAvLyBhdCB0aGlzIGVycm9yIGxldmVsLlxuICAgIGxldCBiaW5NaW4gPSAwO1xuICAgIGxldCBiaW5NaWQgPSBiaW5NYXg7XG5cbiAgICB3aGlsZSAoYmluTWluIDwgYmluTWlkKSB7XG4gICAgICBjb25zdCBzY29yZSA9IGNvbXB1dGVTY29yZSQxKHBhdHRlcm4sIHtcbiAgICAgICAgZXJyb3JzOiBpLFxuICAgICAgICBjdXJyZW50TG9jYXRpb246IGV4cGVjdGVkTG9jYXRpb24gKyBiaW5NaWQsXG4gICAgICAgIGV4cGVjdGVkTG9jYXRpb24sXG4gICAgICAgIGRpc3RhbmNlLFxuICAgICAgICBpZ25vcmVMb2NhdGlvblxuICAgICAgfSk7XG5cbiAgICAgIGlmIChzY29yZSA8PSBjdXJyZW50VGhyZXNob2xkKSB7XG4gICAgICAgIGJpbk1pbiA9IGJpbk1pZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJpbk1heCA9IGJpbk1pZDtcbiAgICAgIH1cblxuICAgICAgYmluTWlkID0gTWF0aC5mbG9vcigoYmluTWF4IC0gYmluTWluKSAvIDIgKyBiaW5NaW4pO1xuICAgIH1cblxuICAgIC8vIFVzZSB0aGUgcmVzdWx0IGZyb20gdGhpcyBpdGVyYXRpb24gYXMgdGhlIG1heGltdW0gZm9yIHRoZSBuZXh0LlxuICAgIGJpbk1heCA9IGJpbk1pZDtcblxuICAgIGxldCBzdGFydCA9IE1hdGgubWF4KDEsIGV4cGVjdGVkTG9jYXRpb24gLSBiaW5NaWQgKyAxKTtcbiAgICBsZXQgZmluaXNoID0gZmluZEFsbE1hdGNoZXNcbiAgICAgID8gdGV4dExlblxuICAgICAgOiBNYXRoLm1pbihleHBlY3RlZExvY2F0aW9uICsgYmluTWlkLCB0ZXh0TGVuKSArIHBhdHRlcm5MZW47XG5cbiAgICAvLyBJbml0aWFsaXplIHRoZSBiaXQgYXJyYXlcbiAgICBsZXQgYml0QXJyID0gQXJyYXkoZmluaXNoICsgMik7XG5cbiAgICBiaXRBcnJbZmluaXNoICsgMV0gPSAoMSA8PCBpKSAtIDE7XG5cbiAgICBmb3IgKGxldCBqID0gZmluaXNoOyBqID49IHN0YXJ0OyBqIC09IDEpIHtcbiAgICAgIGxldCBjdXJyZW50TG9jYXRpb24gPSBqIC0gMTtcbiAgICAgIGxldCBjaGFyTWF0Y2ggPSBwYXR0ZXJuQWxwaGFiZXRbdGV4dC5jaGFyQXQoY3VycmVudExvY2F0aW9uKV07XG5cbiAgICAgIGlmIChjb21wdXRlTWF0Y2hlcykge1xuICAgICAgICAvLyBTcGVlZCB1cDogcXVpY2sgYm9vbCB0byBpbnQgY29udmVyc2lvbiAoaS5lLCBgY2hhck1hdGNoID8gMSA6IDBgKVxuICAgICAgICBtYXRjaE1hc2tbY3VycmVudExvY2F0aW9uXSA9ICshIWNoYXJNYXRjaDtcbiAgICAgIH1cblxuICAgICAgLy8gRmlyc3QgcGFzczogZXhhY3QgbWF0Y2hcbiAgICAgIGJpdEFycltqXSA9ICgoYml0QXJyW2ogKyAxXSA8PCAxKSB8IDEpICYgY2hhck1hdGNoO1xuXG4gICAgICAvLyBTdWJzZXF1ZW50IHBhc3NlczogZnV6enkgbWF0Y2hcbiAgICAgIGlmIChpKSB7XG4gICAgICAgIGJpdEFycltqXSB8PVxuICAgICAgICAgICgobGFzdEJpdEFycltqICsgMV0gfCBsYXN0Qml0QXJyW2pdKSA8PCAxKSB8IDEgfCBsYXN0Qml0QXJyW2ogKyAxXTtcbiAgICAgIH1cblxuICAgICAgaWYgKGJpdEFycltqXSAmIG1hc2spIHtcbiAgICAgICAgZmluYWxTY29yZSA9IGNvbXB1dGVTY29yZSQxKHBhdHRlcm4sIHtcbiAgICAgICAgICBlcnJvcnM6IGksXG4gICAgICAgICAgY3VycmVudExvY2F0aW9uLFxuICAgICAgICAgIGV4cGVjdGVkTG9jYXRpb24sXG4gICAgICAgICAgZGlzdGFuY2UsXG4gICAgICAgICAgaWdub3JlTG9jYXRpb25cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVGhpcyBtYXRjaCB3aWxsIGFsbW9zdCBjZXJ0YWlubHkgYmUgYmV0dGVyIHRoYW4gYW55IGV4aXN0aW5nIG1hdGNoLlxuICAgICAgICAvLyBCdXQgY2hlY2sgYW55d2F5LlxuICAgICAgICBpZiAoZmluYWxTY29yZSA8PSBjdXJyZW50VGhyZXNob2xkKSB7XG4gICAgICAgICAgLy8gSW5kZWVkIGl0IGlzXG4gICAgICAgICAgY3VycmVudFRocmVzaG9sZCA9IGZpbmFsU2NvcmU7XG4gICAgICAgICAgYmVzdExvY2F0aW9uID0gY3VycmVudExvY2F0aW9uO1xuXG4gICAgICAgICAgLy8gQWxyZWFkeSBwYXNzZWQgYGxvY2AsIGRvd25oaWxsIGZyb20gaGVyZSBvbiBpbi5cbiAgICAgICAgICBpZiAoYmVzdExvY2F0aW9uIDw9IGV4cGVjdGVkTG9jYXRpb24pIHtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gV2hlbiBwYXNzaW5nIGBiZXN0TG9jYXRpb25gLCBkb24ndCBleGNlZWQgb3VyIGN1cnJlbnQgZGlzdGFuY2UgZnJvbSBgZXhwZWN0ZWRMb2NhdGlvbmAuXG4gICAgICAgICAgc3RhcnQgPSBNYXRoLm1heCgxLCAyICogZXhwZWN0ZWRMb2NhdGlvbiAtIGJlc3RMb2NhdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBObyBob3BlIGZvciBhIChiZXR0ZXIpIG1hdGNoIGF0IGdyZWF0ZXIgZXJyb3IgbGV2ZWxzLlxuICAgIGNvbnN0IHNjb3JlID0gY29tcHV0ZVNjb3JlJDEocGF0dGVybiwge1xuICAgICAgZXJyb3JzOiBpICsgMSxcbiAgICAgIGN1cnJlbnRMb2NhdGlvbjogZXhwZWN0ZWRMb2NhdGlvbixcbiAgICAgIGV4cGVjdGVkTG9jYXRpb24sXG4gICAgICBkaXN0YW5jZSxcbiAgICAgIGlnbm9yZUxvY2F0aW9uXG4gICAgfSk7XG5cbiAgICBpZiAoc2NvcmUgPiBjdXJyZW50VGhyZXNob2xkKSB7XG4gICAgICBicmVha1xuICAgIH1cblxuICAgIGxhc3RCaXRBcnIgPSBiaXRBcnI7XG4gIH1cblxuICBjb25zdCByZXN1bHQgPSB7XG4gICAgaXNNYXRjaDogYmVzdExvY2F0aW9uID49IDAsXG4gICAgLy8gQ291bnQgZXhhY3QgbWF0Y2hlcyAodGhvc2Ugd2l0aCBhIHNjb3JlIG9mIDApIHRvIGJlIFwiYWxtb3N0XCIgZXhhY3RcbiAgICBzY29yZTogTWF0aC5tYXgoMC4wMDEsIGZpbmFsU2NvcmUpXG4gIH07XG5cbiAgaWYgKGNvbXB1dGVNYXRjaGVzKSB7XG4gICAgY29uc3QgaW5kaWNlcyA9IGNvbnZlcnRNYXNrVG9JbmRpY2VzKG1hdGNoTWFzaywgbWluTWF0Y2hDaGFyTGVuZ3RoKTtcbiAgICBpZiAoIWluZGljZXMubGVuZ3RoKSB7XG4gICAgICByZXN1bHQuaXNNYXRjaCA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoaW5jbHVkZU1hdGNoZXMpIHtcbiAgICAgIHJlc3VsdC5pbmRpY2VzID0gaW5kaWNlcztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVBhdHRlcm5BbHBoYWJldChwYXR0ZXJuKSB7XG4gIGxldCBtYXNrID0ge307XG5cbiAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHBhdHRlcm4ubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICBjb25zdCBjaGFyID0gcGF0dGVybi5jaGFyQXQoaSk7XG4gICAgbWFza1tjaGFyXSA9IChtYXNrW2NoYXJdIHx8IDApIHwgKDEgPDwgKGxlbiAtIGkgLSAxKSk7XG4gIH1cblxuICByZXR1cm4gbWFza1xufVxuXG5jbGFzcyBCaXRhcFNlYXJjaCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhdHRlcm4sXG4gICAge1xuICAgICAgbG9jYXRpb24gPSBDb25maWcubG9jYXRpb24sXG4gICAgICB0aHJlc2hvbGQgPSBDb25maWcudGhyZXNob2xkLFxuICAgICAgZGlzdGFuY2UgPSBDb25maWcuZGlzdGFuY2UsXG4gICAgICBpbmNsdWRlTWF0Y2hlcyA9IENvbmZpZy5pbmNsdWRlTWF0Y2hlcyxcbiAgICAgIGZpbmRBbGxNYXRjaGVzID0gQ29uZmlnLmZpbmRBbGxNYXRjaGVzLFxuICAgICAgbWluTWF0Y2hDaGFyTGVuZ3RoID0gQ29uZmlnLm1pbk1hdGNoQ2hhckxlbmd0aCxcbiAgICAgIGlzQ2FzZVNlbnNpdGl2ZSA9IENvbmZpZy5pc0Nhc2VTZW5zaXRpdmUsXG4gICAgICBpZ25vcmVMb2NhdGlvbiA9IENvbmZpZy5pZ25vcmVMb2NhdGlvblxuICAgIH0gPSB7fVxuICApIHtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBsb2NhdGlvbixcbiAgICAgIHRocmVzaG9sZCxcbiAgICAgIGRpc3RhbmNlLFxuICAgICAgaW5jbHVkZU1hdGNoZXMsXG4gICAgICBmaW5kQWxsTWF0Y2hlcyxcbiAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aCxcbiAgICAgIGlzQ2FzZVNlbnNpdGl2ZSxcbiAgICAgIGlnbm9yZUxvY2F0aW9uXG4gICAgfTtcblxuICAgIHRoaXMucGF0dGVybiA9IGlzQ2FzZVNlbnNpdGl2ZSA/IHBhdHRlcm4gOiBwYXR0ZXJuLnRvTG93ZXJDYXNlKCk7XG5cbiAgICB0aGlzLmNodW5rcyA9IFtdO1xuXG4gICAgaWYgKCF0aGlzLnBhdHRlcm4ubGVuZ3RoKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBhZGRDaHVuayA9IChwYXR0ZXJuLCBzdGFydEluZGV4KSA9PiB7XG4gICAgICB0aGlzLmNodW5rcy5wdXNoKHtcbiAgICAgICAgcGF0dGVybixcbiAgICAgICAgYWxwaGFiZXQ6IGNyZWF0ZVBhdHRlcm5BbHBoYWJldChwYXR0ZXJuKSxcbiAgICAgICAgc3RhcnRJbmRleFxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGNvbnN0IGxlbiA9IHRoaXMucGF0dGVybi5sZW5ndGg7XG5cbiAgICBpZiAobGVuID4gTUFYX0JJVFMpIHtcbiAgICAgIGxldCBpID0gMDtcbiAgICAgIGNvbnN0IHJlbWFpbmRlciA9IGxlbiAlIE1BWF9CSVRTO1xuICAgICAgY29uc3QgZW5kID0gbGVuIC0gcmVtYWluZGVyO1xuXG4gICAgICB3aGlsZSAoaSA8IGVuZCkge1xuICAgICAgICBhZGRDaHVuayh0aGlzLnBhdHRlcm4uc3Vic3RyKGksIE1BWF9CSVRTKSwgaSk7XG4gICAgICAgIGkgKz0gTUFYX0JJVFM7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZW1haW5kZXIpIHtcbiAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGxlbiAtIE1BWF9CSVRTO1xuICAgICAgICBhZGRDaHVuayh0aGlzLnBhdHRlcm4uc3Vic3RyKHN0YXJ0SW5kZXgpLCBzdGFydEluZGV4KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYWRkQ2h1bmsodGhpcy5wYXR0ZXJuLCAwKTtcbiAgICB9XG4gIH1cblxuICBzZWFyY2hJbih0ZXh0KSB7XG4gICAgY29uc3QgeyBpc0Nhc2VTZW5zaXRpdmUsIGluY2x1ZGVNYXRjaGVzIH0gPSB0aGlzLm9wdGlvbnM7XG5cbiAgICBpZiAoIWlzQ2FzZVNlbnNpdGl2ZSkge1xuICAgICAgdGV4dCA9IHRleHQudG9Mb3dlckNhc2UoKTtcbiAgICB9XG5cbiAgICAvLyBFeGFjdCBtYXRjaFxuICAgIGlmICh0aGlzLnBhdHRlcm4gPT09IHRleHQpIHtcbiAgICAgIGxldCByZXN1bHQgPSB7XG4gICAgICAgIGlzTWF0Y2g6IHRydWUsXG4gICAgICAgIHNjb3JlOiAwXG4gICAgICB9O1xuXG4gICAgICBpZiAoaW5jbHVkZU1hdGNoZXMpIHtcbiAgICAgICAgcmVzdWx0LmluZGljZXMgPSBbWzAsIHRleHQubGVuZ3RoIC0gMV1dO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfVxuXG4gICAgLy8gT3RoZXJ3aXNlLCB1c2UgQml0YXAgYWxnb3JpdGhtXG4gICAgY29uc3Qge1xuICAgICAgbG9jYXRpb24sXG4gICAgICBkaXN0YW5jZSxcbiAgICAgIHRocmVzaG9sZCxcbiAgICAgIGZpbmRBbGxNYXRjaGVzLFxuICAgICAgbWluTWF0Y2hDaGFyTGVuZ3RoLFxuICAgICAgaWdub3JlTG9jYXRpb25cbiAgICB9ID0gdGhpcy5vcHRpb25zO1xuXG4gICAgbGV0IGFsbEluZGljZXMgPSBbXTtcbiAgICBsZXQgdG90YWxTY29yZSA9IDA7XG4gICAgbGV0IGhhc01hdGNoZXMgPSBmYWxzZTtcblxuICAgIHRoaXMuY2h1bmtzLmZvckVhY2goKHsgcGF0dGVybiwgYWxwaGFiZXQsIHN0YXJ0SW5kZXggfSkgPT4ge1xuICAgICAgY29uc3QgeyBpc01hdGNoLCBzY29yZSwgaW5kaWNlcyB9ID0gc2VhcmNoKHRleHQsIHBhdHRlcm4sIGFscGhhYmV0LCB7XG4gICAgICAgIGxvY2F0aW9uOiBsb2NhdGlvbiArIHN0YXJ0SW5kZXgsXG4gICAgICAgIGRpc3RhbmNlLFxuICAgICAgICB0aHJlc2hvbGQsXG4gICAgICAgIGZpbmRBbGxNYXRjaGVzLFxuICAgICAgICBtaW5NYXRjaENoYXJMZW5ndGgsXG4gICAgICAgIGluY2x1ZGVNYXRjaGVzLFxuICAgICAgICBpZ25vcmVMb2NhdGlvblxuICAgICAgfSk7XG5cbiAgICAgIGlmIChpc01hdGNoKSB7XG4gICAgICAgIGhhc01hdGNoZXMgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICB0b3RhbFNjb3JlICs9IHNjb3JlO1xuXG4gICAgICBpZiAoaXNNYXRjaCAmJiBpbmRpY2VzKSB7XG4gICAgICAgIGFsbEluZGljZXMgPSBbLi4uYWxsSW5kaWNlcywgLi4uaW5kaWNlc107XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBsZXQgcmVzdWx0ID0ge1xuICAgICAgaXNNYXRjaDogaGFzTWF0Y2hlcyxcbiAgICAgIHNjb3JlOiBoYXNNYXRjaGVzID8gdG90YWxTY29yZSAvIHRoaXMuY2h1bmtzLmxlbmd0aCA6IDFcbiAgICB9O1xuXG4gICAgaWYgKGhhc01hdGNoZXMgJiYgaW5jbHVkZU1hdGNoZXMpIHtcbiAgICAgIHJlc3VsdC5pbmRpY2VzID0gYWxsSW5kaWNlcztcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cbn1cblxuY2xhc3MgQmFzZU1hdGNoIHtcbiAgY29uc3RydWN0b3IocGF0dGVybikge1xuICAgIHRoaXMucGF0dGVybiA9IHBhdHRlcm47XG4gIH1cbiAgc3RhdGljIGlzTXVsdGlNYXRjaChwYXR0ZXJuKSB7XG4gICAgcmV0dXJuIGdldE1hdGNoKHBhdHRlcm4sIHRoaXMubXVsdGlSZWdleClcbiAgfVxuICBzdGF0aWMgaXNTaW5nbGVNYXRjaChwYXR0ZXJuKSB7XG4gICAgcmV0dXJuIGdldE1hdGNoKHBhdHRlcm4sIHRoaXMuc2luZ2xlUmVnZXgpXG4gIH1cbiAgc2VhcmNoKC8qdGV4dCovKSB7fVxufVxuXG5mdW5jdGlvbiBnZXRNYXRjaChwYXR0ZXJuLCBleHApIHtcbiAgY29uc3QgbWF0Y2hlcyA9IHBhdHRlcm4ubWF0Y2goZXhwKTtcbiAgcmV0dXJuIG1hdGNoZXMgPyBtYXRjaGVzWzFdIDogbnVsbFxufVxuXG4vLyBUb2tlbjogJ2ZpbGVcblxuY2xhc3MgRXhhY3RNYXRjaCBleHRlbmRzIEJhc2VNYXRjaCB7XG4gIGNvbnN0cnVjdG9yKHBhdHRlcm4pIHtcbiAgICBzdXBlcihwYXR0ZXJuKTtcbiAgfVxuICBzdGF0aWMgZ2V0IHR5cGUoKSB7XG4gICAgcmV0dXJuICdleGFjdCdcbiAgfVxuICBzdGF0aWMgZ2V0IG11bHRpUmVnZXgoKSB7XG4gICAgcmV0dXJuIC9ePVwiKC4qKVwiJC9cbiAgfVxuICBzdGF0aWMgZ2V0IHNpbmdsZVJlZ2V4KCkge1xuICAgIHJldHVybiAvXj0oLiopJC9cbiAgfVxuICBzZWFyY2godGV4dCkge1xuICAgIGNvbnN0IGlzTWF0Y2ggPSB0ZXh0ID09PSB0aGlzLnBhdHRlcm47XG5cbiAgICByZXR1cm4ge1xuICAgICAgaXNNYXRjaCxcbiAgICAgIHNjb3JlOiBpc01hdGNoID8gMCA6IDEsXG4gICAgICBpbmRpY2VzOiBbMCwgdGhpcy5wYXR0ZXJuLmxlbmd0aCAtIDFdXG4gICAgfVxuICB9XG59XG5cbi8vIFRva2VuOiAhZmlyZVxuXG5jbGFzcyBJbnZlcnNlRXhhY3RNYXRjaCBleHRlbmRzIEJhc2VNYXRjaCB7XG4gIGNvbnN0cnVjdG9yKHBhdHRlcm4pIHtcbiAgICBzdXBlcihwYXR0ZXJuKTtcbiAgfVxuICBzdGF0aWMgZ2V0IHR5cGUoKSB7XG4gICAgcmV0dXJuICdpbnZlcnNlLWV4YWN0J1xuICB9XG4gIHN0YXRpYyBnZXQgbXVsdGlSZWdleCgpIHtcbiAgICByZXR1cm4gL14hXCIoLiopXCIkL1xuICB9XG4gIHN0YXRpYyBnZXQgc2luZ2xlUmVnZXgoKSB7XG4gICAgcmV0dXJuIC9eISguKikkL1xuICB9XG4gIHNlYXJjaCh0ZXh0KSB7XG4gICAgY29uc3QgaW5kZXggPSB0ZXh0LmluZGV4T2YodGhpcy5wYXR0ZXJuKTtcbiAgICBjb25zdCBpc01hdGNoID0gaW5kZXggPT09IC0xO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTWF0Y2gsXG4gICAgICBzY29yZTogaXNNYXRjaCA/IDAgOiAxLFxuICAgICAgaW5kaWNlczogWzAsIHRleHQubGVuZ3RoIC0gMV1cbiAgICB9XG4gIH1cbn1cblxuLy8gVG9rZW46IF5maWxlXG5cbmNsYXNzIFByZWZpeEV4YWN0TWF0Y2ggZXh0ZW5kcyBCYXNlTWF0Y2gge1xuICBjb25zdHJ1Y3RvcihwYXR0ZXJuKSB7XG4gICAgc3VwZXIocGF0dGVybik7XG4gIH1cbiAgc3RhdGljIGdldCB0eXBlKCkge1xuICAgIHJldHVybiAncHJlZml4LWV4YWN0J1xuICB9XG4gIHN0YXRpYyBnZXQgbXVsdGlSZWdleCgpIHtcbiAgICByZXR1cm4gL15cXF5cIiguKilcIiQvXG4gIH1cbiAgc3RhdGljIGdldCBzaW5nbGVSZWdleCgpIHtcbiAgICByZXR1cm4gL15cXF4oLiopJC9cbiAgfVxuICBzZWFyY2godGV4dCkge1xuICAgIGNvbnN0IGlzTWF0Y2ggPSB0ZXh0LnN0YXJ0c1dpdGgodGhpcy5wYXR0ZXJuKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpc01hdGNoLFxuICAgICAgc2NvcmU6IGlzTWF0Y2ggPyAwIDogMSxcbiAgICAgIGluZGljZXM6IFswLCB0aGlzLnBhdHRlcm4ubGVuZ3RoIC0gMV1cbiAgICB9XG4gIH1cbn1cblxuLy8gVG9rZW46ICFeZmlyZVxuXG5jbGFzcyBJbnZlcnNlUHJlZml4RXhhY3RNYXRjaCBleHRlbmRzIEJhc2VNYXRjaCB7XG4gIGNvbnN0cnVjdG9yKHBhdHRlcm4pIHtcbiAgICBzdXBlcihwYXR0ZXJuKTtcbiAgfVxuICBzdGF0aWMgZ2V0IHR5cGUoKSB7XG4gICAgcmV0dXJuICdpbnZlcnNlLXByZWZpeC1leGFjdCdcbiAgfVxuICBzdGF0aWMgZ2V0IG11bHRpUmVnZXgoKSB7XG4gICAgcmV0dXJuIC9eIVxcXlwiKC4qKVwiJC9cbiAgfVxuICBzdGF0aWMgZ2V0IHNpbmdsZVJlZ2V4KCkge1xuICAgIHJldHVybiAvXiFcXF4oLiopJC9cbiAgfVxuICBzZWFyY2godGV4dCkge1xuICAgIGNvbnN0IGlzTWF0Y2ggPSAhdGV4dC5zdGFydHNXaXRoKHRoaXMucGF0dGVybik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaXNNYXRjaCxcbiAgICAgIHNjb3JlOiBpc01hdGNoID8gMCA6IDEsXG4gICAgICBpbmRpY2VzOiBbMCwgdGV4dC5sZW5ndGggLSAxXVxuICAgIH1cbiAgfVxufVxuXG4vLyBUb2tlbjogLmZpbGUkXG5cbmNsYXNzIFN1ZmZpeEV4YWN0TWF0Y2ggZXh0ZW5kcyBCYXNlTWF0Y2gge1xuICBjb25zdHJ1Y3RvcihwYXR0ZXJuKSB7XG4gICAgc3VwZXIocGF0dGVybik7XG4gIH1cbiAgc3RhdGljIGdldCB0eXBlKCkge1xuICAgIHJldHVybiAnc3VmZml4LWV4YWN0J1xuICB9XG4gIHN0YXRpYyBnZXQgbXVsdGlSZWdleCgpIHtcbiAgICByZXR1cm4gL15cIiguKilcIlxcJCQvXG4gIH1cbiAgc3RhdGljIGdldCBzaW5nbGVSZWdleCgpIHtcbiAgICByZXR1cm4gL14oLiopXFwkJC9cbiAgfVxuICBzZWFyY2godGV4dCkge1xuICAgIGNvbnN0IGlzTWF0Y2ggPSB0ZXh0LmVuZHNXaXRoKHRoaXMucGF0dGVybik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaXNNYXRjaCxcbiAgICAgIHNjb3JlOiBpc01hdGNoID8gMCA6IDEsXG4gICAgICBpbmRpY2VzOiBbdGV4dC5sZW5ndGggLSB0aGlzLnBhdHRlcm4ubGVuZ3RoLCB0ZXh0Lmxlbmd0aCAtIDFdXG4gICAgfVxuICB9XG59XG5cbi8vIFRva2VuOiAhLmZpbGUkXG5cbmNsYXNzIEludmVyc2VTdWZmaXhFeGFjdE1hdGNoIGV4dGVuZHMgQmFzZU1hdGNoIHtcbiAgY29uc3RydWN0b3IocGF0dGVybikge1xuICAgIHN1cGVyKHBhdHRlcm4pO1xuICB9XG4gIHN0YXRpYyBnZXQgdHlwZSgpIHtcbiAgICByZXR1cm4gJ2ludmVyc2Utc3VmZml4LWV4YWN0J1xuICB9XG4gIHN0YXRpYyBnZXQgbXVsdGlSZWdleCgpIHtcbiAgICByZXR1cm4gL14hXCIoLiopXCJcXCQkL1xuICB9XG4gIHN0YXRpYyBnZXQgc2luZ2xlUmVnZXgoKSB7XG4gICAgcmV0dXJuIC9eISguKilcXCQkL1xuICB9XG4gIHNlYXJjaCh0ZXh0KSB7XG4gICAgY29uc3QgaXNNYXRjaCA9ICF0ZXh0LmVuZHNXaXRoKHRoaXMucGF0dGVybik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTWF0Y2gsXG4gICAgICBzY29yZTogaXNNYXRjaCA/IDAgOiAxLFxuICAgICAgaW5kaWNlczogWzAsIHRleHQubGVuZ3RoIC0gMV1cbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgRnV6enlNYXRjaCBleHRlbmRzIEJhc2VNYXRjaCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhdHRlcm4sXG4gICAge1xuICAgICAgbG9jYXRpb24gPSBDb25maWcubG9jYXRpb24sXG4gICAgICB0aHJlc2hvbGQgPSBDb25maWcudGhyZXNob2xkLFxuICAgICAgZGlzdGFuY2UgPSBDb25maWcuZGlzdGFuY2UsXG4gICAgICBpbmNsdWRlTWF0Y2hlcyA9IENvbmZpZy5pbmNsdWRlTWF0Y2hlcyxcbiAgICAgIGZpbmRBbGxNYXRjaGVzID0gQ29uZmlnLmZpbmRBbGxNYXRjaGVzLFxuICAgICAgbWluTWF0Y2hDaGFyTGVuZ3RoID0gQ29uZmlnLm1pbk1hdGNoQ2hhckxlbmd0aCxcbiAgICAgIGlzQ2FzZVNlbnNpdGl2ZSA9IENvbmZpZy5pc0Nhc2VTZW5zaXRpdmUsXG4gICAgICBpZ25vcmVMb2NhdGlvbiA9IENvbmZpZy5pZ25vcmVMb2NhdGlvblxuICAgIH0gPSB7fVxuICApIHtcbiAgICBzdXBlcihwYXR0ZXJuKTtcbiAgICB0aGlzLl9iaXRhcFNlYXJjaCA9IG5ldyBCaXRhcFNlYXJjaChwYXR0ZXJuLCB7XG4gICAgICBsb2NhdGlvbixcbiAgICAgIHRocmVzaG9sZCxcbiAgICAgIGRpc3RhbmNlLFxuICAgICAgaW5jbHVkZU1hdGNoZXMsXG4gICAgICBmaW5kQWxsTWF0Y2hlcyxcbiAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aCxcbiAgICAgIGlzQ2FzZVNlbnNpdGl2ZSxcbiAgICAgIGlnbm9yZUxvY2F0aW9uXG4gICAgfSk7XG4gIH1cbiAgc3RhdGljIGdldCB0eXBlKCkge1xuICAgIHJldHVybiAnZnV6enknXG4gIH1cbiAgc3RhdGljIGdldCBtdWx0aVJlZ2V4KCkge1xuICAgIHJldHVybiAvXlwiKC4qKVwiJC9cbiAgfVxuICBzdGF0aWMgZ2V0IHNpbmdsZVJlZ2V4KCkge1xuICAgIHJldHVybiAvXiguKikkL1xuICB9XG4gIHNlYXJjaCh0ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX2JpdGFwU2VhcmNoLnNlYXJjaEluKHRleHQpXG4gIH1cbn1cblxuLy8gVG9rZW46ICdmaWxlXG5cbmNsYXNzIEluY2x1ZGVNYXRjaCBleHRlbmRzIEJhc2VNYXRjaCB7XG4gIGNvbnN0cnVjdG9yKHBhdHRlcm4pIHtcbiAgICBzdXBlcihwYXR0ZXJuKTtcbiAgfVxuICBzdGF0aWMgZ2V0IHR5cGUoKSB7XG4gICAgcmV0dXJuICdpbmNsdWRlJ1xuICB9XG4gIHN0YXRpYyBnZXQgbXVsdGlSZWdleCgpIHtcbiAgICByZXR1cm4gL14nXCIoLiopXCIkL1xuICB9XG4gIHN0YXRpYyBnZXQgc2luZ2xlUmVnZXgoKSB7XG4gICAgcmV0dXJuIC9eJyguKikkL1xuICB9XG4gIHNlYXJjaCh0ZXh0KSB7XG4gICAgbGV0IGxvY2F0aW9uID0gMDtcbiAgICBsZXQgaW5kZXg7XG5cbiAgICBjb25zdCBpbmRpY2VzID0gW107XG4gICAgY29uc3QgcGF0dGVybkxlbiA9IHRoaXMucGF0dGVybi5sZW5ndGg7XG5cbiAgICAvLyBHZXQgYWxsIGV4YWN0IG1hdGNoZXNcbiAgICB3aGlsZSAoKGluZGV4ID0gdGV4dC5pbmRleE9mKHRoaXMucGF0dGVybiwgbG9jYXRpb24pKSA+IC0xKSB7XG4gICAgICBsb2NhdGlvbiA9IGluZGV4ICsgcGF0dGVybkxlbjtcbiAgICAgIGluZGljZXMucHVzaChbaW5kZXgsIGxvY2F0aW9uIC0gMV0pO1xuICAgIH1cblxuICAgIGNvbnN0IGlzTWF0Y2ggPSAhIWluZGljZXMubGVuZ3RoO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTWF0Y2gsXG4gICAgICBzY29yZTogaXNNYXRjaCA/IDAgOiAxLFxuICAgICAgaW5kaWNlc1xuICAgIH1cbiAgfVxufVxuXG4vLyBcdTI3NTdPcmRlciBpcyBpbXBvcnRhbnQuIERPIE5PVCBDSEFOR0UuXG5jb25zdCBzZWFyY2hlcnMgPSBbXG4gIEV4YWN0TWF0Y2gsXG4gIEluY2x1ZGVNYXRjaCxcbiAgUHJlZml4RXhhY3RNYXRjaCxcbiAgSW52ZXJzZVByZWZpeEV4YWN0TWF0Y2gsXG4gIEludmVyc2VTdWZmaXhFeGFjdE1hdGNoLFxuICBTdWZmaXhFeGFjdE1hdGNoLFxuICBJbnZlcnNlRXhhY3RNYXRjaCxcbiAgRnV6enlNYXRjaFxuXTtcblxuY29uc3Qgc2VhcmNoZXJzTGVuID0gc2VhcmNoZXJzLmxlbmd0aDtcblxuLy8gUmVnZXggdG8gc3BsaXQgYnkgc3BhY2VzLCBidXQga2VlcCBhbnl0aGluZyBpbiBxdW90ZXMgdG9nZXRoZXJcbmNvbnN0IFNQQUNFX1JFID0gLyArKD89KD86W15cXFwiXSpcXFwiW15cXFwiXSpcXFwiKSpbXlxcXCJdKiQpLztcbmNvbnN0IE9SX1RPS0VOID0gJ3wnO1xuXG4vLyBSZXR1cm4gYSAyRCBhcnJheSByZXByZXNlbnRhdGlvbiBvZiB0aGUgcXVlcnksIGZvciBzaW1wbGVyIHBhcnNpbmcuXG4vLyBFeGFtcGxlOlxuLy8gXCJeY29yZSBnbyQgfCByYiQgfCBweSQgeHkkXCIgPT4gW1tcIl5jb3JlXCIsIFwiZ28kXCJdLCBbXCJyYiRcIl0sIFtcInB5JFwiLCBcInh5JFwiXV1cbmZ1bmN0aW9uIHBhcnNlUXVlcnkocGF0dGVybiwgb3B0aW9ucyA9IHt9KSB7XG4gIHJldHVybiBwYXR0ZXJuLnNwbGl0KE9SX1RPS0VOKS5tYXAoKGl0ZW0pID0+IHtcbiAgICBsZXQgcXVlcnkgPSBpdGVtXG4gICAgICAudHJpbSgpXG4gICAgICAuc3BsaXQoU1BBQ0VfUkUpXG4gICAgICAuZmlsdGVyKChpdGVtKSA9PiBpdGVtICYmICEhaXRlbS50cmltKCkpO1xuXG4gICAgbGV0IHJlc3VsdHMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gcXVlcnkubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgIGNvbnN0IHF1ZXJ5SXRlbSA9IHF1ZXJ5W2ldO1xuXG4gICAgICAvLyAxLiBIYW5kbGUgbXVsdGlwbGUgcXVlcnkgbWF0Y2ggKGkuZSwgb25jZSB0aGF0IGFyZSBxdW90ZWQsIGxpa2UgYFwiaGVsbG8gd29ybGRcImApXG4gICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgIGxldCBpZHggPSAtMTtcbiAgICAgIHdoaWxlICghZm91bmQgJiYgKytpZHggPCBzZWFyY2hlcnNMZW4pIHtcbiAgICAgICAgY29uc3Qgc2VhcmNoZXIgPSBzZWFyY2hlcnNbaWR4XTtcbiAgICAgICAgbGV0IHRva2VuID0gc2VhcmNoZXIuaXNNdWx0aU1hdGNoKHF1ZXJ5SXRlbSk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgIHJlc3VsdHMucHVzaChuZXcgc2VhcmNoZXIodG9rZW4sIG9wdGlvbnMpKTtcbiAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIuIEhhbmRsZSBzaW5nbGUgcXVlcnkgbWF0Y2hlcyAoaS5lLCBvbmNlIHRoYXQgYXJlICpub3QqIHF1b3RlZClcbiAgICAgIGlkeCA9IC0xO1xuICAgICAgd2hpbGUgKCsraWR4IDwgc2VhcmNoZXJzTGVuKSB7XG4gICAgICAgIGNvbnN0IHNlYXJjaGVyID0gc2VhcmNoZXJzW2lkeF07XG4gICAgICAgIGxldCB0b2tlbiA9IHNlYXJjaGVyLmlzU2luZ2xlTWF0Y2gocXVlcnlJdGVtKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKG5ldyBzZWFyY2hlcih0b2tlbiwgb3B0aW9ucykpO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0c1xuICB9KVxufVxuXG4vLyBUaGVzZSBleHRlbmRlZCBtYXRjaGVycyBjYW4gcmV0dXJuIGFuIGFycmF5IG9mIG1hdGNoZXMsIGFzIG9wcG9zZWRcbi8vIHRvIGEgc2luZ2wgbWF0Y2hcbmNvbnN0IE11bHRpTWF0Y2hTZXQgPSBuZXcgU2V0KFtGdXp6eU1hdGNoLnR5cGUsIEluY2x1ZGVNYXRjaC50eXBlXSk7XG5cbi8qKlxuICogQ29tbWFuZC1saWtlIHNlYXJjaGluZ1xuICogPT09PT09PT09PT09PT09PT09PT09PVxuICpcbiAqIEdpdmVuIG11bHRpcGxlIHNlYXJjaCB0ZXJtcyBkZWxpbWl0ZWQgYnkgc3BhY2VzLmUuZy4gYF5qc2NyaXB0IC5weXRob24kIHJ1YnkgIWphdmFgLFxuICogc2VhcmNoIGluIGEgZ2l2ZW4gdGV4dC5cbiAqXG4gKiBTZWFyY2ggc3ludGF4OlxuICpcbiAqIHwgVG9rZW4gICAgICAgfCBNYXRjaCB0eXBlICAgICAgICAgICAgICAgICB8IERlc2NyaXB0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgLS0tLS0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSB8IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHxcbiAqIHwgYGpzY3JpcHRgICAgfCBmdXp6eS1tYXRjaCAgICAgICAgICAgICAgICB8IEl0ZW1zIHRoYXQgZnV6enkgbWF0Y2ggYGpzY3JpcHRgICAgICAgIHxcbiAqIHwgYD1zY2hlbWVgICAgfCBleGFjdC1tYXRjaCAgICAgICAgICAgICAgICB8IEl0ZW1zIHRoYXQgYXJlIGBzY2hlbWVgICAgICAgICAgICAgICAgIHxcbiAqIHwgYCdweXRob25gICAgfCBpbmNsdWRlLW1hdGNoICAgICAgICAgICAgICB8IEl0ZW1zIHRoYXQgaW5jbHVkZSBgcHl0aG9uYCAgICAgICAgICAgIHxcbiAqIHwgYCFydWJ5YCAgICAgfCBpbnZlcnNlLWV4YWN0LW1hdGNoICAgICAgICB8IEl0ZW1zIHRoYXQgZG8gbm90IGluY2x1ZGUgYHJ1YnlgICAgICAgIHxcbiAqIHwgYF5qYXZhYCAgICAgfCBwcmVmaXgtZXhhY3QtbWF0Y2ggICAgICAgICB8IEl0ZW1zIHRoYXQgc3RhcnQgd2l0aCBgamF2YWAgICAgICAgICAgIHxcbiAqIHwgYCFeZWFybGFuZ2AgfCBpbnZlcnNlLXByZWZpeC1leGFjdC1tYXRjaCB8IEl0ZW1zIHRoYXQgZG8gbm90IHN0YXJ0IHdpdGggYGVhcmxhbmdgIHxcbiAqIHwgYC5qcyRgICAgICAgfCBzdWZmaXgtZXhhY3QtbWF0Y2ggICAgICAgICB8IEl0ZW1zIHRoYXQgZW5kIHdpdGggYC5qc2AgICAgICAgICAgICAgIHxcbiAqIHwgYCEuZ28kYCAgICAgfCBpbnZlcnNlLXN1ZmZpeC1leGFjdC1tYXRjaCB8IEl0ZW1zIHRoYXQgZG8gbm90IGVuZCB3aXRoIGAuZ29gICAgICAgIHxcbiAqXG4gKiBBIHNpbmdsZSBwaXBlIGNoYXJhY3RlciBhY3RzIGFzIGFuIE9SIG9wZXJhdG9yLiBGb3IgZXhhbXBsZSwgdGhlIGZvbGxvd2luZ1xuICogcXVlcnkgbWF0Y2hlcyBlbnRyaWVzIHRoYXQgc3RhcnQgd2l0aCBgY29yZWAgYW5kIGVuZCB3aXRoIGVpdGhlcmBnb2AsIGByYmAsXG4gKiBvcmBweWAuXG4gKlxuICogYGBgXG4gKiBeY29yZSBnbyQgfCByYiQgfCBweSRcbiAqIGBgYFxuICovXG5jbGFzcyBFeHRlbmRlZFNlYXJjaCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhdHRlcm4sXG4gICAge1xuICAgICAgaXNDYXNlU2Vuc2l0aXZlID0gQ29uZmlnLmlzQ2FzZVNlbnNpdGl2ZSxcbiAgICAgIGluY2x1ZGVNYXRjaGVzID0gQ29uZmlnLmluY2x1ZGVNYXRjaGVzLFxuICAgICAgbWluTWF0Y2hDaGFyTGVuZ3RoID0gQ29uZmlnLm1pbk1hdGNoQ2hhckxlbmd0aCxcbiAgICAgIGlnbm9yZUxvY2F0aW9uID0gQ29uZmlnLmlnbm9yZUxvY2F0aW9uLFxuICAgICAgZmluZEFsbE1hdGNoZXMgPSBDb25maWcuZmluZEFsbE1hdGNoZXMsXG4gICAgICBsb2NhdGlvbiA9IENvbmZpZy5sb2NhdGlvbixcbiAgICAgIHRocmVzaG9sZCA9IENvbmZpZy50aHJlc2hvbGQsXG4gICAgICBkaXN0YW5jZSA9IENvbmZpZy5kaXN0YW5jZVxuICAgIH0gPSB7fVxuICApIHtcbiAgICB0aGlzLnF1ZXJ5ID0gbnVsbDtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBpc0Nhc2VTZW5zaXRpdmUsXG4gICAgICBpbmNsdWRlTWF0Y2hlcyxcbiAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aCxcbiAgICAgIGZpbmRBbGxNYXRjaGVzLFxuICAgICAgaWdub3JlTG9jYXRpb24sXG4gICAgICBsb2NhdGlvbixcbiAgICAgIHRocmVzaG9sZCxcbiAgICAgIGRpc3RhbmNlXG4gICAgfTtcblxuICAgIHRoaXMucGF0dGVybiA9IGlzQ2FzZVNlbnNpdGl2ZSA/IHBhdHRlcm4gOiBwYXR0ZXJuLnRvTG93ZXJDYXNlKCk7XG4gICAgdGhpcy5xdWVyeSA9IHBhcnNlUXVlcnkodGhpcy5wYXR0ZXJuLCB0aGlzLm9wdGlvbnMpO1xuICB9XG5cbiAgc3RhdGljIGNvbmRpdGlvbihfLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIG9wdGlvbnMudXNlRXh0ZW5kZWRTZWFyY2hcbiAgfVxuXG4gIHNlYXJjaEluKHRleHQpIHtcbiAgICBjb25zdCBxdWVyeSA9IHRoaXMucXVlcnk7XG5cbiAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc01hdGNoOiBmYWxzZSxcbiAgICAgICAgc2NvcmU6IDFcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB7IGluY2x1ZGVNYXRjaGVzLCBpc0Nhc2VTZW5zaXRpdmUgfSA9IHRoaXMub3B0aW9ucztcblxuICAgIHRleHQgPSBpc0Nhc2VTZW5zaXRpdmUgPyB0ZXh0IDogdGV4dC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgbGV0IG51bU1hdGNoZXMgPSAwO1xuICAgIGxldCBhbGxJbmRpY2VzID0gW107XG4gICAgbGV0IHRvdGFsU2NvcmUgPSAwO1xuXG4gICAgLy8gT1JzXG4gICAgZm9yIChsZXQgaSA9IDAsIHFMZW4gPSBxdWVyeS5sZW5ndGg7IGkgPCBxTGVuOyBpICs9IDEpIHtcbiAgICAgIGNvbnN0IHNlYXJjaGVycyA9IHF1ZXJ5W2ldO1xuXG4gICAgICAvLyBSZXNldCBpbmRpY2VzXG4gICAgICBhbGxJbmRpY2VzLmxlbmd0aCA9IDA7XG4gICAgICBudW1NYXRjaGVzID0gMDtcblxuICAgICAgLy8gQU5Ec1xuICAgICAgZm9yIChsZXQgaiA9IDAsIHBMZW4gPSBzZWFyY2hlcnMubGVuZ3RoOyBqIDwgcExlbjsgaiArPSAxKSB7XG4gICAgICAgIGNvbnN0IHNlYXJjaGVyID0gc2VhcmNoZXJzW2pdO1xuICAgICAgICBjb25zdCB7IGlzTWF0Y2gsIGluZGljZXMsIHNjb3JlIH0gPSBzZWFyY2hlci5zZWFyY2godGV4dCk7XG5cbiAgICAgICAgaWYgKGlzTWF0Y2gpIHtcbiAgICAgICAgICBudW1NYXRjaGVzICs9IDE7XG4gICAgICAgICAgdG90YWxTY29yZSArPSBzY29yZTtcbiAgICAgICAgICBpZiAoaW5jbHVkZU1hdGNoZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBzZWFyY2hlci5jb25zdHJ1Y3Rvci50eXBlO1xuICAgICAgICAgICAgaWYgKE11bHRpTWF0Y2hTZXQuaGFzKHR5cGUpKSB7XG4gICAgICAgICAgICAgIGFsbEluZGljZXMgPSBbLi4uYWxsSW5kaWNlcywgLi4uaW5kaWNlc107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhbGxJbmRpY2VzLnB1c2goaW5kaWNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRvdGFsU2NvcmUgPSAwO1xuICAgICAgICAgIG51bU1hdGNoZXMgPSAwO1xuICAgICAgICAgIGFsbEluZGljZXMubGVuZ3RoID0gMDtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE9SIGNvbmRpdGlvbiwgc28gaWYgVFJVRSwgcmV0dXJuXG4gICAgICBpZiAobnVtTWF0Y2hlcykge1xuICAgICAgICBsZXQgcmVzdWx0ID0ge1xuICAgICAgICAgIGlzTWF0Y2g6IHRydWUsXG4gICAgICAgICAgc2NvcmU6IHRvdGFsU2NvcmUgLyBudW1NYXRjaGVzXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGluY2x1ZGVNYXRjaGVzKSB7XG4gICAgICAgICAgcmVzdWx0LmluZGljZXMgPSBhbGxJbmRpY2VzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vdGhpbmcgd2FzIG1hdGNoZWRcbiAgICByZXR1cm4ge1xuICAgICAgaXNNYXRjaDogZmFsc2UsXG4gICAgICBzY29yZTogMVxuICAgIH1cbiAgfVxufVxuXG5jb25zdCByZWdpc3RlcmVkU2VhcmNoZXJzID0gW107XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyKC4uLmFyZ3MpIHtcbiAgcmVnaXN0ZXJlZFNlYXJjaGVycy5wdXNoKC4uLmFyZ3MpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTZWFyY2hlcihwYXR0ZXJuLCBvcHRpb25zKSB7XG4gIGZvciAobGV0IGkgPSAwLCBsZW4gPSByZWdpc3RlcmVkU2VhcmNoZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgbGV0IHNlYXJjaGVyQ2xhc3MgPSByZWdpc3RlcmVkU2VhcmNoZXJzW2ldO1xuICAgIGlmIChzZWFyY2hlckNsYXNzLmNvbmRpdGlvbihwYXR0ZXJuLCBvcHRpb25zKSkge1xuICAgICAgcmV0dXJuIG5ldyBzZWFyY2hlckNsYXNzKHBhdHRlcm4sIG9wdGlvbnMpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBCaXRhcFNlYXJjaChwYXR0ZXJuLCBvcHRpb25zKVxufVxuXG5jb25zdCBMb2dpY2FsT3BlcmF0b3IgPSB7XG4gIEFORDogJyRhbmQnLFxuICBPUjogJyRvcidcbn07XG5cbmNvbnN0IEtleVR5cGUgPSB7XG4gIFBBVEg6ICckcGF0aCcsXG4gIFBBVFRFUk46ICckdmFsJ1xufTtcblxuY29uc3QgaXNFeHByZXNzaW9uID0gKHF1ZXJ5KSA9PlxuICAhIShxdWVyeVtMb2dpY2FsT3BlcmF0b3IuQU5EXSB8fCBxdWVyeVtMb2dpY2FsT3BlcmF0b3IuT1JdKTtcblxuY29uc3QgaXNQYXRoID0gKHF1ZXJ5KSA9PiAhIXF1ZXJ5W0tleVR5cGUuUEFUSF07XG5cbmNvbnN0IGlzTGVhZiA9IChxdWVyeSkgPT5cbiAgIWlzQXJyYXkocXVlcnkpICYmIGlzT2JqZWN0KHF1ZXJ5KSAmJiAhaXNFeHByZXNzaW9uKHF1ZXJ5KTtcblxuY29uc3QgY29udmVydFRvRXhwbGljaXQgPSAocXVlcnkpID0+ICh7XG4gIFtMb2dpY2FsT3BlcmF0b3IuQU5EXTogT2JqZWN0LmtleXMocXVlcnkpLm1hcCgoa2V5KSA9PiAoe1xuICAgIFtrZXldOiBxdWVyeVtrZXldXG4gIH0pKVxufSk7XG5cbi8vIFdoZW4gYGF1dG9gIGlzIGB0cnVlYCwgdGhlIHBhcnNlIGZ1bmN0aW9uIHdpbGwgaW5mZXIgYW5kIGluaXRpYWxpemUgYW5kIGFkZFxuLy8gdGhlIGFwcHJvcHJpYXRlIGBTZWFyY2hlcmAgaW5zdGFuY2VcbmZ1bmN0aW9uIHBhcnNlKHF1ZXJ5LCBvcHRpb25zLCB7IGF1dG8gPSB0cnVlIH0gPSB7fSkge1xuICBjb25zdCBuZXh0ID0gKHF1ZXJ5KSA9PiB7XG4gICAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyhxdWVyeSk7XG5cbiAgICBjb25zdCBpc1F1ZXJ5UGF0aCA9IGlzUGF0aChxdWVyeSk7XG5cbiAgICBpZiAoIWlzUXVlcnlQYXRoICYmIGtleXMubGVuZ3RoID4gMSAmJiAhaXNFeHByZXNzaW9uKHF1ZXJ5KSkge1xuICAgICAgcmV0dXJuIG5leHQoY29udmVydFRvRXhwbGljaXQocXVlcnkpKVxuICAgIH1cblxuICAgIGlmIChpc0xlYWYocXVlcnkpKSB7XG4gICAgICBjb25zdCBrZXkgPSBpc1F1ZXJ5UGF0aCA/IHF1ZXJ5W0tleVR5cGUuUEFUSF0gOiBrZXlzWzBdO1xuXG4gICAgICBjb25zdCBwYXR0ZXJuID0gaXNRdWVyeVBhdGggPyBxdWVyeVtLZXlUeXBlLlBBVFRFUk5dIDogcXVlcnlba2V5XTtcblxuICAgICAgaWYgKCFpc1N0cmluZyhwYXR0ZXJuKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTE9HSUNBTF9TRUFSQ0hfSU5WQUxJRF9RVUVSWV9GT1JfS0VZKGtleSkpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG9iaiA9IHtcbiAgICAgICAga2V5SWQ6IGNyZWF0ZUtleUlkKGtleSksXG4gICAgICAgIHBhdHRlcm5cbiAgICAgIH07XG5cbiAgICAgIGlmIChhdXRvKSB7XG4gICAgICAgIG9iai5zZWFyY2hlciA9IGNyZWF0ZVNlYXJjaGVyKHBhdHRlcm4sIG9wdGlvbnMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb2JqXG4gICAgfVxuXG4gICAgbGV0IG5vZGUgPSB7XG4gICAgICBjaGlsZHJlbjogW10sXG4gICAgICBvcGVyYXRvcjoga2V5c1swXVxuICAgIH07XG5cbiAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBxdWVyeVtrZXldO1xuXG4gICAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgdmFsdWUuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgIG5vZGUuY2hpbGRyZW4ucHVzaChuZXh0KGl0ZW0pKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZVxuICB9O1xuXG4gIGlmICghaXNFeHByZXNzaW9uKHF1ZXJ5KSkge1xuICAgIHF1ZXJ5ID0gY29udmVydFRvRXhwbGljaXQocXVlcnkpO1xuICB9XG5cbiAgcmV0dXJuIG5leHQocXVlcnkpXG59XG5cbi8vIFByYWN0aWNhbCBzY29yaW5nIGZ1bmN0aW9uXG5mdW5jdGlvbiBjb21wdXRlU2NvcmUoXG4gIHJlc3VsdHMsXG4gIHsgaWdub3JlRmllbGROb3JtID0gQ29uZmlnLmlnbm9yZUZpZWxkTm9ybSB9XG4pIHtcbiAgcmVzdWx0cy5mb3JFYWNoKChyZXN1bHQpID0+IHtcbiAgICBsZXQgdG90YWxTY29yZSA9IDE7XG5cbiAgICByZXN1bHQubWF0Y2hlcy5mb3JFYWNoKCh7IGtleSwgbm9ybSwgc2NvcmUgfSkgPT4ge1xuICAgICAgY29uc3Qgd2VpZ2h0ID0ga2V5ID8ga2V5LndlaWdodCA6IG51bGw7XG5cbiAgICAgIHRvdGFsU2NvcmUgKj0gTWF0aC5wb3coXG4gICAgICAgIHNjb3JlID09PSAwICYmIHdlaWdodCA/IE51bWJlci5FUFNJTE9OIDogc2NvcmUsXG4gICAgICAgICh3ZWlnaHQgfHwgMSkgKiAoaWdub3JlRmllbGROb3JtID8gMSA6IG5vcm0pXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgcmVzdWx0LnNjb3JlID0gdG90YWxTY29yZTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybU1hdGNoZXMocmVzdWx0LCBkYXRhKSB7XG4gIGNvbnN0IG1hdGNoZXMgPSByZXN1bHQubWF0Y2hlcztcbiAgZGF0YS5tYXRjaGVzID0gW107XG5cbiAgaWYgKCFpc0RlZmluZWQobWF0Y2hlcykpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIG1hdGNoZXMuZm9yRWFjaCgobWF0Y2gpID0+IHtcbiAgICBpZiAoIWlzRGVmaW5lZChtYXRjaC5pbmRpY2VzKSB8fCAhbWF0Y2guaW5kaWNlcy5sZW5ndGgpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHsgaW5kaWNlcywgdmFsdWUgfSA9IG1hdGNoO1xuXG4gICAgbGV0IG9iaiA9IHtcbiAgICAgIGluZGljZXMsXG4gICAgICB2YWx1ZVxuICAgIH07XG5cbiAgICBpZiAobWF0Y2gua2V5KSB7XG4gICAgICBvYmoua2V5ID0gbWF0Y2gua2V5LnNyYztcbiAgICB9XG5cbiAgICBpZiAobWF0Y2guaWR4ID4gLTEpIHtcbiAgICAgIG9iai5yZWZJbmRleCA9IG1hdGNoLmlkeDtcbiAgICB9XG5cbiAgICBkYXRhLm1hdGNoZXMucHVzaChvYmopO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gdHJhbnNmb3JtU2NvcmUocmVzdWx0LCBkYXRhKSB7XG4gIGRhdGEuc2NvcmUgPSByZXN1bHQuc2NvcmU7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdChcbiAgcmVzdWx0cyxcbiAgZG9jcyxcbiAge1xuICAgIGluY2x1ZGVNYXRjaGVzID0gQ29uZmlnLmluY2x1ZGVNYXRjaGVzLFxuICAgIGluY2x1ZGVTY29yZSA9IENvbmZpZy5pbmNsdWRlU2NvcmVcbiAgfSA9IHt9XG4pIHtcbiAgY29uc3QgdHJhbnNmb3JtZXJzID0gW107XG5cbiAgaWYgKGluY2x1ZGVNYXRjaGVzKSB0cmFuc2Zvcm1lcnMucHVzaCh0cmFuc2Zvcm1NYXRjaGVzKTtcbiAgaWYgKGluY2x1ZGVTY29yZSkgdHJhbnNmb3JtZXJzLnB1c2godHJhbnNmb3JtU2NvcmUpO1xuXG4gIHJldHVybiByZXN1bHRzLm1hcCgocmVzdWx0KSA9PiB7XG4gICAgY29uc3QgeyBpZHggfSA9IHJlc3VsdDtcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBpdGVtOiBkb2NzW2lkeF0sXG4gICAgICByZWZJbmRleDogaWR4XG4gICAgfTtcblxuICAgIGlmICh0cmFuc2Zvcm1lcnMubGVuZ3RoKSB7XG4gICAgICB0cmFuc2Zvcm1lcnMuZm9yRWFjaCgodHJhbnNmb3JtZXIpID0+IHtcbiAgICAgICAgdHJhbnNmb3JtZXIocmVzdWx0LCBkYXRhKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhXG4gIH0pXG59XG5cbmNsYXNzIEZ1c2Uge1xuICBjb25zdHJ1Y3Rvcihkb2NzLCBvcHRpb25zID0ge30sIGluZGV4KSB7XG4gICAgdGhpcy5vcHRpb25zID0geyAuLi5Db25maWcsIC4uLm9wdGlvbnMgfTtcblxuICAgIGlmIChcbiAgICAgIHRoaXMub3B0aW9ucy51c2VFeHRlbmRlZFNlYXJjaCAmJlxuICAgICAgIXRydWVcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihFWFRFTkRFRF9TRUFSQ0hfVU5BVkFJTEFCTEUpXG4gICAgfVxuXG4gICAgdGhpcy5fa2V5U3RvcmUgPSBuZXcgS2V5U3RvcmUodGhpcy5vcHRpb25zLmtleXMpO1xuXG4gICAgdGhpcy5zZXRDb2xsZWN0aW9uKGRvY3MsIGluZGV4KTtcbiAgfVxuXG4gIHNldENvbGxlY3Rpb24oZG9jcywgaW5kZXgpIHtcbiAgICB0aGlzLl9kb2NzID0gZG9jcztcblxuICAgIGlmIChpbmRleCAmJiAhKGluZGV4IGluc3RhbmNlb2YgRnVzZUluZGV4KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKElOQ09SUkVDVF9JTkRFWF9UWVBFKVxuICAgIH1cblxuICAgIHRoaXMuX215SW5kZXggPVxuICAgICAgaW5kZXggfHxcbiAgICAgIGNyZWF0ZUluZGV4KHRoaXMub3B0aW9ucy5rZXlzLCB0aGlzLl9kb2NzLCB7XG4gICAgICAgIGdldEZuOiB0aGlzLm9wdGlvbnMuZ2V0Rm4sXG4gICAgICAgIGZpZWxkTm9ybVdlaWdodDogdGhpcy5vcHRpb25zLmZpZWxkTm9ybVdlaWdodFxuICAgICAgfSk7XG4gIH1cblxuICBhZGQoZG9jKSB7XG4gICAgaWYgKCFpc0RlZmluZWQoZG9jKSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5fZG9jcy5wdXNoKGRvYyk7XG4gICAgdGhpcy5fbXlJbmRleC5hZGQoZG9jKTtcbiAgfVxuXG4gIHJlbW92ZShwcmVkaWNhdGUgPSAoLyogZG9jLCBpZHggKi8pID0+IGZhbHNlKSB7XG4gICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHRoaXMuX2RvY3MubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgIGNvbnN0IGRvYyA9IHRoaXMuX2RvY3NbaV07XG4gICAgICBpZiAocHJlZGljYXRlKGRvYywgaSkpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVBdChpKTtcbiAgICAgICAgaSAtPSAxO1xuICAgICAgICBsZW4gLT0gMTtcblxuICAgICAgICByZXN1bHRzLnB1c2goZG9jKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0c1xuICB9XG5cbiAgcmVtb3ZlQXQoaWR4KSB7XG4gICAgdGhpcy5fZG9jcy5zcGxpY2UoaWR4LCAxKTtcbiAgICB0aGlzLl9teUluZGV4LnJlbW92ZUF0KGlkeCk7XG4gIH1cblxuICBnZXRJbmRleCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbXlJbmRleFxuICB9XG5cbiAgc2VhcmNoKHF1ZXJ5LCB7IGxpbWl0ID0gLTEgfSA9IHt9KSB7XG4gICAgY29uc3Qge1xuICAgICAgaW5jbHVkZU1hdGNoZXMsXG4gICAgICBpbmNsdWRlU2NvcmUsXG4gICAgICBzaG91bGRTb3J0LFxuICAgICAgc29ydEZuLFxuICAgICAgaWdub3JlRmllbGROb3JtXG4gICAgfSA9IHRoaXMub3B0aW9ucztcblxuICAgIGxldCByZXN1bHRzID0gaXNTdHJpbmcocXVlcnkpXG4gICAgICA/IGlzU3RyaW5nKHRoaXMuX2RvY3NbMF0pXG4gICAgICAgID8gdGhpcy5fc2VhcmNoU3RyaW5nTGlzdChxdWVyeSlcbiAgICAgICAgOiB0aGlzLl9zZWFyY2hPYmplY3RMaXN0KHF1ZXJ5KVxuICAgICAgOiB0aGlzLl9zZWFyY2hMb2dpY2FsKHF1ZXJ5KTtcblxuICAgIGNvbXB1dGVTY29yZShyZXN1bHRzLCB7IGlnbm9yZUZpZWxkTm9ybSB9KTtcblxuICAgIGlmIChzaG91bGRTb3J0KSB7XG4gICAgICByZXN1bHRzLnNvcnQoc29ydEZuKTtcbiAgICB9XG5cbiAgICBpZiAoaXNOdW1iZXIobGltaXQpICYmIGxpbWl0ID4gLTEpIHtcbiAgICAgIHJlc3VsdHMgPSByZXN1bHRzLnNsaWNlKDAsIGxpbWl0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9ybWF0KHJlc3VsdHMsIHRoaXMuX2RvY3MsIHtcbiAgICAgIGluY2x1ZGVNYXRjaGVzLFxuICAgICAgaW5jbHVkZVNjb3JlXG4gICAgfSlcbiAgfVxuXG4gIF9zZWFyY2hTdHJpbmdMaXN0KHF1ZXJ5KSB7XG4gICAgY29uc3Qgc2VhcmNoZXIgPSBjcmVhdGVTZWFyY2hlcihxdWVyeSwgdGhpcy5vcHRpb25zKTtcbiAgICBjb25zdCB7IHJlY29yZHMgfSA9IHRoaXMuX215SW5kZXg7XG4gICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuXG4gICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IHN0cmluZyBpbiB0aGUgaW5kZXhcbiAgICByZWNvcmRzLmZvckVhY2goKHsgdjogdGV4dCwgaTogaWR4LCBuOiBub3JtIH0pID0+IHtcbiAgICAgIGlmICghaXNEZWZpbmVkKHRleHQpKSB7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGlzTWF0Y2gsIHNjb3JlLCBpbmRpY2VzIH0gPSBzZWFyY2hlci5zZWFyY2hJbih0ZXh0KTtcblxuICAgICAgaWYgKGlzTWF0Y2gpIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgICBpdGVtOiB0ZXh0LFxuICAgICAgICAgIGlkeCxcbiAgICAgICAgICBtYXRjaGVzOiBbeyBzY29yZSwgdmFsdWU6IHRleHQsIG5vcm0sIGluZGljZXMgfV1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0c1xuICB9XG5cbiAgX3NlYXJjaExvZ2ljYWwocXVlcnkpIHtcblxuICAgIGNvbnN0IGV4cHJlc3Npb24gPSBwYXJzZShxdWVyeSwgdGhpcy5vcHRpb25zKTtcblxuICAgIGNvbnN0IGV2YWx1YXRlID0gKG5vZGUsIGl0ZW0sIGlkeCkgPT4ge1xuICAgICAgaWYgKCFub2RlLmNoaWxkcmVuKSB7XG4gICAgICAgIGNvbnN0IHsga2V5SWQsIHNlYXJjaGVyIH0gPSBub2RlO1xuXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSB0aGlzLl9maW5kTWF0Y2hlcyh7XG4gICAgICAgICAga2V5OiB0aGlzLl9rZXlTdG9yZS5nZXQoa2V5SWQpLFxuICAgICAgICAgIHZhbHVlOiB0aGlzLl9teUluZGV4LmdldFZhbHVlRm9ySXRlbUF0S2V5SWQoaXRlbSwga2V5SWQpLFxuICAgICAgICAgIHNlYXJjaGVyXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWR4LFxuICAgICAgICAgICAgICBpdGVtLFxuICAgICAgICAgICAgICBtYXRjaGVzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlcyA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IG5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3QgY2hpbGQgPSBub2RlLmNoaWxkcmVuW2ldO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBldmFsdWF0ZShjaGlsZCwgaXRlbSwgaWR4KTtcbiAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGgpIHtcbiAgICAgICAgICByZXMucHVzaCguLi5yZXN1bHQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5vZGUub3BlcmF0b3IgPT09IExvZ2ljYWxPcGVyYXRvci5BTkQpIHtcbiAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc1xuICAgIH07XG5cbiAgICBjb25zdCByZWNvcmRzID0gdGhpcy5fbXlJbmRleC5yZWNvcmRzO1xuICAgIGNvbnN0IHJlc3VsdE1hcCA9IHt9O1xuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcblxuICAgIHJlY29yZHMuZm9yRWFjaCgoeyAkOiBpdGVtLCBpOiBpZHggfSkgPT4ge1xuICAgICAgaWYgKGlzRGVmaW5lZChpdGVtKSkge1xuICAgICAgICBsZXQgZXhwUmVzdWx0cyA9IGV2YWx1YXRlKGV4cHJlc3Npb24sIGl0ZW0sIGlkeCk7XG5cbiAgICAgICAgaWYgKGV4cFJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgICAgLy8gRGVkdXBlIHdoZW4gYWRkaW5nXG4gICAgICAgICAgaWYgKCFyZXN1bHRNYXBbaWR4XSkge1xuICAgICAgICAgICAgcmVzdWx0TWFwW2lkeF0gPSB7IGlkeCwgaXRlbSwgbWF0Y2hlczogW10gfTtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHRNYXBbaWR4XSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV4cFJlc3VsdHMuZm9yRWFjaCgoeyBtYXRjaGVzIH0pID0+IHtcbiAgICAgICAgICAgIHJlc3VsdE1hcFtpZHhdLm1hdGNoZXMucHVzaCguLi5tYXRjaGVzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdHNcbiAgfVxuXG4gIF9zZWFyY2hPYmplY3RMaXN0KHF1ZXJ5KSB7XG4gICAgY29uc3Qgc2VhcmNoZXIgPSBjcmVhdGVTZWFyY2hlcihxdWVyeSwgdGhpcy5vcHRpb25zKTtcbiAgICBjb25zdCB7IGtleXMsIHJlY29yZHMgfSA9IHRoaXMuX215SW5kZXg7XG4gICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuXG4gICAgLy8gTGlzdCBpcyBBcnJheTxPYmplY3Q+XG4gICAgcmVjb3Jkcy5mb3JFYWNoKCh7ICQ6IGl0ZW0sIGk6IGlkeCB9KSA9PiB7XG4gICAgICBpZiAoIWlzRGVmaW5lZChpdGVtKSkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgbGV0IG1hdGNoZXMgPSBbXTtcblxuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGtleSAoaS5lLCBwYXRoKSwgYW5kIGZldGNoIHRoZSB2YWx1ZSBhdCB0aGF0IGtleVxuICAgICAga2V5cy5mb3JFYWNoKChrZXksIGtleUluZGV4KSA9PiB7XG4gICAgICAgIG1hdGNoZXMucHVzaChcbiAgICAgICAgICAuLi50aGlzLl9maW5kTWF0Y2hlcyh7XG4gICAgICAgICAgICBrZXksXG4gICAgICAgICAgICB2YWx1ZTogaXRlbVtrZXlJbmRleF0sXG4gICAgICAgICAgICBzZWFyY2hlclxuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgaWR4LFxuICAgICAgICAgIGl0ZW0sXG4gICAgICAgICAgbWF0Y2hlc1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHRzXG4gIH1cbiAgX2ZpbmRNYXRjaGVzKHsga2V5LCB2YWx1ZSwgc2VhcmNoZXIgfSkge1xuICAgIGlmICghaXNEZWZpbmVkKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuXG4gICAgbGV0IG1hdGNoZXMgPSBbXTtcblxuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgdmFsdWUuZm9yRWFjaCgoeyB2OiB0ZXh0LCBpOiBpZHgsIG46IG5vcm0gfSkgPT4ge1xuICAgICAgICBpZiAoIWlzRGVmaW5lZCh0ZXh0KSkge1xuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBpc01hdGNoLCBzY29yZSwgaW5kaWNlcyB9ID0gc2VhcmNoZXIuc2VhcmNoSW4odGV4dCk7XG5cbiAgICAgICAgaWYgKGlzTWF0Y2gpIHtcbiAgICAgICAgICBtYXRjaGVzLnB1c2goe1xuICAgICAgICAgICAgc2NvcmUsXG4gICAgICAgICAgICBrZXksXG4gICAgICAgICAgICB2YWx1ZTogdGV4dCxcbiAgICAgICAgICAgIGlkeCxcbiAgICAgICAgICAgIG5vcm0sXG4gICAgICAgICAgICBpbmRpY2VzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7IHY6IHRleHQsIG46IG5vcm0gfSA9IHZhbHVlO1xuXG4gICAgICBjb25zdCB7IGlzTWF0Y2gsIHNjb3JlLCBpbmRpY2VzIH0gPSBzZWFyY2hlci5zZWFyY2hJbih0ZXh0KTtcblxuICAgICAgaWYgKGlzTWF0Y2gpIHtcbiAgICAgICAgbWF0Y2hlcy5wdXNoKHsgc2NvcmUsIGtleSwgdmFsdWU6IHRleHQsIG5vcm0sIGluZGljZXMgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1hdGNoZXNcbiAgfVxufVxuXG5GdXNlLnZlcnNpb24gPSAnNi42LjInO1xuRnVzZS5jcmVhdGVJbmRleCA9IGNyZWF0ZUluZGV4O1xuRnVzZS5wYXJzZUluZGV4ID0gcGFyc2VJbmRleDtcbkZ1c2UuY29uZmlnID0gQ29uZmlnO1xuXG57XG4gIEZ1c2UucGFyc2VRdWVyeSA9IHBhcnNlO1xufVxuXG57XG4gIHJlZ2lzdGVyKEV4dGVuZGVkU2VhcmNoKTtcbn1cblxuZXhwb3J0IHsgRnVzZSBhcyBkZWZhdWx0IH07XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGFyb3VuZChvYmosIGZhY3Rvcmllcykge1xuICAgIGNvbnN0IHJlbW92ZXJzID0gT2JqZWN0LmtleXMoZmFjdG9yaWVzKS5tYXAoa2V5ID0+IGFyb3VuZDEob2JqLCBrZXksIGZhY3Rvcmllc1trZXldKSk7XG4gICAgcmV0dXJuIHJlbW92ZXJzLmxlbmd0aCA9PT0gMSA/IHJlbW92ZXJzWzBdIDogZnVuY3Rpb24gKCkgeyByZW1vdmVycy5mb3JFYWNoKHIgPT4gcigpKTsgfTtcbn1cbmZ1bmN0aW9uIGFyb3VuZDEob2JqLCBtZXRob2QsIGNyZWF0ZVdyYXBwZXIpIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9IG9ialttZXRob2RdLCBoYWRPd24gPSBvYmouaGFzT3duUHJvcGVydHkobWV0aG9kKTtcbiAgICBsZXQgY3VycmVudCA9IGNyZWF0ZVdyYXBwZXIob3JpZ2luYWwpO1xuICAgIC8vIExldCBvdXIgd3JhcHBlciBpbmhlcml0IHN0YXRpYyBwcm9wcyBmcm9tIHRoZSB3cmFwcGluZyBtZXRob2QsXG4gICAgLy8gYW5kIHRoZSB3cmFwcGluZyBtZXRob2QsIHByb3BzIGZyb20gdGhlIG9yaWdpbmFsIG1ldGhvZFxuICAgIGlmIChvcmlnaW5hbClcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGN1cnJlbnQsIG9yaWdpbmFsKTtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yod3JhcHBlciwgY3VycmVudCk7XG4gICAgb2JqW21ldGhvZF0gPSB3cmFwcGVyO1xuICAgIC8vIFJldHVybiBhIGNhbGxiYWNrIHRvIGFsbG93IHNhZmUgcmVtb3ZhbFxuICAgIHJldHVybiByZW1vdmU7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYmVlbiBkZWFjdGl2YXRlZCBhbmQgYXJlIG5vIGxvbmdlciB3cmFwcGVkLCByZW1vdmUgb3Vyc2VsdmVzXG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbCAmJiBvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcilcbiAgICAgICAgICAgIHJlbW92ZSgpO1xuICAgICAgICByZXR1cm4gY3VycmVudC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAvLyBJZiBubyBvdGhlciBwYXRjaGVzLCBqdXN0IGRvIGEgZGlyZWN0IHJlbW92YWxcbiAgICAgICAgaWYgKG9ialttZXRob2RdID09PSB3cmFwcGVyKSB7XG4gICAgICAgICAgICBpZiAoaGFkT3duKVxuICAgICAgICAgICAgICAgIG9ialttZXRob2RdID0gb3JpZ2luYWw7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIG9ialttZXRob2RdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gRWxzZSBwYXNzIGZ1dHVyZSBjYWxscyB0aHJvdWdoLCBhbmQgcmVtb3ZlIHdyYXBwZXIgZnJvbSB0aGUgcHJvdG90eXBlIGNoYWluXG4gICAgICAgIGN1cnJlbnQgPSBvcmlnaW5hbDtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIG9yaWdpbmFsIHx8IEZ1bmN0aW9uKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZGVkdXBlKGtleSwgb2xkRm4sIG5ld0ZuKSB7XG4gICAgY2hlY2tba2V5XSA9IGtleTtcbiAgICByZXR1cm4gY2hlY2s7XG4gICAgZnVuY3Rpb24gY2hlY2soLi4uYXJncykge1xuICAgICAgICByZXR1cm4gKG9sZEZuW2tleV0gPT09IGtleSA/IG9sZEZuIDogbmV3Rm4pLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhZnRlcihwcm9taXNlLCBjYikge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2IsIGNiKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemUoYXN5bmNGdW5jdGlvbikge1xuICAgIGxldCBsYXN0UnVuID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBhZnRlcihsYXN0UnVuLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXN5bmNGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmdzKS50aGVuKHJlcywgcmVqKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgd3JhcHBlci5hZnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGxhc3RSdW4gPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsgYWZ0ZXIobGFzdFJ1biwgcmVzKTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbn1cbiIsICIvKiohXG4gKiBTb3J0YWJsZSAxLjE1LjFcbiAqIEBhdXRob3JcdFJ1YmFYYSAgIDx0cmFzaEBydWJheGEub3JnPlxuICogQGF1dGhvclx0b3dlbm0gICAgPG93ZW4yMzM1NUBnbWFpbC5jb20+XG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTtcbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTtcbiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHtcbiAgICAgIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTtcbiAgfVxuICByZXR1cm4ga2V5cztcbn1cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKHRhcmdldCkge1xuICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9O1xuICAgIGlmIChpICUgMikge1xuICAgICAgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBfdHlwZW9mKG9iaikge1xuICBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cbiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7XG4gICAgX3R5cGVvZiA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHJldHVybiB0eXBlb2Ygb2JqO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgX3R5cGVvZiA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIF90eXBlb2Yob2JqKTtcbn1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgaWYgKGtleSBpbiBvYmopIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbmZ1bmN0aW9uIF9leHRlbmRzKCkge1xuICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcbiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7XG4gIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgdmFyIGtleSwgaTtcbiAgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHtcbiAgICBrZXkgPSBzb3VyY2VLZXlzW2ldO1xuICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKHNvdXJjZSwgZXhjbHVkZWQpIHtcbiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307XG4gIHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTtcbiAgdmFyIGtleSwgaTtcbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICB2YXIgc291cmNlU3ltYm9sS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc291cmNlKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc291cmNlU3ltYm9sS2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0gc291cmNlU3ltYm9sS2V5c1tpXTtcbiAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzb3VyY2UsIGtleSkpIGNvbnRpbnVlO1xuICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHtcbiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTtcbn1cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7XG59XG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHtcbiAgaWYgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlcltcIkBAaXRlcmF0b3JcIl0gIT0gbnVsbCkgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7XG59XG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7XG4gIGlmICghbykgcmV0dXJuO1xuICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xuICB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7XG4gIGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7XG4gIGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pO1xuICBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG59XG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikge1xuICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSBhcnIyW2ldID0gYXJyW2ldO1xuICByZXR1cm4gYXJyMjtcbn1cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5cbnZhciB2ZXJzaW9uID0gXCIxLjE1LjFcIjtcblxuZnVuY3Rpb24gdXNlckFnZW50KHBhdHRlcm4pIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5uYXZpZ2F0b3IpIHtcbiAgICByZXR1cm4gISEgLypAX19QVVJFX18qL25hdmlnYXRvci51c2VyQWdlbnQubWF0Y2gocGF0dGVybik7XG4gIH1cbn1cbnZhciBJRTExT3JMZXNzID0gdXNlckFnZW50KC8oPzpUcmlkZW50LipydlsgOl0/MTFcXC58bXNpZXxpZW1vYmlsZXxXaW5kb3dzIFBob25lKS9pKTtcbnZhciBFZGdlID0gdXNlckFnZW50KC9FZGdlL2kpO1xudmFyIEZpcmVGb3ggPSB1c2VyQWdlbnQoL2ZpcmVmb3gvaSk7XG52YXIgU2FmYXJpID0gdXNlckFnZW50KC9zYWZhcmkvaSkgJiYgIXVzZXJBZ2VudCgvY2hyb21lL2kpICYmICF1c2VyQWdlbnQoL2FuZHJvaWQvaSk7XG52YXIgSU9TID0gdXNlckFnZW50KC9pUChhZHxvZHxob25lKS9pKTtcbnZhciBDaHJvbWVGb3JBbmRyb2lkID0gdXNlckFnZW50KC9jaHJvbWUvaSkgJiYgdXNlckFnZW50KC9hbmRyb2lkL2kpO1xuXG52YXIgY2FwdHVyZU1vZGUgPSB7XG4gIGNhcHR1cmU6IGZhbHNlLFxuICBwYXNzaXZlOiBmYWxzZVxufTtcbmZ1bmN0aW9uIG9uKGVsLCBldmVudCwgZm4pIHtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgZm4sICFJRTExT3JMZXNzICYmIGNhcHR1cmVNb2RlKTtcbn1cbmZ1bmN0aW9uIG9mZihlbCwgZXZlbnQsIGZuKSB7XG4gIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGZuLCAhSUUxMU9yTGVzcyAmJiBjYXB0dXJlTW9kZSk7XG59XG5mdW5jdGlvbiBtYXRjaGVzKCAvKipIVE1MRWxlbWVudCovZWwsIC8qKlN0cmluZyovc2VsZWN0b3IpIHtcbiAgaWYgKCFzZWxlY3RvcikgcmV0dXJuO1xuICBzZWxlY3RvclswXSA9PT0gJz4nICYmIChzZWxlY3RvciA9IHNlbGVjdG9yLnN1YnN0cmluZygxKSk7XG4gIGlmIChlbCkge1xuICAgIHRyeSB7XG4gICAgICBpZiAoZWwubWF0Y2hlcykge1xuICAgICAgICByZXR1cm4gZWwubWF0Y2hlcyhzZWxlY3Rvcik7XG4gICAgICB9IGVsc2UgaWYgKGVsLm1zTWF0Y2hlc1NlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiBlbC5tc01hdGNoZXNTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICB9IGVsc2UgaWYgKGVsLndlYmtpdE1hdGNoZXNTZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gZWwud2Via2l0TWF0Y2hlc1NlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChfKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGdldFBhcmVudE9ySG9zdChlbCkge1xuICByZXR1cm4gZWwuaG9zdCAmJiBlbCAhPT0gZG9jdW1lbnQgJiYgZWwuaG9zdC5ub2RlVHlwZSA/IGVsLmhvc3QgOiBlbC5wYXJlbnROb2RlO1xufVxuZnVuY3Rpb24gY2xvc2VzdCggLyoqSFRNTEVsZW1lbnQqL2VsLCAvKipTdHJpbmcqL3NlbGVjdG9yLCAvKipIVE1MRWxlbWVudCovY3R4LCBpbmNsdWRlQ1RYKSB7XG4gIGlmIChlbCkge1xuICAgIGN0eCA9IGN0eCB8fCBkb2N1bWVudDtcbiAgICBkbyB7XG4gICAgICBpZiAoc2VsZWN0b3IgIT0gbnVsbCAmJiAoc2VsZWN0b3JbMF0gPT09ICc+JyA/IGVsLnBhcmVudE5vZGUgPT09IGN0eCAmJiBtYXRjaGVzKGVsLCBzZWxlY3RvcikgOiBtYXRjaGVzKGVsLCBzZWxlY3RvcikpIHx8IGluY2x1ZGVDVFggJiYgZWwgPT09IGN0eCkge1xuICAgICAgICByZXR1cm4gZWw7XG4gICAgICB9XG4gICAgICBpZiAoZWwgPT09IGN0eCkgYnJlYWs7XG4gICAgICAvKiBqc2hpbnQgYm9zczp0cnVlICovXG4gICAgfSB3aGlsZSAoZWwgPSBnZXRQYXJlbnRPckhvc3QoZWwpKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbnZhciBSX1NQQUNFID0gL1xccysvZztcbmZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsLCBuYW1lLCBzdGF0ZSkge1xuICBpZiAoZWwgJiYgbmFtZSkge1xuICAgIGlmIChlbC5jbGFzc0xpc3QpIHtcbiAgICAgIGVsLmNsYXNzTGlzdFtzdGF0ZSA/ICdhZGQnIDogJ3JlbW92ZSddKG5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgY2xhc3NOYW1lID0gKCcgJyArIGVsLmNsYXNzTmFtZSArICcgJykucmVwbGFjZShSX1NQQUNFLCAnICcpLnJlcGxhY2UoJyAnICsgbmFtZSArICcgJywgJyAnKTtcbiAgICAgIGVsLmNsYXNzTmFtZSA9IChjbGFzc05hbWUgKyAoc3RhdGUgPyAnICcgKyBuYW1lIDogJycpKS5yZXBsYWNlKFJfU1BBQ0UsICcgJyk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBjc3MoZWwsIHByb3AsIHZhbCkge1xuICB2YXIgc3R5bGUgPSBlbCAmJiBlbC5zdHlsZTtcbiAgaWYgKHN0eWxlKSB7XG4gICAgaWYgKHZhbCA9PT0gdm9pZCAwKSB7XG4gICAgICBpZiAoZG9jdW1lbnQuZGVmYXVsdFZpZXcgJiYgZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSkge1xuICAgICAgICB2YWwgPSBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsLCAnJyk7XG4gICAgICB9IGVsc2UgaWYgKGVsLmN1cnJlbnRTdHlsZSkge1xuICAgICAgICB2YWwgPSBlbC5jdXJyZW50U3R5bGU7XG4gICAgICB9XG4gICAgICByZXR1cm4gcHJvcCA9PT0gdm9pZCAwID8gdmFsIDogdmFsW3Byb3BdO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIShwcm9wIGluIHN0eWxlKSAmJiBwcm9wLmluZGV4T2YoJ3dlYmtpdCcpID09PSAtMSkge1xuICAgICAgICBwcm9wID0gJy13ZWJraXQtJyArIHByb3A7XG4gICAgICB9XG4gICAgICBzdHlsZVtwcm9wXSA9IHZhbCArICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/ICcnIDogJ3B4Jyk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBtYXRyaXgoZWwsIHNlbGZPbmx5KSB7XG4gIHZhciBhcHBsaWVkVHJhbnNmb3JtcyA9ICcnO1xuICBpZiAodHlwZW9mIGVsID09PSAnc3RyaW5nJykge1xuICAgIGFwcGxpZWRUcmFuc2Zvcm1zID0gZWw7XG4gIH0gZWxzZSB7XG4gICAgZG8ge1xuICAgICAgdmFyIHRyYW5zZm9ybSA9IGNzcyhlbCwgJ3RyYW5zZm9ybScpO1xuICAgICAgaWYgKHRyYW5zZm9ybSAmJiB0cmFuc2Zvcm0gIT09ICdub25lJykge1xuICAgICAgICBhcHBsaWVkVHJhbnNmb3JtcyA9IHRyYW5zZm9ybSArICcgJyArIGFwcGxpZWRUcmFuc2Zvcm1zO1xuICAgICAgfVxuICAgICAgLyoganNoaW50IGJvc3M6dHJ1ZSAqL1xuICAgIH0gd2hpbGUgKCFzZWxmT25seSAmJiAoZWwgPSBlbC5wYXJlbnROb2RlKSk7XG4gIH1cbiAgdmFyIG1hdHJpeEZuID0gd2luZG93LkRPTU1hdHJpeCB8fCB3aW5kb3cuV2ViS2l0Q1NTTWF0cml4IHx8IHdpbmRvdy5DU1NNYXRyaXggfHwgd2luZG93Lk1TQ1NTTWF0cml4O1xuICAvKmpzaGludCAtVzA1NiAqL1xuICByZXR1cm4gbWF0cml4Rm4gJiYgbmV3IG1hdHJpeEZuKGFwcGxpZWRUcmFuc2Zvcm1zKTtcbn1cbmZ1bmN0aW9uIGZpbmQoY3R4LCB0YWdOYW1lLCBpdGVyYXRvcikge1xuICBpZiAoY3R4KSB7XG4gICAgdmFyIGxpc3QgPSBjdHguZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnTmFtZSksXG4gICAgICBpID0gMCxcbiAgICAgIG4gPSBsaXN0Lmxlbmd0aDtcbiAgICBpZiAoaXRlcmF0b3IpIHtcbiAgICAgIGZvciAoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIGl0ZXJhdG9yKGxpc3RbaV0sIGkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbGlzdDtcbiAgfVxuICByZXR1cm4gW107XG59XG5mdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGxpbmdFbGVtZW50KCkge1xuICB2YXIgc2Nyb2xsaW5nRWxlbWVudCA9IGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ7XG4gIGlmIChzY3JvbGxpbmdFbGVtZW50KSB7XG4gICAgcmV0dXJuIHNjcm9sbGluZ0VsZW1lbnQ7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgfVxufVxuXG4vKipcclxuICogUmV0dXJucyB0aGUgXCJib3VuZGluZyBjbGllbnQgcmVjdFwiIG9mIGdpdmVuIGVsZW1lbnRcclxuICogQHBhcmFtICB7SFRNTEVsZW1lbnR9IGVsICAgICAgICAgICAgICAgICAgICAgICBUaGUgZWxlbWVudCB3aG9zZSBib3VuZGluZ0NsaWVudFJlY3QgaXMgd2FudGVkXHJcbiAqIEBwYXJhbSAge1tCb29sZWFuXX0gcmVsYXRpdmVUb0NvbnRhaW5pbmdCbG9jayAgV2hldGhlciB0aGUgcmVjdCBzaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGNvbnRhaW5pbmcgYmxvY2sgb2YgKGluY2x1ZGluZykgdGhlIGNvbnRhaW5lclxyXG4gKiBAcGFyYW0gIHtbQm9vbGVhbl19IHJlbGF0aXZlVG9Ob25TdGF0aWNQYXJlbnQgIFdoZXRoZXIgdGhlIHJlY3Qgc2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSByZWxhdGl2ZSBwYXJlbnQgb2YgKGluY2x1ZGluZykgdGhlIGNvbnRhaWVuclxyXG4gKiBAcGFyYW0gIHtbQm9vbGVhbl19IHVuZG9TY2FsZSAgICAgICAgICAgICAgICAgIFdoZXRoZXIgdGhlIGNvbnRhaW5lcidzIHNjYWxlKCkgc2hvdWxkIGJlIHVuZG9uZVxyXG4gKiBAcGFyYW0gIHtbSFRNTEVsZW1lbnRdfSBjb250YWluZXIgICAgICAgICAgICAgIFRoZSBwYXJlbnQgdGhlIGVsZW1lbnQgd2lsbCBiZSBwbGFjZWQgaW5cclxuICogQHJldHVybiB7T2JqZWN0fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGUgYm91bmRpbmdDbGllbnRSZWN0IG9mIGVsLCB3aXRoIHNwZWNpZmllZCBhZGp1c3RtZW50c1xyXG4gKi9cbmZ1bmN0aW9uIGdldFJlY3QoZWwsIHJlbGF0aXZlVG9Db250YWluaW5nQmxvY2ssIHJlbGF0aXZlVG9Ob25TdGF0aWNQYXJlbnQsIHVuZG9TY2FsZSwgY29udGFpbmVyKSB7XG4gIGlmICghZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICYmIGVsICE9PSB3aW5kb3cpIHJldHVybjtcbiAgdmFyIGVsUmVjdCwgdG9wLCBsZWZ0LCBib3R0b20sIHJpZ2h0LCBoZWlnaHQsIHdpZHRoO1xuICBpZiAoZWwgIT09IHdpbmRvdyAmJiBlbC5wYXJlbnROb2RlICYmIGVsICE9PSBnZXRXaW5kb3dTY3JvbGxpbmdFbGVtZW50KCkpIHtcbiAgICBlbFJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB0b3AgPSBlbFJlY3QudG9wO1xuICAgIGxlZnQgPSBlbFJlY3QubGVmdDtcbiAgICBib3R0b20gPSBlbFJlY3QuYm90dG9tO1xuICAgIHJpZ2h0ID0gZWxSZWN0LnJpZ2h0O1xuICAgIGhlaWdodCA9IGVsUmVjdC5oZWlnaHQ7XG4gICAgd2lkdGggPSBlbFJlY3Qud2lkdGg7XG4gIH0gZWxzZSB7XG4gICAgdG9wID0gMDtcbiAgICBsZWZ0ID0gMDtcbiAgICBib3R0b20gPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgcmlnaHQgPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgfVxuICBpZiAoKHJlbGF0aXZlVG9Db250YWluaW5nQmxvY2sgfHwgcmVsYXRpdmVUb05vblN0YXRpY1BhcmVudCkgJiYgZWwgIT09IHdpbmRvdykge1xuICAgIC8vIEFkanVzdCBmb3IgdHJhbnNsYXRlKClcbiAgICBjb250YWluZXIgPSBjb250YWluZXIgfHwgZWwucGFyZW50Tm9kZTtcblxuICAgIC8vIHNvbHZlcyAjMTEyMyAoc2VlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzc5NTM4MDYvNjA4ODMxMilcbiAgICAvLyBOb3QgbmVlZGVkIG9uIDw9IElFMTFcbiAgICBpZiAoIUlFMTFPckxlc3MpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKGNvbnRhaW5lciAmJiBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICYmIChjc3MoY29udGFpbmVyLCAndHJhbnNmb3JtJykgIT09ICdub25lJyB8fCByZWxhdGl2ZVRvTm9uU3RhdGljUGFyZW50ICYmIGNzcyhjb250YWluZXIsICdwb3NpdGlvbicpICE9PSAnc3RhdGljJykpIHtcbiAgICAgICAgICB2YXIgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgIC8vIFNldCByZWxhdGl2ZSB0byBlZGdlcyBvZiBwYWRkaW5nIGJveCBvZiBjb250YWluZXJcbiAgICAgICAgICB0b3AgLT0gY29udGFpbmVyUmVjdC50b3AgKyBwYXJzZUludChjc3MoY29udGFpbmVyLCAnYm9yZGVyLXRvcC13aWR0aCcpKTtcbiAgICAgICAgICBsZWZ0IC09IGNvbnRhaW5lclJlY3QubGVmdCArIHBhcnNlSW50KGNzcyhjb250YWluZXIsICdib3JkZXItbGVmdC13aWR0aCcpKTtcbiAgICAgICAgICBib3R0b20gPSB0b3AgKyBlbFJlY3QuaGVpZ2h0O1xuICAgICAgICAgIHJpZ2h0ID0gbGVmdCArIGVsUmVjdC53aWR0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAvKiBqc2hpbnQgYm9zczp0cnVlICovXG4gICAgICB9IHdoaWxlIChjb250YWluZXIgPSBjb250YWluZXIucGFyZW50Tm9kZSk7XG4gICAgfVxuICB9XG4gIGlmICh1bmRvU2NhbGUgJiYgZWwgIT09IHdpbmRvdykge1xuICAgIC8vIEFkanVzdCBmb3Igc2NhbGUoKVxuICAgIHZhciBlbE1hdHJpeCA9IG1hdHJpeChjb250YWluZXIgfHwgZWwpLFxuICAgICAgc2NhbGVYID0gZWxNYXRyaXggJiYgZWxNYXRyaXguYSxcbiAgICAgIHNjYWxlWSA9IGVsTWF0cml4ICYmIGVsTWF0cml4LmQ7XG4gICAgaWYgKGVsTWF0cml4KSB7XG4gICAgICB0b3AgLz0gc2NhbGVZO1xuICAgICAgbGVmdCAvPSBzY2FsZVg7XG4gICAgICB3aWR0aCAvPSBzY2FsZVg7XG4gICAgICBoZWlnaHQgLz0gc2NhbGVZO1xuICAgICAgYm90dG9tID0gdG9wICsgaGVpZ2h0O1xuICAgICAgcmlnaHQgPSBsZWZ0ICsgd2lkdGg7XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgdG9wOiB0b3AsXG4gICAgbGVmdDogbGVmdCxcbiAgICBib3R0b206IGJvdHRvbSxcbiAgICByaWdodDogcmlnaHQsXG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0XG4gIH07XG59XG5cbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBjb250ZW50IHJlY3Qgb2YgdGhlIGVsZW1lbnQgKGJvdW5kaW5nIHJlY3QgbWludXMgYm9yZGVyIGFuZCBwYWRkaW5nKVxyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbCBcclxuICovXG5mdW5jdGlvbiBnZXRDb250ZW50UmVjdChlbCkge1xuICB2YXIgcmVjdCA9IGdldFJlY3QoZWwpO1xuICB2YXIgcGFkZGluZ0xlZnQgPSBwYXJzZUludChjc3MoZWwsICdwYWRkaW5nLWxlZnQnKSksXG4gICAgcGFkZGluZ1RvcCA9IHBhcnNlSW50KGNzcyhlbCwgJ3BhZGRpbmctdG9wJykpLFxuICAgIHBhZGRpbmdSaWdodCA9IHBhcnNlSW50KGNzcyhlbCwgJ3BhZGRpbmctcmlnaHQnKSksXG4gICAgcGFkZGluZ0JvdHRvbSA9IHBhcnNlSW50KGNzcyhlbCwgJ3BhZGRpbmctYm90dG9tJykpO1xuICByZWN0LnRvcCArPSBwYWRkaW5nVG9wICsgcGFyc2VJbnQoY3NzKGVsLCAnYm9yZGVyLXRvcC13aWR0aCcpKTtcbiAgcmVjdC5sZWZ0ICs9IHBhZGRpbmdMZWZ0ICsgcGFyc2VJbnQoY3NzKGVsLCAnYm9yZGVyLWxlZnQtd2lkdGgnKSk7XG4gIC8vIENsaWVudCBXaWR0aC9IZWlnaHQgaW5jbHVkZXMgcGFkZGluZyBvbmx5XG4gIHJlY3Qud2lkdGggPSBlbC5jbGllbnRXaWR0aCAtIHBhZGRpbmdMZWZ0IC0gcGFkZGluZ1JpZ2h0O1xuICByZWN0LmhlaWdodCA9IGVsLmNsaWVudEhlaWdodCAtIHBhZGRpbmdUb3AgLSBwYWRkaW5nQm90dG9tO1xuICByZWN0LmJvdHRvbSA9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQ7XG4gIHJlY3QucmlnaHQgPSByZWN0LmxlZnQgKyByZWN0LndpZHRoO1xuICByZXR1cm4gcmVjdDtcbn1cblxuLyoqXHJcbiAqIENoZWNrcyBpZiBhIHNpZGUgb2YgYW4gZWxlbWVudCBpcyBzY3JvbGxlZCBwYXN0IGEgc2lkZSBvZiBpdHMgcGFyZW50c1xyXG4gKiBAcGFyYW0gIHtIVE1MRWxlbWVudH0gIGVsICAgICAgICAgICBUaGUgZWxlbWVudCB3aG8ncyBzaWRlIGJlaW5nIHNjcm9sbGVkIG91dCBvZiB2aWV3IGlzIGluIHF1ZXN0aW9uXHJcbiAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgZWxTaWRlICAgICAgIFNpZGUgb2YgdGhlIGVsZW1lbnQgaW4gcXVlc3Rpb24gKCd0b3AnLCAnbGVmdCcsICdyaWdodCcsICdib3R0b20nKVxyXG4gKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgIHBhcmVudFNpZGUgICBTaWRlIG9mIHRoZSBwYXJlbnQgaW4gcXVlc3Rpb24gKCd0b3AnLCAnbGVmdCcsICdyaWdodCcsICdib3R0b20nKVxyXG4gKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gICAgICAgICAgICAgICBUaGUgcGFyZW50IHNjcm9sbCBlbGVtZW50IHRoYXQgdGhlIGVsJ3Mgc2lkZSBpcyBzY3JvbGxlZCBwYXN0LCBvciBudWxsIGlmIHRoZXJlIGlzIG5vIHN1Y2ggZWxlbWVudFxyXG4gKi9cbmZ1bmN0aW9uIGlzU2Nyb2xsZWRQYXN0KGVsLCBlbFNpZGUsIHBhcmVudFNpZGUpIHtcbiAgdmFyIHBhcmVudCA9IGdldFBhcmVudEF1dG9TY3JvbGxFbGVtZW50KGVsLCB0cnVlKSxcbiAgICBlbFNpZGVWYWwgPSBnZXRSZWN0KGVsKVtlbFNpZGVdO1xuXG4gIC8qIGpzaGludCBib3NzOnRydWUgKi9cbiAgd2hpbGUgKHBhcmVudCkge1xuICAgIHZhciBwYXJlbnRTaWRlVmFsID0gZ2V0UmVjdChwYXJlbnQpW3BhcmVudFNpZGVdLFxuICAgICAgdmlzaWJsZSA9IHZvaWQgMDtcbiAgICBpZiAocGFyZW50U2lkZSA9PT0gJ3RvcCcgfHwgcGFyZW50U2lkZSA9PT0gJ2xlZnQnKSB7XG4gICAgICB2aXNpYmxlID0gZWxTaWRlVmFsID49IHBhcmVudFNpZGVWYWw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZpc2libGUgPSBlbFNpZGVWYWwgPD0gcGFyZW50U2lkZVZhbDtcbiAgICB9XG4gICAgaWYgKCF2aXNpYmxlKSByZXR1cm4gcGFyZW50O1xuICAgIGlmIChwYXJlbnQgPT09IGdldFdpbmRvd1Njcm9sbGluZ0VsZW1lbnQoKSkgYnJlYWs7XG4gICAgcGFyZW50ID0gZ2V0UGFyZW50QXV0b1Njcm9sbEVsZW1lbnQocGFyZW50LCBmYWxzZSk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcclxuICogR2V0cyBudGggY2hpbGQgb2YgZWwsIGlnbm9yaW5nIGhpZGRlbiBjaGlsZHJlbiwgc29ydGFibGUncyBlbGVtZW50cyAoZG9lcyBub3QgaWdub3JlIGNsb25lIGlmIGl0J3MgdmlzaWJsZSlcclxuICogYW5kIG5vbi1kcmFnZ2FibGUgZWxlbWVudHNcclxuICogQHBhcmFtICB7SFRNTEVsZW1lbnR9IGVsICAgICAgIFRoZSBwYXJlbnQgZWxlbWVudFxyXG4gKiBAcGFyYW0gIHtOdW1iZXJ9IGNoaWxkTnVtICAgICAgVGhlIGluZGV4IG9mIHRoZSBjaGlsZFxyXG4gKiBAcGFyYW0gIHtPYmplY3R9IG9wdGlvbnMgICAgICAgUGFyZW50IFNvcnRhYmxlJ3Mgb3B0aW9uc1xyXG4gKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gICAgICAgICAgVGhlIGNoaWxkIGF0IGluZGV4IGNoaWxkTnVtLCBvciBudWxsIGlmIG5vdCBmb3VuZFxyXG4gKi9cbmZ1bmN0aW9uIGdldENoaWxkKGVsLCBjaGlsZE51bSwgb3B0aW9ucywgaW5jbHVkZURyYWdFbCkge1xuICB2YXIgY3VycmVudENoaWxkID0gMCxcbiAgICBpID0gMCxcbiAgICBjaGlsZHJlbiA9IGVsLmNoaWxkcmVuO1xuICB3aGlsZSAoaSA8IGNoaWxkcmVuLmxlbmd0aCkge1xuICAgIGlmIChjaGlsZHJlbltpXS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScgJiYgY2hpbGRyZW5baV0gIT09IFNvcnRhYmxlLmdob3N0ICYmIChpbmNsdWRlRHJhZ0VsIHx8IGNoaWxkcmVuW2ldICE9PSBTb3J0YWJsZS5kcmFnZ2VkKSAmJiBjbG9zZXN0KGNoaWxkcmVuW2ldLCBvcHRpb25zLmRyYWdnYWJsZSwgZWwsIGZhbHNlKSkge1xuICAgICAgaWYgKGN1cnJlbnRDaGlsZCA9PT0gY2hpbGROdW0pIHtcbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuW2ldO1xuICAgICAgfVxuICAgICAgY3VycmVudENoaWxkKys7XG4gICAgfVxuICAgIGkrKztcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXHJcbiAqIEdldHMgdGhlIGxhc3QgY2hpbGQgaW4gdGhlIGVsLCBpZ25vcmluZyBnaG9zdEVsIG9yIGludmlzaWJsZSBlbGVtZW50cyAoY2xvbmVzKVxyXG4gKiBAcGFyYW0gIHtIVE1MRWxlbWVudH0gZWwgICAgICAgUGFyZW50IGVsZW1lbnRcclxuICogQHBhcmFtICB7c2VsZWN0b3J9IHNlbGVjdG9yICAgIEFueSBvdGhlciBlbGVtZW50cyB0aGF0IHNob3VsZCBiZSBpZ25vcmVkXHJcbiAqIEByZXR1cm4ge0hUTUxFbGVtZW50fSAgICAgICAgICBUaGUgbGFzdCBjaGlsZCwgaWdub3JpbmcgZ2hvc3RFbFxyXG4gKi9cbmZ1bmN0aW9uIGxhc3RDaGlsZChlbCwgc2VsZWN0b3IpIHtcbiAgdmFyIGxhc3QgPSBlbC5sYXN0RWxlbWVudENoaWxkO1xuICB3aGlsZSAobGFzdCAmJiAobGFzdCA9PT0gU29ydGFibGUuZ2hvc3QgfHwgY3NzKGxhc3QsICdkaXNwbGF5JykgPT09ICdub25lJyB8fCBzZWxlY3RvciAmJiAhbWF0Y2hlcyhsYXN0LCBzZWxlY3RvcikpKSB7XG4gICAgbGFzdCA9IGxhc3QucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgfVxuICByZXR1cm4gbGFzdCB8fCBudWxsO1xufVxuXG4vKipcclxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgYW4gZWxlbWVudCB3aXRoaW4gaXRzIHBhcmVudCBmb3IgYSBzZWxlY3RlZCBzZXQgb2ZcclxuICogZWxlbWVudHNcclxuICogQHBhcmFtICB7SFRNTEVsZW1lbnR9IGVsXHJcbiAqIEBwYXJhbSAge3NlbGVjdG9yfSBzZWxlY3RvclxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xuZnVuY3Rpb24gaW5kZXgoZWwsIHNlbGVjdG9yKSB7XG4gIHZhciBpbmRleCA9IDA7XG4gIGlmICghZWwgfHwgIWVsLnBhcmVudE5vZGUpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICAvKiBqc2hpbnQgYm9zczp0cnVlICovXG4gIHdoaWxlIChlbCA9IGVsLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoZWwubm9kZU5hbWUudG9VcHBlckNhc2UoKSAhPT0gJ1RFTVBMQVRFJyAmJiBlbCAhPT0gU29ydGFibGUuY2xvbmUgJiYgKCFzZWxlY3RvciB8fCBtYXRjaGVzKGVsLCBzZWxlY3RvcikpKSB7XG4gICAgICBpbmRleCsrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gaW5kZXg7XG59XG5cbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBzY3JvbGwgb2Zmc2V0IG9mIHRoZSBnaXZlbiBlbGVtZW50LCBhZGRlZCB3aXRoIGFsbCB0aGUgc2Nyb2xsIG9mZnNldHMgb2YgcGFyZW50IGVsZW1lbnRzLlxyXG4gKiBUaGUgdmFsdWUgaXMgcmV0dXJuZWQgaW4gcmVhbCBwaXhlbHMuXHJcbiAqIEBwYXJhbSAge0hUTUxFbGVtZW50fSBlbFxyXG4gKiBAcmV0dXJuIHtBcnJheX0gICAgICAgICAgICAgT2Zmc2V0cyBpbiB0aGUgZm9ybWF0IG9mIFtsZWZ0LCB0b3BdXHJcbiAqL1xuZnVuY3Rpb24gZ2V0UmVsYXRpdmVTY3JvbGxPZmZzZXQoZWwpIHtcbiAgdmFyIG9mZnNldExlZnQgPSAwLFxuICAgIG9mZnNldFRvcCA9IDAsXG4gICAgd2luU2Nyb2xsZXIgPSBnZXRXaW5kb3dTY3JvbGxpbmdFbGVtZW50KCk7XG4gIGlmIChlbCkge1xuICAgIGRvIHtcbiAgICAgIHZhciBlbE1hdHJpeCA9IG1hdHJpeChlbCksXG4gICAgICAgIHNjYWxlWCA9IGVsTWF0cml4LmEsXG4gICAgICAgIHNjYWxlWSA9IGVsTWF0cml4LmQ7XG4gICAgICBvZmZzZXRMZWZ0ICs9IGVsLnNjcm9sbExlZnQgKiBzY2FsZVg7XG4gICAgICBvZmZzZXRUb3AgKz0gZWwuc2Nyb2xsVG9wICogc2NhbGVZO1xuICAgIH0gd2hpbGUgKGVsICE9PSB3aW5TY3JvbGxlciAmJiAoZWwgPSBlbC5wYXJlbnROb2RlKSk7XG4gIH1cbiAgcmV0dXJuIFtvZmZzZXRMZWZ0LCBvZmZzZXRUb3BdO1xufVxuXG4vKipcclxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIG9iamVjdCB3aXRoaW4gdGhlIGdpdmVuIGFycmF5XHJcbiAqIEBwYXJhbSAge0FycmF5fSBhcnIgICBBcnJheSB0aGF0IG1heSBvciBtYXkgbm90IGhvbGQgdGhlIG9iamVjdFxyXG4gKiBAcGFyYW0gIHtPYmplY3R9IG9iaiAgQW4gb2JqZWN0IHRoYXQgaGFzIGEga2V5LXZhbHVlIHBhaXIgdW5pcXVlIHRvIGFuZCBpZGVudGljYWwgdG8gYSBrZXktdmFsdWUgcGFpciBpbiB0aGUgb2JqZWN0IHlvdSB3YW50IHRvIGZpbmRcclxuICogQHJldHVybiB7TnVtYmVyfSAgICAgIFRoZSBpbmRleCBvZiB0aGUgb2JqZWN0IGluIHRoZSBhcnJheSwgb3IgLTFcclxuICovXG5mdW5jdGlvbiBpbmRleE9mT2JqZWN0KGFyciwgb2JqKSB7XG4gIGZvciAodmFyIGkgaW4gYXJyKSB7XG4gICAgaWYgKCFhcnIuaGFzT3duUHJvcGVydHkoaSkpIGNvbnRpbnVlO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSAmJiBvYmpba2V5XSA9PT0gYXJyW2ldW2tleV0pIHJldHVybiBOdW1iZXIoaSk7XG4gICAgfVxuICB9XG4gIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIGdldFBhcmVudEF1dG9TY3JvbGxFbGVtZW50KGVsLCBpbmNsdWRlU2VsZikge1xuICAvLyBza2lwIHRvIHdpbmRvd1xuICBpZiAoIWVsIHx8ICFlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHJldHVybiBnZXRXaW5kb3dTY3JvbGxpbmdFbGVtZW50KCk7XG4gIHZhciBlbGVtID0gZWw7XG4gIHZhciBnb3RTZWxmID0gZmFsc2U7XG4gIGRvIHtcbiAgICAvLyB3ZSBkb24ndCBuZWVkIHRvIGdldCBlbGVtIGNzcyBpZiBpdCBpc24ndCBldmVuIG92ZXJmbG93aW5nIGluIHRoZSBmaXJzdCBwbGFjZSAocGVyZm9ybWFuY2UpXG4gICAgaWYgKGVsZW0uY2xpZW50V2lkdGggPCBlbGVtLnNjcm9sbFdpZHRoIHx8IGVsZW0uY2xpZW50SGVpZ2h0IDwgZWxlbS5zY3JvbGxIZWlnaHQpIHtcbiAgICAgIHZhciBlbGVtQ1NTID0gY3NzKGVsZW0pO1xuICAgICAgaWYgKGVsZW0uY2xpZW50V2lkdGggPCBlbGVtLnNjcm9sbFdpZHRoICYmIChlbGVtQ1NTLm92ZXJmbG93WCA9PSAnYXV0bycgfHwgZWxlbUNTUy5vdmVyZmxvd1ggPT0gJ3Njcm9sbCcpIHx8IGVsZW0uY2xpZW50SGVpZ2h0IDwgZWxlbS5zY3JvbGxIZWlnaHQgJiYgKGVsZW1DU1Mub3ZlcmZsb3dZID09ICdhdXRvJyB8fCBlbGVtQ1NTLm92ZXJmbG93WSA9PSAnc2Nyb2xsJykpIHtcbiAgICAgICAgaWYgKCFlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCB8fCBlbGVtID09PSBkb2N1bWVudC5ib2R5KSByZXR1cm4gZ2V0V2luZG93U2Nyb2xsaW5nRWxlbWVudCgpO1xuICAgICAgICBpZiAoZ290U2VsZiB8fCBpbmNsdWRlU2VsZikgcmV0dXJuIGVsZW07XG4gICAgICAgIGdvdFNlbGYgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICAvKiBqc2hpbnQgYm9zczp0cnVlICovXG4gIH0gd2hpbGUgKGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpO1xuICByZXR1cm4gZ2V0V2luZG93U2Nyb2xsaW5nRWxlbWVudCgpO1xufVxuZnVuY3Rpb24gZXh0ZW5kKGRzdCwgc3JjKSB7XG4gIGlmIChkc3QgJiYgc3JjKSB7XG4gICAgZm9yICh2YXIga2V5IGluIHNyYykge1xuICAgICAgaWYgKHNyYy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIGRzdFtrZXldID0gc3JjW2tleV07XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBkc3Q7XG59XG5mdW5jdGlvbiBpc1JlY3RFcXVhbChyZWN0MSwgcmVjdDIpIHtcbiAgcmV0dXJuIE1hdGgucm91bmQocmVjdDEudG9wKSA9PT0gTWF0aC5yb3VuZChyZWN0Mi50b3ApICYmIE1hdGgucm91bmQocmVjdDEubGVmdCkgPT09IE1hdGgucm91bmQocmVjdDIubGVmdCkgJiYgTWF0aC5yb3VuZChyZWN0MS5oZWlnaHQpID09PSBNYXRoLnJvdW5kKHJlY3QyLmhlaWdodCkgJiYgTWF0aC5yb3VuZChyZWN0MS53aWR0aCkgPT09IE1hdGgucm91bmQocmVjdDIud2lkdGgpO1xufVxudmFyIF90aHJvdHRsZVRpbWVvdXQ7XG5mdW5jdGlvbiB0aHJvdHRsZShjYWxsYmFjaywgbXMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIV90aHJvdHRsZVRpbWVvdXQpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICBfdGhpcyA9IHRoaXM7XG4gICAgICBpZiAoYXJncy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgY2FsbGJhY2suY2FsbChfdGhpcywgYXJnc1swXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYWxsYmFjay5hcHBseShfdGhpcywgYXJncyk7XG4gICAgICB9XG4gICAgICBfdGhyb3R0bGVUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aHJvdHRsZVRpbWVvdXQgPSB2b2lkIDA7XG4gICAgICB9LCBtcyk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gY2FuY2VsVGhyb3R0bGUoKSB7XG4gIGNsZWFyVGltZW91dChfdGhyb3R0bGVUaW1lb3V0KTtcbiAgX3Rocm90dGxlVGltZW91dCA9IHZvaWQgMDtcbn1cbmZ1bmN0aW9uIHNjcm9sbEJ5KGVsLCB4LCB5KSB7XG4gIGVsLnNjcm9sbExlZnQgKz0geDtcbiAgZWwuc2Nyb2xsVG9wICs9IHk7XG59XG5mdW5jdGlvbiBjbG9uZShlbCkge1xuICB2YXIgUG9seW1lciA9IHdpbmRvdy5Qb2x5bWVyO1xuICB2YXIgJCA9IHdpbmRvdy5qUXVlcnkgfHwgd2luZG93LlplcHRvO1xuICBpZiAoUG9seW1lciAmJiBQb2x5bWVyLmRvbSkge1xuICAgIHJldHVybiBQb2x5bWVyLmRvbShlbCkuY2xvbmVOb2RlKHRydWUpO1xuICB9IGVsc2UgaWYgKCQpIHtcbiAgICByZXR1cm4gJChlbCkuY2xvbmUodHJ1ZSlbMF07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGVsLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxufVxuZnVuY3Rpb24gc2V0UmVjdChlbCwgcmVjdCkge1xuICBjc3MoZWwsICdwb3NpdGlvbicsICdhYnNvbHV0ZScpO1xuICBjc3MoZWwsICd0b3AnLCByZWN0LnRvcCk7XG4gIGNzcyhlbCwgJ2xlZnQnLCByZWN0LmxlZnQpO1xuICBjc3MoZWwsICd3aWR0aCcsIHJlY3Qud2lkdGgpO1xuICBjc3MoZWwsICdoZWlnaHQnLCByZWN0LmhlaWdodCk7XG59XG5mdW5jdGlvbiB1bnNldFJlY3QoZWwpIHtcbiAgY3NzKGVsLCAncG9zaXRpb24nLCAnJyk7XG4gIGNzcyhlbCwgJ3RvcCcsICcnKTtcbiAgY3NzKGVsLCAnbGVmdCcsICcnKTtcbiAgY3NzKGVsLCAnd2lkdGgnLCAnJyk7XG4gIGNzcyhlbCwgJ2hlaWdodCcsICcnKTtcbn1cbnZhciBleHBhbmRvID0gJ1NvcnRhYmxlJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG5mdW5jdGlvbiBBbmltYXRpb25TdGF0ZU1hbmFnZXIoKSB7XG4gIHZhciBhbmltYXRpb25TdGF0ZXMgPSBbXSxcbiAgICBhbmltYXRpb25DYWxsYmFja0lkO1xuICByZXR1cm4ge1xuICAgIGNhcHR1cmVBbmltYXRpb25TdGF0ZTogZnVuY3Rpb24gY2FwdHVyZUFuaW1hdGlvblN0YXRlKCkge1xuICAgICAgYW5pbWF0aW9uU3RhdGVzID0gW107XG4gICAgICBpZiAoIXRoaXMub3B0aW9ucy5hbmltYXRpb24pIHJldHVybjtcbiAgICAgIHZhciBjaGlsZHJlbiA9IFtdLnNsaWNlLmNhbGwodGhpcy5lbC5jaGlsZHJlbik7XG4gICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBpZiAoY3NzKGNoaWxkLCAnZGlzcGxheScpID09PSAnbm9uZScgfHwgY2hpbGQgPT09IFNvcnRhYmxlLmdob3N0KSByZXR1cm47XG4gICAgICAgIGFuaW1hdGlvblN0YXRlcy5wdXNoKHtcbiAgICAgICAgICB0YXJnZXQ6IGNoaWxkLFxuICAgICAgICAgIHJlY3Q6IGdldFJlY3QoY2hpbGQpXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgZnJvbVJlY3QgPSBfb2JqZWN0U3ByZWFkMih7fSwgYW5pbWF0aW9uU3RhdGVzW2FuaW1hdGlvblN0YXRlcy5sZW5ndGggLSAxXS5yZWN0KTtcblxuICAgICAgICAvLyBJZiBhbmltYXRpbmc6IGNvbXBlbnNhdGUgZm9yIGN1cnJlbnQgYW5pbWF0aW9uXG4gICAgICAgIGlmIChjaGlsZC50aGlzQW5pbWF0aW9uRHVyYXRpb24pIHtcbiAgICAgICAgICB2YXIgY2hpbGRNYXRyaXggPSBtYXRyaXgoY2hpbGQsIHRydWUpO1xuICAgICAgICAgIGlmIChjaGlsZE1hdHJpeCkge1xuICAgICAgICAgICAgZnJvbVJlY3QudG9wIC09IGNoaWxkTWF0cml4LmY7XG4gICAgICAgICAgICBmcm9tUmVjdC5sZWZ0IC09IGNoaWxkTWF0cml4LmU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNoaWxkLmZyb21SZWN0ID0gZnJvbVJlY3Q7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFkZEFuaW1hdGlvblN0YXRlOiBmdW5jdGlvbiBhZGRBbmltYXRpb25TdGF0ZShzdGF0ZSkge1xuICAgICAgYW5pbWF0aW9uU3RhdGVzLnB1c2goc3RhdGUpO1xuICAgIH0sXG4gICAgcmVtb3ZlQW5pbWF0aW9uU3RhdGU6IGZ1bmN0aW9uIHJlbW92ZUFuaW1hdGlvblN0YXRlKHRhcmdldCkge1xuICAgICAgYW5pbWF0aW9uU3RhdGVzLnNwbGljZShpbmRleE9mT2JqZWN0KGFuaW1hdGlvblN0YXRlcywge1xuICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgfSksIDEpO1xuICAgIH0sXG4gICAgYW5pbWF0ZUFsbDogZnVuY3Rpb24gYW5pbWF0ZUFsbChjYWxsYmFjaykge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmFuaW1hdGlvbikge1xuICAgICAgICBjbGVhclRpbWVvdXQoYW5pbWF0aW9uQ2FsbGJhY2tJZCk7XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIGNhbGxiYWNrKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBhbmltYXRpbmcgPSBmYWxzZSxcbiAgICAgICAgYW5pbWF0aW9uVGltZSA9IDA7XG4gICAgICBhbmltYXRpb25TdGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgdmFyIHRpbWUgPSAwLFxuICAgICAgICAgIHRhcmdldCA9IHN0YXRlLnRhcmdldCxcbiAgICAgICAgICBmcm9tUmVjdCA9IHRhcmdldC5mcm9tUmVjdCxcbiAgICAgICAgICB0b1JlY3QgPSBnZXRSZWN0KHRhcmdldCksXG4gICAgICAgICAgcHJldkZyb21SZWN0ID0gdGFyZ2V0LnByZXZGcm9tUmVjdCxcbiAgICAgICAgICBwcmV2VG9SZWN0ID0gdGFyZ2V0LnByZXZUb1JlY3QsXG4gICAgICAgICAgYW5pbWF0aW5nUmVjdCA9IHN0YXRlLnJlY3QsXG4gICAgICAgICAgdGFyZ2V0TWF0cml4ID0gbWF0cml4KHRhcmdldCwgdHJ1ZSk7XG4gICAgICAgIGlmICh0YXJnZXRNYXRyaXgpIHtcbiAgICAgICAgICAvLyBDb21wZW5zYXRlIGZvciBjdXJyZW50IGFuaW1hdGlvblxuICAgICAgICAgIHRvUmVjdC50b3AgLT0gdGFyZ2V0TWF0cml4LmY7XG4gICAgICAgICAgdG9SZWN0LmxlZnQgLT0gdGFyZ2V0TWF0cml4LmU7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0LnRvUmVjdCA9IHRvUmVjdDtcbiAgICAgICAgaWYgKHRhcmdldC50aGlzQW5pbWF0aW9uRHVyYXRpb24pIHtcbiAgICAgICAgICAvLyBDb3VsZCBhbHNvIGNoZWNrIGlmIGFuaW1hdGluZ1JlY3QgaXMgYmV0d2VlbiBmcm9tUmVjdCBhbmQgdG9SZWN0XG4gICAgICAgICAgaWYgKGlzUmVjdEVxdWFsKHByZXZGcm9tUmVjdCwgdG9SZWN0KSAmJiAhaXNSZWN0RXF1YWwoZnJvbVJlY3QsIHRvUmVjdCkgJiZcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgYW5pbWF0aW5nUmVjdCBpcyBvbiBsaW5lIGJldHdlZW4gdG9SZWN0ICYgZnJvbVJlY3RcbiAgICAgICAgICAoYW5pbWF0aW5nUmVjdC50b3AgLSB0b1JlY3QudG9wKSAvIChhbmltYXRpbmdSZWN0LmxlZnQgLSB0b1JlY3QubGVmdCkgPT09IChmcm9tUmVjdC50b3AgLSB0b1JlY3QudG9wKSAvIChmcm9tUmVjdC5sZWZ0IC0gdG9SZWN0LmxlZnQpKSB7XG4gICAgICAgICAgICAvLyBJZiByZXR1cm5pbmcgdG8gc2FtZSBwbGFjZSBhcyBzdGFydGVkIGZyb20gYW5pbWF0aW9uIGFuZCBvbiBzYW1lIGF4aXNcbiAgICAgICAgICAgIHRpbWUgPSBjYWxjdWxhdGVSZWFsVGltZShhbmltYXRpbmdSZWN0LCBwcmV2RnJvbVJlY3QsIHByZXZUb1JlY3QsIF90aGlzLm9wdGlvbnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIGZyb21SZWN0ICE9IHRvUmVjdDogYW5pbWF0ZVxuICAgICAgICBpZiAoIWlzUmVjdEVxdWFsKHRvUmVjdCwgZnJvbVJlY3QpKSB7XG4gICAgICAgICAgdGFyZ2V0LnByZXZGcm9tUmVjdCA9IGZyb21SZWN0O1xuICAgICAgICAgIHRhcmdldC5wcmV2VG9SZWN0ID0gdG9SZWN0O1xuICAgICAgICAgIGlmICghdGltZSkge1xuICAgICAgICAgICAgdGltZSA9IF90aGlzLm9wdGlvbnMuYW5pbWF0aW9uO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfdGhpcy5hbmltYXRlKHRhcmdldCwgYW5pbWF0aW5nUmVjdCwgdG9SZWN0LCB0aW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZSkge1xuICAgICAgICAgIGFuaW1hdGluZyA9IHRydWU7XG4gICAgICAgICAgYW5pbWF0aW9uVGltZSA9IE1hdGgubWF4KGFuaW1hdGlvblRpbWUsIHRpbWUpO1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0YXJnZXQuYW5pbWF0aW9uUmVzZXRUaW1lcik7XG4gICAgICAgICAgdGFyZ2V0LmFuaW1hdGlvblJlc2V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRhcmdldC5hbmltYXRpb25UaW1lID0gMDtcbiAgICAgICAgICAgIHRhcmdldC5wcmV2RnJvbVJlY3QgPSBudWxsO1xuICAgICAgICAgICAgdGFyZ2V0LmZyb21SZWN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRhcmdldC5wcmV2VG9SZWN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRhcmdldC50aGlzQW5pbWF0aW9uRHVyYXRpb24gPSBudWxsO1xuICAgICAgICAgIH0sIHRpbWUpO1xuICAgICAgICAgIHRhcmdldC50aGlzQW5pbWF0aW9uRHVyYXRpb24gPSB0aW1lO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNsZWFyVGltZW91dChhbmltYXRpb25DYWxsYmFja0lkKTtcbiAgICAgIGlmICghYW5pbWF0aW5nKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIGNhbGxiYWNrKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhbmltYXRpb25DYWxsYmFja0lkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgY2FsbGJhY2soKTtcbiAgICAgICAgfSwgYW5pbWF0aW9uVGltZSk7XG4gICAgICB9XG4gICAgICBhbmltYXRpb25TdGF0ZXMgPSBbXTtcbiAgICB9LFxuICAgIGFuaW1hdGU6IGZ1bmN0aW9uIGFuaW1hdGUodGFyZ2V0LCBjdXJyZW50UmVjdCwgdG9SZWN0LCBkdXJhdGlvbikge1xuICAgICAgaWYgKGR1cmF0aW9uKSB7XG4gICAgICAgIGNzcyh0YXJnZXQsICd0cmFuc2l0aW9uJywgJycpO1xuICAgICAgICBjc3ModGFyZ2V0LCAndHJhbnNmb3JtJywgJycpO1xuICAgICAgICB2YXIgZWxNYXRyaXggPSBtYXRyaXgodGhpcy5lbCksXG4gICAgICAgICAgc2NhbGVYID0gZWxNYXRyaXggJiYgZWxNYXRyaXguYSxcbiAgICAgICAgICBzY2FsZVkgPSBlbE1hdHJpeCAmJiBlbE1hdHJpeC5kLFxuICAgICAgICAgIHRyYW5zbGF0ZVggPSAoY3VycmVudFJlY3QubGVmdCAtIHRvUmVjdC5sZWZ0KSAvIChzY2FsZVggfHwgMSksXG4gICAgICAgICAgdHJhbnNsYXRlWSA9IChjdXJyZW50UmVjdC50b3AgLSB0b1JlY3QudG9wKSAvIChzY2FsZVkgfHwgMSk7XG4gICAgICAgIHRhcmdldC5hbmltYXRpbmdYID0gISF0cmFuc2xhdGVYO1xuICAgICAgICB0YXJnZXQuYW5pbWF0aW5nWSA9ICEhdHJhbnNsYXRlWTtcbiAgICAgICAgY3NzKHRhcmdldCwgJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUzZCgnICsgdHJhbnNsYXRlWCArICdweCwnICsgdHJhbnNsYXRlWSArICdweCwwKScpO1xuICAgICAgICB0aGlzLmZvclJlcGFpbnREdW1teSA9IHJlcGFpbnQodGFyZ2V0KTsgLy8gcmVwYWludFxuXG4gICAgICAgIGNzcyh0YXJnZXQsICd0cmFuc2l0aW9uJywgJ3RyYW5zZm9ybSAnICsgZHVyYXRpb24gKyAnbXMnICsgKHRoaXMub3B0aW9ucy5lYXNpbmcgPyAnICcgKyB0aGlzLm9wdGlvbnMuZWFzaW5nIDogJycpKTtcbiAgICAgICAgY3NzKHRhcmdldCwgJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUzZCgwLDAsMCknKTtcbiAgICAgICAgdHlwZW9mIHRhcmdldC5hbmltYXRlZCA9PT0gJ251bWJlcicgJiYgY2xlYXJUaW1lb3V0KHRhcmdldC5hbmltYXRlZCk7XG4gICAgICAgIHRhcmdldC5hbmltYXRlZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNzcyh0YXJnZXQsICd0cmFuc2l0aW9uJywgJycpO1xuICAgICAgICAgIGNzcyh0YXJnZXQsICd0cmFuc2Zvcm0nLCAnJyk7XG4gICAgICAgICAgdGFyZ2V0LmFuaW1hdGVkID0gZmFsc2U7XG4gICAgICAgICAgdGFyZ2V0LmFuaW1hdGluZ1ggPSBmYWxzZTtcbiAgICAgICAgICB0YXJnZXQuYW5pbWF0aW5nWSA9IGZhbHNlO1xuICAgICAgICB9LCBkdXJhdGlvbik7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gcmVwYWludCh0YXJnZXQpIHtcbiAgcmV0dXJuIHRhcmdldC5vZmZzZXRXaWR0aDtcbn1cbmZ1bmN0aW9uIGNhbGN1bGF0ZVJlYWxUaW1lKGFuaW1hdGluZ1JlY3QsIGZyb21SZWN0LCB0b1JlY3QsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhmcm9tUmVjdC50b3AgLSBhbmltYXRpbmdSZWN0LnRvcCwgMikgKyBNYXRoLnBvdyhmcm9tUmVjdC5sZWZ0IC0gYW5pbWF0aW5nUmVjdC5sZWZ0LCAyKSkgLyBNYXRoLnNxcnQoTWF0aC5wb3coZnJvbVJlY3QudG9wIC0gdG9SZWN0LnRvcCwgMikgKyBNYXRoLnBvdyhmcm9tUmVjdC5sZWZ0IC0gdG9SZWN0LmxlZnQsIDIpKSAqIG9wdGlvbnMuYW5pbWF0aW9uO1xufVxuXG52YXIgcGx1Z2lucyA9IFtdO1xudmFyIGRlZmF1bHRzID0ge1xuICBpbml0aWFsaXplQnlEZWZhdWx0OiB0cnVlXG59O1xudmFyIFBsdWdpbk1hbmFnZXIgPSB7XG4gIG1vdW50OiBmdW5jdGlvbiBtb3VudChwbHVnaW4pIHtcbiAgICAvLyBTZXQgZGVmYXVsdCBzdGF0aWMgcHJvcGVydGllc1xuICAgIGZvciAodmFyIG9wdGlvbiBpbiBkZWZhdWx0cykge1xuICAgICAgaWYgKGRlZmF1bHRzLmhhc093blByb3BlcnR5KG9wdGlvbikgJiYgIShvcHRpb24gaW4gcGx1Z2luKSkge1xuICAgICAgICBwbHVnaW5bb3B0aW9uXSA9IGRlZmF1bHRzW29wdGlvbl07XG4gICAgICB9XG4gICAgfVxuICAgIHBsdWdpbnMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuICAgICAgaWYgKHAucGx1Z2luTmFtZSA9PT0gcGx1Z2luLnBsdWdpbk5hbWUpIHtcbiAgICAgICAgdGhyb3cgXCJTb3J0YWJsZTogQ2Fubm90IG1vdW50IHBsdWdpbiBcIi5jb25jYXQocGx1Z2luLnBsdWdpbk5hbWUsIFwiIG1vcmUgdGhhbiBvbmNlXCIpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHBsdWdpbnMucHVzaChwbHVnaW4pO1xuICB9LFxuICBwbHVnaW5FdmVudDogZnVuY3Rpb24gcGx1Z2luRXZlbnQoZXZlbnROYW1lLCBzb3J0YWJsZSwgZXZ0KSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICB0aGlzLmV2ZW50Q2FuY2VsZWQgPSBmYWxzZTtcbiAgICBldnQuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuZXZlbnRDYW5jZWxlZCA9IHRydWU7XG4gICAgfTtcbiAgICB2YXIgZXZlbnROYW1lR2xvYmFsID0gZXZlbnROYW1lICsgJ0dsb2JhbCc7XG4gICAgcGx1Z2lucy5mb3JFYWNoKGZ1bmN0aW9uIChwbHVnaW4pIHtcbiAgICAgIGlmICghc29ydGFibGVbcGx1Z2luLnBsdWdpbk5hbWVdKSByZXR1cm47XG4gICAgICAvLyBGaXJlIGdsb2JhbCBldmVudHMgaWYgaXQgZXhpc3RzIGluIHRoaXMgc29ydGFibGVcbiAgICAgIGlmIChzb3J0YWJsZVtwbHVnaW4ucGx1Z2luTmFtZV1bZXZlbnROYW1lR2xvYmFsXSkge1xuICAgICAgICBzb3J0YWJsZVtwbHVnaW4ucGx1Z2luTmFtZV1bZXZlbnROYW1lR2xvYmFsXShfb2JqZWN0U3ByZWFkMih7XG4gICAgICAgICAgc29ydGFibGU6IHNvcnRhYmxlXG4gICAgICAgIH0sIGV2dCkpO1xuICAgICAgfVxuXG4gICAgICAvLyBPbmx5IGZpcmUgcGx1Z2luIGV2ZW50IGlmIHBsdWdpbiBpcyBlbmFibGVkIGluIHRoaXMgc29ydGFibGUsXG4gICAgICAvLyBhbmQgcGx1Z2luIGhhcyBldmVudCBkZWZpbmVkXG4gICAgICBpZiAoc29ydGFibGUub3B0aW9uc1twbHVnaW4ucGx1Z2luTmFtZV0gJiYgc29ydGFibGVbcGx1Z2luLnBsdWdpbk5hbWVdW2V2ZW50TmFtZV0pIHtcbiAgICAgICAgc29ydGFibGVbcGx1Z2luLnBsdWdpbk5hbWVdW2V2ZW50TmFtZV0oX29iamVjdFNwcmVhZDIoe1xuICAgICAgICAgIHNvcnRhYmxlOiBzb3J0YWJsZVxuICAgICAgICB9LCBldnQpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcbiAgaW5pdGlhbGl6ZVBsdWdpbnM6IGZ1bmN0aW9uIGluaXRpYWxpemVQbHVnaW5zKHNvcnRhYmxlLCBlbCwgZGVmYXVsdHMsIG9wdGlvbnMpIHtcbiAgICBwbHVnaW5zLmZvckVhY2goZnVuY3Rpb24gKHBsdWdpbikge1xuICAgICAgdmFyIHBsdWdpbk5hbWUgPSBwbHVnaW4ucGx1Z2luTmFtZTtcbiAgICAgIGlmICghc29ydGFibGUub3B0aW9uc1twbHVnaW5OYW1lXSAmJiAhcGx1Z2luLmluaXRpYWxpemVCeURlZmF1bHQpIHJldHVybjtcbiAgICAgIHZhciBpbml0aWFsaXplZCA9IG5ldyBwbHVnaW4oc29ydGFibGUsIGVsLCBzb3J0YWJsZS5vcHRpb25zKTtcbiAgICAgIGluaXRpYWxpemVkLnNvcnRhYmxlID0gc29ydGFibGU7XG4gICAgICBpbml0aWFsaXplZC5vcHRpb25zID0gc29ydGFibGUub3B0aW9ucztcbiAgICAgIHNvcnRhYmxlW3BsdWdpbk5hbWVdID0gaW5pdGlhbGl6ZWQ7XG5cbiAgICAgIC8vIEFkZCBkZWZhdWx0IG9wdGlvbnMgZnJvbSBwbHVnaW5cbiAgICAgIF9leHRlbmRzKGRlZmF1bHRzLCBpbml0aWFsaXplZC5kZWZhdWx0cyk7XG4gICAgfSk7XG4gICAgZm9yICh2YXIgb3B0aW9uIGluIHNvcnRhYmxlLm9wdGlvbnMpIHtcbiAgICAgIGlmICghc29ydGFibGUub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShvcHRpb24pKSBjb250aW51ZTtcbiAgICAgIHZhciBtb2RpZmllZCA9IHRoaXMubW9kaWZ5T3B0aW9uKHNvcnRhYmxlLCBvcHRpb24sIHNvcnRhYmxlLm9wdGlvbnNbb3B0aW9uXSk7XG4gICAgICBpZiAodHlwZW9mIG1vZGlmaWVkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBzb3J0YWJsZS5vcHRpb25zW29wdGlvbl0gPSBtb2RpZmllZDtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGdldEV2ZW50UHJvcGVydGllczogZnVuY3Rpb24gZ2V0RXZlbnRQcm9wZXJ0aWVzKG5hbWUsIHNvcnRhYmxlKSB7XG4gICAgdmFyIGV2ZW50UHJvcGVydGllcyA9IHt9O1xuICAgIHBsdWdpbnMuZm9yRWFjaChmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgICBpZiAodHlwZW9mIHBsdWdpbi5ldmVudFByb3BlcnRpZXMgIT09ICdmdW5jdGlvbicpIHJldHVybjtcbiAgICAgIF9leHRlbmRzKGV2ZW50UHJvcGVydGllcywgcGx1Z2luLmV2ZW50UHJvcGVydGllcy5jYWxsKHNvcnRhYmxlW3BsdWdpbi5wbHVnaW5OYW1lXSwgbmFtZSkpO1xuICAgIH0pO1xuICAgIHJldHVybiBldmVudFByb3BlcnRpZXM7XG4gIH0sXG4gIG1vZGlmeU9wdGlvbjogZnVuY3Rpb24gbW9kaWZ5T3B0aW9uKHNvcnRhYmxlLCBuYW1lLCB2YWx1ZSkge1xuICAgIHZhciBtb2RpZmllZFZhbHVlO1xuICAgIHBsdWdpbnMuZm9yRWFjaChmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgICAvLyBQbHVnaW4gbXVzdCBleGlzdCBvbiB0aGUgU29ydGFibGVcbiAgICAgIGlmICghc29ydGFibGVbcGx1Z2luLnBsdWdpbk5hbWVdKSByZXR1cm47XG5cbiAgICAgIC8vIElmIHN0YXRpYyBvcHRpb24gbGlzdGVuZXIgZXhpc3RzIGZvciB0aGlzIG9wdGlvbiwgY2FsbCBpbiB0aGUgY29udGV4dCBvZiB0aGUgU29ydGFibGUncyBpbnN0YW5jZSBvZiB0aGlzIHBsdWdpblxuICAgICAgaWYgKHBsdWdpbi5vcHRpb25MaXN0ZW5lcnMgJiYgdHlwZW9mIHBsdWdpbi5vcHRpb25MaXN0ZW5lcnNbbmFtZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgbW9kaWZpZWRWYWx1ZSA9IHBsdWdpbi5vcHRpb25MaXN0ZW5lcnNbbmFtZV0uY2FsbChzb3J0YWJsZVtwbHVnaW4ucGx1Z2luTmFtZV0sIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbW9kaWZpZWRWYWx1ZTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZGlzcGF0Y2hFdmVudChfcmVmKSB7XG4gIHZhciBzb3J0YWJsZSA9IF9yZWYuc29ydGFibGUsXG4gICAgcm9vdEVsID0gX3JlZi5yb290RWwsXG4gICAgbmFtZSA9IF9yZWYubmFtZSxcbiAgICB0YXJnZXRFbCA9IF9yZWYudGFyZ2V0RWwsXG4gICAgY2xvbmVFbCA9IF9yZWYuY2xvbmVFbCxcbiAgICB0b0VsID0gX3JlZi50b0VsLFxuICAgIGZyb21FbCA9IF9yZWYuZnJvbUVsLFxuICAgIG9sZEluZGV4ID0gX3JlZi5vbGRJbmRleCxcbiAgICBuZXdJbmRleCA9IF9yZWYubmV3SW5kZXgsXG4gICAgb2xkRHJhZ2dhYmxlSW5kZXggPSBfcmVmLm9sZERyYWdnYWJsZUluZGV4LFxuICAgIG5ld0RyYWdnYWJsZUluZGV4ID0gX3JlZi5uZXdEcmFnZ2FibGVJbmRleCxcbiAgICBvcmlnaW5hbEV2ZW50ID0gX3JlZi5vcmlnaW5hbEV2ZW50LFxuICAgIHB1dFNvcnRhYmxlID0gX3JlZi5wdXRTb3J0YWJsZSxcbiAgICBleHRyYUV2ZW50UHJvcGVydGllcyA9IF9yZWYuZXh0cmFFdmVudFByb3BlcnRpZXM7XG4gIHNvcnRhYmxlID0gc29ydGFibGUgfHwgcm9vdEVsICYmIHJvb3RFbFtleHBhbmRvXTtcbiAgaWYgKCFzb3J0YWJsZSkgcmV0dXJuO1xuICB2YXIgZXZ0LFxuICAgIG9wdGlvbnMgPSBzb3J0YWJsZS5vcHRpb25zLFxuICAgIG9uTmFtZSA9ICdvbicgKyBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zdWJzdHIoMSk7XG4gIC8vIFN1cHBvcnQgZm9yIG5ldyBDdXN0b21FdmVudCBmZWF0dXJlXG4gIGlmICh3aW5kb3cuQ3VzdG9tRXZlbnQgJiYgIUlFMTFPckxlc3MgJiYgIUVkZ2UpIHtcbiAgICBldnQgPSBuZXcgQ3VzdG9tRXZlbnQobmFtZSwge1xuICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTtcbiAgICBldnQuaW5pdEV2ZW50KG5hbWUsIHRydWUsIHRydWUpO1xuICB9XG4gIGV2dC50byA9IHRvRWwgfHwgcm9vdEVsO1xuICBldnQuZnJvbSA9IGZyb21FbCB8fCByb290RWw7XG4gIGV2dC5pdGVtID0gdGFyZ2V0RWwgfHwgcm9vdEVsO1xuICBldnQuY2xvbmUgPSBjbG9uZUVsO1xuICBldnQub2xkSW5kZXggPSBvbGRJbmRleDtcbiAgZXZ0Lm5ld0luZGV4ID0gbmV3SW5kZXg7XG4gIGV2dC5vbGREcmFnZ2FibGVJbmRleCA9IG9sZERyYWdnYWJsZUluZGV4O1xuICBldnQubmV3RHJhZ2dhYmxlSW5kZXggPSBuZXdEcmFnZ2FibGVJbmRleDtcbiAgZXZ0Lm9yaWdpbmFsRXZlbnQgPSBvcmlnaW5hbEV2ZW50O1xuICBldnQucHVsbE1vZGUgPSBwdXRTb3J0YWJsZSA/IHB1dFNvcnRhYmxlLmxhc3RQdXRNb2RlIDogdW5kZWZpbmVkO1xuICB2YXIgYWxsRXZlbnRQcm9wZXJ0aWVzID0gX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIGV4dHJhRXZlbnRQcm9wZXJ0aWVzKSwgUGx1Z2luTWFuYWdlci5nZXRFdmVudFByb3BlcnRpZXMobmFtZSwgc29ydGFibGUpKTtcbiAgZm9yICh2YXIgb3B0aW9uIGluIGFsbEV2ZW50UHJvcGVydGllcykge1xuICAgIGV2dFtvcHRpb25dID0gYWxsRXZlbnRQcm9wZXJ0aWVzW29wdGlvbl07XG4gIH1cbiAgaWYgKHJvb3RFbCkge1xuICAgIHJvb3RFbC5kaXNwYXRjaEV2ZW50KGV2dCk7XG4gIH1cbiAgaWYgKG9wdGlvbnNbb25OYW1lXSkge1xuICAgIG9wdGlvbnNbb25OYW1lXS5jYWxsKHNvcnRhYmxlLCBldnQpO1xuICB9XG59XG5cbnZhciBfZXhjbHVkZWQgPSBbXCJldnRcIl07XG52YXIgcGx1Z2luRXZlbnQgPSBmdW5jdGlvbiBwbHVnaW5FdmVudChldmVudE5hbWUsIHNvcnRhYmxlKSB7XG4gIHZhciBfcmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fSxcbiAgICBvcmlnaW5hbEV2ZW50ID0gX3JlZi5ldnQsXG4gICAgZGF0YSA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfcmVmLCBfZXhjbHVkZWQpO1xuICBQbHVnaW5NYW5hZ2VyLnBsdWdpbkV2ZW50LmJpbmQoU29ydGFibGUpKGV2ZW50TmFtZSwgc29ydGFibGUsIF9vYmplY3RTcHJlYWQyKHtcbiAgICBkcmFnRWw6IGRyYWdFbCxcbiAgICBwYXJlbnRFbDogcGFyZW50RWwsXG4gICAgZ2hvc3RFbDogZ2hvc3RFbCxcbiAgICByb290RWw6IHJvb3RFbCxcbiAgICBuZXh0RWw6IG5leHRFbCxcbiAgICBsYXN0RG93bkVsOiBsYXN0RG93bkVsLFxuICAgIGNsb25lRWw6IGNsb25lRWwsXG4gICAgY2xvbmVIaWRkZW46IGNsb25lSGlkZGVuLFxuICAgIGRyYWdTdGFydGVkOiBtb3ZlZCxcbiAgICBwdXRTb3J0YWJsZTogcHV0U29ydGFibGUsXG4gICAgYWN0aXZlU29ydGFibGU6IFNvcnRhYmxlLmFjdGl2ZSxcbiAgICBvcmlnaW5hbEV2ZW50OiBvcmlnaW5hbEV2ZW50LFxuICAgIG9sZEluZGV4OiBvbGRJbmRleCxcbiAgICBvbGREcmFnZ2FibGVJbmRleDogb2xkRHJhZ2dhYmxlSW5kZXgsXG4gICAgbmV3SW5kZXg6IG5ld0luZGV4LFxuICAgIG5ld0RyYWdnYWJsZUluZGV4OiBuZXdEcmFnZ2FibGVJbmRleCxcbiAgICBoaWRlR2hvc3RGb3JUYXJnZXQ6IF9oaWRlR2hvc3RGb3JUYXJnZXQsXG4gICAgdW5oaWRlR2hvc3RGb3JUYXJnZXQ6IF91bmhpZGVHaG9zdEZvclRhcmdldCxcbiAgICBjbG9uZU5vd0hpZGRlbjogZnVuY3Rpb24gY2xvbmVOb3dIaWRkZW4oKSB7XG4gICAgICBjbG9uZUhpZGRlbiA9IHRydWU7XG4gICAgfSxcbiAgICBjbG9uZU5vd1Nob3duOiBmdW5jdGlvbiBjbG9uZU5vd1Nob3duKCkge1xuICAgICAgY2xvbmVIaWRkZW4gPSBmYWxzZTtcbiAgICB9LFxuICAgIGRpc3BhdGNoU29ydGFibGVFdmVudDogZnVuY3Rpb24gZGlzcGF0Y2hTb3J0YWJsZUV2ZW50KG5hbWUpIHtcbiAgICAgIF9kaXNwYXRjaEV2ZW50KHtcbiAgICAgICAgc29ydGFibGU6IHNvcnRhYmxlLFxuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBvcmlnaW5hbEV2ZW50OiBvcmlnaW5hbEV2ZW50XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIGRhdGEpKTtcbn07XG5mdW5jdGlvbiBfZGlzcGF0Y2hFdmVudChpbmZvKSB7XG4gIGRpc3BhdGNoRXZlbnQoX29iamVjdFNwcmVhZDIoe1xuICAgIHB1dFNvcnRhYmxlOiBwdXRTb3J0YWJsZSxcbiAgICBjbG9uZUVsOiBjbG9uZUVsLFxuICAgIHRhcmdldEVsOiBkcmFnRWwsXG4gICAgcm9vdEVsOiByb290RWwsXG4gICAgb2xkSW5kZXg6IG9sZEluZGV4LFxuICAgIG9sZERyYWdnYWJsZUluZGV4OiBvbGREcmFnZ2FibGVJbmRleCxcbiAgICBuZXdJbmRleDogbmV3SW5kZXgsXG4gICAgbmV3RHJhZ2dhYmxlSW5kZXg6IG5ld0RyYWdnYWJsZUluZGV4XG4gIH0sIGluZm8pKTtcbn1cbnZhciBkcmFnRWwsXG4gIHBhcmVudEVsLFxuICBnaG9zdEVsLFxuICByb290RWwsXG4gIG5leHRFbCxcbiAgbGFzdERvd25FbCxcbiAgY2xvbmVFbCxcbiAgY2xvbmVIaWRkZW4sXG4gIG9sZEluZGV4LFxuICBuZXdJbmRleCxcbiAgb2xkRHJhZ2dhYmxlSW5kZXgsXG4gIG5ld0RyYWdnYWJsZUluZGV4LFxuICBhY3RpdmVHcm91cCxcbiAgcHV0U29ydGFibGUsXG4gIGF3YWl0aW5nRHJhZ1N0YXJ0ZWQgPSBmYWxzZSxcbiAgaWdub3JlTmV4dENsaWNrID0gZmFsc2UsXG4gIHNvcnRhYmxlcyA9IFtdLFxuICB0YXBFdnQsXG4gIHRvdWNoRXZ0LFxuICBsYXN0RHgsXG4gIGxhc3REeSxcbiAgdGFwRGlzdGFuY2VMZWZ0LFxuICB0YXBEaXN0YW5jZVRvcCxcbiAgbW92ZWQsXG4gIGxhc3RUYXJnZXQsXG4gIGxhc3REaXJlY3Rpb24sXG4gIHBhc3RGaXJzdEludmVydFRocmVzaCA9IGZhbHNlLFxuICBpc0NpcmN1bXN0YW50aWFsSW52ZXJ0ID0gZmFsc2UsXG4gIHRhcmdldE1vdmVEaXN0YW5jZSxcbiAgLy8gRm9yIHBvc2l0aW9uaW5nIGdob3N0IGFic29sdXRlbHlcbiAgZ2hvc3RSZWxhdGl2ZVBhcmVudCxcbiAgZ2hvc3RSZWxhdGl2ZVBhcmVudEluaXRpYWxTY3JvbGwgPSBbXSxcbiAgLy8gKGxlZnQsIHRvcClcblxuICBfc2lsZW50ID0gZmFsc2UsXG4gIHNhdmVkSW5wdXRDaGVja2VkID0gW107XG5cbi8qKiBAY29uc3QgKi9cbnZhciBkb2N1bWVudEV4aXN0cyA9IHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcsXG4gIFBvc2l0aW9uR2hvc3RBYnNvbHV0ZWx5ID0gSU9TLFxuICBDU1NGbG9hdFByb3BlcnR5ID0gRWRnZSB8fCBJRTExT3JMZXNzID8gJ2Nzc0Zsb2F0JyA6ICdmbG9hdCcsXG4gIC8vIFRoaXMgd2lsbCBub3QgcGFzcyBmb3IgSUU5LCBiZWNhdXNlIElFOSBEbkQgb25seSB3b3JrcyBvbiBhbmNob3JzXG4gIHN1cHBvcnREcmFnZ2FibGUgPSBkb2N1bWVudEV4aXN0cyAmJiAhQ2hyb21lRm9yQW5kcm9pZCAmJiAhSU9TICYmICdkcmFnZ2FibGUnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICBzdXBwb3J0Q3NzUG9pbnRlckV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWRvY3VtZW50RXhpc3RzKSByZXR1cm47XG4gICAgLy8gZmFsc2Ugd2hlbiA8PSBJRTExXG4gICAgaWYgKElFMTFPckxlc3MpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgneCcpO1xuICAgIGVsLnN0eWxlLmNzc1RleHQgPSAncG9pbnRlci1ldmVudHM6YXV0byc7XG4gICAgcmV0dXJuIGVsLnN0eWxlLnBvaW50ZXJFdmVudHMgPT09ICdhdXRvJztcbiAgfSgpLFxuICBfZGV0ZWN0RGlyZWN0aW9uID0gZnVuY3Rpb24gX2RldGVjdERpcmVjdGlvbihlbCwgb3B0aW9ucykge1xuICAgIHZhciBlbENTUyA9IGNzcyhlbCksXG4gICAgICBlbFdpZHRoID0gcGFyc2VJbnQoZWxDU1Mud2lkdGgpIC0gcGFyc2VJbnQoZWxDU1MucGFkZGluZ0xlZnQpIC0gcGFyc2VJbnQoZWxDU1MucGFkZGluZ1JpZ2h0KSAtIHBhcnNlSW50KGVsQ1NTLmJvcmRlckxlZnRXaWR0aCkgLSBwYXJzZUludChlbENTUy5ib3JkZXJSaWdodFdpZHRoKSxcbiAgICAgIGNoaWxkMSA9IGdldENoaWxkKGVsLCAwLCBvcHRpb25zKSxcbiAgICAgIGNoaWxkMiA9IGdldENoaWxkKGVsLCAxLCBvcHRpb25zKSxcbiAgICAgIGZpcnN0Q2hpbGRDU1MgPSBjaGlsZDEgJiYgY3NzKGNoaWxkMSksXG4gICAgICBzZWNvbmRDaGlsZENTUyA9IGNoaWxkMiAmJiBjc3MoY2hpbGQyKSxcbiAgICAgIGZpcnN0Q2hpbGRXaWR0aCA9IGZpcnN0Q2hpbGRDU1MgJiYgcGFyc2VJbnQoZmlyc3RDaGlsZENTUy5tYXJnaW5MZWZ0KSArIHBhcnNlSW50KGZpcnN0Q2hpbGRDU1MubWFyZ2luUmlnaHQpICsgZ2V0UmVjdChjaGlsZDEpLndpZHRoLFxuICAgICAgc2Vjb25kQ2hpbGRXaWR0aCA9IHNlY29uZENoaWxkQ1NTICYmIHBhcnNlSW50KHNlY29uZENoaWxkQ1NTLm1hcmdpbkxlZnQpICsgcGFyc2VJbnQoc2Vjb25kQ2hpbGRDU1MubWFyZ2luUmlnaHQpICsgZ2V0UmVjdChjaGlsZDIpLndpZHRoO1xuICAgIGlmIChlbENTUy5kaXNwbGF5ID09PSAnZmxleCcpIHtcbiAgICAgIHJldHVybiBlbENTUy5mbGV4RGlyZWN0aW9uID09PSAnY29sdW1uJyB8fCBlbENTUy5mbGV4RGlyZWN0aW9uID09PSAnY29sdW1uLXJldmVyc2UnID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJztcbiAgICB9XG4gICAgaWYgKGVsQ1NTLmRpc3BsYXkgPT09ICdncmlkJykge1xuICAgICAgcmV0dXJuIGVsQ1NTLmdyaWRUZW1wbGF0ZUNvbHVtbnMuc3BsaXQoJyAnKS5sZW5ndGggPD0gMSA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCc7XG4gICAgfVxuICAgIGlmIChjaGlsZDEgJiYgZmlyc3RDaGlsZENTU1tcImZsb2F0XCJdICYmIGZpcnN0Q2hpbGRDU1NbXCJmbG9hdFwiXSAhPT0gJ25vbmUnKSB7XG4gICAgICB2YXIgdG91Y2hpbmdTaWRlQ2hpbGQyID0gZmlyc3RDaGlsZENTU1tcImZsb2F0XCJdID09PSAnbGVmdCcgPyAnbGVmdCcgOiAncmlnaHQnO1xuICAgICAgcmV0dXJuIGNoaWxkMiAmJiAoc2Vjb25kQ2hpbGRDU1MuY2xlYXIgPT09ICdib3RoJyB8fCBzZWNvbmRDaGlsZENTUy5jbGVhciA9PT0gdG91Y2hpbmdTaWRlQ2hpbGQyKSA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCc7XG4gICAgfVxuICAgIHJldHVybiBjaGlsZDEgJiYgKGZpcnN0Q2hpbGRDU1MuZGlzcGxheSA9PT0gJ2Jsb2NrJyB8fCBmaXJzdENoaWxkQ1NTLmRpc3BsYXkgPT09ICdmbGV4JyB8fCBmaXJzdENoaWxkQ1NTLmRpc3BsYXkgPT09ICd0YWJsZScgfHwgZmlyc3RDaGlsZENTUy5kaXNwbGF5ID09PSAnZ3JpZCcgfHwgZmlyc3RDaGlsZFdpZHRoID49IGVsV2lkdGggJiYgZWxDU1NbQ1NTRmxvYXRQcm9wZXJ0eV0gPT09ICdub25lJyB8fCBjaGlsZDIgJiYgZWxDU1NbQ1NTRmxvYXRQcm9wZXJ0eV0gPT09ICdub25lJyAmJiBmaXJzdENoaWxkV2lkdGggKyBzZWNvbmRDaGlsZFdpZHRoID4gZWxXaWR0aCkgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICB9LFxuICBfZHJhZ0VsSW5Sb3dDb2x1bW4gPSBmdW5jdGlvbiBfZHJhZ0VsSW5Sb3dDb2x1bW4oZHJhZ1JlY3QsIHRhcmdldFJlY3QsIHZlcnRpY2FsKSB7XG4gICAgdmFyIGRyYWdFbFMxT3BwID0gdmVydGljYWwgPyBkcmFnUmVjdC5sZWZ0IDogZHJhZ1JlY3QudG9wLFxuICAgICAgZHJhZ0VsUzJPcHAgPSB2ZXJ0aWNhbCA/IGRyYWdSZWN0LnJpZ2h0IDogZHJhZ1JlY3QuYm90dG9tLFxuICAgICAgZHJhZ0VsT3BwTGVuZ3RoID0gdmVydGljYWwgPyBkcmFnUmVjdC53aWR0aCA6IGRyYWdSZWN0LmhlaWdodCxcbiAgICAgIHRhcmdldFMxT3BwID0gdmVydGljYWwgPyB0YXJnZXRSZWN0LmxlZnQgOiB0YXJnZXRSZWN0LnRvcCxcbiAgICAgIHRhcmdldFMyT3BwID0gdmVydGljYWwgPyB0YXJnZXRSZWN0LnJpZ2h0IDogdGFyZ2V0UmVjdC5ib3R0b20sXG4gICAgICB0YXJnZXRPcHBMZW5ndGggPSB2ZXJ0aWNhbCA/IHRhcmdldFJlY3Qud2lkdGggOiB0YXJnZXRSZWN0LmhlaWdodDtcbiAgICByZXR1cm4gZHJhZ0VsUzFPcHAgPT09IHRhcmdldFMxT3BwIHx8IGRyYWdFbFMyT3BwID09PSB0YXJnZXRTMk9wcCB8fCBkcmFnRWxTMU9wcCArIGRyYWdFbE9wcExlbmd0aCAvIDIgPT09IHRhcmdldFMxT3BwICsgdGFyZ2V0T3BwTGVuZ3RoIC8gMjtcbiAgfSxcbiAgLyoqXHJcbiAgICogRGV0ZWN0cyBmaXJzdCBuZWFyZXN0IGVtcHR5IHNvcnRhYmxlIHRvIFggYW5kIFkgcG9zaXRpb24gdXNpbmcgZW1wdHlJbnNlcnRUaHJlc2hvbGQuXHJcbiAgICogQHBhcmFtICB7TnVtYmVyfSB4ICAgICAgWCBwb3NpdGlvblxyXG4gICAqIEBwYXJhbSAge051bWJlcn0geSAgICAgIFkgcG9zaXRpb25cclxuICAgKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gICBFbGVtZW50IG9mIHRoZSBmaXJzdCBmb3VuZCBuZWFyZXN0IFNvcnRhYmxlXHJcbiAgICovXG4gIF9kZXRlY3ROZWFyZXN0RW1wdHlTb3J0YWJsZSA9IGZ1bmN0aW9uIF9kZXRlY3ROZWFyZXN0RW1wdHlTb3J0YWJsZSh4LCB5KSB7XG4gICAgdmFyIHJldDtcbiAgICBzb3J0YWJsZXMuc29tZShmdW5jdGlvbiAoc29ydGFibGUpIHtcbiAgICAgIHZhciB0aHJlc2hvbGQgPSBzb3J0YWJsZVtleHBhbmRvXS5vcHRpb25zLmVtcHR5SW5zZXJ0VGhyZXNob2xkO1xuICAgICAgaWYgKCF0aHJlc2hvbGQgfHwgbGFzdENoaWxkKHNvcnRhYmxlKSkgcmV0dXJuO1xuICAgICAgdmFyIHJlY3QgPSBnZXRSZWN0KHNvcnRhYmxlKSxcbiAgICAgICAgaW5zaWRlSG9yaXpvbnRhbGx5ID0geCA+PSByZWN0LmxlZnQgLSB0aHJlc2hvbGQgJiYgeCA8PSByZWN0LnJpZ2h0ICsgdGhyZXNob2xkLFxuICAgICAgICBpbnNpZGVWZXJ0aWNhbGx5ID0geSA+PSByZWN0LnRvcCAtIHRocmVzaG9sZCAmJiB5IDw9IHJlY3QuYm90dG9tICsgdGhyZXNob2xkO1xuICAgICAgaWYgKGluc2lkZUhvcml6b250YWxseSAmJiBpbnNpZGVWZXJ0aWNhbGx5KSB7XG4gICAgICAgIHJldHVybiByZXQgPSBzb3J0YWJsZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmV0O1xuICB9LFxuICBfcHJlcGFyZUdyb3VwID0gZnVuY3Rpb24gX3ByZXBhcmVHcm91cChvcHRpb25zKSB7XG4gICAgZnVuY3Rpb24gdG9Gbih2YWx1ZSwgcHVsbCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0bywgZnJvbSwgZHJhZ0VsLCBldnQpIHtcbiAgICAgICAgdmFyIHNhbWVHcm91cCA9IHRvLm9wdGlvbnMuZ3JvdXAubmFtZSAmJiBmcm9tLm9wdGlvbnMuZ3JvdXAubmFtZSAmJiB0by5vcHRpb25zLmdyb3VwLm5hbWUgPT09IGZyb20ub3B0aW9ucy5ncm91cC5uYW1lO1xuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCAmJiAocHVsbCB8fCBzYW1lR3JvdXApKSB7XG4gICAgICAgICAgLy8gRGVmYXVsdCBwdWxsIHZhbHVlXG4gICAgICAgICAgLy8gRGVmYXVsdCBwdWxsIGFuZCBwdXQgdmFsdWUgaWYgc2FtZSBncm91cFxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKHB1bGwgJiYgdmFsdWUgPT09ICdjbG9uZScpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgcmV0dXJuIHRvRm4odmFsdWUodG8sIGZyb20sIGRyYWdFbCwgZXZ0KSwgcHVsbCkodG8sIGZyb20sIGRyYWdFbCwgZXZ0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgb3RoZXJHcm91cCA9IChwdWxsID8gdG8gOiBmcm9tKS5vcHRpb25zLmdyb3VwLm5hbWU7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID09PSB0cnVlIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUgPT09IG90aGVyR3JvdXAgfHwgdmFsdWUuam9pbiAmJiB2YWx1ZS5pbmRleE9mKG90aGVyR3JvdXApID4gLTE7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIHZhciBncm91cCA9IHt9O1xuICAgIHZhciBvcmlnaW5hbEdyb3VwID0gb3B0aW9ucy5ncm91cDtcbiAgICBpZiAoIW9yaWdpbmFsR3JvdXAgfHwgX3R5cGVvZihvcmlnaW5hbEdyb3VwKSAhPSAnb2JqZWN0Jykge1xuICAgICAgb3JpZ2luYWxHcm91cCA9IHtcbiAgICAgICAgbmFtZTogb3JpZ2luYWxHcm91cFxuICAgICAgfTtcbiAgICB9XG4gICAgZ3JvdXAubmFtZSA9IG9yaWdpbmFsR3JvdXAubmFtZTtcbiAgICBncm91cC5jaGVja1B1bGwgPSB0b0ZuKG9yaWdpbmFsR3JvdXAucHVsbCwgdHJ1ZSk7XG4gICAgZ3JvdXAuY2hlY2tQdXQgPSB0b0ZuKG9yaWdpbmFsR3JvdXAucHV0KTtcbiAgICBncm91cC5yZXZlcnRDbG9uZSA9IG9yaWdpbmFsR3JvdXAucmV2ZXJ0Q2xvbmU7XG4gICAgb3B0aW9ucy5ncm91cCA9IGdyb3VwO1xuICB9LFxuICBfaGlkZUdob3N0Rm9yVGFyZ2V0ID0gZnVuY3Rpb24gX2hpZGVHaG9zdEZvclRhcmdldCgpIHtcbiAgICBpZiAoIXN1cHBvcnRDc3NQb2ludGVyRXZlbnRzICYmIGdob3N0RWwpIHtcbiAgICAgIGNzcyhnaG9zdEVsLCAnZGlzcGxheScsICdub25lJyk7XG4gICAgfVxuICB9LFxuICBfdW5oaWRlR2hvc3RGb3JUYXJnZXQgPSBmdW5jdGlvbiBfdW5oaWRlR2hvc3RGb3JUYXJnZXQoKSB7XG4gICAgaWYgKCFzdXBwb3J0Q3NzUG9pbnRlckV2ZW50cyAmJiBnaG9zdEVsKSB7XG4gICAgICBjc3MoZ2hvc3RFbCwgJ2Rpc3BsYXknLCAnJyk7XG4gICAgfVxuICB9O1xuXG4vLyAjMTE4NCBmaXggLSBQcmV2ZW50IGNsaWNrIGV2ZW50IG9uIGZhbGxiYWNrIGlmIGRyYWdnZWQgYnV0IGl0ZW0gbm90IGNoYW5nZWQgcG9zaXRpb25cbmlmIChkb2N1bWVudEV4aXN0cyAmJiAhQ2hyb21lRm9yQW5kcm9pZCkge1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAoaWdub3JlTmV4dENsaWNrKSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24gJiYgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgZXZ0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiAmJiBldnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICBpZ25vcmVOZXh0Q2xpY2sgPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sIHRydWUpO1xufVxudmFyIG5lYXJlc3RFbXB0eUluc2VydERldGVjdEV2ZW50ID0gZnVuY3Rpb24gbmVhcmVzdEVtcHR5SW5zZXJ0RGV0ZWN0RXZlbnQoZXZ0KSB7XG4gIGlmIChkcmFnRWwpIHtcbiAgICBldnQgPSBldnQudG91Y2hlcyA/IGV2dC50b3VjaGVzWzBdIDogZXZ0O1xuICAgIHZhciBuZWFyZXN0ID0gX2RldGVjdE5lYXJlc3RFbXB0eVNvcnRhYmxlKGV2dC5jbGllbnRYLCBldnQuY2xpZW50WSk7XG4gICAgaWYgKG5lYXJlc3QpIHtcbiAgICAgIC8vIENyZWF0ZSBpbWl0YXRpb24gZXZlbnRcbiAgICAgIHZhciBldmVudCA9IHt9O1xuICAgICAgZm9yICh2YXIgaSBpbiBldnQpIHtcbiAgICAgICAgaWYgKGV2dC5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgIGV2ZW50W2ldID0gZXZ0W2ldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBldmVudC50YXJnZXQgPSBldmVudC5yb290RWwgPSBuZWFyZXN0O1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQgPSB2b2lkIDA7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24gPSB2b2lkIDA7XG4gICAgICBuZWFyZXN0W2V4cGFuZG9dLl9vbkRyYWdPdmVyKGV2ZW50KTtcbiAgICB9XG4gIH1cbn07XG52YXIgX2NoZWNrT3V0c2lkZVRhcmdldEVsID0gZnVuY3Rpb24gX2NoZWNrT3V0c2lkZVRhcmdldEVsKGV2dCkge1xuICBpZiAoZHJhZ0VsKSB7XG4gICAgZHJhZ0VsLnBhcmVudE5vZGVbZXhwYW5kb10uX2lzT3V0c2lkZVRoaXNFbChldnQudGFyZ2V0KTtcbiAgfVxufTtcblxuLyoqXHJcbiAqIEBjbGFzcyAgU29ydGFibGVcclxuICogQHBhcmFtICB7SFRNTEVsZW1lbnR9ICBlbFxyXG4gKiBAcGFyYW0gIHtPYmplY3R9ICAgICAgIFtvcHRpb25zXVxyXG4gKi9cbmZ1bmN0aW9uIFNvcnRhYmxlKGVsLCBvcHRpb25zKSB7XG4gIGlmICghKGVsICYmIGVsLm5vZGVUeXBlICYmIGVsLm5vZGVUeXBlID09PSAxKSkge1xuICAgIHRocm93IFwiU29ydGFibGU6IGBlbGAgbXVzdCBiZSBhbiBIVE1MRWxlbWVudCwgbm90IFwiLmNvbmNhdCh7fS50b1N0cmluZy5jYWxsKGVsKSk7XG4gIH1cbiAgdGhpcy5lbCA9IGVsOyAvLyByb290IGVsZW1lbnRcbiAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyA9IF9leHRlbmRzKHt9LCBvcHRpb25zKTtcblxuICAvLyBFeHBvcnQgaW5zdGFuY2VcbiAgZWxbZXhwYW5kb10gPSB0aGlzO1xuICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgZ3JvdXA6IG51bGwsXG4gICAgc29ydDogdHJ1ZSxcbiAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgc3RvcmU6IG51bGwsXG4gICAgaGFuZGxlOiBudWxsLFxuICAgIGRyYWdnYWJsZTogL15bdW9dbCQvaS50ZXN0KGVsLm5vZGVOYW1lKSA/ICc+bGknIDogJz4qJyxcbiAgICBzd2FwVGhyZXNob2xkOiAxLFxuICAgIC8vIHBlcmNlbnRhZ2U7IDAgPD0geCA8PSAxXG4gICAgaW52ZXJ0U3dhcDogZmFsc2UsXG4gICAgLy8gaW52ZXJ0IGFsd2F5c1xuICAgIGludmVydGVkU3dhcFRocmVzaG9sZDogbnVsbCxcbiAgICAvLyB3aWxsIGJlIHNldCB0byBzYW1lIGFzIHN3YXBUaHJlc2hvbGQgaWYgZGVmYXVsdFxuICAgIHJlbW92ZUNsb25lT25IaWRlOiB0cnVlLFxuICAgIGRpcmVjdGlvbjogZnVuY3Rpb24gZGlyZWN0aW9uKCkge1xuICAgICAgcmV0dXJuIF9kZXRlY3REaXJlY3Rpb24oZWwsIHRoaXMub3B0aW9ucyk7XG4gICAgfSxcbiAgICBnaG9zdENsYXNzOiAnc29ydGFibGUtZ2hvc3QnLFxuICAgIGNob3NlbkNsYXNzOiAnc29ydGFibGUtY2hvc2VuJyxcbiAgICBkcmFnQ2xhc3M6ICdzb3J0YWJsZS1kcmFnJyxcbiAgICBpZ25vcmU6ICdhLCBpbWcnLFxuICAgIGZpbHRlcjogbnVsbCxcbiAgICBwcmV2ZW50T25GaWx0ZXI6IHRydWUsXG4gICAgYW5pbWF0aW9uOiAwLFxuICAgIGVhc2luZzogbnVsbCxcbiAgICBzZXREYXRhOiBmdW5jdGlvbiBzZXREYXRhKGRhdGFUcmFuc2ZlciwgZHJhZ0VsKSB7XG4gICAgICBkYXRhVHJhbnNmZXIuc2V0RGF0YSgnVGV4dCcsIGRyYWdFbC50ZXh0Q29udGVudCk7XG4gICAgfSxcbiAgICBkcm9wQnViYmxlOiBmYWxzZSxcbiAgICBkcmFnb3ZlckJ1YmJsZTogZmFsc2UsXG4gICAgZGF0YUlkQXR0cjogJ2RhdGEtaWQnLFxuICAgIGRlbGF5OiAwLFxuICAgIGRlbGF5T25Ub3VjaE9ubHk6IGZhbHNlLFxuICAgIHRvdWNoU3RhcnRUaHJlc2hvbGQ6IChOdW1iZXIucGFyc2VJbnQgPyBOdW1iZXIgOiB3aW5kb3cpLnBhcnNlSW50KHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCAxMCkgfHwgMSxcbiAgICBmb3JjZUZhbGxiYWNrOiBmYWxzZSxcbiAgICBmYWxsYmFja0NsYXNzOiAnc29ydGFibGUtZmFsbGJhY2snLFxuICAgIGZhbGxiYWNrT25Cb2R5OiBmYWxzZSxcbiAgICBmYWxsYmFja1RvbGVyYW5jZTogMCxcbiAgICBmYWxsYmFja09mZnNldDoge1xuICAgICAgeDogMCxcbiAgICAgIHk6IDBcbiAgICB9LFxuICAgIHN1cHBvcnRQb2ludGVyOiBTb3J0YWJsZS5zdXBwb3J0UG9pbnRlciAhPT0gZmFsc2UgJiYgJ1BvaW50ZXJFdmVudCcgaW4gd2luZG93ICYmICFTYWZhcmksXG4gICAgZW1wdHlJbnNlcnRUaHJlc2hvbGQ6IDVcbiAgfTtcbiAgUGx1Z2luTWFuYWdlci5pbml0aWFsaXplUGx1Z2lucyh0aGlzLCBlbCwgZGVmYXVsdHMpO1xuXG4gIC8vIFNldCBkZWZhdWx0IG9wdGlvbnNcbiAgZm9yICh2YXIgbmFtZSBpbiBkZWZhdWx0cykge1xuICAgICEobmFtZSBpbiBvcHRpb25zKSAmJiAob3B0aW9uc1tuYW1lXSA9IGRlZmF1bHRzW25hbWVdKTtcbiAgfVxuICBfcHJlcGFyZUdyb3VwKG9wdGlvbnMpO1xuXG4gIC8vIEJpbmQgYWxsIHByaXZhdGUgbWV0aG9kc1xuICBmb3IgKHZhciBmbiBpbiB0aGlzKSB7XG4gICAgaWYgKGZuLmNoYXJBdCgwKSA9PT0gJ18nICYmIHR5cGVvZiB0aGlzW2ZuXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhpc1tmbl0gPSB0aGlzW2ZuXS5iaW5kKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFNldHVwIGRyYWcgbW9kZVxuICB0aGlzLm5hdGl2ZURyYWdnYWJsZSA9IG9wdGlvbnMuZm9yY2VGYWxsYmFjayA/IGZhbHNlIDogc3VwcG9ydERyYWdnYWJsZTtcbiAgaWYgKHRoaXMubmF0aXZlRHJhZ2dhYmxlKSB7XG4gICAgLy8gVG91Y2ggc3RhcnQgdGhyZXNob2xkIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gdGhlIG5hdGl2ZSBkcmFnc3RhcnQgdGhyZXNob2xkXG4gICAgdGhpcy5vcHRpb25zLnRvdWNoU3RhcnRUaHJlc2hvbGQgPSAxO1xuICB9XG5cbiAgLy8gQmluZCBldmVudHNcbiAgaWYgKG9wdGlvbnMuc3VwcG9ydFBvaW50ZXIpIHtcbiAgICBvbihlbCwgJ3BvaW50ZXJkb3duJywgdGhpcy5fb25UYXBTdGFydCk7XG4gIH0gZWxzZSB7XG4gICAgb24oZWwsICdtb3VzZWRvd24nLCB0aGlzLl9vblRhcFN0YXJ0KTtcbiAgICBvbihlbCwgJ3RvdWNoc3RhcnQnLCB0aGlzLl9vblRhcFN0YXJ0KTtcbiAgfVxuICBpZiAodGhpcy5uYXRpdmVEcmFnZ2FibGUpIHtcbiAgICBvbihlbCwgJ2RyYWdvdmVyJywgdGhpcyk7XG4gICAgb24oZWwsICdkcmFnZW50ZXInLCB0aGlzKTtcbiAgfVxuICBzb3J0YWJsZXMucHVzaCh0aGlzLmVsKTtcblxuICAvLyBSZXN0b3JlIHNvcnRpbmdcbiAgb3B0aW9ucy5zdG9yZSAmJiBvcHRpb25zLnN0b3JlLmdldCAmJiB0aGlzLnNvcnQob3B0aW9ucy5zdG9yZS5nZXQodGhpcykgfHwgW10pO1xuXG4gIC8vIEFkZCBhbmltYXRpb24gc3RhdGUgbWFuYWdlclxuICBfZXh0ZW5kcyh0aGlzLCBBbmltYXRpb25TdGF0ZU1hbmFnZXIoKSk7XG59XG5Tb3J0YWJsZS5wcm90b3R5cGUgPSAvKiogQGxlbmRzIFNvcnRhYmxlLnByb3RvdHlwZSAqL3tcbiAgY29uc3RydWN0b3I6IFNvcnRhYmxlLFxuICBfaXNPdXRzaWRlVGhpc0VsOiBmdW5jdGlvbiBfaXNPdXRzaWRlVGhpc0VsKHRhcmdldCkge1xuICAgIGlmICghdGhpcy5lbC5jb250YWlucyh0YXJnZXQpICYmIHRhcmdldCAhPT0gdGhpcy5lbCkge1xuICAgICAgbGFzdFRhcmdldCA9IG51bGw7XG4gICAgfVxuICB9LFxuICBfZ2V0RGlyZWN0aW9uOiBmdW5jdGlvbiBfZ2V0RGlyZWN0aW9uKGV2dCwgdGFyZ2V0KSB7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uID09PSAnZnVuY3Rpb24nID8gdGhpcy5vcHRpb25zLmRpcmVjdGlvbi5jYWxsKHRoaXMsIGV2dCwgdGFyZ2V0LCBkcmFnRWwpIDogdGhpcy5vcHRpb25zLmRpcmVjdGlvbjtcbiAgfSxcbiAgX29uVGFwU3RhcnQ6IGZ1bmN0aW9uIF9vblRhcFN0YXJ0KCAvKiogRXZlbnR8VG91Y2hFdmVudCAqL2V2dCkge1xuICAgIGlmICghZXZ0LmNhbmNlbGFibGUpIHJldHVybjtcbiAgICB2YXIgX3RoaXMgPSB0aGlzLFxuICAgICAgZWwgPSB0aGlzLmVsLFxuICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgIHByZXZlbnRPbkZpbHRlciA9IG9wdGlvbnMucHJldmVudE9uRmlsdGVyLFxuICAgICAgdHlwZSA9IGV2dC50eXBlLFxuICAgICAgdG91Y2ggPSBldnQudG91Y2hlcyAmJiBldnQudG91Y2hlc1swXSB8fCBldnQucG9pbnRlclR5cGUgJiYgZXZ0LnBvaW50ZXJUeXBlID09PSAndG91Y2gnICYmIGV2dCxcbiAgICAgIHRhcmdldCA9ICh0b3VjaCB8fCBldnQpLnRhcmdldCxcbiAgICAgIG9yaWdpbmFsVGFyZ2V0ID0gZXZ0LnRhcmdldC5zaGFkb3dSb290ICYmIChldnQucGF0aCAmJiBldnQucGF0aFswXSB8fCBldnQuY29tcG9zZWRQYXRoICYmIGV2dC5jb21wb3NlZFBhdGgoKVswXSkgfHwgdGFyZ2V0LFxuICAgICAgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXI7XG4gICAgX3NhdmVJbnB1dENoZWNrZWRTdGF0ZShlbCk7XG5cbiAgICAvLyBEb24ndCB0cmlnZ2VyIHN0YXJ0IGV2ZW50IHdoZW4gYW4gZWxlbWVudCBpcyBiZWVuIGRyYWdnZWQsIG90aGVyd2lzZSB0aGUgZXZ0Lm9sZGluZGV4IGFsd2F5cyB3cm9uZyB3aGVuIHNldCBvcHRpb24uZ3JvdXAuXG4gICAgaWYgKGRyYWdFbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoL21vdXNlZG93bnxwb2ludGVyZG93bi8udGVzdCh0eXBlKSAmJiBldnQuYnV0dG9uICE9PSAwIHx8IG9wdGlvbnMuZGlzYWJsZWQpIHtcbiAgICAgIHJldHVybjsgLy8gb25seSBsZWZ0IGJ1dHRvbiBhbmQgZW5hYmxlZFxuICAgIH1cblxuICAgIC8vIGNhbmNlbCBkbmQgaWYgb3JpZ2luYWwgdGFyZ2V0IGlzIGNvbnRlbnQgZWRpdGFibGVcbiAgICBpZiAob3JpZ2luYWxUYXJnZXQuaXNDb250ZW50RWRpdGFibGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTYWZhcmkgaWdub3JlcyBmdXJ0aGVyIGV2ZW50IGhhbmRsaW5nIGFmdGVyIG1vdXNlZG93blxuICAgIGlmICghdGhpcy5uYXRpdmVEcmFnZ2FibGUgJiYgU2FmYXJpICYmIHRhcmdldCAmJiB0YXJnZXQudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09PSAnU0VMRUNUJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0YXJnZXQgPSBjbG9zZXN0KHRhcmdldCwgb3B0aW9ucy5kcmFnZ2FibGUsIGVsLCBmYWxzZSk7XG4gICAgaWYgKHRhcmdldCAmJiB0YXJnZXQuYW5pbWF0ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGxhc3REb3duRWwgPT09IHRhcmdldCkge1xuICAgICAgLy8gSWdub3JpbmcgZHVwbGljYXRlIGBkb3duYFxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgaW5kZXggb2YgdGhlIGRyYWdnZWQgZWxlbWVudCB3aXRoaW4gaXRzIHBhcmVudFxuICAgIG9sZEluZGV4ID0gaW5kZXgodGFyZ2V0KTtcbiAgICBvbGREcmFnZ2FibGVJbmRleCA9IGluZGV4KHRhcmdldCwgb3B0aW9ucy5kcmFnZ2FibGUpO1xuXG4gICAgLy8gQ2hlY2sgZmlsdGVyXG4gICAgaWYgKHR5cGVvZiBmaWx0ZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGlmIChmaWx0ZXIuY2FsbCh0aGlzLCBldnQsIHRhcmdldCwgdGhpcykpIHtcbiAgICAgICAgX2Rpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgIHNvcnRhYmxlOiBfdGhpcyxcbiAgICAgICAgICByb290RWw6IG9yaWdpbmFsVGFyZ2V0LFxuICAgICAgICAgIG5hbWU6ICdmaWx0ZXInLFxuICAgICAgICAgIHRhcmdldEVsOiB0YXJnZXQsXG4gICAgICAgICAgdG9FbDogZWwsXG4gICAgICAgICAgZnJvbUVsOiBlbFxuICAgICAgICB9KTtcbiAgICAgICAgcGx1Z2luRXZlbnQoJ2ZpbHRlcicsIF90aGlzLCB7XG4gICAgICAgICAgZXZ0OiBldnRcbiAgICAgICAgfSk7XG4gICAgICAgIHByZXZlbnRPbkZpbHRlciAmJiBldnQuY2FuY2VsYWJsZSAmJiBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuOyAvLyBjYW5jZWwgZG5kXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChmaWx0ZXIpIHtcbiAgICAgIGZpbHRlciA9IGZpbHRlci5zcGxpdCgnLCcpLnNvbWUoZnVuY3Rpb24gKGNyaXRlcmlhKSB7XG4gICAgICAgIGNyaXRlcmlhID0gY2xvc2VzdChvcmlnaW5hbFRhcmdldCwgY3JpdGVyaWEudHJpbSgpLCBlbCwgZmFsc2UpO1xuICAgICAgICBpZiAoY3JpdGVyaWEpIHtcbiAgICAgICAgICBfZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgICAgICBzb3J0YWJsZTogX3RoaXMsXG4gICAgICAgICAgICByb290RWw6IGNyaXRlcmlhLFxuICAgICAgICAgICAgbmFtZTogJ2ZpbHRlcicsXG4gICAgICAgICAgICB0YXJnZXRFbDogdGFyZ2V0LFxuICAgICAgICAgICAgZnJvbUVsOiBlbCxcbiAgICAgICAgICAgIHRvRWw6IGVsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcGx1Z2luRXZlbnQoJ2ZpbHRlcicsIF90aGlzLCB7XG4gICAgICAgICAgICBldnQ6IGV2dFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChmaWx0ZXIpIHtcbiAgICAgICAgcHJldmVudE9uRmlsdGVyICYmIGV2dC5jYW5jZWxhYmxlICYmIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm47IC8vIGNhbmNlbCBkbmRcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuaGFuZGxlICYmICFjbG9zZXN0KG9yaWdpbmFsVGFyZ2V0LCBvcHRpb25zLmhhbmRsZSwgZWwsIGZhbHNlKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFByZXBhcmUgYGRyYWdzdGFydGBcbiAgICB0aGlzLl9wcmVwYXJlRHJhZ1N0YXJ0KGV2dCwgdG91Y2gsIHRhcmdldCk7XG4gIH0sXG4gIF9wcmVwYXJlRHJhZ1N0YXJ0OiBmdW5jdGlvbiBfcHJlcGFyZURyYWdTdGFydCggLyoqIEV2ZW50ICovZXZ0LCAvKiogVG91Y2ggKi90b3VjaCwgLyoqIEhUTUxFbGVtZW50ICovdGFyZ2V0KSB7XG4gICAgdmFyIF90aGlzID0gdGhpcyxcbiAgICAgIGVsID0gX3RoaXMuZWwsXG4gICAgICBvcHRpb25zID0gX3RoaXMub3B0aW9ucyxcbiAgICAgIG93bmVyRG9jdW1lbnQgPSBlbC5vd25lckRvY3VtZW50LFxuICAgICAgZHJhZ1N0YXJ0Rm47XG4gICAgaWYgKHRhcmdldCAmJiAhZHJhZ0VsICYmIHRhcmdldC5wYXJlbnROb2RlID09PSBlbCkge1xuICAgICAgdmFyIGRyYWdSZWN0ID0gZ2V0UmVjdCh0YXJnZXQpO1xuICAgICAgcm9vdEVsID0gZWw7XG4gICAgICBkcmFnRWwgPSB0YXJnZXQ7XG4gICAgICBwYXJlbnRFbCA9IGRyYWdFbC5wYXJlbnROb2RlO1xuICAgICAgbmV4dEVsID0gZHJhZ0VsLm5leHRTaWJsaW5nO1xuICAgICAgbGFzdERvd25FbCA9IHRhcmdldDtcbiAgICAgIGFjdGl2ZUdyb3VwID0gb3B0aW9ucy5ncm91cDtcbiAgICAgIFNvcnRhYmxlLmRyYWdnZWQgPSBkcmFnRWw7XG4gICAgICB0YXBFdnQgPSB7XG4gICAgICAgIHRhcmdldDogZHJhZ0VsLFxuICAgICAgICBjbGllbnRYOiAodG91Y2ggfHwgZXZ0KS5jbGllbnRYLFxuICAgICAgICBjbGllbnRZOiAodG91Y2ggfHwgZXZ0KS5jbGllbnRZXG4gICAgICB9O1xuICAgICAgdGFwRGlzdGFuY2VMZWZ0ID0gdGFwRXZ0LmNsaWVudFggLSBkcmFnUmVjdC5sZWZ0O1xuICAgICAgdGFwRGlzdGFuY2VUb3AgPSB0YXBFdnQuY2xpZW50WSAtIGRyYWdSZWN0LnRvcDtcbiAgICAgIHRoaXMuX2xhc3RYID0gKHRvdWNoIHx8IGV2dCkuY2xpZW50WDtcbiAgICAgIHRoaXMuX2xhc3RZID0gKHRvdWNoIHx8IGV2dCkuY2xpZW50WTtcbiAgICAgIGRyYWdFbC5zdHlsZVsnd2lsbC1jaGFuZ2UnXSA9ICdhbGwnO1xuICAgICAgZHJhZ1N0YXJ0Rm4gPSBmdW5jdGlvbiBkcmFnU3RhcnRGbigpIHtcbiAgICAgICAgcGx1Z2luRXZlbnQoJ2RlbGF5RW5kZWQnLCBfdGhpcywge1xuICAgICAgICAgIGV2dDogZXZ0XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoU29ydGFibGUuZXZlbnRDYW5jZWxlZCkge1xuICAgICAgICAgIF90aGlzLl9vbkRyb3AoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gRGVsYXllZCBkcmFnIGhhcyBiZWVuIHRyaWdnZXJlZFxuICAgICAgICAvLyB3ZSBjYW4gcmUtZW5hYmxlIHRoZSBldmVudHM6IHRvdWNobW92ZS9tb3VzZW1vdmVcbiAgICAgICAgX3RoaXMuX2Rpc2FibGVEZWxheWVkRHJhZ0V2ZW50cygpO1xuICAgICAgICBpZiAoIUZpcmVGb3ggJiYgX3RoaXMubmF0aXZlRHJhZ2dhYmxlKSB7XG4gICAgICAgICAgZHJhZ0VsLmRyYWdnYWJsZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCaW5kIHRoZSBldmVudHM6IGRyYWdzdGFydC9kcmFnZW5kXG4gICAgICAgIF90aGlzLl90cmlnZ2VyRHJhZ1N0YXJ0KGV2dCwgdG91Y2gpO1xuXG4gICAgICAgIC8vIERyYWcgc3RhcnQgZXZlbnRcbiAgICAgICAgX2Rpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgIHNvcnRhYmxlOiBfdGhpcyxcbiAgICAgICAgICBuYW1lOiAnY2hvb3NlJyxcbiAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2hvc2VuIGl0ZW1cbiAgICAgICAgdG9nZ2xlQ2xhc3MoZHJhZ0VsLCBvcHRpb25zLmNob3NlbkNsYXNzLCB0cnVlKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIERpc2FibGUgXCJkcmFnZ2FibGVcIlxuICAgICAgb3B0aW9ucy5pZ25vcmUuc3BsaXQoJywnKS5mb3JFYWNoKGZ1bmN0aW9uIChjcml0ZXJpYSkge1xuICAgICAgICBmaW5kKGRyYWdFbCwgY3JpdGVyaWEudHJpbSgpLCBfZGlzYWJsZURyYWdnYWJsZSk7XG4gICAgICB9KTtcbiAgICAgIG9uKG93bmVyRG9jdW1lbnQsICdkcmFnb3ZlcicsIG5lYXJlc3RFbXB0eUluc2VydERldGVjdEV2ZW50KTtcbiAgICAgIG9uKG93bmVyRG9jdW1lbnQsICdtb3VzZW1vdmUnLCBuZWFyZXN0RW1wdHlJbnNlcnREZXRlY3RFdmVudCk7XG4gICAgICBvbihvd25lckRvY3VtZW50LCAndG91Y2htb3ZlJywgbmVhcmVzdEVtcHR5SW5zZXJ0RGV0ZWN0RXZlbnQpO1xuICAgICAgb24ob3duZXJEb2N1bWVudCwgJ21vdXNldXAnLCBfdGhpcy5fb25Ecm9wKTtcbiAgICAgIG9uKG93bmVyRG9jdW1lbnQsICd0b3VjaGVuZCcsIF90aGlzLl9vbkRyb3ApO1xuICAgICAgb24ob3duZXJEb2N1bWVudCwgJ3RvdWNoY2FuY2VsJywgX3RoaXMuX29uRHJvcCk7XG5cbiAgICAgIC8vIE1ha2UgZHJhZ0VsIGRyYWdnYWJsZSAobXVzdCBiZSBiZWZvcmUgZGVsYXkgZm9yIEZpcmVGb3gpXG4gICAgICBpZiAoRmlyZUZveCAmJiB0aGlzLm5hdGl2ZURyYWdnYWJsZSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMudG91Y2hTdGFydFRocmVzaG9sZCA9IDQ7XG4gICAgICAgIGRyYWdFbC5kcmFnZ2FibGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgcGx1Z2luRXZlbnQoJ2RlbGF5U3RhcnQnLCB0aGlzLCB7XG4gICAgICAgIGV2dDogZXZ0XG4gICAgICB9KTtcblxuICAgICAgLy8gRGVsYXkgaXMgaW1wb3NzaWJsZSBmb3IgbmF0aXZlIERuRCBpbiBFZGdlIG9yIElFXG4gICAgICBpZiAob3B0aW9ucy5kZWxheSAmJiAoIW9wdGlvbnMuZGVsYXlPblRvdWNoT25seSB8fCB0b3VjaCkgJiYgKCF0aGlzLm5hdGl2ZURyYWdnYWJsZSB8fCAhKEVkZ2UgfHwgSUUxMU9yTGVzcykpKSB7XG4gICAgICAgIGlmIChTb3J0YWJsZS5ldmVudENhbmNlbGVkKSB7XG4gICAgICAgICAgdGhpcy5fb25Ecm9wKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSB1c2VyIG1vdmVzIHRoZSBwb2ludGVyIG9yIGxldCBnbyB0aGUgY2xpY2sgb3IgdG91Y2hcbiAgICAgICAgLy8gYmVmb3JlIHRoZSBkZWxheSBoYXMgYmVlbiByZWFjaGVkOlxuICAgICAgICAvLyBkaXNhYmxlIHRoZSBkZWxheWVkIGRyYWdcbiAgICAgICAgb24ob3duZXJEb2N1bWVudCwgJ21vdXNldXAnLCBfdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnKTtcbiAgICAgICAgb24ob3duZXJEb2N1bWVudCwgJ3RvdWNoZW5kJywgX3RoaXMuX2Rpc2FibGVEZWxheWVkRHJhZyk7XG4gICAgICAgIG9uKG93bmVyRG9jdW1lbnQsICd0b3VjaGNhbmNlbCcsIF90aGlzLl9kaXNhYmxlRGVsYXllZERyYWcpO1xuICAgICAgICBvbihvd25lckRvY3VtZW50LCAnbW91c2Vtb3ZlJywgX3RoaXMuX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlcik7XG4gICAgICAgIG9uKG93bmVyRG9jdW1lbnQsICd0b3VjaG1vdmUnLCBfdGhpcy5fZGVsYXllZERyYWdUb3VjaE1vdmVIYW5kbGVyKTtcbiAgICAgICAgb3B0aW9ucy5zdXBwb3J0UG9pbnRlciAmJiBvbihvd25lckRvY3VtZW50LCAncG9pbnRlcm1vdmUnLCBfdGhpcy5fZGVsYXllZERyYWdUb3VjaE1vdmVIYW5kbGVyKTtcbiAgICAgICAgX3RoaXMuX2RyYWdTdGFydFRpbWVyID0gc2V0VGltZW91dChkcmFnU3RhcnRGbiwgb3B0aW9ucy5kZWxheSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkcmFnU3RhcnRGbigpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlcjogZnVuY3Rpb24gX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlciggLyoqIFRvdWNoRXZlbnR8UG9pbnRlckV2ZW50ICoqL2UpIHtcbiAgICB2YXIgdG91Y2ggPSBlLnRvdWNoZXMgPyBlLnRvdWNoZXNbMF0gOiBlO1xuICAgIGlmIChNYXRoLm1heChNYXRoLmFicyh0b3VjaC5jbGllbnRYIC0gdGhpcy5fbGFzdFgpLCBNYXRoLmFicyh0b3VjaC5jbGllbnRZIC0gdGhpcy5fbGFzdFkpKSA+PSBNYXRoLmZsb29yKHRoaXMub3B0aW9ucy50b3VjaFN0YXJ0VGhyZXNob2xkIC8gKHRoaXMubmF0aXZlRHJhZ2dhYmxlICYmIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDEpKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnKCk7XG4gICAgfVxuICB9LFxuICBfZGlzYWJsZURlbGF5ZWREcmFnOiBmdW5jdGlvbiBfZGlzYWJsZURlbGF5ZWREcmFnKCkge1xuICAgIGRyYWdFbCAmJiBfZGlzYWJsZURyYWdnYWJsZShkcmFnRWwpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9kcmFnU3RhcnRUaW1lcik7XG4gICAgdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnRXZlbnRzKCk7XG4gIH0sXG4gIF9kaXNhYmxlRGVsYXllZERyYWdFdmVudHM6IGZ1bmN0aW9uIF9kaXNhYmxlRGVsYXllZERyYWdFdmVudHMoKSB7XG4gICAgdmFyIG93bmVyRG9jdW1lbnQgPSB0aGlzLmVsLm93bmVyRG9jdW1lbnQ7XG4gICAgb2ZmKG93bmVyRG9jdW1lbnQsICdtb3VzZXVwJywgdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnKTtcbiAgICBvZmYob3duZXJEb2N1bWVudCwgJ3RvdWNoZW5kJywgdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnKTtcbiAgICBvZmYob3duZXJEb2N1bWVudCwgJ3RvdWNoY2FuY2VsJywgdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnKTtcbiAgICBvZmYob3duZXJEb2N1bWVudCwgJ21vdXNlbW92ZScsIHRoaXMuX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlcik7XG4gICAgb2ZmKG93bmVyRG9jdW1lbnQsICd0b3VjaG1vdmUnLCB0aGlzLl9kZWxheWVkRHJhZ1RvdWNoTW92ZUhhbmRsZXIpO1xuICAgIG9mZihvd25lckRvY3VtZW50LCAncG9pbnRlcm1vdmUnLCB0aGlzLl9kZWxheWVkRHJhZ1RvdWNoTW92ZUhhbmRsZXIpO1xuICB9LFxuICBfdHJpZ2dlckRyYWdTdGFydDogZnVuY3Rpb24gX3RyaWdnZXJEcmFnU3RhcnQoIC8qKiBFdmVudCAqL2V2dCwgLyoqIFRvdWNoICovdG91Y2gpIHtcbiAgICB0b3VjaCA9IHRvdWNoIHx8IGV2dC5wb2ludGVyVHlwZSA9PSAndG91Y2gnICYmIGV2dDtcbiAgICBpZiAoIXRoaXMubmF0aXZlRHJhZ2dhYmxlIHx8IHRvdWNoKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLnN1cHBvcnRQb2ludGVyKSB7XG4gICAgICAgIG9uKGRvY3VtZW50LCAncG9pbnRlcm1vdmUnLCB0aGlzLl9vblRvdWNoTW92ZSk7XG4gICAgICB9IGVsc2UgaWYgKHRvdWNoKSB7XG4gICAgICAgIG9uKGRvY3VtZW50LCAndG91Y2htb3ZlJywgdGhpcy5fb25Ub3VjaE1vdmUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb24oZG9jdW1lbnQsICdtb3VzZW1vdmUnLCB0aGlzLl9vblRvdWNoTW92ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIG9uKGRyYWdFbCwgJ2RyYWdlbmQnLCB0aGlzKTtcbiAgICAgIG9uKHJvb3RFbCwgJ2RyYWdzdGFydCcsIHRoaXMuX29uRHJhZ1N0YXJ0KTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcbiAgICAgICAgLy8gVGltZW91dCBuZWNjZXNzYXJ5IGZvciBJRTlcbiAgICAgICAgX25leHRUaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkoKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7fVxuICB9LFxuICBfZHJhZ1N0YXJ0ZWQ6IGZ1bmN0aW9uIF9kcmFnU3RhcnRlZChmYWxsYmFjaywgZXZ0KSB7XG4gICAgYXdhaXRpbmdEcmFnU3RhcnRlZCA9IGZhbHNlO1xuICAgIGlmIChyb290RWwgJiYgZHJhZ0VsKSB7XG4gICAgICBwbHVnaW5FdmVudCgnZHJhZ1N0YXJ0ZWQnLCB0aGlzLCB7XG4gICAgICAgIGV2dDogZXZ0XG4gICAgICB9KTtcbiAgICAgIGlmICh0aGlzLm5hdGl2ZURyYWdnYWJsZSkge1xuICAgICAgICBvbihkb2N1bWVudCwgJ2RyYWdvdmVyJywgX2NoZWNrT3V0c2lkZVRhcmdldEVsKTtcbiAgICAgIH1cbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG4gICAgICAvLyBBcHBseSBlZmZlY3RcbiAgICAgICFmYWxsYmFjayAmJiB0b2dnbGVDbGFzcyhkcmFnRWwsIG9wdGlvbnMuZHJhZ0NsYXNzLCBmYWxzZSk7XG4gICAgICB0b2dnbGVDbGFzcyhkcmFnRWwsIG9wdGlvbnMuZ2hvc3RDbGFzcywgdHJ1ZSk7XG4gICAgICBTb3J0YWJsZS5hY3RpdmUgPSB0aGlzO1xuICAgICAgZmFsbGJhY2sgJiYgdGhpcy5fYXBwZW5kR2hvc3QoKTtcblxuICAgICAgLy8gRHJhZyBzdGFydCBldmVudFxuICAgICAgX2Rpc3BhdGNoRXZlbnQoe1xuICAgICAgICBzb3J0YWJsZTogdGhpcyxcbiAgICAgICAgbmFtZTogJ3N0YXJ0JyxcbiAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbnVsbGluZygpO1xuICAgIH1cbiAgfSxcbiAgX2VtdWxhdGVEcmFnT3ZlcjogZnVuY3Rpb24gX2VtdWxhdGVEcmFnT3ZlcigpIHtcbiAgICBpZiAodG91Y2hFdnQpIHtcbiAgICAgIHRoaXMuX2xhc3RYID0gdG91Y2hFdnQuY2xpZW50WDtcbiAgICAgIHRoaXMuX2xhc3RZID0gdG91Y2hFdnQuY2xpZW50WTtcbiAgICAgIF9oaWRlR2hvc3RGb3JUYXJnZXQoKTtcbiAgICAgIHZhciB0YXJnZXQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHRvdWNoRXZ0LmNsaWVudFgsIHRvdWNoRXZ0LmNsaWVudFkpO1xuICAgICAgdmFyIHBhcmVudCA9IHRhcmdldDtcbiAgICAgIHdoaWxlICh0YXJnZXQgJiYgdGFyZ2V0LnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnNoYWRvd1Jvb3QuZWxlbWVudEZyb21Qb2ludCh0b3VjaEV2dC5jbGllbnRYLCB0b3VjaEV2dC5jbGllbnRZKTtcbiAgICAgICAgaWYgKHRhcmdldCA9PT0gcGFyZW50KSBicmVhaztcbiAgICAgICAgcGFyZW50ID0gdGFyZ2V0O1xuICAgICAgfVxuICAgICAgZHJhZ0VsLnBhcmVudE5vZGVbZXhwYW5kb10uX2lzT3V0c2lkZVRoaXNFbCh0YXJnZXQpO1xuICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICBkbyB7XG4gICAgICAgICAgaWYgKHBhcmVudFtleHBhbmRvXSkge1xuICAgICAgICAgICAgdmFyIGluc2VydGVkID0gdm9pZCAwO1xuICAgICAgICAgICAgaW5zZXJ0ZWQgPSBwYXJlbnRbZXhwYW5kb10uX29uRHJhZ092ZXIoe1xuICAgICAgICAgICAgICBjbGllbnRYOiB0b3VjaEV2dC5jbGllbnRYLFxuICAgICAgICAgICAgICBjbGllbnRZOiB0b3VjaEV2dC5jbGllbnRZLFxuICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgICAgICAgcm9vdEVsOiBwYXJlbnRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGluc2VydGVkICYmICF0aGlzLm9wdGlvbnMuZHJhZ292ZXJCdWJibGUpIHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRhcmdldCA9IHBhcmVudDsgLy8gc3RvcmUgbGFzdCBlbGVtZW50XG4gICAgICAgIH1cbiAgICAgICAgLyoganNoaW50IGJvc3M6dHJ1ZSAqLyB3aGlsZSAocGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGUpO1xuICAgICAgfVxuICAgICAgX3VuaGlkZUdob3N0Rm9yVGFyZ2V0KCk7XG4gICAgfVxuICB9LFxuICBfb25Ub3VjaE1vdmU6IGZ1bmN0aW9uIF9vblRvdWNoTW92ZSggLyoqVG91Y2hFdmVudCovZXZ0KSB7XG4gICAgaWYgKHRhcEV2dCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgIGZhbGxiYWNrVG9sZXJhbmNlID0gb3B0aW9ucy5mYWxsYmFja1RvbGVyYW5jZSxcbiAgICAgICAgZmFsbGJhY2tPZmZzZXQgPSBvcHRpb25zLmZhbGxiYWNrT2Zmc2V0LFxuICAgICAgICB0b3VjaCA9IGV2dC50b3VjaGVzID8gZXZ0LnRvdWNoZXNbMF0gOiBldnQsXG4gICAgICAgIGdob3N0TWF0cml4ID0gZ2hvc3RFbCAmJiBtYXRyaXgoZ2hvc3RFbCwgdHJ1ZSksXG4gICAgICAgIHNjYWxlWCA9IGdob3N0RWwgJiYgZ2hvc3RNYXRyaXggJiYgZ2hvc3RNYXRyaXguYSxcbiAgICAgICAgc2NhbGVZID0gZ2hvc3RFbCAmJiBnaG9zdE1hdHJpeCAmJiBnaG9zdE1hdHJpeC5kLFxuICAgICAgICByZWxhdGl2ZVNjcm9sbE9mZnNldCA9IFBvc2l0aW9uR2hvc3RBYnNvbHV0ZWx5ICYmIGdob3N0UmVsYXRpdmVQYXJlbnQgJiYgZ2V0UmVsYXRpdmVTY3JvbGxPZmZzZXQoZ2hvc3RSZWxhdGl2ZVBhcmVudCksXG4gICAgICAgIGR4ID0gKHRvdWNoLmNsaWVudFggLSB0YXBFdnQuY2xpZW50WCArIGZhbGxiYWNrT2Zmc2V0LngpIC8gKHNjYWxlWCB8fCAxKSArIChyZWxhdGl2ZVNjcm9sbE9mZnNldCA/IHJlbGF0aXZlU2Nyb2xsT2Zmc2V0WzBdIC0gZ2hvc3RSZWxhdGl2ZVBhcmVudEluaXRpYWxTY3JvbGxbMF0gOiAwKSAvIChzY2FsZVggfHwgMSksXG4gICAgICAgIGR5ID0gKHRvdWNoLmNsaWVudFkgLSB0YXBFdnQuY2xpZW50WSArIGZhbGxiYWNrT2Zmc2V0LnkpIC8gKHNjYWxlWSB8fCAxKSArIChyZWxhdGl2ZVNjcm9sbE9mZnNldCA/IHJlbGF0aXZlU2Nyb2xsT2Zmc2V0WzFdIC0gZ2hvc3RSZWxhdGl2ZVBhcmVudEluaXRpYWxTY3JvbGxbMV0gOiAwKSAvIChzY2FsZVkgfHwgMSk7XG5cbiAgICAgIC8vIG9ubHkgc2V0IHRoZSBzdGF0dXMgdG8gZHJhZ2dpbmcsIHdoZW4gd2UgYXJlIGFjdHVhbGx5IGRyYWdnaW5nXG4gICAgICBpZiAoIVNvcnRhYmxlLmFjdGl2ZSAmJiAhYXdhaXRpbmdEcmFnU3RhcnRlZCkge1xuICAgICAgICBpZiAoZmFsbGJhY2tUb2xlcmFuY2UgJiYgTWF0aC5tYXgoTWF0aC5hYnModG91Y2guY2xpZW50WCAtIHRoaXMuX2xhc3RYKSwgTWF0aC5hYnModG91Y2guY2xpZW50WSAtIHRoaXMuX2xhc3RZKSkgPCBmYWxsYmFja1RvbGVyYW5jZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9vbkRyYWdTdGFydChldnQsIHRydWUpO1xuICAgICAgfVxuICAgICAgaWYgKGdob3N0RWwpIHtcbiAgICAgICAgaWYgKGdob3N0TWF0cml4KSB7XG4gICAgICAgICAgZ2hvc3RNYXRyaXguZSArPSBkeCAtIChsYXN0RHggfHwgMCk7XG4gICAgICAgICAgZ2hvc3RNYXRyaXguZiArPSBkeSAtIChsYXN0RHkgfHwgMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ2hvc3RNYXRyaXggPSB7XG4gICAgICAgICAgICBhOiAxLFxuICAgICAgICAgICAgYjogMCxcbiAgICAgICAgICAgIGM6IDAsXG4gICAgICAgICAgICBkOiAxLFxuICAgICAgICAgICAgZTogZHgsXG4gICAgICAgICAgICBmOiBkeVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNzc01hdHJpeCA9IFwibWF0cml4KFwiLmNvbmNhdChnaG9zdE1hdHJpeC5hLCBcIixcIikuY29uY2F0KGdob3N0TWF0cml4LmIsIFwiLFwiKS5jb25jYXQoZ2hvc3RNYXRyaXguYywgXCIsXCIpLmNvbmNhdChnaG9zdE1hdHJpeC5kLCBcIixcIikuY29uY2F0KGdob3N0TWF0cml4LmUsIFwiLFwiKS5jb25jYXQoZ2hvc3RNYXRyaXguZiwgXCIpXCIpO1xuICAgICAgICBjc3MoZ2hvc3RFbCwgJ3dlYmtpdFRyYW5zZm9ybScsIGNzc01hdHJpeCk7XG4gICAgICAgIGNzcyhnaG9zdEVsLCAnbW96VHJhbnNmb3JtJywgY3NzTWF0cml4KTtcbiAgICAgICAgY3NzKGdob3N0RWwsICdtc1RyYW5zZm9ybScsIGNzc01hdHJpeCk7XG4gICAgICAgIGNzcyhnaG9zdEVsLCAndHJhbnNmb3JtJywgY3NzTWF0cml4KTtcbiAgICAgICAgbGFzdER4ID0gZHg7XG4gICAgICAgIGxhc3REeSA9IGR5O1xuICAgICAgICB0b3VjaEV2dCA9IHRvdWNoO1xuICAgICAgfVxuICAgICAgZXZ0LmNhbmNlbGFibGUgJiYgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9LFxuICBfYXBwZW5kR2hvc3Q6IGZ1bmN0aW9uIF9hcHBlbmRHaG9zdCgpIHtcbiAgICAvLyBCdWcgaWYgdXNpbmcgc2NhbGUoKTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjYzNzA1OFxuICAgIC8vIE5vdCBiZWluZyBhZGp1c3RlZCBmb3JcbiAgICBpZiAoIWdob3N0RWwpIHtcbiAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLm9wdGlvbnMuZmFsbGJhY2tPbkJvZHkgPyBkb2N1bWVudC5ib2R5IDogcm9vdEVsLFxuICAgICAgICByZWN0ID0gZ2V0UmVjdChkcmFnRWwsIHRydWUsIFBvc2l0aW9uR2hvc3RBYnNvbHV0ZWx5LCB0cnVlLCBjb250YWluZXIpLFxuICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG4gICAgICAvLyBQb3NpdGlvbiBhYnNvbHV0ZWx5XG4gICAgICBpZiAoUG9zaXRpb25HaG9zdEFic29sdXRlbHkpIHtcbiAgICAgICAgLy8gR2V0IHJlbGF0aXZlbHkgcG9zaXRpb25lZCBwYXJlbnRcbiAgICAgICAgZ2hvc3RSZWxhdGl2ZVBhcmVudCA9IGNvbnRhaW5lcjtcbiAgICAgICAgd2hpbGUgKGNzcyhnaG9zdFJlbGF0aXZlUGFyZW50LCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycgJiYgY3NzKGdob3N0UmVsYXRpdmVQYXJlbnQsICd0cmFuc2Zvcm0nKSA9PT0gJ25vbmUnICYmIGdob3N0UmVsYXRpdmVQYXJlbnQgIT09IGRvY3VtZW50KSB7XG4gICAgICAgICAgZ2hvc3RSZWxhdGl2ZVBhcmVudCA9IGdob3N0UmVsYXRpdmVQYXJlbnQucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2hvc3RSZWxhdGl2ZVBhcmVudCAhPT0gZG9jdW1lbnQuYm9keSAmJiBnaG9zdFJlbGF0aXZlUGFyZW50ICE9PSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHtcbiAgICAgICAgICBpZiAoZ2hvc3RSZWxhdGl2ZVBhcmVudCA9PT0gZG9jdW1lbnQpIGdob3N0UmVsYXRpdmVQYXJlbnQgPSBnZXRXaW5kb3dTY3JvbGxpbmdFbGVtZW50KCk7XG4gICAgICAgICAgcmVjdC50b3AgKz0gZ2hvc3RSZWxhdGl2ZVBhcmVudC5zY3JvbGxUb3A7XG4gICAgICAgICAgcmVjdC5sZWZ0ICs9IGdob3N0UmVsYXRpdmVQYXJlbnQuc2Nyb2xsTGVmdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnaG9zdFJlbGF0aXZlUGFyZW50ID0gZ2V0V2luZG93U2Nyb2xsaW5nRWxlbWVudCgpO1xuICAgICAgICB9XG4gICAgICAgIGdob3N0UmVsYXRpdmVQYXJlbnRJbml0aWFsU2Nyb2xsID0gZ2V0UmVsYXRpdmVTY3JvbGxPZmZzZXQoZ2hvc3RSZWxhdGl2ZVBhcmVudCk7XG4gICAgICB9XG4gICAgICBnaG9zdEVsID0gZHJhZ0VsLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIHRvZ2dsZUNsYXNzKGdob3N0RWwsIG9wdGlvbnMuZ2hvc3RDbGFzcywgZmFsc2UpO1xuICAgICAgdG9nZ2xlQ2xhc3MoZ2hvc3RFbCwgb3B0aW9ucy5mYWxsYmFja0NsYXNzLCB0cnVlKTtcbiAgICAgIHRvZ2dsZUNsYXNzKGdob3N0RWwsIG9wdGlvbnMuZHJhZ0NsYXNzLCB0cnVlKTtcbiAgICAgIGNzcyhnaG9zdEVsLCAndHJhbnNpdGlvbicsICcnKTtcbiAgICAgIGNzcyhnaG9zdEVsLCAndHJhbnNmb3JtJywgJycpO1xuICAgICAgY3NzKGdob3N0RWwsICdib3gtc2l6aW5nJywgJ2JvcmRlci1ib3gnKTtcbiAgICAgIGNzcyhnaG9zdEVsLCAnbWFyZ2luJywgMCk7XG4gICAgICBjc3MoZ2hvc3RFbCwgJ3RvcCcsIHJlY3QudG9wKTtcbiAgICAgIGNzcyhnaG9zdEVsLCAnbGVmdCcsIHJlY3QubGVmdCk7XG4gICAgICBjc3MoZ2hvc3RFbCwgJ3dpZHRoJywgcmVjdC53aWR0aCk7XG4gICAgICBjc3MoZ2hvc3RFbCwgJ2hlaWdodCcsIHJlY3QuaGVpZ2h0KTtcbiAgICAgIGNzcyhnaG9zdEVsLCAnb3BhY2l0eScsICcwLjgnKTtcbiAgICAgIGNzcyhnaG9zdEVsLCAncG9zaXRpb24nLCBQb3NpdGlvbkdob3N0QWJzb2x1dGVseSA/ICdhYnNvbHV0ZScgOiAnZml4ZWQnKTtcbiAgICAgIGNzcyhnaG9zdEVsLCAnekluZGV4JywgJzEwMDAwMCcpO1xuICAgICAgY3NzKGdob3N0RWwsICdwb2ludGVyRXZlbnRzJywgJ25vbmUnKTtcbiAgICAgIFNvcnRhYmxlLmdob3N0ID0gZ2hvc3RFbDtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChnaG9zdEVsKTtcblxuICAgICAgLy8gU2V0IHRyYW5zZm9ybS1vcmlnaW5cbiAgICAgIGNzcyhnaG9zdEVsLCAndHJhbnNmb3JtLW9yaWdpbicsIHRhcERpc3RhbmNlTGVmdCAvIHBhcnNlSW50KGdob3N0RWwuc3R5bGUud2lkdGgpICogMTAwICsgJyUgJyArIHRhcERpc3RhbmNlVG9wIC8gcGFyc2VJbnQoZ2hvc3RFbC5zdHlsZS5oZWlnaHQpICogMTAwICsgJyUnKTtcbiAgICB9XG4gIH0sXG4gIF9vbkRyYWdTdGFydDogZnVuY3Rpb24gX29uRHJhZ1N0YXJ0KCAvKipFdmVudCovZXZ0LCAvKipib29sZWFuKi9mYWxsYmFjaykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgdmFyIGRhdGFUcmFuc2ZlciA9IGV2dC5kYXRhVHJhbnNmZXI7XG4gICAgdmFyIG9wdGlvbnMgPSBfdGhpcy5vcHRpb25zO1xuICAgIHBsdWdpbkV2ZW50KCdkcmFnU3RhcnQnLCB0aGlzLCB7XG4gICAgICBldnQ6IGV2dFxuICAgIH0pO1xuICAgIGlmIChTb3J0YWJsZS5ldmVudENhbmNlbGVkKSB7XG4gICAgICB0aGlzLl9vbkRyb3AoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcGx1Z2luRXZlbnQoJ3NldHVwQ2xvbmUnLCB0aGlzKTtcbiAgICBpZiAoIVNvcnRhYmxlLmV2ZW50Q2FuY2VsZWQpIHtcbiAgICAgIGNsb25lRWwgPSBjbG9uZShkcmFnRWwpO1xuICAgICAgY2xvbmVFbC5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcbiAgICAgIGNsb25lRWwuZHJhZ2dhYmxlID0gZmFsc2U7XG4gICAgICBjbG9uZUVsLnN0eWxlWyd3aWxsLWNoYW5nZSddID0gJyc7XG4gICAgICB0aGlzLl9oaWRlQ2xvbmUoKTtcbiAgICAgIHRvZ2dsZUNsYXNzKGNsb25lRWwsIHRoaXMub3B0aW9ucy5jaG9zZW5DbGFzcywgZmFsc2UpO1xuICAgICAgU29ydGFibGUuY2xvbmUgPSBjbG9uZUVsO1xuICAgIH1cblxuICAgIC8vICMxMTQzOiBJRnJhbWUgc3VwcG9ydCB3b3JrYXJvdW5kXG4gICAgX3RoaXMuY2xvbmVJZCA9IF9uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICBwbHVnaW5FdmVudCgnY2xvbmUnLCBfdGhpcyk7XG4gICAgICBpZiAoU29ydGFibGUuZXZlbnRDYW5jZWxlZCkgcmV0dXJuO1xuICAgICAgaWYgKCFfdGhpcy5vcHRpb25zLnJlbW92ZUNsb25lT25IaWRlKSB7XG4gICAgICAgIHJvb3RFbC5pbnNlcnRCZWZvcmUoY2xvbmVFbCwgZHJhZ0VsKTtcbiAgICAgIH1cbiAgICAgIF90aGlzLl9oaWRlQ2xvbmUoKTtcbiAgICAgIF9kaXNwYXRjaEV2ZW50KHtcbiAgICAgICAgc29ydGFibGU6IF90aGlzLFxuICAgICAgICBuYW1lOiAnY2xvbmUnXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICAhZmFsbGJhY2sgJiYgdG9nZ2xlQ2xhc3MoZHJhZ0VsLCBvcHRpb25zLmRyYWdDbGFzcywgdHJ1ZSk7XG5cbiAgICAvLyBTZXQgcHJvcGVyIGRyb3AgZXZlbnRzXG4gICAgaWYgKGZhbGxiYWNrKSB7XG4gICAgICBpZ25vcmVOZXh0Q2xpY2sgPSB0cnVlO1xuICAgICAgX3RoaXMuX2xvb3BJZCA9IHNldEludGVydmFsKF90aGlzLl9lbXVsYXRlRHJhZ092ZXIsIDUwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVW5kbyB3aGF0IHdhcyBzZXQgaW4gX3ByZXBhcmVEcmFnU3RhcnQgYmVmb3JlIGRyYWcgc3RhcnRlZFxuICAgICAgb2ZmKGRvY3VtZW50LCAnbW91c2V1cCcsIF90aGlzLl9vbkRyb3ApO1xuICAgICAgb2ZmKGRvY3VtZW50LCAndG91Y2hlbmQnLCBfdGhpcy5fb25Ecm9wKTtcbiAgICAgIG9mZihkb2N1bWVudCwgJ3RvdWNoY2FuY2VsJywgX3RoaXMuX29uRHJvcCk7XG4gICAgICBpZiAoZGF0YVRyYW5zZmVyKSB7XG4gICAgICAgIGRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xuICAgICAgICBvcHRpb25zLnNldERhdGEgJiYgb3B0aW9ucy5zZXREYXRhLmNhbGwoX3RoaXMsIGRhdGFUcmFuc2ZlciwgZHJhZ0VsKTtcbiAgICAgIH1cbiAgICAgIG9uKGRvY3VtZW50LCAnZHJvcCcsIF90aGlzKTtcblxuICAgICAgLy8gIzEyNzYgZml4OlxuICAgICAgY3NzKGRyYWdFbCwgJ3RyYW5zZm9ybScsICd0cmFuc2xhdGVaKDApJyk7XG4gICAgfVxuICAgIGF3YWl0aW5nRHJhZ1N0YXJ0ZWQgPSB0cnVlO1xuICAgIF90aGlzLl9kcmFnU3RhcnRJZCA9IF9uZXh0VGljayhfdGhpcy5fZHJhZ1N0YXJ0ZWQuYmluZChfdGhpcywgZmFsbGJhY2ssIGV2dCkpO1xuICAgIG9uKGRvY3VtZW50LCAnc2VsZWN0c3RhcnQnLCBfdGhpcyk7XG4gICAgbW92ZWQgPSB0cnVlO1xuICAgIGlmIChTYWZhcmkpIHtcbiAgICAgIGNzcyhkb2N1bWVudC5ib2R5LCAndXNlci1zZWxlY3QnLCAnbm9uZScpO1xuICAgIH1cbiAgfSxcbiAgLy8gUmV0dXJucyB0cnVlIC0gaWYgbm8gZnVydGhlciBhY3Rpb24gaXMgbmVlZGVkIChlaXRoZXIgaW5zZXJ0ZWQgb3IgYW5vdGhlciBjb25kaXRpb24pXG4gIF9vbkRyYWdPdmVyOiBmdW5jdGlvbiBfb25EcmFnT3ZlciggLyoqRXZlbnQqL2V2dCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWwsXG4gICAgICB0YXJnZXQgPSBldnQudGFyZ2V0LFxuICAgICAgZHJhZ1JlY3QsXG4gICAgICB0YXJnZXRSZWN0LFxuICAgICAgcmV2ZXJ0LFxuICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgIGdyb3VwID0gb3B0aW9ucy5ncm91cCxcbiAgICAgIGFjdGl2ZVNvcnRhYmxlID0gU29ydGFibGUuYWN0aXZlLFxuICAgICAgaXNPd25lciA9IGFjdGl2ZUdyb3VwID09PSBncm91cCxcbiAgICAgIGNhblNvcnQgPSBvcHRpb25zLnNvcnQsXG4gICAgICBmcm9tU29ydGFibGUgPSBwdXRTb3J0YWJsZSB8fCBhY3RpdmVTb3J0YWJsZSxcbiAgICAgIHZlcnRpY2FsLFxuICAgICAgX3RoaXMgPSB0aGlzLFxuICAgICAgY29tcGxldGVkRmlyZWQgPSBmYWxzZTtcbiAgICBpZiAoX3NpbGVudCkgcmV0dXJuO1xuICAgIGZ1bmN0aW9uIGRyYWdPdmVyRXZlbnQobmFtZSwgZXh0cmEpIHtcbiAgICAgIHBsdWdpbkV2ZW50KG5hbWUsIF90aGlzLCBfb2JqZWN0U3ByZWFkMih7XG4gICAgICAgIGV2dDogZXZ0LFxuICAgICAgICBpc093bmVyOiBpc093bmVyLFxuICAgICAgICBheGlzOiB2ZXJ0aWNhbCA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCcsXG4gICAgICAgIHJldmVydDogcmV2ZXJ0LFxuICAgICAgICBkcmFnUmVjdDogZHJhZ1JlY3QsXG4gICAgICAgIHRhcmdldFJlY3Q6IHRhcmdldFJlY3QsXG4gICAgICAgIGNhblNvcnQ6IGNhblNvcnQsXG4gICAgICAgIGZyb21Tb3J0YWJsZTogZnJvbVNvcnRhYmxlLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWQsXG4gICAgICAgIG9uTW92ZTogZnVuY3Rpb24gb25Nb3ZlKHRhcmdldCwgYWZ0ZXIpIHtcbiAgICAgICAgICByZXR1cm4gX29uTW92ZShyb290RWwsIGVsLCBkcmFnRWwsIGRyYWdSZWN0LCB0YXJnZXQsIGdldFJlY3QodGFyZ2V0KSwgZXZ0LCBhZnRlcik7XG4gICAgICAgIH0sXG4gICAgICAgIGNoYW5nZWQ6IGNoYW5nZWRcbiAgICAgIH0sIGV4dHJhKSk7XG4gICAgfVxuXG4gICAgLy8gQ2FwdHVyZSBhbmltYXRpb24gc3RhdGVcbiAgICBmdW5jdGlvbiBjYXB0dXJlKCkge1xuICAgICAgZHJhZ092ZXJFdmVudCgnZHJhZ092ZXJBbmltYXRpb25DYXB0dXJlJyk7XG4gICAgICBfdGhpcy5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKTtcbiAgICAgIGlmIChfdGhpcyAhPT0gZnJvbVNvcnRhYmxlKSB7XG4gICAgICAgIGZyb21Tb3J0YWJsZS5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gaW52b2NhdGlvbiB3aGVuIGRyYWdFbCBpcyBpbnNlcnRlZCAob3IgY29tcGxldGVkKVxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlZChpbnNlcnRpb24pIHtcbiAgICAgIGRyYWdPdmVyRXZlbnQoJ2RyYWdPdmVyQ29tcGxldGVkJywge1xuICAgICAgICBpbnNlcnRpb246IGluc2VydGlvblxuICAgICAgfSk7XG4gICAgICBpZiAoaW5zZXJ0aW9uKSB7XG4gICAgICAgIC8vIENsb25lcyBtdXN0IGJlIGhpZGRlbiBiZWZvcmUgZm9sZGluZyBhbmltYXRpb24gdG8gY2FwdHVyZSBkcmFnUmVjdEFic29sdXRlIHByb3Blcmx5XG4gICAgICAgIGlmIChpc093bmVyKSB7XG4gICAgICAgICAgYWN0aXZlU29ydGFibGUuX2hpZGVDbG9uZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFjdGl2ZVNvcnRhYmxlLl9zaG93Q2xvbmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfdGhpcyAhPT0gZnJvbVNvcnRhYmxlKSB7XG4gICAgICAgICAgLy8gU2V0IGdob3N0IGNsYXNzIHRvIG5ldyBzb3J0YWJsZSdzIGdob3N0IGNsYXNzXG4gICAgICAgICAgdG9nZ2xlQ2xhc3MoZHJhZ0VsLCBwdXRTb3J0YWJsZSA/IHB1dFNvcnRhYmxlLm9wdGlvbnMuZ2hvc3RDbGFzcyA6IGFjdGl2ZVNvcnRhYmxlLm9wdGlvbnMuZ2hvc3RDbGFzcywgZmFsc2UpO1xuICAgICAgICAgIHRvZ2dsZUNsYXNzKGRyYWdFbCwgb3B0aW9ucy5naG9zdENsYXNzLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHV0U29ydGFibGUgIT09IF90aGlzICYmIF90aGlzICE9PSBTb3J0YWJsZS5hY3RpdmUpIHtcbiAgICAgICAgICBwdXRTb3J0YWJsZSA9IF90aGlzO1xuICAgICAgICB9IGVsc2UgaWYgKF90aGlzID09PSBTb3J0YWJsZS5hY3RpdmUgJiYgcHV0U29ydGFibGUpIHtcbiAgICAgICAgICBwdXRTb3J0YWJsZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbmltYXRpb25cbiAgICAgICAgaWYgKGZyb21Tb3J0YWJsZSA9PT0gX3RoaXMpIHtcbiAgICAgICAgICBfdGhpcy5faWdub3JlV2hpbGVBbmltYXRpbmcgPSB0YXJnZXQ7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuYW5pbWF0ZUFsbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZHJhZ092ZXJFdmVudCgnZHJhZ092ZXJBbmltYXRpb25Db21wbGV0ZScpO1xuICAgICAgICAgIF90aGlzLl9pZ25vcmVXaGlsZUFuaW1hdGluZyA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoX3RoaXMgIT09IGZyb21Tb3J0YWJsZSkge1xuICAgICAgICAgIGZyb21Tb3J0YWJsZS5hbmltYXRlQWxsKCk7XG4gICAgICAgICAgZnJvbVNvcnRhYmxlLl9pZ25vcmVXaGlsZUFuaW1hdGluZyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTnVsbCBsYXN0VGFyZ2V0IGlmIGl0IGlzIG5vdCBpbnNpZGUgYSBwcmV2aW91c2x5IHN3YXBwZWQgZWxlbWVudFxuICAgICAgaWYgKHRhcmdldCA9PT0gZHJhZ0VsICYmICFkcmFnRWwuYW5pbWF0ZWQgfHwgdGFyZ2V0ID09PSBlbCAmJiAhdGFyZ2V0LmFuaW1hdGVkKSB7XG4gICAgICAgIGxhc3RUYXJnZXQgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyBubyBidWJibGluZyBhbmQgbm90IGZhbGxiYWNrXG4gICAgICBpZiAoIW9wdGlvbnMuZHJhZ292ZXJCdWJibGUgJiYgIWV2dC5yb290RWwgJiYgdGFyZ2V0ICE9PSBkb2N1bWVudCkge1xuICAgICAgICBkcmFnRWwucGFyZW50Tm9kZVtleHBhbmRvXS5faXNPdXRzaWRlVGhpc0VsKGV2dC50YXJnZXQpO1xuXG4gICAgICAgIC8vIERvIG5vdCBkZXRlY3QgZm9yIGVtcHR5IGluc2VydCBpZiBhbHJlYWR5IGluc2VydGVkXG4gICAgICAgICFpbnNlcnRpb24gJiYgbmVhcmVzdEVtcHR5SW5zZXJ0RGV0ZWN0RXZlbnQoZXZ0KTtcbiAgICAgIH1cbiAgICAgICFvcHRpb25zLmRyYWdvdmVyQnViYmxlICYmIGV2dC5zdG9wUHJvcGFnYXRpb24gJiYgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgcmV0dXJuIGNvbXBsZXRlZEZpcmVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBDYWxsIHdoZW4gZHJhZ0VsIGhhcyBiZWVuIGluc2VydGVkXG4gICAgZnVuY3Rpb24gY2hhbmdlZCgpIHtcbiAgICAgIG5ld0luZGV4ID0gaW5kZXgoZHJhZ0VsKTtcbiAgICAgIG5ld0RyYWdnYWJsZUluZGV4ID0gaW5kZXgoZHJhZ0VsLCBvcHRpb25zLmRyYWdnYWJsZSk7XG4gICAgICBfZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgIHNvcnRhYmxlOiBfdGhpcyxcbiAgICAgICAgbmFtZTogJ2NoYW5nZScsXG4gICAgICAgIHRvRWw6IGVsLFxuICAgICAgICBuZXdJbmRleDogbmV3SW5kZXgsXG4gICAgICAgIG5ld0RyYWdnYWJsZUluZGV4OiBuZXdEcmFnZ2FibGVJbmRleCxcbiAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGV2dC5wcmV2ZW50RGVmYXVsdCAhPT0gdm9pZCAwKSB7XG4gICAgICBldnQuY2FuY2VsYWJsZSAmJiBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgdGFyZ2V0ID0gY2xvc2VzdCh0YXJnZXQsIG9wdGlvbnMuZHJhZ2dhYmxlLCBlbCwgdHJ1ZSk7XG4gICAgZHJhZ092ZXJFdmVudCgnZHJhZ092ZXInKTtcbiAgICBpZiAoU29ydGFibGUuZXZlbnRDYW5jZWxlZCkgcmV0dXJuIGNvbXBsZXRlZEZpcmVkO1xuICAgIGlmIChkcmFnRWwuY29udGFpbnMoZXZ0LnRhcmdldCkgfHwgdGFyZ2V0LmFuaW1hdGVkICYmIHRhcmdldC5hbmltYXRpbmdYICYmIHRhcmdldC5hbmltYXRpbmdZIHx8IF90aGlzLl9pZ25vcmVXaGlsZUFuaW1hdGluZyA9PT0gdGFyZ2V0KSB7XG4gICAgICByZXR1cm4gY29tcGxldGVkKGZhbHNlKTtcbiAgICB9XG4gICAgaWdub3JlTmV4dENsaWNrID0gZmFsc2U7XG4gICAgaWYgKGFjdGl2ZVNvcnRhYmxlICYmICFvcHRpb25zLmRpc2FibGVkICYmIChpc093bmVyID8gY2FuU29ydCB8fCAocmV2ZXJ0ID0gcGFyZW50RWwgIT09IHJvb3RFbCkgLy8gUmV2ZXJ0aW5nIGl0ZW0gaW50byB0aGUgb3JpZ2luYWwgbGlzdFxuICAgIDogcHV0U29ydGFibGUgPT09IHRoaXMgfHwgKHRoaXMubGFzdFB1dE1vZGUgPSBhY3RpdmVHcm91cC5jaGVja1B1bGwodGhpcywgYWN0aXZlU29ydGFibGUsIGRyYWdFbCwgZXZ0KSkgJiYgZ3JvdXAuY2hlY2tQdXQodGhpcywgYWN0aXZlU29ydGFibGUsIGRyYWdFbCwgZXZ0KSkpIHtcbiAgICAgIHZlcnRpY2FsID0gdGhpcy5fZ2V0RGlyZWN0aW9uKGV2dCwgdGFyZ2V0KSA9PT0gJ3ZlcnRpY2FsJztcbiAgICAgIGRyYWdSZWN0ID0gZ2V0UmVjdChkcmFnRWwpO1xuICAgICAgZHJhZ092ZXJFdmVudCgnZHJhZ092ZXJWYWxpZCcpO1xuICAgICAgaWYgKFNvcnRhYmxlLmV2ZW50Q2FuY2VsZWQpIHJldHVybiBjb21wbGV0ZWRGaXJlZDtcbiAgICAgIGlmIChyZXZlcnQpIHtcbiAgICAgICAgcGFyZW50RWwgPSByb290RWw7IC8vIGFjdHVhbGl6YXRpb25cbiAgICAgICAgY2FwdHVyZSgpO1xuICAgICAgICB0aGlzLl9oaWRlQ2xvbmUoKTtcbiAgICAgICAgZHJhZ092ZXJFdmVudCgncmV2ZXJ0Jyk7XG4gICAgICAgIGlmICghU29ydGFibGUuZXZlbnRDYW5jZWxlZCkge1xuICAgICAgICAgIGlmIChuZXh0RWwpIHtcbiAgICAgICAgICAgIHJvb3RFbC5pbnNlcnRCZWZvcmUoZHJhZ0VsLCBuZXh0RWwpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByb290RWwuYXBwZW5kQ2hpbGQoZHJhZ0VsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbXBsZXRlZCh0cnVlKTtcbiAgICAgIH1cbiAgICAgIHZhciBlbExhc3RDaGlsZCA9IGxhc3RDaGlsZChlbCwgb3B0aW9ucy5kcmFnZ2FibGUpO1xuICAgICAgaWYgKCFlbExhc3RDaGlsZCB8fCBfZ2hvc3RJc0xhc3QoZXZ0LCB2ZXJ0aWNhbCwgdGhpcykgJiYgIWVsTGFzdENoaWxkLmFuaW1hdGVkKSB7XG4gICAgICAgIC8vIEluc2VydCB0byBlbmQgb2YgbGlzdFxuXG4gICAgICAgIC8vIElmIGFscmVhZHkgYXQgZW5kIG9mIGxpc3Q6IERvIG5vdCBpbnNlcnRcbiAgICAgICAgaWYgKGVsTGFzdENoaWxkID09PSBkcmFnRWwpIHtcbiAgICAgICAgICByZXR1cm4gY29tcGxldGVkKGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgbGFzdCBlbGVtZW50LCBpdCBpcyB0aGUgdGFyZ2V0XG4gICAgICAgIGlmIChlbExhc3RDaGlsZCAmJiBlbCA9PT0gZXZ0LnRhcmdldCkge1xuICAgICAgICAgIHRhcmdldCA9IGVsTGFzdENoaWxkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICB0YXJnZXRSZWN0ID0gZ2V0UmVjdCh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfb25Nb3ZlKHJvb3RFbCwgZWwsIGRyYWdFbCwgZHJhZ1JlY3QsIHRhcmdldCwgdGFyZ2V0UmVjdCwgZXZ0LCAhIXRhcmdldCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgY2FwdHVyZSgpO1xuICAgICAgICAgIGlmIChlbExhc3RDaGlsZCAmJiBlbExhc3RDaGlsZC5uZXh0U2libGluZykge1xuICAgICAgICAgICAgLy8gdGhlIGxhc3QgZHJhZ2dhYmxlIGVsZW1lbnQgaXMgbm90IHRoZSBsYXN0IG5vZGVcbiAgICAgICAgICAgIGVsLmluc2VydEJlZm9yZShkcmFnRWwsIGVsTGFzdENoaWxkLm5leHRTaWJsaW5nKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoZHJhZ0VsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcGFyZW50RWwgPSBlbDsgLy8gYWN0dWFsaXphdGlvblxuXG4gICAgICAgICAgY2hhbmdlZCgpO1xuICAgICAgICAgIHJldHVybiBjb21wbGV0ZWQodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZWxMYXN0Q2hpbGQgJiYgX2dob3N0SXNGaXJzdChldnQsIHZlcnRpY2FsLCB0aGlzKSkge1xuICAgICAgICAvLyBJbnNlcnQgdG8gc3RhcnQgb2YgbGlzdFxuICAgICAgICB2YXIgZmlyc3RDaGlsZCA9IGdldENoaWxkKGVsLCAwLCBvcHRpb25zLCB0cnVlKTtcbiAgICAgICAgaWYgKGZpcnN0Q2hpbGQgPT09IGRyYWdFbCkge1xuICAgICAgICAgIHJldHVybiBjb21wbGV0ZWQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldCA9IGZpcnN0Q2hpbGQ7XG4gICAgICAgIHRhcmdldFJlY3QgPSBnZXRSZWN0KHRhcmdldCk7XG4gICAgICAgIGlmIChfb25Nb3ZlKHJvb3RFbCwgZWwsIGRyYWdFbCwgZHJhZ1JlY3QsIHRhcmdldCwgdGFyZ2V0UmVjdCwgZXZ0LCBmYWxzZSkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgY2FwdHVyZSgpO1xuICAgICAgICAgIGVsLmluc2VydEJlZm9yZShkcmFnRWwsIGZpcnN0Q2hpbGQpO1xuICAgICAgICAgIHBhcmVudEVsID0gZWw7IC8vIGFjdHVhbGl6YXRpb25cblxuICAgICAgICAgIGNoYW5nZWQoKTtcbiAgICAgICAgICByZXR1cm4gY29tcGxldGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHRhcmdldC5wYXJlbnROb2RlID09PSBlbCkge1xuICAgICAgICB0YXJnZXRSZWN0ID0gZ2V0UmVjdCh0YXJnZXQpO1xuICAgICAgICB2YXIgZGlyZWN0aW9uID0gMCxcbiAgICAgICAgICB0YXJnZXRCZWZvcmVGaXJzdFN3YXAsXG4gICAgICAgICAgZGlmZmVyZW50TGV2ZWwgPSBkcmFnRWwucGFyZW50Tm9kZSAhPT0gZWwsXG4gICAgICAgICAgZGlmZmVyZW50Um93Q29sID0gIV9kcmFnRWxJblJvd0NvbHVtbihkcmFnRWwuYW5pbWF0ZWQgJiYgZHJhZ0VsLnRvUmVjdCB8fCBkcmFnUmVjdCwgdGFyZ2V0LmFuaW1hdGVkICYmIHRhcmdldC50b1JlY3QgfHwgdGFyZ2V0UmVjdCwgdmVydGljYWwpLFxuICAgICAgICAgIHNpZGUxID0gdmVydGljYWwgPyAndG9wJyA6ICdsZWZ0JyxcbiAgICAgICAgICBzY3JvbGxlZFBhc3RUb3AgPSBpc1Njcm9sbGVkUGFzdCh0YXJnZXQsICd0b3AnLCAndG9wJykgfHwgaXNTY3JvbGxlZFBhc3QoZHJhZ0VsLCAndG9wJywgJ3RvcCcpLFxuICAgICAgICAgIHNjcm9sbEJlZm9yZSA9IHNjcm9sbGVkUGFzdFRvcCA/IHNjcm9sbGVkUGFzdFRvcC5zY3JvbGxUb3AgOiB2b2lkIDA7XG4gICAgICAgIGlmIChsYXN0VGFyZ2V0ICE9PSB0YXJnZXQpIHtcbiAgICAgICAgICB0YXJnZXRCZWZvcmVGaXJzdFN3YXAgPSB0YXJnZXRSZWN0W3NpZGUxXTtcbiAgICAgICAgICBwYXN0Rmlyc3RJbnZlcnRUaHJlc2ggPSBmYWxzZTtcbiAgICAgICAgICBpc0NpcmN1bXN0YW50aWFsSW52ZXJ0ID0gIWRpZmZlcmVudFJvd0NvbCAmJiBvcHRpb25zLmludmVydFN3YXAgfHwgZGlmZmVyZW50TGV2ZWw7XG4gICAgICAgIH1cbiAgICAgICAgZGlyZWN0aW9uID0gX2dldFN3YXBEaXJlY3Rpb24oZXZ0LCB0YXJnZXQsIHRhcmdldFJlY3QsIHZlcnRpY2FsLCBkaWZmZXJlbnRSb3dDb2wgPyAxIDogb3B0aW9ucy5zd2FwVGhyZXNob2xkLCBvcHRpb25zLmludmVydGVkU3dhcFRocmVzaG9sZCA9PSBudWxsID8gb3B0aW9ucy5zd2FwVGhyZXNob2xkIDogb3B0aW9ucy5pbnZlcnRlZFN3YXBUaHJlc2hvbGQsIGlzQ2lyY3Vtc3RhbnRpYWxJbnZlcnQsIGxhc3RUYXJnZXQgPT09IHRhcmdldCk7XG4gICAgICAgIHZhciBzaWJsaW5nO1xuICAgICAgICBpZiAoZGlyZWN0aW9uICE9PSAwKSB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGFyZ2V0IGlzIGJlc2lkZSBkcmFnRWwgaW4gcmVzcGVjdGl2ZSBkaXJlY3Rpb24gKGlnbm9yaW5nIGhpZGRlbiBlbGVtZW50cylcbiAgICAgICAgICB2YXIgZHJhZ0luZGV4ID0gaW5kZXgoZHJhZ0VsKTtcbiAgICAgICAgICBkbyB7XG4gICAgICAgICAgICBkcmFnSW5kZXggLT0gZGlyZWN0aW9uO1xuICAgICAgICAgICAgc2libGluZyA9IHBhcmVudEVsLmNoaWxkcmVuW2RyYWdJbmRleF07XG4gICAgICAgICAgfSB3aGlsZSAoc2libGluZyAmJiAoY3NzKHNpYmxpbmcsICdkaXNwbGF5JykgPT09ICdub25lJyB8fCBzaWJsaW5nID09PSBnaG9zdEVsKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgZHJhZ0VsIGlzIGFscmVhZHkgYmVzaWRlIHRhcmdldDogRG8gbm90IGluc2VydFxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAwIHx8IHNpYmxpbmcgPT09IHRhcmdldCkge1xuICAgICAgICAgIHJldHVybiBjb21wbGV0ZWQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGxhc3RUYXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIGxhc3REaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgIHZhciBuZXh0U2libGluZyA9IHRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcsXG4gICAgICAgICAgYWZ0ZXIgPSBmYWxzZTtcbiAgICAgICAgYWZ0ZXIgPSBkaXJlY3Rpb24gPT09IDE7XG4gICAgICAgIHZhciBtb3ZlVmVjdG9yID0gX29uTW92ZShyb290RWwsIGVsLCBkcmFnRWwsIGRyYWdSZWN0LCB0YXJnZXQsIHRhcmdldFJlY3QsIGV2dCwgYWZ0ZXIpO1xuICAgICAgICBpZiAobW92ZVZlY3RvciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICBpZiAobW92ZVZlY3RvciA9PT0gMSB8fCBtb3ZlVmVjdG9yID09PSAtMSkge1xuICAgICAgICAgICAgYWZ0ZXIgPSBtb3ZlVmVjdG9yID09PSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfc2lsZW50ID0gdHJ1ZTtcbiAgICAgICAgICBzZXRUaW1lb3V0KF91bnNpbGVudCwgMzApO1xuICAgICAgICAgIGNhcHR1cmUoKTtcbiAgICAgICAgICBpZiAoYWZ0ZXIgJiYgIW5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChkcmFnRWwpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ0VsLCBhZnRlciA/IG5leHRTaWJsaW5nIDogdGFyZ2V0KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBVbmRvIGNocm9tZSdzIHNjcm9sbCBhZGp1c3RtZW50IChoYXMgbm8gZWZmZWN0IG9uIG90aGVyIGJyb3dzZXJzKVxuICAgICAgICAgIGlmIChzY3JvbGxlZFBhc3RUb3ApIHtcbiAgICAgICAgICAgIHNjcm9sbEJ5KHNjcm9sbGVkUGFzdFRvcCwgMCwgc2Nyb2xsQmVmb3JlIC0gc2Nyb2xsZWRQYXN0VG9wLnNjcm9sbFRvcCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBhcmVudEVsID0gZHJhZ0VsLnBhcmVudE5vZGU7IC8vIGFjdHVhbGl6YXRpb25cblxuICAgICAgICAgIC8vIG11c3QgYmUgZG9uZSBiZWZvcmUgYW5pbWF0aW9uXG4gICAgICAgICAgaWYgKHRhcmdldEJlZm9yZUZpcnN0U3dhcCAhPT0gdW5kZWZpbmVkICYmICFpc0NpcmN1bXN0YW50aWFsSW52ZXJ0KSB7XG4gICAgICAgICAgICB0YXJnZXRNb3ZlRGlzdGFuY2UgPSBNYXRoLmFicyh0YXJnZXRCZWZvcmVGaXJzdFN3YXAgLSBnZXRSZWN0KHRhcmdldClbc2lkZTFdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2hhbmdlZCgpO1xuICAgICAgICAgIHJldHVybiBjb21wbGV0ZWQodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChlbC5jb250YWlucyhkcmFnRWwpKSB7XG4gICAgICAgIHJldHVybiBjb21wbGV0ZWQoZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIF9pZ25vcmVXaGlsZUFuaW1hdGluZzogbnVsbCxcbiAgX29mZk1vdmVFdmVudHM6IGZ1bmN0aW9uIF9vZmZNb3ZlRXZlbnRzKCkge1xuICAgIG9mZihkb2N1bWVudCwgJ21vdXNlbW92ZScsIHRoaXMuX29uVG91Y2hNb3ZlKTtcbiAgICBvZmYoZG9jdW1lbnQsICd0b3VjaG1vdmUnLCB0aGlzLl9vblRvdWNoTW92ZSk7XG4gICAgb2ZmKGRvY3VtZW50LCAncG9pbnRlcm1vdmUnLCB0aGlzLl9vblRvdWNoTW92ZSk7XG4gICAgb2ZmKGRvY3VtZW50LCAnZHJhZ292ZXInLCBuZWFyZXN0RW1wdHlJbnNlcnREZXRlY3RFdmVudCk7XG4gICAgb2ZmKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgbmVhcmVzdEVtcHR5SW5zZXJ0RGV0ZWN0RXZlbnQpO1xuICAgIG9mZihkb2N1bWVudCwgJ3RvdWNobW92ZScsIG5lYXJlc3RFbXB0eUluc2VydERldGVjdEV2ZW50KTtcbiAgfSxcbiAgX29mZlVwRXZlbnRzOiBmdW5jdGlvbiBfb2ZmVXBFdmVudHMoKSB7XG4gICAgdmFyIG93bmVyRG9jdW1lbnQgPSB0aGlzLmVsLm93bmVyRG9jdW1lbnQ7XG4gICAgb2ZmKG93bmVyRG9jdW1lbnQsICdtb3VzZXVwJywgdGhpcy5fb25Ecm9wKTtcbiAgICBvZmYob3duZXJEb2N1bWVudCwgJ3RvdWNoZW5kJywgdGhpcy5fb25Ecm9wKTtcbiAgICBvZmYob3duZXJEb2N1bWVudCwgJ3BvaW50ZXJ1cCcsIHRoaXMuX29uRHJvcCk7XG4gICAgb2ZmKG93bmVyRG9jdW1lbnQsICd0b3VjaGNhbmNlbCcsIHRoaXMuX29uRHJvcCk7XG4gICAgb2ZmKGRvY3VtZW50LCAnc2VsZWN0c3RhcnQnLCB0aGlzKTtcbiAgfSxcbiAgX29uRHJvcDogZnVuY3Rpb24gX29uRHJvcCggLyoqRXZlbnQqL2V2dCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWwsXG4gICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG4gICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZHJhZ2dlZCBlbGVtZW50IHdpdGhpbiBpdHMgcGFyZW50XG4gICAgbmV3SW5kZXggPSBpbmRleChkcmFnRWwpO1xuICAgIG5ld0RyYWdnYWJsZUluZGV4ID0gaW5kZXgoZHJhZ0VsLCBvcHRpb25zLmRyYWdnYWJsZSk7XG4gICAgcGx1Z2luRXZlbnQoJ2Ryb3AnLCB0aGlzLCB7XG4gICAgICBldnQ6IGV2dFxuICAgIH0pO1xuICAgIHBhcmVudEVsID0gZHJhZ0VsICYmIGRyYWdFbC5wYXJlbnROb2RlO1xuXG4gICAgLy8gR2V0IGFnYWluIGFmdGVyIHBsdWdpbiBldmVudFxuICAgIG5ld0luZGV4ID0gaW5kZXgoZHJhZ0VsKTtcbiAgICBuZXdEcmFnZ2FibGVJbmRleCA9IGluZGV4KGRyYWdFbCwgb3B0aW9ucy5kcmFnZ2FibGUpO1xuICAgIGlmIChTb3J0YWJsZS5ldmVudENhbmNlbGVkKSB7XG4gICAgICB0aGlzLl9udWxsaW5nKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGF3YWl0aW5nRHJhZ1N0YXJ0ZWQgPSBmYWxzZTtcbiAgICBpc0NpcmN1bXN0YW50aWFsSW52ZXJ0ID0gZmFsc2U7XG4gICAgcGFzdEZpcnN0SW52ZXJ0VGhyZXNoID0gZmFsc2U7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9sb29wSWQpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9kcmFnU3RhcnRUaW1lcik7XG4gICAgX2NhbmNlbE5leHRUaWNrKHRoaXMuY2xvbmVJZCk7XG4gICAgX2NhbmNlbE5leHRUaWNrKHRoaXMuX2RyYWdTdGFydElkKTtcblxuICAgIC8vIFVuYmluZCBldmVudHNcbiAgICBpZiAodGhpcy5uYXRpdmVEcmFnZ2FibGUpIHtcbiAgICAgIG9mZihkb2N1bWVudCwgJ2Ryb3AnLCB0aGlzKTtcbiAgICAgIG9mZihlbCwgJ2RyYWdzdGFydCcsIHRoaXMuX29uRHJhZ1N0YXJ0KTtcbiAgICB9XG4gICAgdGhpcy5fb2ZmTW92ZUV2ZW50cygpO1xuICAgIHRoaXMuX29mZlVwRXZlbnRzKCk7XG4gICAgaWYgKFNhZmFyaSkge1xuICAgICAgY3NzKGRvY3VtZW50LmJvZHksICd1c2VyLXNlbGVjdCcsICcnKTtcbiAgICB9XG4gICAgY3NzKGRyYWdFbCwgJ3RyYW5zZm9ybScsICcnKTtcbiAgICBpZiAoZXZ0KSB7XG4gICAgICBpZiAobW92ZWQpIHtcbiAgICAgICAgZXZ0LmNhbmNlbGFibGUgJiYgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICFvcHRpb25zLmRyb3BCdWJibGUgJiYgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfVxuICAgICAgZ2hvc3RFbCAmJiBnaG9zdEVsLnBhcmVudE5vZGUgJiYgZ2hvc3RFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGdob3N0RWwpO1xuICAgICAgaWYgKHJvb3RFbCA9PT0gcGFyZW50RWwgfHwgcHV0U29ydGFibGUgJiYgcHV0U29ydGFibGUubGFzdFB1dE1vZGUgIT09ICdjbG9uZScpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGNsb25lKHMpXG4gICAgICAgIGNsb25lRWwgJiYgY2xvbmVFbC5wYXJlbnROb2RlICYmIGNsb25lRWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjbG9uZUVsKTtcbiAgICAgIH1cbiAgICAgIGlmIChkcmFnRWwpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlRHJhZ2dhYmxlKSB7XG4gICAgICAgICAgb2ZmKGRyYWdFbCwgJ2RyYWdlbmQnLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBfZGlzYWJsZURyYWdnYWJsZShkcmFnRWwpO1xuICAgICAgICBkcmFnRWwuc3R5bGVbJ3dpbGwtY2hhbmdlJ10gPSAnJztcblxuICAgICAgICAvLyBSZW1vdmUgY2xhc3Nlc1xuICAgICAgICAvLyBnaG9zdENsYXNzIGlzIGFkZGVkIGluIGRyYWdTdGFydGVkXG4gICAgICAgIGlmIChtb3ZlZCAmJiAhYXdhaXRpbmdEcmFnU3RhcnRlZCkge1xuICAgICAgICAgIHRvZ2dsZUNsYXNzKGRyYWdFbCwgcHV0U29ydGFibGUgPyBwdXRTb3J0YWJsZS5vcHRpb25zLmdob3N0Q2xhc3MgOiB0aGlzLm9wdGlvbnMuZ2hvc3RDbGFzcywgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRvZ2dsZUNsYXNzKGRyYWdFbCwgdGhpcy5vcHRpb25zLmNob3NlbkNsYXNzLCBmYWxzZSk7XG5cbiAgICAgICAgLy8gRHJhZyBzdG9wIGV2ZW50XG4gICAgICAgIF9kaXNwYXRjaEV2ZW50KHtcbiAgICAgICAgICBzb3J0YWJsZTogdGhpcyxcbiAgICAgICAgICBuYW1lOiAndW5jaG9vc2UnLFxuICAgICAgICAgIHRvRWw6IHBhcmVudEVsLFxuICAgICAgICAgIG5ld0luZGV4OiBudWxsLFxuICAgICAgICAgIG5ld0RyYWdnYWJsZUluZGV4OiBudWxsLFxuICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2dFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHJvb3RFbCAhPT0gcGFyZW50RWwpIHtcbiAgICAgICAgICBpZiAobmV3SW5kZXggPj0gMCkge1xuICAgICAgICAgICAgLy8gQWRkIGV2ZW50XG4gICAgICAgICAgICBfZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgICAgICAgIHJvb3RFbDogcGFyZW50RWwsXG4gICAgICAgICAgICAgIG5hbWU6ICdhZGQnLFxuICAgICAgICAgICAgICB0b0VsOiBwYXJlbnRFbCxcbiAgICAgICAgICAgICAgZnJvbUVsOiByb290RWwsXG4gICAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2dFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSBldmVudFxuICAgICAgICAgICAgX2Rpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgICAgICBzb3J0YWJsZTogdGhpcyxcbiAgICAgICAgICAgICAgbmFtZTogJ3JlbW92ZScsXG4gICAgICAgICAgICAgIHRvRWw6IHBhcmVudEVsLFxuICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBkcmFnIGZyb20gb25lIGxpc3QgYW5kIGRyb3AgaW50byBhbm90aGVyXG4gICAgICAgICAgICBfZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgICAgICAgIHJvb3RFbDogcGFyZW50RWwsXG4gICAgICAgICAgICAgIG5hbWU6ICdzb3J0JyxcbiAgICAgICAgICAgICAgdG9FbDogcGFyZW50RWwsXG4gICAgICAgICAgICAgIGZyb21FbDogcm9vdEVsLFxuICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX2Rpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgICAgICBzb3J0YWJsZTogdGhpcyxcbiAgICAgICAgICAgICAgbmFtZTogJ3NvcnQnLFxuICAgICAgICAgICAgICB0b0VsOiBwYXJlbnRFbCxcbiAgICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcHV0U29ydGFibGUgJiYgcHV0U29ydGFibGUuc2F2ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChuZXdJbmRleCAhPT0gb2xkSW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChuZXdJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICAgIC8vIGRyYWcgJiBkcm9wIHdpdGhpbiB0aGUgc2FtZSBsaXN0XG4gICAgICAgICAgICAgIF9kaXNwYXRjaEV2ZW50KHtcbiAgICAgICAgICAgICAgICBzb3J0YWJsZTogdGhpcyxcbiAgICAgICAgICAgICAgICBuYW1lOiAndXBkYXRlJyxcbiAgICAgICAgICAgICAgICB0b0VsOiBwYXJlbnRFbCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIF9kaXNwYXRjaEV2ZW50KHtcbiAgICAgICAgICAgICAgICBzb3J0YWJsZTogdGhpcyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnc29ydCcsXG4gICAgICAgICAgICAgICAgdG9FbDogcGFyZW50RWwsXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoU29ydGFibGUuYWN0aXZlKSB7XG4gICAgICAgICAgLyoganNoaW50IGVxbnVsbDp0cnVlICovXG4gICAgICAgICAgaWYgKG5ld0luZGV4ID09IG51bGwgfHwgbmV3SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICBuZXdJbmRleCA9IG9sZEluZGV4O1xuICAgICAgICAgICAgbmV3RHJhZ2dhYmxlSW5kZXggPSBvbGREcmFnZ2FibGVJbmRleDtcbiAgICAgICAgICB9XG4gICAgICAgICAgX2Rpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgICAgc29ydGFibGU6IHRoaXMsXG4gICAgICAgICAgICBuYW1lOiAnZW5kJyxcbiAgICAgICAgICAgIHRvRWw6IHBhcmVudEVsLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBTYXZlIHNvcnRpbmdcbiAgICAgICAgICB0aGlzLnNhdmUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLl9udWxsaW5nKCk7XG4gIH0sXG4gIF9udWxsaW5nOiBmdW5jdGlvbiBfbnVsbGluZygpIHtcbiAgICBwbHVnaW5FdmVudCgnbnVsbGluZycsIHRoaXMpO1xuICAgIHJvb3RFbCA9IGRyYWdFbCA9IHBhcmVudEVsID0gZ2hvc3RFbCA9IG5leHRFbCA9IGNsb25lRWwgPSBsYXN0RG93bkVsID0gY2xvbmVIaWRkZW4gPSB0YXBFdnQgPSB0b3VjaEV2dCA9IG1vdmVkID0gbmV3SW5kZXggPSBuZXdEcmFnZ2FibGVJbmRleCA9IG9sZEluZGV4ID0gb2xkRHJhZ2dhYmxlSW5kZXggPSBsYXN0VGFyZ2V0ID0gbGFzdERpcmVjdGlvbiA9IHB1dFNvcnRhYmxlID0gYWN0aXZlR3JvdXAgPSBTb3J0YWJsZS5kcmFnZ2VkID0gU29ydGFibGUuZ2hvc3QgPSBTb3J0YWJsZS5jbG9uZSA9IFNvcnRhYmxlLmFjdGl2ZSA9IG51bGw7XG4gICAgc2F2ZWRJbnB1dENoZWNrZWQuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGVsLmNoZWNrZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIHNhdmVkSW5wdXRDaGVja2VkLmxlbmd0aCA9IGxhc3REeCA9IGxhc3REeSA9IDA7XG4gIH0sXG4gIGhhbmRsZUV2ZW50OiBmdW5jdGlvbiBoYW5kbGVFdmVudCggLyoqRXZlbnQqL2V2dCkge1xuICAgIHN3aXRjaCAoZXZ0LnR5cGUpIHtcbiAgICAgIGNhc2UgJ2Ryb3AnOlxuICAgICAgY2FzZSAnZHJhZ2VuZCc6XG4gICAgICAgIHRoaXMuX29uRHJvcChldnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2RyYWdlbnRlcic6XG4gICAgICBjYXNlICdkcmFnb3Zlcic6XG4gICAgICAgIGlmIChkcmFnRWwpIHtcbiAgICAgICAgICB0aGlzLl9vbkRyYWdPdmVyKGV2dCk7XG4gICAgICAgICAgX2dsb2JhbERyYWdPdmVyKGV2dCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdzZWxlY3RzdGFydCc6XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH0sXG4gIC8qKlxyXG4gICAqIFNlcmlhbGl6ZXMgdGhlIGl0ZW0gaW50byBhbiBhcnJheSBvZiBzdHJpbmcuXHJcbiAgICogQHJldHVybnMge1N0cmluZ1tdfVxyXG4gICAqL1xuICB0b0FycmF5OiBmdW5jdGlvbiB0b0FycmF5KCkge1xuICAgIHZhciBvcmRlciA9IFtdLFxuICAgICAgZWwsXG4gICAgICBjaGlsZHJlbiA9IHRoaXMuZWwuY2hpbGRyZW4sXG4gICAgICBpID0gMCxcbiAgICAgIG4gPSBjaGlsZHJlbi5sZW5ndGgsXG4gICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuICAgIGZvciAoOyBpIDwgbjsgaSsrKSB7XG4gICAgICBlbCA9IGNoaWxkcmVuW2ldO1xuICAgICAgaWYgKGNsb3Nlc3QoZWwsIG9wdGlvbnMuZHJhZ2dhYmxlLCB0aGlzLmVsLCBmYWxzZSkpIHtcbiAgICAgICAgb3JkZXIucHVzaChlbC5nZXRBdHRyaWJ1dGUob3B0aW9ucy5kYXRhSWRBdHRyKSB8fCBfZ2VuZXJhdGVJZChlbCkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3JkZXI7XG4gIH0sXG4gIC8qKlxyXG4gICAqIFNvcnRzIHRoZSBlbGVtZW50cyBhY2NvcmRpbmcgdG8gdGhlIGFycmF5LlxyXG4gICAqIEBwYXJhbSAge1N0cmluZ1tdfSAgb3JkZXIgIG9yZGVyIG9mIHRoZSBpdGVtc1xyXG4gICAqL1xuICBzb3J0OiBmdW5jdGlvbiBzb3J0KG9yZGVyLCB1c2VBbmltYXRpb24pIHtcbiAgICB2YXIgaXRlbXMgPSB7fSxcbiAgICAgIHJvb3RFbCA9IHRoaXMuZWw7XG4gICAgdGhpcy50b0FycmF5KCkuZm9yRWFjaChmdW5jdGlvbiAoaWQsIGkpIHtcbiAgICAgIHZhciBlbCA9IHJvb3RFbC5jaGlsZHJlbltpXTtcbiAgICAgIGlmIChjbG9zZXN0KGVsLCB0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlLCByb290RWwsIGZhbHNlKSkge1xuICAgICAgICBpdGVtc1tpZF0gPSBlbDtcbiAgICAgIH1cbiAgICB9LCB0aGlzKTtcbiAgICB1c2VBbmltYXRpb24gJiYgdGhpcy5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKTtcbiAgICBvcmRlci5mb3JFYWNoKGZ1bmN0aW9uIChpZCkge1xuICAgICAgaWYgKGl0ZW1zW2lkXSkge1xuICAgICAgICByb290RWwucmVtb3ZlQ2hpbGQoaXRlbXNbaWRdKTtcbiAgICAgICAgcm9vdEVsLmFwcGVuZENoaWxkKGl0ZW1zW2lkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdXNlQW5pbWF0aW9uICYmIHRoaXMuYW5pbWF0ZUFsbCgpO1xuICB9LFxuICAvKipcclxuICAgKiBTYXZlIHRoZSBjdXJyZW50IHNvcnRpbmdcclxuICAgKi9cbiAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICB2YXIgc3RvcmUgPSB0aGlzLm9wdGlvbnMuc3RvcmU7XG4gICAgc3RvcmUgJiYgc3RvcmUuc2V0ICYmIHN0b3JlLnNldCh0aGlzKTtcbiAgfSxcbiAgLyoqXHJcbiAgICogRm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgc2V0LCBnZXQgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBtYXRjaGVzIHRoZSBzZWxlY3RvciBieSB0ZXN0aW5nIHRoZSBlbGVtZW50IGl0c2VsZiBhbmQgdHJhdmVyc2luZyB1cCB0aHJvdWdoIGl0cyBhbmNlc3RvcnMgaW4gdGhlIERPTSB0cmVlLlxyXG4gICAqIEBwYXJhbSAgIHtIVE1MRWxlbWVudH0gIGVsXHJcbiAgICogQHBhcmFtICAge1N0cmluZ30gICAgICAgW3NlbGVjdG9yXSAgZGVmYXVsdDogYG9wdGlvbnMuZHJhZ2dhYmxlYFxyXG4gICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudHxudWxsfVxyXG4gICAqL1xuICBjbG9zZXN0OiBmdW5jdGlvbiBjbG9zZXN0JDEoZWwsIHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIGNsb3Nlc3QoZWwsIHNlbGVjdG9yIHx8IHRoaXMub3B0aW9ucy5kcmFnZ2FibGUsIHRoaXMuZWwsIGZhbHNlKTtcbiAgfSxcbiAgLyoqXHJcbiAgICogU2V0L2dldCBvcHRpb25cclxuICAgKiBAcGFyYW0gICB7c3RyaW5nfSBuYW1lXHJcbiAgICogQHBhcmFtICAgeyp9ICAgICAgW3ZhbHVlXVxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xuICBvcHRpb246IGZ1bmN0aW9uIG9wdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gb3B0aW9uc1tuYW1lXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIG1vZGlmaWVkVmFsdWUgPSBQbHVnaW5NYW5hZ2VyLm1vZGlmeU9wdGlvbih0aGlzLCBuYW1lLCB2YWx1ZSk7XG4gICAgICBpZiAodHlwZW9mIG1vZGlmaWVkVmFsdWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG9wdGlvbnNbbmFtZV0gPSBtb2RpZmllZFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3B0aW9uc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKG5hbWUgPT09ICdncm91cCcpIHtcbiAgICAgICAgX3ByZXBhcmVHcm91cChvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIC8qKlxyXG4gICAqIERlc3Ryb3lcclxuICAgKi9cbiAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICBwbHVnaW5FdmVudCgnZGVzdHJveScsIHRoaXMpO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgZWxbZXhwYW5kb10gPSBudWxsO1xuICAgIG9mZihlbCwgJ21vdXNlZG93bicsIHRoaXMuX29uVGFwU3RhcnQpO1xuICAgIG9mZihlbCwgJ3RvdWNoc3RhcnQnLCB0aGlzLl9vblRhcFN0YXJ0KTtcbiAgICBvZmYoZWwsICdwb2ludGVyZG93bicsIHRoaXMuX29uVGFwU3RhcnQpO1xuICAgIGlmICh0aGlzLm5hdGl2ZURyYWdnYWJsZSkge1xuICAgICAgb2ZmKGVsLCAnZHJhZ292ZXInLCB0aGlzKTtcbiAgICAgIG9mZihlbCwgJ2RyYWdlbnRlcicsIHRoaXMpO1xuICAgIH1cbiAgICAvLyBSZW1vdmUgZHJhZ2dhYmxlIGF0dHJpYnV0ZXNcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkcmFnZ2FibGVdJyksIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdkcmFnZ2FibGUnKTtcbiAgICB9KTtcbiAgICB0aGlzLl9vbkRyb3AoKTtcbiAgICB0aGlzLl9kaXNhYmxlRGVsYXllZERyYWdFdmVudHMoKTtcbiAgICBzb3J0YWJsZXMuc3BsaWNlKHNvcnRhYmxlcy5pbmRleE9mKHRoaXMuZWwpLCAxKTtcbiAgICB0aGlzLmVsID0gZWwgPSBudWxsO1xuICB9LFxuICBfaGlkZUNsb25lOiBmdW5jdGlvbiBfaGlkZUNsb25lKCkge1xuICAgIGlmICghY2xvbmVIaWRkZW4pIHtcbiAgICAgIHBsdWdpbkV2ZW50KCdoaWRlQ2xvbmUnLCB0aGlzKTtcbiAgICAgIGlmIChTb3J0YWJsZS5ldmVudENhbmNlbGVkKSByZXR1cm47XG4gICAgICBjc3MoY2xvbmVFbCwgJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5yZW1vdmVDbG9uZU9uSGlkZSAmJiBjbG9uZUVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgY2xvbmVFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNsb25lRWwpO1xuICAgICAgfVxuICAgICAgY2xvbmVIaWRkZW4gPSB0cnVlO1xuICAgIH1cbiAgfSxcbiAgX3Nob3dDbG9uZTogZnVuY3Rpb24gX3Nob3dDbG9uZShwdXRTb3J0YWJsZSkge1xuICAgIGlmIChwdXRTb3J0YWJsZS5sYXN0UHV0TW9kZSAhPT0gJ2Nsb25lJykge1xuICAgICAgdGhpcy5faGlkZUNsb25lKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjbG9uZUhpZGRlbikge1xuICAgICAgcGx1Z2luRXZlbnQoJ3Nob3dDbG9uZScsIHRoaXMpO1xuICAgICAgaWYgKFNvcnRhYmxlLmV2ZW50Q2FuY2VsZWQpIHJldHVybjtcblxuICAgICAgLy8gc2hvdyBjbG9uZSBhdCBkcmFnRWwgb3Igb3JpZ2luYWwgcG9zaXRpb25cbiAgICAgIGlmIChkcmFnRWwucGFyZW50Tm9kZSA9PSByb290RWwgJiYgIXRoaXMub3B0aW9ucy5ncm91cC5yZXZlcnRDbG9uZSkge1xuICAgICAgICByb290RWwuaW5zZXJ0QmVmb3JlKGNsb25lRWwsIGRyYWdFbCk7XG4gICAgICB9IGVsc2UgaWYgKG5leHRFbCkge1xuICAgICAgICByb290RWwuaW5zZXJ0QmVmb3JlKGNsb25lRWwsIG5leHRFbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByb290RWwuYXBwZW5kQ2hpbGQoY2xvbmVFbCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmdyb3VwLnJldmVydENsb25lKSB7XG4gICAgICAgIHRoaXMuYW5pbWF0ZShkcmFnRWwsIGNsb25lRWwpO1xuICAgICAgfVxuICAgICAgY3NzKGNsb25lRWwsICdkaXNwbGF5JywgJycpO1xuICAgICAgY2xvbmVIaWRkZW4gPSBmYWxzZTtcbiAgICB9XG4gIH1cbn07XG5mdW5jdGlvbiBfZ2xvYmFsRHJhZ092ZXIoIC8qKkV2ZW50Ki9ldnQpIHtcbiAgaWYgKGV2dC5kYXRhVHJhbnNmZXIpIHtcbiAgICBldnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnbW92ZSc7XG4gIH1cbiAgZXZ0LmNhbmNlbGFibGUgJiYgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG59XG5mdW5jdGlvbiBfb25Nb3ZlKGZyb21FbCwgdG9FbCwgZHJhZ0VsLCBkcmFnUmVjdCwgdGFyZ2V0RWwsIHRhcmdldFJlY3QsIG9yaWdpbmFsRXZlbnQsIHdpbGxJbnNlcnRBZnRlcikge1xuICB2YXIgZXZ0LFxuICAgIHNvcnRhYmxlID0gZnJvbUVsW2V4cGFuZG9dLFxuICAgIG9uTW92ZUZuID0gc29ydGFibGUub3B0aW9ucy5vbk1vdmUsXG4gICAgcmV0VmFsO1xuICAvLyBTdXBwb3J0IGZvciBuZXcgQ3VzdG9tRXZlbnQgZmVhdHVyZVxuICBpZiAod2luZG93LkN1c3RvbUV2ZW50ICYmICFJRTExT3JMZXNzICYmICFFZGdlKSB7XG4gICAgZXZ0ID0gbmV3IEN1c3RvbUV2ZW50KCdtb3ZlJywge1xuICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTtcbiAgICBldnQuaW5pdEV2ZW50KCdtb3ZlJywgdHJ1ZSwgdHJ1ZSk7XG4gIH1cbiAgZXZ0LnRvID0gdG9FbDtcbiAgZXZ0LmZyb20gPSBmcm9tRWw7XG4gIGV2dC5kcmFnZ2VkID0gZHJhZ0VsO1xuICBldnQuZHJhZ2dlZFJlY3QgPSBkcmFnUmVjdDtcbiAgZXZ0LnJlbGF0ZWQgPSB0YXJnZXRFbCB8fCB0b0VsO1xuICBldnQucmVsYXRlZFJlY3QgPSB0YXJnZXRSZWN0IHx8IGdldFJlY3QodG9FbCk7XG4gIGV2dC53aWxsSW5zZXJ0QWZ0ZXIgPSB3aWxsSW5zZXJ0QWZ0ZXI7XG4gIGV2dC5vcmlnaW5hbEV2ZW50ID0gb3JpZ2luYWxFdmVudDtcbiAgZnJvbUVsLmRpc3BhdGNoRXZlbnQoZXZ0KTtcbiAgaWYgKG9uTW92ZUZuKSB7XG4gICAgcmV0VmFsID0gb25Nb3ZlRm4uY2FsbChzb3J0YWJsZSwgZXZ0LCBvcmlnaW5hbEV2ZW50KTtcbiAgfVxuICByZXR1cm4gcmV0VmFsO1xufVxuZnVuY3Rpb24gX2Rpc2FibGVEcmFnZ2FibGUoZWwpIHtcbiAgZWwuZHJhZ2dhYmxlID0gZmFsc2U7XG59XG5mdW5jdGlvbiBfdW5zaWxlbnQoKSB7XG4gIF9zaWxlbnQgPSBmYWxzZTtcbn1cbmZ1bmN0aW9uIF9naG9zdElzRmlyc3QoZXZ0LCB2ZXJ0aWNhbCwgc29ydGFibGUpIHtcbiAgdmFyIGZpcnN0RWxSZWN0ID0gZ2V0UmVjdChnZXRDaGlsZChzb3J0YWJsZS5lbCwgMCwgc29ydGFibGUub3B0aW9ucywgdHJ1ZSkpO1xuICB2YXIgc29ydGFibGVDb250ZW50UmVjdCA9IGdldENvbnRlbnRSZWN0KHNvcnRhYmxlLmVsKTtcbiAgdmFyIHNwYWNlciA9IDEwO1xuICByZXR1cm4gdmVydGljYWwgPyBldnQuY2xpZW50WCA8IHNvcnRhYmxlQ29udGVudFJlY3QubGVmdCAtIHNwYWNlciB8fCBldnQuY2xpZW50WSA8IGZpcnN0RWxSZWN0LnRvcCAmJiBldnQuY2xpZW50WCA8IGZpcnN0RWxSZWN0LnJpZ2h0IDogZXZ0LmNsaWVudFkgPCBzb3J0YWJsZUNvbnRlbnRSZWN0LnRvcCAtIHNwYWNlciB8fCBldnQuY2xpZW50WSA8IGZpcnN0RWxSZWN0LmJvdHRvbSAmJiBldnQuY2xpZW50WCA8IGZpcnN0RWxSZWN0LmxlZnQ7XG59XG5mdW5jdGlvbiBfZ2hvc3RJc0xhc3QoZXZ0LCB2ZXJ0aWNhbCwgc29ydGFibGUpIHtcbiAgdmFyIGxhc3RFbFJlY3QgPSBnZXRSZWN0KGxhc3RDaGlsZChzb3J0YWJsZS5lbCwgc29ydGFibGUub3B0aW9ucy5kcmFnZ2FibGUpKTtcbiAgdmFyIHNvcnRhYmxlQ29udGVudFJlY3QgPSBnZXRDb250ZW50UmVjdChzb3J0YWJsZS5lbCk7XG4gIHZhciBzcGFjZXIgPSAxMDtcbiAgcmV0dXJuIHZlcnRpY2FsID8gZXZ0LmNsaWVudFggPiBzb3J0YWJsZUNvbnRlbnRSZWN0LnJpZ2h0ICsgc3BhY2VyIHx8IGV2dC5jbGllbnRZID4gbGFzdEVsUmVjdC5ib3R0b20gJiYgZXZ0LmNsaWVudFggPiBsYXN0RWxSZWN0LmxlZnQgOiBldnQuY2xpZW50WSA+IHNvcnRhYmxlQ29udGVudFJlY3QuYm90dG9tICsgc3BhY2VyIHx8IGV2dC5jbGllbnRYID4gbGFzdEVsUmVjdC5yaWdodCAmJiBldnQuY2xpZW50WSA+IGxhc3RFbFJlY3QudG9wO1xufVxuZnVuY3Rpb24gX2dldFN3YXBEaXJlY3Rpb24oZXZ0LCB0YXJnZXQsIHRhcmdldFJlY3QsIHZlcnRpY2FsLCBzd2FwVGhyZXNob2xkLCBpbnZlcnRlZFN3YXBUaHJlc2hvbGQsIGludmVydFN3YXAsIGlzTGFzdFRhcmdldCkge1xuICB2YXIgbW91c2VPbkF4aXMgPSB2ZXJ0aWNhbCA/IGV2dC5jbGllbnRZIDogZXZ0LmNsaWVudFgsXG4gICAgdGFyZ2V0TGVuZ3RoID0gdmVydGljYWwgPyB0YXJnZXRSZWN0LmhlaWdodCA6IHRhcmdldFJlY3Qud2lkdGgsXG4gICAgdGFyZ2V0UzEgPSB2ZXJ0aWNhbCA/IHRhcmdldFJlY3QudG9wIDogdGFyZ2V0UmVjdC5sZWZ0LFxuICAgIHRhcmdldFMyID0gdmVydGljYWwgPyB0YXJnZXRSZWN0LmJvdHRvbSA6IHRhcmdldFJlY3QucmlnaHQsXG4gICAgaW52ZXJ0ID0gZmFsc2U7XG4gIGlmICghaW52ZXJ0U3dhcCkge1xuICAgIC8vIE5ldmVyIGludmVydCBvciBjcmVhdGUgZHJhZ0VsIHNoYWRvdyB3aGVuIHRhcmdldCBtb3ZlbWVuZXQgY2F1c2VzIG1vdXNlIHRvIG1vdmUgcGFzdCB0aGUgZW5kIG9mIHJlZ3VsYXIgc3dhcFRocmVzaG9sZFxuICAgIGlmIChpc0xhc3RUYXJnZXQgJiYgdGFyZ2V0TW92ZURpc3RhbmNlIDwgdGFyZ2V0TGVuZ3RoICogc3dhcFRocmVzaG9sZCkge1xuICAgICAgLy8gbXVsdGlwbGllZCBvbmx5IGJ5IHN3YXBUaHJlc2hvbGQgYmVjYXVzZSBtb3VzZSB3aWxsIGFscmVhZHkgYmUgaW5zaWRlIHRhcmdldCBieSAoMSAtIHRocmVzaG9sZCkgKiB0YXJnZXRMZW5ndGggLyAyXG4gICAgICAvLyBjaGVjayBpZiBwYXN0IGZpcnN0IGludmVydCB0aHJlc2hvbGQgb24gc2lkZSBvcHBvc2l0ZSBvZiBsYXN0RGlyZWN0aW9uXG4gICAgICBpZiAoIXBhc3RGaXJzdEludmVydFRocmVzaCAmJiAobGFzdERpcmVjdGlvbiA9PT0gMSA/IG1vdXNlT25BeGlzID4gdGFyZ2V0UzEgKyB0YXJnZXRMZW5ndGggKiBpbnZlcnRlZFN3YXBUaHJlc2hvbGQgLyAyIDogbW91c2VPbkF4aXMgPCB0YXJnZXRTMiAtIHRhcmdldExlbmd0aCAqIGludmVydGVkU3dhcFRocmVzaG9sZCAvIDIpKSB7XG4gICAgICAgIC8vIHBhc3QgZmlyc3QgaW52ZXJ0IHRocmVzaG9sZCwgZG8gbm90IHJlc3RyaWN0IGludmVydGVkIHRocmVzaG9sZCB0byBkcmFnRWwgc2hhZG93XG4gICAgICAgIHBhc3RGaXJzdEludmVydFRocmVzaCA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoIXBhc3RGaXJzdEludmVydFRocmVzaCkge1xuICAgICAgICAvLyBkcmFnRWwgc2hhZG93ICh0YXJnZXQgbW92ZSBkaXN0YW5jZSBzaGFkb3cpXG4gICAgICAgIGlmIChsYXN0RGlyZWN0aW9uID09PSAxID8gbW91c2VPbkF4aXMgPCB0YXJnZXRTMSArIHRhcmdldE1vdmVEaXN0YW5jZSAvLyBvdmVyIGRyYWdFbCBzaGFkb3dcbiAgICAgICAgOiBtb3VzZU9uQXhpcyA+IHRhcmdldFMyIC0gdGFyZ2V0TW92ZURpc3RhbmNlKSB7XG4gICAgICAgICAgcmV0dXJuIC1sYXN0RGlyZWN0aW9uO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnZlcnQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZWd1bGFyXG4gICAgICBpZiAobW91c2VPbkF4aXMgPiB0YXJnZXRTMSArIHRhcmdldExlbmd0aCAqICgxIC0gc3dhcFRocmVzaG9sZCkgLyAyICYmIG1vdXNlT25BeGlzIDwgdGFyZ2V0UzIgLSB0YXJnZXRMZW5ndGggKiAoMSAtIHN3YXBUaHJlc2hvbGQpIC8gMikge1xuICAgICAgICByZXR1cm4gX2dldEluc2VydERpcmVjdGlvbih0YXJnZXQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpbnZlcnQgPSBpbnZlcnQgfHwgaW52ZXJ0U3dhcDtcbiAgaWYgKGludmVydCkge1xuICAgIC8vIEludmVydCBvZiByZWd1bGFyXG4gICAgaWYgKG1vdXNlT25BeGlzIDwgdGFyZ2V0UzEgKyB0YXJnZXRMZW5ndGggKiBpbnZlcnRlZFN3YXBUaHJlc2hvbGQgLyAyIHx8IG1vdXNlT25BeGlzID4gdGFyZ2V0UzIgLSB0YXJnZXRMZW5ndGggKiBpbnZlcnRlZFN3YXBUaHJlc2hvbGQgLyAyKSB7XG4gICAgICByZXR1cm4gbW91c2VPbkF4aXMgPiB0YXJnZXRTMSArIHRhcmdldExlbmd0aCAvIDIgPyAxIDogLTE7XG4gICAgfVxuICB9XG4gIHJldHVybiAwO1xufVxuXG4vKipcclxuICogR2V0cyB0aGUgZGlyZWN0aW9uIGRyYWdFbCBtdXN0IGJlIHN3YXBwZWQgcmVsYXRpdmUgdG8gdGFyZ2V0IGluIG9yZGVyIHRvIG1ha2UgaXRcclxuICogc2VlbSB0aGF0IGRyYWdFbCBoYXMgYmVlbiBcImluc2VydGVkXCIgaW50byB0aGF0IGVsZW1lbnQncyBwb3NpdGlvblxyXG4gKiBAcGFyYW0gIHtIVE1MRWxlbWVudH0gdGFyZ2V0ICAgICAgIFRoZSB0YXJnZXQgd2hvc2UgcG9zaXRpb24gZHJhZ0VsIGlzIGJlaW5nIGluc2VydGVkIGF0XHJcbiAqIEByZXR1cm4ge051bWJlcn0gICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uIGRyYWdFbCBtdXN0IGJlIHN3YXBwZWRcclxuICovXG5mdW5jdGlvbiBfZ2V0SW5zZXJ0RGlyZWN0aW9uKHRhcmdldCkge1xuICBpZiAoaW5kZXgoZHJhZ0VsKSA8IGluZGV4KHRhcmdldCkpIHtcbiAgICByZXR1cm4gMTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cbn1cblxuLyoqXHJcbiAqIEdlbmVyYXRlIGlkXHJcbiAqIEBwYXJhbSAgIHtIVE1MRWxlbWVudH0gZWxcclxuICogQHJldHVybnMge1N0cmluZ31cclxuICogQHByaXZhdGVcclxuICovXG5mdW5jdGlvbiBfZ2VuZXJhdGVJZChlbCkge1xuICB2YXIgc3RyID0gZWwudGFnTmFtZSArIGVsLmNsYXNzTmFtZSArIGVsLnNyYyArIGVsLmhyZWYgKyBlbC50ZXh0Q29udGVudCxcbiAgICBpID0gc3RyLmxlbmd0aCxcbiAgICBzdW0gPSAwO1xuICB3aGlsZSAoaS0tKSB7XG4gICAgc3VtICs9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICB9XG4gIHJldHVybiBzdW0udG9TdHJpbmcoMzYpO1xufVxuZnVuY3Rpb24gX3NhdmVJbnB1dENoZWNrZWRTdGF0ZShyb290KSB7XG4gIHNhdmVkSW5wdXRDaGVja2VkLmxlbmd0aCA9IDA7XG4gIHZhciBpbnB1dHMgPSByb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpO1xuICB2YXIgaWR4ID0gaW5wdXRzLmxlbmd0aDtcbiAgd2hpbGUgKGlkeC0tKSB7XG4gICAgdmFyIGVsID0gaW5wdXRzW2lkeF07XG4gICAgZWwuY2hlY2tlZCAmJiBzYXZlZElucHV0Q2hlY2tlZC5wdXNoKGVsKTtcbiAgfVxufVxuZnVuY3Rpb24gX25leHRUaWNrKGZuKSB7XG4gIHJldHVybiBzZXRUaW1lb3V0KGZuLCAwKTtcbn1cbmZ1bmN0aW9uIF9jYW5jZWxOZXh0VGljayhpZCkge1xuICByZXR1cm4gY2xlYXJUaW1lb3V0KGlkKTtcbn1cblxuLy8gRml4ZWQgIzk3MzpcbmlmIChkb2N1bWVudEV4aXN0cykge1xuICBvbihkb2N1bWVudCwgJ3RvdWNobW92ZScsIGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAoKFNvcnRhYmxlLmFjdGl2ZSB8fCBhd2FpdGluZ0RyYWdTdGFydGVkKSAmJiBldnQuY2FuY2VsYWJsZSkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gRXhwb3J0IHV0aWxzXG5Tb3J0YWJsZS51dGlscyA9IHtcbiAgb246IG9uLFxuICBvZmY6IG9mZixcbiAgY3NzOiBjc3MsXG4gIGZpbmQ6IGZpbmQsXG4gIGlzOiBmdW5jdGlvbiBpcyhlbCwgc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gISFjbG9zZXN0KGVsLCBzZWxlY3RvciwgZWwsIGZhbHNlKTtcbiAgfSxcbiAgZXh0ZW5kOiBleHRlbmQsXG4gIHRocm90dGxlOiB0aHJvdHRsZSxcbiAgY2xvc2VzdDogY2xvc2VzdCxcbiAgdG9nZ2xlQ2xhc3M6IHRvZ2dsZUNsYXNzLFxuICBjbG9uZTogY2xvbmUsXG4gIGluZGV4OiBpbmRleCxcbiAgbmV4dFRpY2s6IF9uZXh0VGljayxcbiAgY2FuY2VsTmV4dFRpY2s6IF9jYW5jZWxOZXh0VGljayxcbiAgZGV0ZWN0RGlyZWN0aW9uOiBfZGV0ZWN0RGlyZWN0aW9uLFxuICBnZXRDaGlsZDogZ2V0Q2hpbGRcbn07XG5cbi8qKlxyXG4gKiBHZXQgdGhlIFNvcnRhYmxlIGluc3RhbmNlIG9mIGFuIGVsZW1lbnRcclxuICogQHBhcmFtICB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgVGhlIGVsZW1lbnRcclxuICogQHJldHVybiB7U29ydGFibGV8dW5kZWZpbmVkfSAgICAgICAgIFRoZSBpbnN0YW5jZSBvZiBTb3J0YWJsZVxyXG4gKi9cblNvcnRhYmxlLmdldCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50W2V4cGFuZG9dO1xufTtcblxuLyoqXHJcbiAqIE1vdW50IGEgcGx1Z2luIHRvIFNvcnRhYmxlXHJcbiAqIEBwYXJhbSAgey4uLlNvcnRhYmxlUGx1Z2lufFNvcnRhYmxlUGx1Z2luW119IHBsdWdpbnMgICAgICAgUGx1Z2lucyBiZWluZyBtb3VudGVkXHJcbiAqL1xuU29ydGFibGUubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBwbHVnaW5zID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIHBsdWdpbnNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cbiAgaWYgKHBsdWdpbnNbMF0uY29uc3RydWN0b3IgPT09IEFycmF5KSBwbHVnaW5zID0gcGx1Z2luc1swXTtcbiAgcGx1Z2lucy5mb3JFYWNoKGZ1bmN0aW9uIChwbHVnaW4pIHtcbiAgICBpZiAoIXBsdWdpbi5wcm90b3R5cGUgfHwgIXBsdWdpbi5wcm90b3R5cGUuY29uc3RydWN0b3IpIHtcbiAgICAgIHRocm93IFwiU29ydGFibGU6IE1vdW50ZWQgcGx1Z2luIG11c3QgYmUgYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiwgbm90IFwiLmNvbmNhdCh7fS50b1N0cmluZy5jYWxsKHBsdWdpbikpO1xuICAgIH1cbiAgICBpZiAocGx1Z2luLnV0aWxzKSBTb3J0YWJsZS51dGlscyA9IF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHt9LCBTb3J0YWJsZS51dGlscyksIHBsdWdpbi51dGlscyk7XG4gICAgUGx1Z2luTWFuYWdlci5tb3VudChwbHVnaW4pO1xuICB9KTtcbn07XG5cbi8qKlxyXG4gKiBDcmVhdGUgc29ydGFibGUgaW5zdGFuY2VcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gIGVsXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSAgICAgIFtvcHRpb25zXVxyXG4gKi9cblNvcnRhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChlbCwgb3B0aW9ucykge1xuICByZXR1cm4gbmV3IFNvcnRhYmxlKGVsLCBvcHRpb25zKTtcbn07XG5cbi8vIEV4cG9ydFxuU29ydGFibGUudmVyc2lvbiA9IHZlcnNpb247XG5cbnZhciBhdXRvU2Nyb2xscyA9IFtdLFxuICBzY3JvbGxFbCxcbiAgc2Nyb2xsUm9vdEVsLFxuICBzY3JvbGxpbmcgPSBmYWxzZSxcbiAgbGFzdEF1dG9TY3JvbGxYLFxuICBsYXN0QXV0b1Njcm9sbFksXG4gIHRvdWNoRXZ0JDEsXG4gIHBvaW50ZXJFbGVtQ2hhbmdlZEludGVydmFsO1xuZnVuY3Rpb24gQXV0b1Njcm9sbFBsdWdpbigpIHtcbiAgZnVuY3Rpb24gQXV0b1Njcm9sbCgpIHtcbiAgICB0aGlzLmRlZmF1bHRzID0ge1xuICAgICAgc2Nyb2xsOiB0cnVlLFxuICAgICAgZm9yY2VBdXRvU2Nyb2xsRmFsbGJhY2s6IGZhbHNlLFxuICAgICAgc2Nyb2xsU2Vuc2l0aXZpdHk6IDMwLFxuICAgICAgc2Nyb2xsU3BlZWQ6IDEwLFxuICAgICAgYnViYmxlU2Nyb2xsOiB0cnVlXG4gICAgfTtcblxuICAgIC8vIEJpbmQgYWxsIHByaXZhdGUgbWV0aG9kc1xuICAgIGZvciAodmFyIGZuIGluIHRoaXMpIHtcbiAgICAgIGlmIChmbi5jaGFyQXQoMCkgPT09ICdfJyAmJiB0eXBlb2YgdGhpc1tmbl0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpc1tmbl0gPSB0aGlzW2ZuXS5iaW5kKHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBBdXRvU2Nyb2xsLnByb3RvdHlwZSA9IHtcbiAgICBkcmFnU3RhcnRlZDogZnVuY3Rpb24gZHJhZ1N0YXJ0ZWQoX3JlZikge1xuICAgICAgdmFyIG9yaWdpbmFsRXZlbnQgPSBfcmVmLm9yaWdpbmFsRXZlbnQ7XG4gICAgICBpZiAodGhpcy5zb3J0YWJsZS5uYXRpdmVEcmFnZ2FibGUpIHtcbiAgICAgICAgb24oZG9jdW1lbnQsICdkcmFnb3ZlcicsIHRoaXMuX2hhbmRsZUF1dG9TY3JvbGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zdXBwb3J0UG9pbnRlcikge1xuICAgICAgICAgIG9uKGRvY3VtZW50LCAncG9pbnRlcm1vdmUnLCB0aGlzLl9oYW5kbGVGYWxsYmFja0F1dG9TY3JvbGwpO1xuICAgICAgICB9IGVsc2UgaWYgKG9yaWdpbmFsRXZlbnQudG91Y2hlcykge1xuICAgICAgICAgIG9uKGRvY3VtZW50LCAndG91Y2htb3ZlJywgdGhpcy5faGFuZGxlRmFsbGJhY2tBdXRvU2Nyb2xsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvbihkb2N1bWVudCwgJ21vdXNlbW92ZScsIHRoaXMuX2hhbmRsZUZhbGxiYWNrQXV0b1Njcm9sbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGRyYWdPdmVyQ29tcGxldGVkOiBmdW5jdGlvbiBkcmFnT3ZlckNvbXBsZXRlZChfcmVmMikge1xuICAgICAgdmFyIG9yaWdpbmFsRXZlbnQgPSBfcmVmMi5vcmlnaW5hbEV2ZW50O1xuICAgICAgLy8gRm9yIHdoZW4gYnViYmxpbmcgaXMgY2FuY2VsZWQgYW5kIHVzaW5nIGZhbGxiYWNrIChmYWxsYmFjayAndG91Y2htb3ZlJyBhbHdheXMgcmVhY2hlZClcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmRyYWdPdmVyQnViYmxlICYmICFvcmlnaW5hbEV2ZW50LnJvb3RFbCkge1xuICAgICAgICB0aGlzLl9oYW5kbGVBdXRvU2Nyb2xsKG9yaWdpbmFsRXZlbnQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZHJvcDogZnVuY3Rpb24gZHJvcCgpIHtcbiAgICAgIGlmICh0aGlzLnNvcnRhYmxlLm5hdGl2ZURyYWdnYWJsZSkge1xuICAgICAgICBvZmYoZG9jdW1lbnQsICdkcmFnb3ZlcicsIHRoaXMuX2hhbmRsZUF1dG9TY3JvbGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2ZmKGRvY3VtZW50LCAncG9pbnRlcm1vdmUnLCB0aGlzLl9oYW5kbGVGYWxsYmFja0F1dG9TY3JvbGwpO1xuICAgICAgICBvZmYoZG9jdW1lbnQsICd0b3VjaG1vdmUnLCB0aGlzLl9oYW5kbGVGYWxsYmFja0F1dG9TY3JvbGwpO1xuICAgICAgICBvZmYoZG9jdW1lbnQsICdtb3VzZW1vdmUnLCB0aGlzLl9oYW5kbGVGYWxsYmFja0F1dG9TY3JvbGwpO1xuICAgICAgfVxuICAgICAgY2xlYXJQb2ludGVyRWxlbUNoYW5nZWRJbnRlcnZhbCgpO1xuICAgICAgY2xlYXJBdXRvU2Nyb2xscygpO1xuICAgICAgY2FuY2VsVGhyb3R0bGUoKTtcbiAgICB9LFxuICAgIG51bGxpbmc6IGZ1bmN0aW9uIG51bGxpbmcoKSB7XG4gICAgICB0b3VjaEV2dCQxID0gc2Nyb2xsUm9vdEVsID0gc2Nyb2xsRWwgPSBzY3JvbGxpbmcgPSBwb2ludGVyRWxlbUNoYW5nZWRJbnRlcnZhbCA9IGxhc3RBdXRvU2Nyb2xsWCA9IGxhc3RBdXRvU2Nyb2xsWSA9IG51bGw7XG4gICAgICBhdXRvU2Nyb2xscy5sZW5ndGggPSAwO1xuICAgIH0sXG4gICAgX2hhbmRsZUZhbGxiYWNrQXV0b1Njcm9sbDogZnVuY3Rpb24gX2hhbmRsZUZhbGxiYWNrQXV0b1Njcm9sbChldnQpIHtcbiAgICAgIHRoaXMuX2hhbmRsZUF1dG9TY3JvbGwoZXZ0LCB0cnVlKTtcbiAgICB9LFxuICAgIF9oYW5kbGVBdXRvU2Nyb2xsOiBmdW5jdGlvbiBfaGFuZGxlQXV0b1Njcm9sbChldnQsIGZhbGxiYWNrKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgdmFyIHggPSAoZXZ0LnRvdWNoZXMgPyBldnQudG91Y2hlc1swXSA6IGV2dCkuY2xpZW50WCxcbiAgICAgICAgeSA9IChldnQudG91Y2hlcyA/IGV2dC50b3VjaGVzWzBdIDogZXZ0KS5jbGllbnRZLFxuICAgICAgICBlbGVtID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh4LCB5KTtcbiAgICAgIHRvdWNoRXZ0JDEgPSBldnQ7XG5cbiAgICAgIC8vIElFIGRvZXMgbm90IHNlZW0gdG8gaGF2ZSBuYXRpdmUgYXV0b3Njcm9sbCxcbiAgICAgIC8vIEVkZ2UncyBhdXRvc2Nyb2xsIHNlZW1zIHRvbyBjb25kaXRpb25hbCxcbiAgICAgIC8vIE1BQ09TIFNhZmFyaSBkb2VzIG5vdCBoYXZlIGF1dG9zY3JvbGwsXG4gICAgICAvLyBGaXJlZm94IGFuZCBDaHJvbWUgYXJlIGdvb2RcbiAgICAgIGlmIChmYWxsYmFjayB8fCB0aGlzLm9wdGlvbnMuZm9yY2VBdXRvU2Nyb2xsRmFsbGJhY2sgfHwgRWRnZSB8fCBJRTExT3JMZXNzIHx8IFNhZmFyaSkge1xuICAgICAgICBhdXRvU2Nyb2xsKGV2dCwgdGhpcy5vcHRpb25zLCBlbGVtLCBmYWxsYmFjayk7XG5cbiAgICAgICAgLy8gTGlzdGVuZXIgZm9yIHBvaW50ZXIgZWxlbWVudCBjaGFuZ2VcbiAgICAgICAgdmFyIG9nRWxlbVNjcm9sbGVyID0gZ2V0UGFyZW50QXV0b1Njcm9sbEVsZW1lbnQoZWxlbSwgdHJ1ZSk7XG4gICAgICAgIGlmIChzY3JvbGxpbmcgJiYgKCFwb2ludGVyRWxlbUNoYW5nZWRJbnRlcnZhbCB8fCB4ICE9PSBsYXN0QXV0b1Njcm9sbFggfHwgeSAhPT0gbGFzdEF1dG9TY3JvbGxZKSkge1xuICAgICAgICAgIHBvaW50ZXJFbGVtQ2hhbmdlZEludGVydmFsICYmIGNsZWFyUG9pbnRlckVsZW1DaGFuZ2VkSW50ZXJ2YWwoKTtcbiAgICAgICAgICAvLyBEZXRlY3QgZm9yIHBvaW50ZXIgZWxlbSBjaGFuZ2UsIGVtdWxhdGluZyBuYXRpdmUgRG5EIGJlaGF2aW91clxuICAgICAgICAgIHBvaW50ZXJFbGVtQ2hhbmdlZEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG5ld0VsZW0gPSBnZXRQYXJlbnRBdXRvU2Nyb2xsRWxlbWVudChkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHgsIHkpLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChuZXdFbGVtICE9PSBvZ0VsZW1TY3JvbGxlcikge1xuICAgICAgICAgICAgICBvZ0VsZW1TY3JvbGxlciA9IG5ld0VsZW07XG4gICAgICAgICAgICAgIGNsZWFyQXV0b1Njcm9sbHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF1dG9TY3JvbGwoZXZ0LCBfdGhpcy5vcHRpb25zLCBuZXdFbGVtLCBmYWxsYmFjayk7XG4gICAgICAgICAgfSwgMTApO1xuICAgICAgICAgIGxhc3RBdXRvU2Nyb2xsWCA9IHg7XG4gICAgICAgICAgbGFzdEF1dG9TY3JvbGxZID0geTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaWYgRG5EIGlzIGVuYWJsZWQgKGFuZCBicm93c2VyIGhhcyBnb29kIGF1dG9zY3JvbGxpbmcpLCBmaXJzdCBhdXRvc2Nyb2xsIHdpbGwgYWxyZWFkeSBzY3JvbGwsIHNvIGdldCBwYXJlbnQgYXV0b3Njcm9sbCBvZiBmaXJzdCBhdXRvc2Nyb2xsXG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmJ1YmJsZVNjcm9sbCB8fCBnZXRQYXJlbnRBdXRvU2Nyb2xsRWxlbWVudChlbGVtLCB0cnVlKSA9PT0gZ2V0V2luZG93U2Nyb2xsaW5nRWxlbWVudCgpKSB7XG4gICAgICAgICAgY2xlYXJBdXRvU2Nyb2xscygpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBhdXRvU2Nyb2xsKGV2dCwgdGhpcy5vcHRpb25zLCBnZXRQYXJlbnRBdXRvU2Nyb2xsRWxlbWVudChlbGVtLCBmYWxzZSksIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHJldHVybiBfZXh0ZW5kcyhBdXRvU2Nyb2xsLCB7XG4gICAgcGx1Z2luTmFtZTogJ3Njcm9sbCcsXG4gICAgaW5pdGlhbGl6ZUJ5RGVmYXVsdDogdHJ1ZVxuICB9KTtcbn1cbmZ1bmN0aW9uIGNsZWFyQXV0b1Njcm9sbHMoKSB7XG4gIGF1dG9TY3JvbGxzLmZvckVhY2goZnVuY3Rpb24gKGF1dG9TY3JvbGwpIHtcbiAgICBjbGVhckludGVydmFsKGF1dG9TY3JvbGwucGlkKTtcbiAgfSk7XG4gIGF1dG9TY3JvbGxzID0gW107XG59XG5mdW5jdGlvbiBjbGVhclBvaW50ZXJFbGVtQ2hhbmdlZEludGVydmFsKCkge1xuICBjbGVhckludGVydmFsKHBvaW50ZXJFbGVtQ2hhbmdlZEludGVydmFsKTtcbn1cbnZhciBhdXRvU2Nyb2xsID0gdGhyb3R0bGUoZnVuY3Rpb24gKGV2dCwgb3B0aW9ucywgcm9vdEVsLCBpc0ZhbGxiYWNrKSB7XG4gIC8vIEJ1ZzogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NTA1NTIxXG4gIGlmICghb3B0aW9ucy5zY3JvbGwpIHJldHVybjtcbiAgdmFyIHggPSAoZXZ0LnRvdWNoZXMgPyBldnQudG91Y2hlc1swXSA6IGV2dCkuY2xpZW50WCxcbiAgICB5ID0gKGV2dC50b3VjaGVzID8gZXZ0LnRvdWNoZXNbMF0gOiBldnQpLmNsaWVudFksXG4gICAgc2VucyA9IG9wdGlvbnMuc2Nyb2xsU2Vuc2l0aXZpdHksXG4gICAgc3BlZWQgPSBvcHRpb25zLnNjcm9sbFNwZWVkLFxuICAgIHdpblNjcm9sbGVyID0gZ2V0V2luZG93U2Nyb2xsaW5nRWxlbWVudCgpO1xuICB2YXIgc2Nyb2xsVGhpc0luc3RhbmNlID0gZmFsc2UsXG4gICAgc2Nyb2xsQ3VzdG9tRm47XG5cbiAgLy8gTmV3IHNjcm9sbCByb290LCBzZXQgc2Nyb2xsRWxcbiAgaWYgKHNjcm9sbFJvb3RFbCAhPT0gcm9vdEVsKSB7XG4gICAgc2Nyb2xsUm9vdEVsID0gcm9vdEVsO1xuICAgIGNsZWFyQXV0b1Njcm9sbHMoKTtcbiAgICBzY3JvbGxFbCA9IG9wdGlvbnMuc2Nyb2xsO1xuICAgIHNjcm9sbEN1c3RvbUZuID0gb3B0aW9ucy5zY3JvbGxGbjtcbiAgICBpZiAoc2Nyb2xsRWwgPT09IHRydWUpIHtcbiAgICAgIHNjcm9sbEVsID0gZ2V0UGFyZW50QXV0b1Njcm9sbEVsZW1lbnQocm9vdEVsLCB0cnVlKTtcbiAgICB9XG4gIH1cbiAgdmFyIGxheWVyc091dCA9IDA7XG4gIHZhciBjdXJyZW50UGFyZW50ID0gc2Nyb2xsRWw7XG4gIGRvIHtcbiAgICB2YXIgZWwgPSBjdXJyZW50UGFyZW50LFxuICAgICAgcmVjdCA9IGdldFJlY3QoZWwpLFxuICAgICAgdG9wID0gcmVjdC50b3AsXG4gICAgICBib3R0b20gPSByZWN0LmJvdHRvbSxcbiAgICAgIGxlZnQgPSByZWN0LmxlZnQsXG4gICAgICByaWdodCA9IHJlY3QucmlnaHQsXG4gICAgICB3aWR0aCA9IHJlY3Qud2lkdGgsXG4gICAgICBoZWlnaHQgPSByZWN0LmhlaWdodCxcbiAgICAgIGNhblNjcm9sbFggPSB2b2lkIDAsXG4gICAgICBjYW5TY3JvbGxZID0gdm9pZCAwLFxuICAgICAgc2Nyb2xsV2lkdGggPSBlbC5zY3JvbGxXaWR0aCxcbiAgICAgIHNjcm9sbEhlaWdodCA9IGVsLnNjcm9sbEhlaWdodCxcbiAgICAgIGVsQ1NTID0gY3NzKGVsKSxcbiAgICAgIHNjcm9sbFBvc1ggPSBlbC5zY3JvbGxMZWZ0LFxuICAgICAgc2Nyb2xsUG9zWSA9IGVsLnNjcm9sbFRvcDtcbiAgICBpZiAoZWwgPT09IHdpblNjcm9sbGVyKSB7XG4gICAgICBjYW5TY3JvbGxYID0gd2lkdGggPCBzY3JvbGxXaWR0aCAmJiAoZWxDU1Mub3ZlcmZsb3dYID09PSAnYXV0bycgfHwgZWxDU1Mub3ZlcmZsb3dYID09PSAnc2Nyb2xsJyB8fCBlbENTUy5vdmVyZmxvd1ggPT09ICd2aXNpYmxlJyk7XG4gICAgICBjYW5TY3JvbGxZID0gaGVpZ2h0IDwgc2Nyb2xsSGVpZ2h0ICYmIChlbENTUy5vdmVyZmxvd1kgPT09ICdhdXRvJyB8fCBlbENTUy5vdmVyZmxvd1kgPT09ICdzY3JvbGwnIHx8IGVsQ1NTLm92ZXJmbG93WSA9PT0gJ3Zpc2libGUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FuU2Nyb2xsWCA9IHdpZHRoIDwgc2Nyb2xsV2lkdGggJiYgKGVsQ1NTLm92ZXJmbG93WCA9PT0gJ2F1dG8nIHx8IGVsQ1NTLm92ZXJmbG93WCA9PT0gJ3Njcm9sbCcpO1xuICAgICAgY2FuU2Nyb2xsWSA9IGhlaWdodCA8IHNjcm9sbEhlaWdodCAmJiAoZWxDU1Mub3ZlcmZsb3dZID09PSAnYXV0bycgfHwgZWxDU1Mub3ZlcmZsb3dZID09PSAnc2Nyb2xsJyk7XG4gICAgfVxuICAgIHZhciB2eCA9IGNhblNjcm9sbFggJiYgKE1hdGguYWJzKHJpZ2h0IC0geCkgPD0gc2VucyAmJiBzY3JvbGxQb3NYICsgd2lkdGggPCBzY3JvbGxXaWR0aCkgLSAoTWF0aC5hYnMobGVmdCAtIHgpIDw9IHNlbnMgJiYgISFzY3JvbGxQb3NYKTtcbiAgICB2YXIgdnkgPSBjYW5TY3JvbGxZICYmIChNYXRoLmFicyhib3R0b20gLSB5KSA8PSBzZW5zICYmIHNjcm9sbFBvc1kgKyBoZWlnaHQgPCBzY3JvbGxIZWlnaHQpIC0gKE1hdGguYWJzKHRvcCAtIHkpIDw9IHNlbnMgJiYgISFzY3JvbGxQb3NZKTtcbiAgICBpZiAoIWF1dG9TY3JvbGxzW2xheWVyc091dF0pIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IGxheWVyc091dDsgaSsrKSB7XG4gICAgICAgIGlmICghYXV0b1Njcm9sbHNbaV0pIHtcbiAgICAgICAgICBhdXRvU2Nyb2xsc1tpXSA9IHt9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChhdXRvU2Nyb2xsc1tsYXllcnNPdXRdLnZ4ICE9IHZ4IHx8IGF1dG9TY3JvbGxzW2xheWVyc091dF0udnkgIT0gdnkgfHwgYXV0b1Njcm9sbHNbbGF5ZXJzT3V0XS5lbCAhPT0gZWwpIHtcbiAgICAgIGF1dG9TY3JvbGxzW2xheWVyc091dF0uZWwgPSBlbDtcbiAgICAgIGF1dG9TY3JvbGxzW2xheWVyc091dF0udnggPSB2eDtcbiAgICAgIGF1dG9TY3JvbGxzW2xheWVyc091dF0udnkgPSB2eTtcbiAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1Njcm9sbHNbbGF5ZXJzT3V0XS5waWQpO1xuICAgICAgaWYgKHZ4ICE9IDAgfHwgdnkgIT0gMCkge1xuICAgICAgICBzY3JvbGxUaGlzSW5zdGFuY2UgPSB0cnVlO1xuICAgICAgICAvKiBqc2hpbnQgbG9vcGZ1bmM6dHJ1ZSAqL1xuICAgICAgICBhdXRvU2Nyb2xsc1tsYXllcnNPdXRdLnBpZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAvLyBlbXVsYXRlIGRyYWcgb3ZlciBkdXJpbmcgYXV0b3Njcm9sbCAoZmFsbGJhY2spLCBlbXVsYXRpbmcgbmF0aXZlIERuRCBiZWhhdmlvdXJcbiAgICAgICAgICBpZiAoaXNGYWxsYmFjayAmJiB0aGlzLmxheWVyID09PSAwKSB7XG4gICAgICAgICAgICBTb3J0YWJsZS5hY3RpdmUuX29uVG91Y2hNb3ZlKHRvdWNoRXZ0JDEpOyAvLyBUbyBtb3ZlIGdob3N0IGlmIGl0IGlzIHBvc2l0aW9uZWQgYWJzb2x1dGVseVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgc2Nyb2xsT2Zmc2V0WSA9IGF1dG9TY3JvbGxzW3RoaXMubGF5ZXJdLnZ5ID8gYXV0b1Njcm9sbHNbdGhpcy5sYXllcl0udnkgKiBzcGVlZCA6IDA7XG4gICAgICAgICAgdmFyIHNjcm9sbE9mZnNldFggPSBhdXRvU2Nyb2xsc1t0aGlzLmxheWVyXS52eCA/IGF1dG9TY3JvbGxzW3RoaXMubGF5ZXJdLnZ4ICogc3BlZWQgOiAwO1xuICAgICAgICAgIGlmICh0eXBlb2Ygc2Nyb2xsQ3VzdG9tRm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGlmIChzY3JvbGxDdXN0b21Gbi5jYWxsKFNvcnRhYmxlLmRyYWdnZWQucGFyZW50Tm9kZVtleHBhbmRvXSwgc2Nyb2xsT2Zmc2V0WCwgc2Nyb2xsT2Zmc2V0WSwgZXZ0LCB0b3VjaEV2dCQxLCBhdXRvU2Nyb2xsc1t0aGlzLmxheWVyXS5lbCkgIT09ICdjb250aW51ZScpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBzY3JvbGxCeShhdXRvU2Nyb2xsc1t0aGlzLmxheWVyXS5lbCwgc2Nyb2xsT2Zmc2V0WCwgc2Nyb2xsT2Zmc2V0WSk7XG4gICAgICAgIH0uYmluZCh7XG4gICAgICAgICAgbGF5ZXI6IGxheWVyc091dFxuICAgICAgICB9KSwgMjQpO1xuICAgICAgfVxuICAgIH1cbiAgICBsYXllcnNPdXQrKztcbiAgfSB3aGlsZSAob3B0aW9ucy5idWJibGVTY3JvbGwgJiYgY3VycmVudFBhcmVudCAhPT0gd2luU2Nyb2xsZXIgJiYgKGN1cnJlbnRQYXJlbnQgPSBnZXRQYXJlbnRBdXRvU2Nyb2xsRWxlbWVudChjdXJyZW50UGFyZW50LCBmYWxzZSkpKTtcbiAgc2Nyb2xsaW5nID0gc2Nyb2xsVGhpc0luc3RhbmNlOyAvLyBpbiBjYXNlIGFub3RoZXIgZnVuY3Rpb24gY2F0Y2hlcyBzY3JvbGxpbmcgYXMgZmFsc2UgaW4gYmV0d2VlbiB3aGVuIGl0IGlzIG5vdFxufSwgMzApO1xuXG52YXIgZHJvcCA9IGZ1bmN0aW9uIGRyb3AoX3JlZikge1xuICB2YXIgb3JpZ2luYWxFdmVudCA9IF9yZWYub3JpZ2luYWxFdmVudCxcbiAgICBwdXRTb3J0YWJsZSA9IF9yZWYucHV0U29ydGFibGUsXG4gICAgZHJhZ0VsID0gX3JlZi5kcmFnRWwsXG4gICAgYWN0aXZlU29ydGFibGUgPSBfcmVmLmFjdGl2ZVNvcnRhYmxlLFxuICAgIGRpc3BhdGNoU29ydGFibGVFdmVudCA9IF9yZWYuZGlzcGF0Y2hTb3J0YWJsZUV2ZW50LFxuICAgIGhpZGVHaG9zdEZvclRhcmdldCA9IF9yZWYuaGlkZUdob3N0Rm9yVGFyZ2V0LFxuICAgIHVuaGlkZUdob3N0Rm9yVGFyZ2V0ID0gX3JlZi51bmhpZGVHaG9zdEZvclRhcmdldDtcbiAgaWYgKCFvcmlnaW5hbEV2ZW50KSByZXR1cm47XG4gIHZhciB0b1NvcnRhYmxlID0gcHV0U29ydGFibGUgfHwgYWN0aXZlU29ydGFibGU7XG4gIGhpZGVHaG9zdEZvclRhcmdldCgpO1xuICB2YXIgdG91Y2ggPSBvcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzICYmIG9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXMubGVuZ3RoID8gb3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXSA6IG9yaWdpbmFsRXZlbnQ7XG4gIHZhciB0YXJnZXQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHRvdWNoLmNsaWVudFgsIHRvdWNoLmNsaWVudFkpO1xuICB1bmhpZGVHaG9zdEZvclRhcmdldCgpO1xuICBpZiAodG9Tb3J0YWJsZSAmJiAhdG9Tb3J0YWJsZS5lbC5jb250YWlucyh0YXJnZXQpKSB7XG4gICAgZGlzcGF0Y2hTb3J0YWJsZUV2ZW50KCdzcGlsbCcpO1xuICAgIHRoaXMub25TcGlsbCh7XG4gICAgICBkcmFnRWw6IGRyYWdFbCxcbiAgICAgIHB1dFNvcnRhYmxlOiBwdXRTb3J0YWJsZVxuICAgIH0pO1xuICB9XG59O1xuZnVuY3Rpb24gUmV2ZXJ0KCkge31cblJldmVydC5wcm90b3R5cGUgPSB7XG4gIHN0YXJ0SW5kZXg6IG51bGwsXG4gIGRyYWdTdGFydDogZnVuY3Rpb24gZHJhZ1N0YXJ0KF9yZWYyKSB7XG4gICAgdmFyIG9sZERyYWdnYWJsZUluZGV4ID0gX3JlZjIub2xkRHJhZ2dhYmxlSW5kZXg7XG4gICAgdGhpcy5zdGFydEluZGV4ID0gb2xkRHJhZ2dhYmxlSW5kZXg7XG4gIH0sXG4gIG9uU3BpbGw6IGZ1bmN0aW9uIG9uU3BpbGwoX3JlZjMpIHtcbiAgICB2YXIgZHJhZ0VsID0gX3JlZjMuZHJhZ0VsLFxuICAgICAgcHV0U29ydGFibGUgPSBfcmVmMy5wdXRTb3J0YWJsZTtcbiAgICB0aGlzLnNvcnRhYmxlLmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpO1xuICAgIGlmIChwdXRTb3J0YWJsZSkge1xuICAgICAgcHV0U29ydGFibGUuY2FwdHVyZUFuaW1hdGlvblN0YXRlKCk7XG4gICAgfVxuICAgIHZhciBuZXh0U2libGluZyA9IGdldENoaWxkKHRoaXMuc29ydGFibGUuZWwsIHRoaXMuc3RhcnRJbmRleCwgdGhpcy5vcHRpb25zKTtcbiAgICBpZiAobmV4dFNpYmxpbmcpIHtcbiAgICAgIHRoaXMuc29ydGFibGUuZWwuaW5zZXJ0QmVmb3JlKGRyYWdFbCwgbmV4dFNpYmxpbmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNvcnRhYmxlLmVsLmFwcGVuZENoaWxkKGRyYWdFbCk7XG4gICAgfVxuICAgIHRoaXMuc29ydGFibGUuYW5pbWF0ZUFsbCgpO1xuICAgIGlmIChwdXRTb3J0YWJsZSkge1xuICAgICAgcHV0U29ydGFibGUuYW5pbWF0ZUFsbCgpO1xuICAgIH1cbiAgfSxcbiAgZHJvcDogZHJvcFxufTtcbl9leHRlbmRzKFJldmVydCwge1xuICBwbHVnaW5OYW1lOiAncmV2ZXJ0T25TcGlsbCdcbn0pO1xuZnVuY3Rpb24gUmVtb3ZlKCkge31cblJlbW92ZS5wcm90b3R5cGUgPSB7XG4gIG9uU3BpbGw6IGZ1bmN0aW9uIG9uU3BpbGwoX3JlZjQpIHtcbiAgICB2YXIgZHJhZ0VsID0gX3JlZjQuZHJhZ0VsLFxuICAgICAgcHV0U29ydGFibGUgPSBfcmVmNC5wdXRTb3J0YWJsZTtcbiAgICB2YXIgcGFyZW50U29ydGFibGUgPSBwdXRTb3J0YWJsZSB8fCB0aGlzLnNvcnRhYmxlO1xuICAgIHBhcmVudFNvcnRhYmxlLmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpO1xuICAgIGRyYWdFbC5wYXJlbnROb2RlICYmIGRyYWdFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdFbCk7XG4gICAgcGFyZW50U29ydGFibGUuYW5pbWF0ZUFsbCgpO1xuICB9LFxuICBkcm9wOiBkcm9wXG59O1xuX2V4dGVuZHMoUmVtb3ZlLCB7XG4gIHBsdWdpbk5hbWU6ICdyZW1vdmVPblNwaWxsJ1xufSk7XG5cbnZhciBsYXN0U3dhcEVsO1xuZnVuY3Rpb24gU3dhcFBsdWdpbigpIHtcbiAgZnVuY3Rpb24gU3dhcCgpIHtcbiAgICB0aGlzLmRlZmF1bHRzID0ge1xuICAgICAgc3dhcENsYXNzOiAnc29ydGFibGUtc3dhcC1oaWdobGlnaHQnXG4gICAgfTtcbiAgfVxuICBTd2FwLnByb3RvdHlwZSA9IHtcbiAgICBkcmFnU3RhcnQ6IGZ1bmN0aW9uIGRyYWdTdGFydChfcmVmKSB7XG4gICAgICB2YXIgZHJhZ0VsID0gX3JlZi5kcmFnRWw7XG4gICAgICBsYXN0U3dhcEVsID0gZHJhZ0VsO1xuICAgIH0sXG4gICAgZHJhZ092ZXJWYWxpZDogZnVuY3Rpb24gZHJhZ092ZXJWYWxpZChfcmVmMikge1xuICAgICAgdmFyIGNvbXBsZXRlZCA9IF9yZWYyLmNvbXBsZXRlZCxcbiAgICAgICAgdGFyZ2V0ID0gX3JlZjIudGFyZ2V0LFxuICAgICAgICBvbk1vdmUgPSBfcmVmMi5vbk1vdmUsXG4gICAgICAgIGFjdGl2ZVNvcnRhYmxlID0gX3JlZjIuYWN0aXZlU29ydGFibGUsXG4gICAgICAgIGNoYW5nZWQgPSBfcmVmMi5jaGFuZ2VkLFxuICAgICAgICBjYW5jZWwgPSBfcmVmMi5jYW5jZWw7XG4gICAgICBpZiAoIWFjdGl2ZVNvcnRhYmxlLm9wdGlvbnMuc3dhcCkgcmV0dXJuO1xuICAgICAgdmFyIGVsID0gdGhpcy5zb3J0YWJsZS5lbCxcbiAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcbiAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0ICE9PSBlbCkge1xuICAgICAgICB2YXIgcHJldlN3YXBFbCA9IGxhc3RTd2FwRWw7XG4gICAgICAgIGlmIChvbk1vdmUodGFyZ2V0KSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICB0b2dnbGVDbGFzcyh0YXJnZXQsIG9wdGlvbnMuc3dhcENsYXNzLCB0cnVlKTtcbiAgICAgICAgICBsYXN0U3dhcEVsID0gdGFyZ2V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxhc3RTd2FwRWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcmV2U3dhcEVsICYmIHByZXZTd2FwRWwgIT09IGxhc3RTd2FwRWwpIHtcbiAgICAgICAgICB0b2dnbGVDbGFzcyhwcmV2U3dhcEVsLCBvcHRpb25zLnN3YXBDbGFzcywgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjaGFuZ2VkKCk7XG4gICAgICBjb21wbGV0ZWQodHJ1ZSk7XG4gICAgICBjYW5jZWwoKTtcbiAgICB9LFxuICAgIGRyb3A6IGZ1bmN0aW9uIGRyb3AoX3JlZjMpIHtcbiAgICAgIHZhciBhY3RpdmVTb3J0YWJsZSA9IF9yZWYzLmFjdGl2ZVNvcnRhYmxlLFxuICAgICAgICBwdXRTb3J0YWJsZSA9IF9yZWYzLnB1dFNvcnRhYmxlLFxuICAgICAgICBkcmFnRWwgPSBfcmVmMy5kcmFnRWw7XG4gICAgICB2YXIgdG9Tb3J0YWJsZSA9IHB1dFNvcnRhYmxlIHx8IHRoaXMuc29ydGFibGU7XG4gICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcbiAgICAgIGxhc3RTd2FwRWwgJiYgdG9nZ2xlQ2xhc3MobGFzdFN3YXBFbCwgb3B0aW9ucy5zd2FwQ2xhc3MsIGZhbHNlKTtcbiAgICAgIGlmIChsYXN0U3dhcEVsICYmIChvcHRpb25zLnN3YXAgfHwgcHV0U29ydGFibGUgJiYgcHV0U29ydGFibGUub3B0aW9ucy5zd2FwKSkge1xuICAgICAgICBpZiAoZHJhZ0VsICE9PSBsYXN0U3dhcEVsKSB7XG4gICAgICAgICAgdG9Tb3J0YWJsZS5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKTtcbiAgICAgICAgICBpZiAodG9Tb3J0YWJsZSAhPT0gYWN0aXZlU29ydGFibGUpIGFjdGl2ZVNvcnRhYmxlLmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpO1xuICAgICAgICAgIHN3YXBOb2RlcyhkcmFnRWwsIGxhc3RTd2FwRWwpO1xuICAgICAgICAgIHRvU29ydGFibGUuYW5pbWF0ZUFsbCgpO1xuICAgICAgICAgIGlmICh0b1NvcnRhYmxlICE9PSBhY3RpdmVTb3J0YWJsZSkgYWN0aXZlU29ydGFibGUuYW5pbWF0ZUFsbCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBudWxsaW5nOiBmdW5jdGlvbiBudWxsaW5nKCkge1xuICAgICAgbGFzdFN3YXBFbCA9IG51bGw7XG4gICAgfVxuICB9O1xuICByZXR1cm4gX2V4dGVuZHMoU3dhcCwge1xuICAgIHBsdWdpbk5hbWU6ICdzd2FwJyxcbiAgICBldmVudFByb3BlcnRpZXM6IGZ1bmN0aW9uIGV2ZW50UHJvcGVydGllcygpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN3YXBJdGVtOiBsYXN0U3dhcEVsXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59XG5mdW5jdGlvbiBzd2FwTm9kZXMobjEsIG4yKSB7XG4gIHZhciBwMSA9IG4xLnBhcmVudE5vZGUsXG4gICAgcDIgPSBuMi5wYXJlbnROb2RlLFxuICAgIGkxLFxuICAgIGkyO1xuICBpZiAoIXAxIHx8ICFwMiB8fCBwMS5pc0VxdWFsTm9kZShuMikgfHwgcDIuaXNFcXVhbE5vZGUobjEpKSByZXR1cm47XG4gIGkxID0gaW5kZXgobjEpO1xuICBpMiA9IGluZGV4KG4yKTtcbiAgaWYgKHAxLmlzRXF1YWxOb2RlKHAyKSAmJiBpMSA8IGkyKSB7XG4gICAgaTIrKztcbiAgfVxuICBwMS5pbnNlcnRCZWZvcmUobjIsIHAxLmNoaWxkcmVuW2kxXSk7XG4gIHAyLmluc2VydEJlZm9yZShuMSwgcDIuY2hpbGRyZW5baTJdKTtcbn1cblxudmFyIG11bHRpRHJhZ0VsZW1lbnRzID0gW10sXG4gIG11bHRpRHJhZ0Nsb25lcyA9IFtdLFxuICBsYXN0TXVsdGlEcmFnU2VsZWN0LFxuICAvLyBmb3Igc2VsZWN0aW9uIHdpdGggbW9kaWZpZXIga2V5IGRvd24gKFNISUZUKVxuICBtdWx0aURyYWdTb3J0YWJsZSxcbiAgaW5pdGlhbEZvbGRpbmcgPSBmYWxzZSxcbiAgLy8gSW5pdGlhbCBtdWx0aS1kcmFnIGZvbGQgd2hlbiBkcmFnIHN0YXJ0ZWRcbiAgZm9sZGluZyA9IGZhbHNlLFxuICAvLyBGb2xkaW5nIGFueSBvdGhlciB0aW1lXG4gIGRyYWdTdGFydGVkID0gZmFsc2UsXG4gIGRyYWdFbCQxLFxuICBjbG9uZXNGcm9tUmVjdCxcbiAgY2xvbmVzSGlkZGVuO1xuZnVuY3Rpb24gTXVsdGlEcmFnUGx1Z2luKCkge1xuICBmdW5jdGlvbiBNdWx0aURyYWcoc29ydGFibGUpIHtcbiAgICAvLyBCaW5kIGFsbCBwcml2YXRlIG1ldGhvZHNcbiAgICBmb3IgKHZhciBmbiBpbiB0aGlzKSB7XG4gICAgICBpZiAoZm4uY2hhckF0KDApID09PSAnXycgJiYgdHlwZW9mIHRoaXNbZm5dID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXNbZm5dID0gdGhpc1tmbl0uYmluZCh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFzb3J0YWJsZS5vcHRpb25zLmF2b2lkSW1wbGljaXREZXNlbGVjdCkge1xuICAgICAgaWYgKHNvcnRhYmxlLm9wdGlvbnMuc3VwcG9ydFBvaW50ZXIpIHtcbiAgICAgICAgb24oZG9jdW1lbnQsICdwb2ludGVydXAnLCB0aGlzLl9kZXNlbGVjdE11bHRpRHJhZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbihkb2N1bWVudCwgJ21vdXNldXAnLCB0aGlzLl9kZXNlbGVjdE11bHRpRHJhZyk7XG4gICAgICAgIG9uKGRvY3VtZW50LCAndG91Y2hlbmQnLCB0aGlzLl9kZXNlbGVjdE11bHRpRHJhZyk7XG4gICAgICB9XG4gICAgfVxuICAgIG9uKGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMuX2NoZWNrS2V5RG93bik7XG4gICAgb24oZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMuX2NoZWNrS2V5VXApO1xuICAgIHRoaXMuZGVmYXVsdHMgPSB7XG4gICAgICBzZWxlY3RlZENsYXNzOiAnc29ydGFibGUtc2VsZWN0ZWQnLFxuICAgICAgbXVsdGlEcmFnS2V5OiBudWxsLFxuICAgICAgYXZvaWRJbXBsaWNpdERlc2VsZWN0OiBmYWxzZSxcbiAgICAgIHNldERhdGE6IGZ1bmN0aW9uIHNldERhdGEoZGF0YVRyYW5zZmVyLCBkcmFnRWwpIHtcbiAgICAgICAgdmFyIGRhdGEgPSAnJztcbiAgICAgICAgaWYgKG11bHRpRHJhZ0VsZW1lbnRzLmxlbmd0aCAmJiBtdWx0aURyYWdTb3J0YWJsZSA9PT0gc29ydGFibGUpIHtcbiAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50LCBpKSB7XG4gICAgICAgICAgICBkYXRhICs9ICghaSA/ICcnIDogJywgJykgKyBtdWx0aURyYWdFbGVtZW50LnRleHRDb250ZW50O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRhdGEgPSBkcmFnRWwudGV4dENvbnRlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YVRyYW5zZmVyLnNldERhdGEoJ1RleHQnLCBkYXRhKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIE11bHRpRHJhZy5wcm90b3R5cGUgPSB7XG4gICAgbXVsdGlEcmFnS2V5RG93bjogZmFsc2UsXG4gICAgaXNNdWx0aURyYWc6IGZhbHNlLFxuICAgIGRlbGF5U3RhcnRHbG9iYWw6IGZ1bmN0aW9uIGRlbGF5U3RhcnRHbG9iYWwoX3JlZikge1xuICAgICAgdmFyIGRyYWdnZWQgPSBfcmVmLmRyYWdFbDtcbiAgICAgIGRyYWdFbCQxID0gZHJhZ2dlZDtcbiAgICB9LFxuICAgIGRlbGF5RW5kZWQ6IGZ1bmN0aW9uIGRlbGF5RW5kZWQoKSB7XG4gICAgICB0aGlzLmlzTXVsdGlEcmFnID0gfm11bHRpRHJhZ0VsZW1lbnRzLmluZGV4T2YoZHJhZ0VsJDEpO1xuICAgIH0sXG4gICAgc2V0dXBDbG9uZTogZnVuY3Rpb24gc2V0dXBDbG9uZShfcmVmMikge1xuICAgICAgdmFyIHNvcnRhYmxlID0gX3JlZjIuc29ydGFibGUsXG4gICAgICAgIGNhbmNlbCA9IF9yZWYyLmNhbmNlbDtcbiAgICAgIGlmICghdGhpcy5pc011bHRpRHJhZykgcmV0dXJuO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtdWx0aURyYWdFbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBtdWx0aURyYWdDbG9uZXMucHVzaChjbG9uZShtdWx0aURyYWdFbGVtZW50c1tpXSkpO1xuICAgICAgICBtdWx0aURyYWdDbG9uZXNbaV0uc29ydGFibGVJbmRleCA9IG11bHRpRHJhZ0VsZW1lbnRzW2ldLnNvcnRhYmxlSW5kZXg7XG4gICAgICAgIG11bHRpRHJhZ0Nsb25lc1tpXS5kcmFnZ2FibGUgPSBmYWxzZTtcbiAgICAgICAgbXVsdGlEcmFnQ2xvbmVzW2ldLnN0eWxlWyd3aWxsLWNoYW5nZSddID0gJyc7XG4gICAgICAgIHRvZ2dsZUNsYXNzKG11bHRpRHJhZ0Nsb25lc1tpXSwgdGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MsIGZhbHNlKTtcbiAgICAgICAgbXVsdGlEcmFnRWxlbWVudHNbaV0gPT09IGRyYWdFbCQxICYmIHRvZ2dsZUNsYXNzKG11bHRpRHJhZ0Nsb25lc1tpXSwgdGhpcy5vcHRpb25zLmNob3NlbkNsYXNzLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBzb3J0YWJsZS5faGlkZUNsb25lKCk7XG4gICAgICBjYW5jZWwoKTtcbiAgICB9LFxuICAgIGNsb25lOiBmdW5jdGlvbiBjbG9uZShfcmVmMykge1xuICAgICAgdmFyIHNvcnRhYmxlID0gX3JlZjMuc29ydGFibGUsXG4gICAgICAgIHJvb3RFbCA9IF9yZWYzLnJvb3RFbCxcbiAgICAgICAgZGlzcGF0Y2hTb3J0YWJsZUV2ZW50ID0gX3JlZjMuZGlzcGF0Y2hTb3J0YWJsZUV2ZW50LFxuICAgICAgICBjYW5jZWwgPSBfcmVmMy5jYW5jZWw7XG4gICAgICBpZiAoIXRoaXMuaXNNdWx0aURyYWcpIHJldHVybjtcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLnJlbW92ZUNsb25lT25IaWRlKSB7XG4gICAgICAgIGlmIChtdWx0aURyYWdFbGVtZW50cy5sZW5ndGggJiYgbXVsdGlEcmFnU29ydGFibGUgPT09IHNvcnRhYmxlKSB7XG4gICAgICAgICAgaW5zZXJ0TXVsdGlEcmFnQ2xvbmVzKHRydWUsIHJvb3RFbCk7XG4gICAgICAgICAgZGlzcGF0Y2hTb3J0YWJsZUV2ZW50KCdjbG9uZScpO1xuICAgICAgICAgIGNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBzaG93Q2xvbmU6IGZ1bmN0aW9uIHNob3dDbG9uZShfcmVmNCkge1xuICAgICAgdmFyIGNsb25lTm93U2hvd24gPSBfcmVmNC5jbG9uZU5vd1Nob3duLFxuICAgICAgICByb290RWwgPSBfcmVmNC5yb290RWwsXG4gICAgICAgIGNhbmNlbCA9IF9yZWY0LmNhbmNlbDtcbiAgICAgIGlmICghdGhpcy5pc011bHRpRHJhZykgcmV0dXJuO1xuICAgICAgaW5zZXJ0TXVsdGlEcmFnQ2xvbmVzKGZhbHNlLCByb290RWwpO1xuICAgICAgbXVsdGlEcmFnQ2xvbmVzLmZvckVhY2goZnVuY3Rpb24gKGNsb25lKSB7XG4gICAgICAgIGNzcyhjbG9uZSwgJ2Rpc3BsYXknLCAnJyk7XG4gICAgICB9KTtcbiAgICAgIGNsb25lTm93U2hvd24oKTtcbiAgICAgIGNsb25lc0hpZGRlbiA9IGZhbHNlO1xuICAgICAgY2FuY2VsKCk7XG4gICAgfSxcbiAgICBoaWRlQ2xvbmU6IGZ1bmN0aW9uIGhpZGVDbG9uZShfcmVmNSkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIHZhciBzb3J0YWJsZSA9IF9yZWY1LnNvcnRhYmxlLFxuICAgICAgICBjbG9uZU5vd0hpZGRlbiA9IF9yZWY1LmNsb25lTm93SGlkZGVuLFxuICAgICAgICBjYW5jZWwgPSBfcmVmNS5jYW5jZWw7XG4gICAgICBpZiAoIXRoaXMuaXNNdWx0aURyYWcpIHJldHVybjtcbiAgICAgIG11bHRpRHJhZ0Nsb25lcy5mb3JFYWNoKGZ1bmN0aW9uIChjbG9uZSkge1xuICAgICAgICBjc3MoY2xvbmUsICdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgaWYgKF90aGlzLm9wdGlvbnMucmVtb3ZlQ2xvbmVPbkhpZGUgJiYgY2xvbmUucGFyZW50Tm9kZSkge1xuICAgICAgICAgIGNsb25lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2xvbmUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNsb25lTm93SGlkZGVuKCk7XG4gICAgICBjbG9uZXNIaWRkZW4gPSB0cnVlO1xuICAgICAgY2FuY2VsKCk7XG4gICAgfSxcbiAgICBkcmFnU3RhcnRHbG9iYWw6IGZ1bmN0aW9uIGRyYWdTdGFydEdsb2JhbChfcmVmNikge1xuICAgICAgdmFyIHNvcnRhYmxlID0gX3JlZjYuc29ydGFibGU7XG4gICAgICBpZiAoIXRoaXMuaXNNdWx0aURyYWcgJiYgbXVsdGlEcmFnU29ydGFibGUpIHtcbiAgICAgICAgbXVsdGlEcmFnU29ydGFibGUubXVsdGlEcmFnLl9kZXNlbGVjdE11bHRpRHJhZygpO1xuICAgICAgfVxuICAgICAgbXVsdGlEcmFnRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAobXVsdGlEcmFnRWxlbWVudCkge1xuICAgICAgICBtdWx0aURyYWdFbGVtZW50LnNvcnRhYmxlSW5kZXggPSBpbmRleChtdWx0aURyYWdFbGVtZW50KTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTb3J0IG11bHRpLWRyYWcgZWxlbWVudHNcbiAgICAgIG11bHRpRHJhZ0VsZW1lbnRzID0gbXVsdGlEcmFnRWxlbWVudHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYS5zb3J0YWJsZUluZGV4IC0gYi5zb3J0YWJsZUluZGV4O1xuICAgICAgfSk7XG4gICAgICBkcmFnU3RhcnRlZCA9IHRydWU7XG4gICAgfSxcbiAgICBkcmFnU3RhcnRlZDogZnVuY3Rpb24gZHJhZ1N0YXJ0ZWQoX3JlZjcpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuICAgICAgdmFyIHNvcnRhYmxlID0gX3JlZjcuc29ydGFibGU7XG4gICAgICBpZiAoIXRoaXMuaXNNdWx0aURyYWcpIHJldHVybjtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc29ydCkge1xuICAgICAgICAvLyBDYXB0dXJlIHJlY3RzLFxuICAgICAgICAvLyBoaWRlIG11bHRpIGRyYWcgZWxlbWVudHMgKGJ5IHBvc2l0aW9uaW5nIHRoZW0gYWJzb2x1dGUpLFxuICAgICAgICAvLyBzZXQgbXVsdGkgZHJhZyBlbGVtZW50cyByZWN0cyB0byBkcmFnUmVjdCxcbiAgICAgICAgLy8gc2hvdyBtdWx0aSBkcmFnIGVsZW1lbnRzLFxuICAgICAgICAvLyBhbmltYXRlIHRvIHJlY3RzLFxuICAgICAgICAvLyB1bnNldCByZWN0cyAmIHJlbW92ZSBmcm9tIERPTVxuXG4gICAgICAgIHNvcnRhYmxlLmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmFuaW1hdGlvbikge1xuICAgICAgICAgIG11bHRpRHJhZ0VsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKG11bHRpRHJhZ0VsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChtdWx0aURyYWdFbGVtZW50ID09PSBkcmFnRWwkMSkgcmV0dXJuO1xuICAgICAgICAgICAgY3NzKG11bHRpRHJhZ0VsZW1lbnQsICdwb3NpdGlvbicsICdhYnNvbHV0ZScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHZhciBkcmFnUmVjdCA9IGdldFJlY3QoZHJhZ0VsJDEsIGZhbHNlLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAobXVsdGlEcmFnRWxlbWVudCA9PT0gZHJhZ0VsJDEpIHJldHVybjtcbiAgICAgICAgICAgIHNldFJlY3QobXVsdGlEcmFnRWxlbWVudCwgZHJhZ1JlY3QpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGZvbGRpbmcgPSB0cnVlO1xuICAgICAgICAgIGluaXRpYWxGb2xkaW5nID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc29ydGFibGUuYW5pbWF0ZUFsbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvbGRpbmcgPSBmYWxzZTtcbiAgICAgICAgaW5pdGlhbEZvbGRpbmcgPSBmYWxzZTtcbiAgICAgICAgaWYgKF90aGlzMi5vcHRpb25zLmFuaW1hdGlvbikge1xuICAgICAgICAgIG11bHRpRHJhZ0VsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKG11bHRpRHJhZ0VsZW1lbnQpIHtcbiAgICAgICAgICAgIHVuc2V0UmVjdChtdWx0aURyYWdFbGVtZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbW92ZSBhbGwgYXV4aWxpYXJ5IG11bHRpZHJhZyBpdGVtcyBmcm9tIGVsLCBpZiBzb3J0aW5nIGVuYWJsZWRcbiAgICAgICAgaWYgKF90aGlzMi5vcHRpb25zLnNvcnQpIHtcbiAgICAgICAgICByZW1vdmVNdWx0aURyYWdFbGVtZW50cygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRyYWdPdmVyOiBmdW5jdGlvbiBkcmFnT3ZlcihfcmVmOCkge1xuICAgICAgdmFyIHRhcmdldCA9IF9yZWY4LnRhcmdldCxcbiAgICAgICAgY29tcGxldGVkID0gX3JlZjguY29tcGxldGVkLFxuICAgICAgICBjYW5jZWwgPSBfcmVmOC5jYW5jZWw7XG4gICAgICBpZiAoZm9sZGluZyAmJiB+bXVsdGlEcmFnRWxlbWVudHMuaW5kZXhPZih0YXJnZXQpKSB7XG4gICAgICAgIGNvbXBsZXRlZChmYWxzZSk7XG4gICAgICAgIGNhbmNlbCgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgcmV2ZXJ0OiBmdW5jdGlvbiByZXZlcnQoX3JlZjkpIHtcbiAgICAgIHZhciBmcm9tU29ydGFibGUgPSBfcmVmOS5mcm9tU29ydGFibGUsXG4gICAgICAgIHJvb3RFbCA9IF9yZWY5LnJvb3RFbCxcbiAgICAgICAgc29ydGFibGUgPSBfcmVmOS5zb3J0YWJsZSxcbiAgICAgICAgZHJhZ1JlY3QgPSBfcmVmOS5kcmFnUmVjdDtcbiAgICAgIGlmIChtdWx0aURyYWdFbGVtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIC8vIFNldHVwIHVuZm9sZCBhbmltYXRpb25cbiAgICAgICAgbXVsdGlEcmFnRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAobXVsdGlEcmFnRWxlbWVudCkge1xuICAgICAgICAgIHNvcnRhYmxlLmFkZEFuaW1hdGlvblN0YXRlKHtcbiAgICAgICAgICAgIHRhcmdldDogbXVsdGlEcmFnRWxlbWVudCxcbiAgICAgICAgICAgIHJlY3Q6IGZvbGRpbmcgPyBnZXRSZWN0KG11bHRpRHJhZ0VsZW1lbnQpIDogZHJhZ1JlY3RcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB1bnNldFJlY3QobXVsdGlEcmFnRWxlbWVudCk7XG4gICAgICAgICAgbXVsdGlEcmFnRWxlbWVudC5mcm9tUmVjdCA9IGRyYWdSZWN0O1xuICAgICAgICAgIGZyb21Tb3J0YWJsZS5yZW1vdmVBbmltYXRpb25TdGF0ZShtdWx0aURyYWdFbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGZvbGRpbmcgPSBmYWxzZTtcbiAgICAgICAgaW5zZXJ0TXVsdGlEcmFnRWxlbWVudHMoIXRoaXMub3B0aW9ucy5yZW1vdmVDbG9uZU9uSGlkZSwgcm9vdEVsKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGRyYWdPdmVyQ29tcGxldGVkOiBmdW5jdGlvbiBkcmFnT3ZlckNvbXBsZXRlZChfcmVmMTApIHtcbiAgICAgIHZhciBzb3J0YWJsZSA9IF9yZWYxMC5zb3J0YWJsZSxcbiAgICAgICAgaXNPd25lciA9IF9yZWYxMC5pc093bmVyLFxuICAgICAgICBpbnNlcnRpb24gPSBfcmVmMTAuaW5zZXJ0aW9uLFxuICAgICAgICBhY3RpdmVTb3J0YWJsZSA9IF9yZWYxMC5hY3RpdmVTb3J0YWJsZSxcbiAgICAgICAgcGFyZW50RWwgPSBfcmVmMTAucGFyZW50RWwsXG4gICAgICAgIHB1dFNvcnRhYmxlID0gX3JlZjEwLnB1dFNvcnRhYmxlO1xuICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG4gICAgICBpZiAoaW5zZXJ0aW9uKSB7XG4gICAgICAgIC8vIENsb25lcyBtdXN0IGJlIGhpZGRlbiBiZWZvcmUgZm9sZGluZyBhbmltYXRpb24gdG8gY2FwdHVyZSBkcmFnUmVjdEFic29sdXRlIHByb3Blcmx5XG4gICAgICAgIGlmIChpc093bmVyKSB7XG4gICAgICAgICAgYWN0aXZlU29ydGFibGUuX2hpZGVDbG9uZSgpO1xuICAgICAgICB9XG4gICAgICAgIGluaXRpYWxGb2xkaW5nID0gZmFsc2U7XG4gICAgICAgIC8vIElmIGxlYXZpbmcgc29ydDpmYWxzZSByb290LCBvciBhbHJlYWR5IGZvbGRpbmcgLSBGb2xkIHRvIG5ldyBsb2NhdGlvblxuICAgICAgICBpZiAob3B0aW9ucy5hbmltYXRpb24gJiYgbXVsdGlEcmFnRWxlbWVudHMubGVuZ3RoID4gMSAmJiAoZm9sZGluZyB8fCAhaXNPd25lciAmJiAhYWN0aXZlU29ydGFibGUub3B0aW9ucy5zb3J0ICYmICFwdXRTb3J0YWJsZSkpIHtcbiAgICAgICAgICAvLyBGb2xkOiBTZXQgYWxsIG11bHRpIGRyYWcgZWxlbWVudHMncyByZWN0cyB0byBkcmFnRWwncyByZWN0IHdoZW4gbXVsdGktZHJhZyBlbGVtZW50cyBhcmUgaW52aXNpYmxlXG4gICAgICAgICAgdmFyIGRyYWdSZWN0QWJzb2x1dGUgPSBnZXRSZWN0KGRyYWdFbCQxLCBmYWxzZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgbXVsdGlEcmFnRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAobXVsdGlEcmFnRWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKG11bHRpRHJhZ0VsZW1lbnQgPT09IGRyYWdFbCQxKSByZXR1cm47XG4gICAgICAgICAgICBzZXRSZWN0KG11bHRpRHJhZ0VsZW1lbnQsIGRyYWdSZWN0QWJzb2x1dGUpO1xuXG4gICAgICAgICAgICAvLyBNb3ZlIGVsZW1lbnQocykgdG8gZW5kIG9mIHBhcmVudEVsIHNvIHRoYXQgaXQgZG9lcyBub3QgaW50ZXJmZXJlIHdpdGggbXVsdGktZHJhZyBjbG9uZXMgaW5zZXJ0aW9uIGlmIHRoZXkgYXJlIGluc2VydGVkXG4gICAgICAgICAgICAvLyB3aGlsZSBmb2xkaW5nLCBhbmQgc28gdGhhdCB3ZSBjYW4gY2FwdHVyZSB0aGVtIGFnYWluIGJlY2F1c2Ugb2xkIHNvcnRhYmxlIHdpbGwgbm8gbG9uZ2VyIGJlIGZyb21Tb3J0YWJsZVxuICAgICAgICAgICAgcGFyZW50RWwuYXBwZW5kQ2hpbGQobXVsdGlEcmFnRWxlbWVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZm9sZGluZyA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbG9uZXMgbXVzdCBiZSBzaG93biAoYW5kIGNoZWNrIHRvIHJlbW92ZSBtdWx0aSBkcmFncykgYWZ0ZXIgZm9sZGluZyB3aGVuIGludGVyZmVyaW5nIG11bHRpRHJhZ0VsZW1lbnRzIGFyZSBtb3ZlZCBvdXRcbiAgICAgICAgaWYgKCFpc093bmVyKSB7XG4gICAgICAgICAgLy8gT25seSByZW1vdmUgaWYgbm90IGZvbGRpbmcgKGZvbGRpbmcgd2lsbCByZW1vdmUgdGhlbSBhbnl3YXlzKVxuICAgICAgICAgIGlmICghZm9sZGluZykge1xuICAgICAgICAgICAgcmVtb3ZlTXVsdGlEcmFnRWxlbWVudHMoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG11bHRpRHJhZ0VsZW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHZhciBjbG9uZXNIaWRkZW5CZWZvcmUgPSBjbG9uZXNIaWRkZW47XG4gICAgICAgICAgICBhY3RpdmVTb3J0YWJsZS5fc2hvd0Nsb25lKHNvcnRhYmxlKTtcblxuICAgICAgICAgICAgLy8gVW5mb2xkIGFuaW1hdGlvbiBmb3IgY2xvbmVzIGlmIHNob3dpbmcgZnJvbSBoaWRkZW5cbiAgICAgICAgICAgIGlmIChhY3RpdmVTb3J0YWJsZS5vcHRpb25zLmFuaW1hdGlvbiAmJiAhY2xvbmVzSGlkZGVuICYmIGNsb25lc0hpZGRlbkJlZm9yZSkge1xuICAgICAgICAgICAgICBtdWx0aURyYWdDbG9uZXMuZm9yRWFjaChmdW5jdGlvbiAoY2xvbmUpIHtcbiAgICAgICAgICAgICAgICBhY3RpdmVTb3J0YWJsZS5hZGRBbmltYXRpb25TdGF0ZSh7XG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IGNsb25lLFxuICAgICAgICAgICAgICAgICAgcmVjdDogY2xvbmVzRnJvbVJlY3RcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjbG9uZS5mcm9tUmVjdCA9IGNsb25lc0Zyb21SZWN0O1xuICAgICAgICAgICAgICAgIGNsb25lLnRoaXNBbmltYXRpb25EdXJhdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhY3RpdmVTb3J0YWJsZS5fc2hvd0Nsb25lKHNvcnRhYmxlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGRyYWdPdmVyQW5pbWF0aW9uQ2FwdHVyZTogZnVuY3Rpb24gZHJhZ092ZXJBbmltYXRpb25DYXB0dXJlKF9yZWYxMSkge1xuICAgICAgdmFyIGRyYWdSZWN0ID0gX3JlZjExLmRyYWdSZWN0LFxuICAgICAgICBpc093bmVyID0gX3JlZjExLmlzT3duZXIsXG4gICAgICAgIGFjdGl2ZVNvcnRhYmxlID0gX3JlZjExLmFjdGl2ZVNvcnRhYmxlO1xuICAgICAgbXVsdGlEcmFnRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAobXVsdGlEcmFnRWxlbWVudCkge1xuICAgICAgICBtdWx0aURyYWdFbGVtZW50LnRoaXNBbmltYXRpb25EdXJhdGlvbiA9IG51bGw7XG4gICAgICB9KTtcbiAgICAgIGlmIChhY3RpdmVTb3J0YWJsZS5vcHRpb25zLmFuaW1hdGlvbiAmJiAhaXNPd25lciAmJiBhY3RpdmVTb3J0YWJsZS5tdWx0aURyYWcuaXNNdWx0aURyYWcpIHtcbiAgICAgICAgY2xvbmVzRnJvbVJlY3QgPSBfZXh0ZW5kcyh7fSwgZHJhZ1JlY3QpO1xuICAgICAgICB2YXIgZHJhZ01hdHJpeCA9IG1hdHJpeChkcmFnRWwkMSwgdHJ1ZSk7XG4gICAgICAgIGNsb25lc0Zyb21SZWN0LnRvcCAtPSBkcmFnTWF0cml4LmY7XG4gICAgICAgIGNsb25lc0Zyb21SZWN0LmxlZnQgLT0gZHJhZ01hdHJpeC5lO1xuICAgICAgfVxuICAgIH0sXG4gICAgZHJhZ092ZXJBbmltYXRpb25Db21wbGV0ZTogZnVuY3Rpb24gZHJhZ092ZXJBbmltYXRpb25Db21wbGV0ZSgpIHtcbiAgICAgIGlmIChmb2xkaW5nKSB7XG4gICAgICAgIGZvbGRpbmcgPSBmYWxzZTtcbiAgICAgICAgcmVtb3ZlTXVsdGlEcmFnRWxlbWVudHMoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGRyb3A6IGZ1bmN0aW9uIGRyb3AoX3JlZjEyKSB7XG4gICAgICB2YXIgZXZ0ID0gX3JlZjEyLm9yaWdpbmFsRXZlbnQsXG4gICAgICAgIHJvb3RFbCA9IF9yZWYxMi5yb290RWwsXG4gICAgICAgIHBhcmVudEVsID0gX3JlZjEyLnBhcmVudEVsLFxuICAgICAgICBzb3J0YWJsZSA9IF9yZWYxMi5zb3J0YWJsZSxcbiAgICAgICAgZGlzcGF0Y2hTb3J0YWJsZUV2ZW50ID0gX3JlZjEyLmRpc3BhdGNoU29ydGFibGVFdmVudCxcbiAgICAgICAgb2xkSW5kZXggPSBfcmVmMTIub2xkSW5kZXgsXG4gICAgICAgIHB1dFNvcnRhYmxlID0gX3JlZjEyLnB1dFNvcnRhYmxlO1xuICAgICAgdmFyIHRvU29ydGFibGUgPSBwdXRTb3J0YWJsZSB8fCB0aGlzLnNvcnRhYmxlO1xuICAgICAgaWYgKCFldnQpIHJldHVybjtcbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICBjaGlsZHJlbiA9IHBhcmVudEVsLmNoaWxkcmVuO1xuXG4gICAgICAvLyBNdWx0aS1kcmFnIHNlbGVjdGlvblxuICAgICAgaWYgKCFkcmFnU3RhcnRlZCkge1xuICAgICAgICBpZiAob3B0aW9ucy5tdWx0aURyYWdLZXkgJiYgIXRoaXMubXVsdGlEcmFnS2V5RG93bikge1xuICAgICAgICAgIHRoaXMuX2Rlc2VsZWN0TXVsdGlEcmFnKCk7XG4gICAgICAgIH1cbiAgICAgICAgdG9nZ2xlQ2xhc3MoZHJhZ0VsJDEsIG9wdGlvbnMuc2VsZWN0ZWRDbGFzcywgIX5tdWx0aURyYWdFbGVtZW50cy5pbmRleE9mKGRyYWdFbCQxKSk7XG4gICAgICAgIGlmICghfm11bHRpRHJhZ0VsZW1lbnRzLmluZGV4T2YoZHJhZ0VsJDEpKSB7XG4gICAgICAgICAgbXVsdGlEcmFnRWxlbWVudHMucHVzaChkcmFnRWwkMSk7XG4gICAgICAgICAgZGlzcGF0Y2hFdmVudCh7XG4gICAgICAgICAgICBzb3J0YWJsZTogc29ydGFibGUsXG4gICAgICAgICAgICByb290RWw6IHJvb3RFbCxcbiAgICAgICAgICAgIG5hbWU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgdGFyZ2V0RWw6IGRyYWdFbCQxLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBNb2RpZmllciBhY3RpdmF0ZWQsIHNlbGVjdCBmcm9tIGxhc3QgdG8gZHJhZ0VsXG4gICAgICAgICAgaWYgKGV2dC5zaGlmdEtleSAmJiBsYXN0TXVsdGlEcmFnU2VsZWN0ICYmIHNvcnRhYmxlLmVsLmNvbnRhaW5zKGxhc3RNdWx0aURyYWdTZWxlY3QpKSB7XG4gICAgICAgICAgICB2YXIgbGFzdEluZGV4ID0gaW5kZXgobGFzdE11bHRpRHJhZ1NlbGVjdCksXG4gICAgICAgICAgICAgIGN1cnJlbnRJbmRleCA9IGluZGV4KGRyYWdFbCQxKTtcbiAgICAgICAgICAgIGlmICh+bGFzdEluZGV4ICYmIH5jdXJyZW50SW5kZXggJiYgbGFzdEluZGV4ICE9PSBjdXJyZW50SW5kZXgpIHtcbiAgICAgICAgICAgICAgLy8gTXVzdCBpbmNsdWRlIGxhc3RNdWx0aURyYWdTZWxlY3QgKHNlbGVjdCBpdCksIGluIGNhc2UgbW9kaWZpZWQgc2VsZWN0aW9uIGZyb20gbm8gc2VsZWN0aW9uXG4gICAgICAgICAgICAgIC8vIChidXQgcHJldmlvdXMgc2VsZWN0aW9uIGV4aXN0ZWQpXG4gICAgICAgICAgICAgIHZhciBuLCBpO1xuICAgICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ID4gbGFzdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgaSA9IGxhc3RJbmRleDtcbiAgICAgICAgICAgICAgICBuID0gY3VycmVudEluZGV4O1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGkgPSBjdXJyZW50SW5kZXg7XG4gICAgICAgICAgICAgICAgbiA9IGxhc3RJbmRleCArIDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZm9yICg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAofm11bHRpRHJhZ0VsZW1lbnRzLmluZGV4T2YoY2hpbGRyZW5baV0pKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhjaGlsZHJlbltpXSwgb3B0aW9ucy5zZWxlY3RlZENsYXNzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5wdXNoKGNoaWxkcmVuW2ldKTtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50KHtcbiAgICAgICAgICAgICAgICAgIHNvcnRhYmxlOiBzb3J0YWJsZSxcbiAgICAgICAgICAgICAgICAgIHJvb3RFbDogcm9vdEVsLFxuICAgICAgICAgICAgICAgICAgbmFtZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICB0YXJnZXRFbDogY2hpbGRyZW5baV0sXG4gICAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsYXN0TXVsdGlEcmFnU2VsZWN0ID0gZHJhZ0VsJDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIG11bHRpRHJhZ1NvcnRhYmxlID0gdG9Tb3J0YWJsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5zcGxpY2UobXVsdGlEcmFnRWxlbWVudHMuaW5kZXhPZihkcmFnRWwkMSksIDEpO1xuICAgICAgICAgIGxhc3RNdWx0aURyYWdTZWxlY3QgPSBudWxsO1xuICAgICAgICAgIGRpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgICAgc29ydGFibGU6IHNvcnRhYmxlLFxuICAgICAgICAgICAgcm9vdEVsOiByb290RWwsXG4gICAgICAgICAgICBuYW1lOiAnZGVzZWxlY3QnLFxuICAgICAgICAgICAgdGFyZ2V0RWw6IGRyYWdFbCQxLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTXVsdGktZHJhZyBkcm9wXG4gICAgICBpZiAoZHJhZ1N0YXJ0ZWQgJiYgdGhpcy5pc011bHRpRHJhZykge1xuICAgICAgICBmb2xkaW5nID0gZmFsc2U7XG4gICAgICAgIC8vIERvIG5vdCBcInVuZm9sZFwiIGFmdGVyIGFyb3VuZCBkcmFnRWwgaWYgcmV2ZXJ0ZWRcbiAgICAgICAgaWYgKChwYXJlbnRFbFtleHBhbmRvXS5vcHRpb25zLnNvcnQgfHwgcGFyZW50RWwgIT09IHJvb3RFbCkgJiYgbXVsdGlEcmFnRWxlbWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgIHZhciBkcmFnUmVjdCA9IGdldFJlY3QoZHJhZ0VsJDEpLFxuICAgICAgICAgICAgbXVsdGlEcmFnSW5kZXggPSBpbmRleChkcmFnRWwkMSwgJzpub3QoLicgKyB0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyArICcpJyk7XG4gICAgICAgICAgaWYgKCFpbml0aWFsRm9sZGluZyAmJiBvcHRpb25zLmFuaW1hdGlvbikgZHJhZ0VsJDEudGhpc0FuaW1hdGlvbkR1cmF0aW9uID0gbnVsbDtcbiAgICAgICAgICB0b1NvcnRhYmxlLmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpO1xuICAgICAgICAgIGlmICghaW5pdGlhbEZvbGRpbmcpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmFuaW1hdGlvbikge1xuICAgICAgICAgICAgICBkcmFnRWwkMS5mcm9tUmVjdCA9IGRyYWdSZWN0O1xuICAgICAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgbXVsdGlEcmFnRWxlbWVudC50aGlzQW5pbWF0aW9uRHVyYXRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChtdWx0aURyYWdFbGVtZW50ICE9PSBkcmFnRWwkMSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBmb2xkaW5nID8gZ2V0UmVjdChtdWx0aURyYWdFbGVtZW50KSA6IGRyYWdSZWN0O1xuICAgICAgICAgICAgICAgICAgbXVsdGlEcmFnRWxlbWVudC5mcm9tUmVjdCA9IHJlY3Q7XG5cbiAgICAgICAgICAgICAgICAgIC8vIFByZXBhcmUgdW5mb2xkIGFuaW1hdGlvblxuICAgICAgICAgICAgICAgICAgdG9Tb3J0YWJsZS5hZGRBbmltYXRpb25TdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogbXVsdGlEcmFnRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgcmVjdDogcmVjdFxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTXVsdGkgZHJhZyBlbGVtZW50cyBhcmUgbm90IG5lY2Vzc2FyaWx5IHJlbW92ZWQgZnJvbSB0aGUgRE9NIG9uIGRyb3AsIHNvIHRvIHJlaW5zZXJ0XG4gICAgICAgICAgICAvLyBwcm9wZXJseSB0aGV5IG11c3QgYWxsIGJlIHJlbW92ZWRcbiAgICAgICAgICAgIHJlbW92ZU11bHRpRHJhZ0VsZW1lbnRzKCk7XG4gICAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50KSB7XG4gICAgICAgICAgICAgIGlmIChjaGlsZHJlblttdWx0aURyYWdJbmRleF0pIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRFbC5pbnNlcnRCZWZvcmUobXVsdGlEcmFnRWxlbWVudCwgY2hpbGRyZW5bbXVsdGlEcmFnSW5kZXhdKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZChtdWx0aURyYWdFbGVtZW50KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBtdWx0aURyYWdJbmRleCsrO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIElmIGluaXRpYWwgZm9sZGluZyBpcyBkb25lLCB0aGUgZWxlbWVudHMgbWF5IGhhdmUgY2hhbmdlZCBwb3NpdGlvbiBiZWNhdXNlIHRoZXkgYXJlIG5vd1xuICAgICAgICAgICAgLy8gdW5mb2xkaW5nIGFyb3VuZCBkcmFnRWwsIGV2ZW4gdGhvdWdoIGRyYWdFbCBtYXkgbm90IGhhdmUgaGlzIGluZGV4IGNoYW5nZWQsIHNvIHVwZGF0ZSBldmVudFxuICAgICAgICAgICAgLy8gbXVzdCBiZSBmaXJlZCBoZXJlIGFzIFNvcnRhYmxlIHdpbGwgbm90LlxuICAgICAgICAgICAgaWYgKG9sZEluZGV4ID09PSBpbmRleChkcmFnRWwkMSkpIHtcbiAgICAgICAgICAgICAgdmFyIHVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKG11bHRpRHJhZ0VsZW1lbnQuc29ydGFibGVJbmRleCAhPT0gaW5kZXgobXVsdGlEcmFnRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgIHVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKHVwZGF0ZSkge1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoU29ydGFibGVFdmVudCgndXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hTb3J0YWJsZUV2ZW50KCdzb3J0Jyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBNdXN0IGJlIGRvbmUgYWZ0ZXIgY2FwdHVyaW5nIGluZGl2aWR1YWwgcmVjdHMgKHNjcm9sbCBiYXIpXG4gICAgICAgICAgbXVsdGlEcmFnRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAobXVsdGlEcmFnRWxlbWVudCkge1xuICAgICAgICAgICAgdW5zZXRSZWN0KG11bHRpRHJhZ0VsZW1lbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRvU29ydGFibGUuYW5pbWF0ZUFsbCgpO1xuICAgICAgICB9XG4gICAgICAgIG11bHRpRHJhZ1NvcnRhYmxlID0gdG9Tb3J0YWJsZTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVtb3ZlIGNsb25lcyBpZiBuZWNlc3NhcnlcbiAgICAgIGlmIChyb290RWwgPT09IHBhcmVudEVsIHx8IHB1dFNvcnRhYmxlICYmIHB1dFNvcnRhYmxlLmxhc3RQdXRNb2RlICE9PSAnY2xvbmUnKSB7XG4gICAgICAgIG11bHRpRHJhZ0Nsb25lcy5mb3JFYWNoKGZ1bmN0aW9uIChjbG9uZSkge1xuICAgICAgICAgIGNsb25lLnBhcmVudE5vZGUgJiYgY2xvbmUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjbG9uZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgbnVsbGluZ0dsb2JhbDogZnVuY3Rpb24gbnVsbGluZ0dsb2JhbCgpIHtcbiAgICAgIHRoaXMuaXNNdWx0aURyYWcgPSBkcmFnU3RhcnRlZCA9IGZhbHNlO1xuICAgICAgbXVsdGlEcmFnQ2xvbmVzLmxlbmd0aCA9IDA7XG4gICAgfSxcbiAgICBkZXN0cm95R2xvYmFsOiBmdW5jdGlvbiBkZXN0cm95R2xvYmFsKCkge1xuICAgICAgdGhpcy5fZGVzZWxlY3RNdWx0aURyYWcoKTtcbiAgICAgIG9mZihkb2N1bWVudCwgJ3BvaW50ZXJ1cCcsIHRoaXMuX2Rlc2VsZWN0TXVsdGlEcmFnKTtcbiAgICAgIG9mZihkb2N1bWVudCwgJ21vdXNldXAnLCB0aGlzLl9kZXNlbGVjdE11bHRpRHJhZyk7XG4gICAgICBvZmYoZG9jdW1lbnQsICd0b3VjaGVuZCcsIHRoaXMuX2Rlc2VsZWN0TXVsdGlEcmFnKTtcbiAgICAgIG9mZihkb2N1bWVudCwgJ2tleWRvd24nLCB0aGlzLl9jaGVja0tleURvd24pO1xuICAgICAgb2ZmKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLl9jaGVja0tleVVwKTtcbiAgICB9LFxuICAgIF9kZXNlbGVjdE11bHRpRHJhZzogZnVuY3Rpb24gX2Rlc2VsZWN0TXVsdGlEcmFnKGV2dCkge1xuICAgICAgaWYgKHR5cGVvZiBkcmFnU3RhcnRlZCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBkcmFnU3RhcnRlZCkgcmV0dXJuO1xuXG4gICAgICAvLyBPbmx5IGRlc2VsZWN0IGlmIHNlbGVjdGlvbiBpcyBpbiB0aGlzIHNvcnRhYmxlXG4gICAgICBpZiAobXVsdGlEcmFnU29ydGFibGUgIT09IHRoaXMuc29ydGFibGUpIHJldHVybjtcblxuICAgICAgLy8gT25seSBkZXNlbGVjdCBpZiB0YXJnZXQgaXMgbm90IGl0ZW0gaW4gdGhpcyBzb3J0YWJsZVxuICAgICAgaWYgKGV2dCAmJiBjbG9zZXN0KGV2dC50YXJnZXQsIHRoaXMub3B0aW9ucy5kcmFnZ2FibGUsIHRoaXMuc29ydGFibGUuZWwsIGZhbHNlKSkgcmV0dXJuO1xuXG4gICAgICAvLyBPbmx5IGRlc2VsZWN0IGlmIGxlZnQgY2xpY2tcbiAgICAgIGlmIChldnQgJiYgZXZ0LmJ1dHRvbiAhPT0gMCkgcmV0dXJuO1xuICAgICAgd2hpbGUgKG11bHRpRHJhZ0VsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICB2YXIgZWwgPSBtdWx0aURyYWdFbGVtZW50c1swXTtcbiAgICAgICAgdG9nZ2xlQ2xhc3MoZWwsIHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzLCBmYWxzZSk7XG4gICAgICAgIG11bHRpRHJhZ0VsZW1lbnRzLnNoaWZ0KCk7XG4gICAgICAgIGRpc3BhdGNoRXZlbnQoe1xuICAgICAgICAgIHNvcnRhYmxlOiB0aGlzLnNvcnRhYmxlLFxuICAgICAgICAgIHJvb3RFbDogdGhpcy5zb3J0YWJsZS5lbCxcbiAgICAgICAgICBuYW1lOiAnZGVzZWxlY3QnLFxuICAgICAgICAgIHRhcmdldEVsOiBlbCxcbiAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfY2hlY2tLZXlEb3duOiBmdW5jdGlvbiBfY2hlY2tLZXlEb3duKGV2dCkge1xuICAgICAgaWYgKGV2dC5rZXkgPT09IHRoaXMub3B0aW9ucy5tdWx0aURyYWdLZXkpIHtcbiAgICAgICAgdGhpcy5tdWx0aURyYWdLZXlEb3duID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9jaGVja0tleVVwOiBmdW5jdGlvbiBfY2hlY2tLZXlVcChldnQpIHtcbiAgICAgIGlmIChldnQua2V5ID09PSB0aGlzLm9wdGlvbnMubXVsdGlEcmFnS2V5KSB7XG4gICAgICAgIHRoaXMubXVsdGlEcmFnS2V5RG93biA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIF9leHRlbmRzKE11bHRpRHJhZywge1xuICAgIC8vIFN0YXRpYyBtZXRob2RzICYgcHJvcGVydGllc1xuICAgIHBsdWdpbk5hbWU6ICdtdWx0aURyYWcnLFxuICAgIHV0aWxzOiB7XG4gICAgICAvKipcclxuICAgICAgICogU2VsZWN0cyB0aGUgcHJvdmlkZWQgbXVsdGktZHJhZyBpdGVtXHJcbiAgICAgICAqIEBwYXJhbSAge0hUTUxFbGVtZW50fSBlbCAgICBUaGUgZWxlbWVudCB0byBiZSBzZWxlY3RlZFxyXG4gICAgICAgKi9cbiAgICAgIHNlbGVjdDogZnVuY3Rpb24gc2VsZWN0KGVsKSB7XG4gICAgICAgIHZhciBzb3J0YWJsZSA9IGVsLnBhcmVudE5vZGVbZXhwYW5kb107XG4gICAgICAgIGlmICghc29ydGFibGUgfHwgIXNvcnRhYmxlLm9wdGlvbnMubXVsdGlEcmFnIHx8IH5tdWx0aURyYWdFbGVtZW50cy5pbmRleE9mKGVsKSkgcmV0dXJuO1xuICAgICAgICBpZiAobXVsdGlEcmFnU29ydGFibGUgJiYgbXVsdGlEcmFnU29ydGFibGUgIT09IHNvcnRhYmxlKSB7XG4gICAgICAgICAgbXVsdGlEcmFnU29ydGFibGUubXVsdGlEcmFnLl9kZXNlbGVjdE11bHRpRHJhZygpO1xuICAgICAgICAgIG11bHRpRHJhZ1NvcnRhYmxlID0gc29ydGFibGU7XG4gICAgICAgIH1cbiAgICAgICAgdG9nZ2xlQ2xhc3MoZWwsIHNvcnRhYmxlLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcywgdHJ1ZSk7XG4gICAgICAgIG11bHRpRHJhZ0VsZW1lbnRzLnB1c2goZWwpO1xuICAgICAgfSxcbiAgICAgIC8qKlxyXG4gICAgICAgKiBEZXNlbGVjdHMgdGhlIHByb3ZpZGVkIG11bHRpLWRyYWcgaXRlbVxyXG4gICAgICAgKiBAcGFyYW0gIHtIVE1MRWxlbWVudH0gZWwgICAgVGhlIGVsZW1lbnQgdG8gYmUgZGVzZWxlY3RlZFxyXG4gICAgICAgKi9cbiAgICAgIGRlc2VsZWN0OiBmdW5jdGlvbiBkZXNlbGVjdChlbCkge1xuICAgICAgICB2YXIgc29ydGFibGUgPSBlbC5wYXJlbnROb2RlW2V4cGFuZG9dLFxuICAgICAgICAgIGluZGV4ID0gbXVsdGlEcmFnRWxlbWVudHMuaW5kZXhPZihlbCk7XG4gICAgICAgIGlmICghc29ydGFibGUgfHwgIXNvcnRhYmxlLm9wdGlvbnMubXVsdGlEcmFnIHx8ICF+aW5kZXgpIHJldHVybjtcbiAgICAgICAgdG9nZ2xlQ2xhc3MoZWwsIHNvcnRhYmxlLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcywgZmFsc2UpO1xuICAgICAgICBtdWx0aURyYWdFbGVtZW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZXZlbnRQcm9wZXJ0aWVzOiBmdW5jdGlvbiBldmVudFByb3BlcnRpZXMoKSB7XG4gICAgICB2YXIgX3RoaXMzID0gdGhpcztcbiAgICAgIHZhciBvbGRJbmRpY2llcyA9IFtdLFxuICAgICAgICBuZXdJbmRpY2llcyA9IFtdO1xuICAgICAgbXVsdGlEcmFnRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAobXVsdGlEcmFnRWxlbWVudCkge1xuICAgICAgICBvbGRJbmRpY2llcy5wdXNoKHtcbiAgICAgICAgICBtdWx0aURyYWdFbGVtZW50OiBtdWx0aURyYWdFbGVtZW50LFxuICAgICAgICAgIGluZGV4OiBtdWx0aURyYWdFbGVtZW50LnNvcnRhYmxlSW5kZXhcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gbXVsdGlEcmFnRWxlbWVudHMgd2lsbCBhbHJlYWR5IGJlIHNvcnRlZCBpZiBmb2xkaW5nXG4gICAgICAgIHZhciBuZXdJbmRleDtcbiAgICAgICAgaWYgKGZvbGRpbmcgJiYgbXVsdGlEcmFnRWxlbWVudCAhPT0gZHJhZ0VsJDEpIHtcbiAgICAgICAgICBuZXdJbmRleCA9IC0xO1xuICAgICAgICB9IGVsc2UgaWYgKGZvbGRpbmcpIHtcbiAgICAgICAgICBuZXdJbmRleCA9IGluZGV4KG11bHRpRHJhZ0VsZW1lbnQsICc6bm90KC4nICsgX3RoaXMzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyArICcpJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3SW5kZXggPSBpbmRleChtdWx0aURyYWdFbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBuZXdJbmRpY2llcy5wdXNoKHtcbiAgICAgICAgICBtdWx0aURyYWdFbGVtZW50OiBtdWx0aURyYWdFbGVtZW50LFxuICAgICAgICAgIGluZGV4OiBuZXdJbmRleFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXRlbXM6IF90b0NvbnN1bWFibGVBcnJheShtdWx0aURyYWdFbGVtZW50cyksXG4gICAgICAgIGNsb25lczogW10uY29uY2F0KG11bHRpRHJhZ0Nsb25lcyksXG4gICAgICAgIG9sZEluZGljaWVzOiBvbGRJbmRpY2llcyxcbiAgICAgICAgbmV3SW5kaWNpZXM6IG5ld0luZGljaWVzXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uTGlzdGVuZXJzOiB7XG4gICAgICBtdWx0aURyYWdLZXk6IGZ1bmN0aW9uIG11bHRpRHJhZ0tleShrZXkpIHtcbiAgICAgICAga2V5ID0ga2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChrZXkgPT09ICdjdHJsJykge1xuICAgICAgICAgIGtleSA9ICdDb250cm9sJztcbiAgICAgICAgfSBlbHNlIGlmIChrZXkubGVuZ3RoID4gMSkge1xuICAgICAgICAgIGtleSA9IGtleS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGtleS5zdWJzdHIoMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gaW5zZXJ0TXVsdGlEcmFnRWxlbWVudHMoY2xvbmVzSW5zZXJ0ZWQsIHJvb3RFbCkge1xuICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50LCBpKSB7XG4gICAgdmFyIHRhcmdldCA9IHJvb3RFbC5jaGlsZHJlblttdWx0aURyYWdFbGVtZW50LnNvcnRhYmxlSW5kZXggKyAoY2xvbmVzSW5zZXJ0ZWQgPyBOdW1iZXIoaSkgOiAwKV07XG4gICAgaWYgKHRhcmdldCkge1xuICAgICAgcm9vdEVsLmluc2VydEJlZm9yZShtdWx0aURyYWdFbGVtZW50LCB0YXJnZXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByb290RWwuYXBwZW5kQ2hpbGQobXVsdGlEcmFnRWxlbWVudCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXHJcbiAqIEluc2VydCBtdWx0aS1kcmFnIGNsb25lc1xyXG4gKiBAcGFyYW0gIHtbQm9vbGVhbl19IGVsZW1lbnRzSW5zZXJ0ZWQgIFdoZXRoZXIgdGhlIG11bHRpLWRyYWcgZWxlbWVudHMgYXJlIGluc2VydGVkXHJcbiAqIEBwYXJhbSAge0hUTUxFbGVtZW50fSByb290RWxcclxuICovXG5mdW5jdGlvbiBpbnNlcnRNdWx0aURyYWdDbG9uZXMoZWxlbWVudHNJbnNlcnRlZCwgcm9vdEVsKSB7XG4gIG11bHRpRHJhZ0Nsb25lcy5mb3JFYWNoKGZ1bmN0aW9uIChjbG9uZSwgaSkge1xuICAgIHZhciB0YXJnZXQgPSByb290RWwuY2hpbGRyZW5bY2xvbmUuc29ydGFibGVJbmRleCArIChlbGVtZW50c0luc2VydGVkID8gTnVtYmVyKGkpIDogMCldO1xuICAgIGlmICh0YXJnZXQpIHtcbiAgICAgIHJvb3RFbC5pbnNlcnRCZWZvcmUoY2xvbmUsIHRhcmdldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJvb3RFbC5hcHBlbmRDaGlsZChjbG9uZSk7XG4gICAgfVxuICB9KTtcbn1cbmZ1bmN0aW9uIHJlbW92ZU11bHRpRHJhZ0VsZW1lbnRzKCkge1xuICBtdWx0aURyYWdFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtdWx0aURyYWdFbGVtZW50KSB7XG4gICAgaWYgKG11bHRpRHJhZ0VsZW1lbnQgPT09IGRyYWdFbCQxKSByZXR1cm47XG4gICAgbXVsdGlEcmFnRWxlbWVudC5wYXJlbnROb2RlICYmIG11bHRpRHJhZ0VsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChtdWx0aURyYWdFbGVtZW50KTtcbiAgfSk7XG59XG5cblNvcnRhYmxlLm1vdW50KG5ldyBBdXRvU2Nyb2xsUGx1Z2luKCkpO1xuU29ydGFibGUubW91bnQoUmVtb3ZlLCBSZXZlcnQpO1xuXG5leHBvcnQgZGVmYXVsdCBTb3J0YWJsZTtcbmV4cG9ydCB7IE11bHRpRHJhZ1BsdWdpbiBhcyBNdWx0aURyYWcsIFNvcnRhYmxlLCBTd2FwUGx1Z2luIGFzIFN3YXAgfTtcbiIsICJpbXBvcnQgRnVzZSBmcm9tIFwiZnVzZS5qc1wiO1xuaW1wb3J0IHsgTWVudSwgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmxldCBDb2xsYXRvciA9IG5ldyBJbnRsLkNvbGxhdG9yKHVuZGVmaW5lZCwge1xuICB1c2FnZTogXCJzb3J0XCIsXG4gIHNlbnNpdGl2aXR5OiBcImJhc2VcIixcbiAgbnVtZXJpYzogdHJ1ZSxcbn0pLmNvbXBhcmU7XG5cbmxldCBTb3J0ZXIgPSB7XG4gIGFscGhhYmV0aWNhbDogZnVuY3Rpb24gKGZpcnN0OiBURmlsZSwgc2Vjb25kOiBURmlsZSkge1xuICAgIHJldHVybiBDb2xsYXRvcihmaXJzdC5iYXNlbmFtZSwgc2Vjb25kLmJhc2VuYW1lKTtcbiAgfSxcbiAgYWxwaGFiZXRpY2FsUmV2ZXJzZTogZnVuY3Rpb24gKGZpcnN0OiBURmlsZSwgc2Vjb25kOiBURmlsZSkge1xuICAgIHJldHVybiAtU29ydGVyLmFscGhhYmV0aWNhbChmaXJzdCwgc2Vjb25kKTtcbiAgfSxcbiAgYnlNb2RpZmllZFRpbWU6IGZ1bmN0aW9uIChmaXJzdDogVEZpbGUsIHNlY29uZDogVEZpbGUpIHtcbiAgICByZXR1cm4gc2Vjb25kLnN0YXQubXRpbWUgLSBmaXJzdC5zdGF0Lm10aW1lO1xuICB9LFxuICBieU1vZGlmaWVkVGltZVJldmVyc2U6IGZ1bmN0aW9uIChmaXJzdDogVEZpbGUsIHNlY29uZDogVEZpbGUpIHtcbiAgICByZXR1cm4gLVNvcnRlci5ieU1vZGlmaWVkVGltZShmaXJzdCwgc2Vjb25kKTtcbiAgfSxcbiAgYnlDcmVhdGVkVGltZTogZnVuY3Rpb24gKGZpcnN0OiBURmlsZSwgc2Vjb25kOiBURmlsZSkge1xuICAgIHJldHVybiBzZWNvbmQuc3RhdC5jdGltZSAtIGZpcnN0LnN0YXQuY3RpbWU7XG4gIH0sXG4gIGJ5Q3JlYXRlZFRpbWVSZXZlcnNlOiBmdW5jdGlvbiAoZmlyc3Q6IFRGaWxlLCBzZWNvbmQ6IFRGaWxlKSB7XG4gICAgcmV0dXJuIC1Tb3J0ZXIuYnlDcmVhdGVkVGltZShmaXJzdCwgc2Vjb25kKTtcbiAgfSxcbn07XG5cbmNvbnN0IFRyYW5zbGF0ZSA9IGkxOG5leHQudC5iaW5kKGkxOG5leHQpO1xuXG5jb25zdCBTb3J0R2x5cGggPSBcInVwLWFuZC1kb3duLWFycm93c1wiO1xuXG5jb25zdCBzb3J0T3B0aW9uU3RyaW5ncyA9IHtcbiAgYWxwaGFiZXRpY2FsOiBcInBsdWdpbnMuZmlsZS1leHBsb3Jlci5sYWJlbC1zb3J0LWEtdG8telwiLFxuICBhbHBoYWJldGljYWxSZXZlcnNlOiBcInBsdWdpbnMuZmlsZS1leHBsb3Jlci5sYWJlbC1zb3J0LXotdG8tYVwiLFxuICBieU1vZGlmaWVkVGltZTogXCJwbHVnaW5zLmZpbGUtZXhwbG9yZXIubGFiZWwtc29ydC1uZXctdG8tb2xkXCIsXG4gIGJ5TW9kaWZpZWRUaW1lUmV2ZXJzZTogXCJwbHVnaW5zLmZpbGUtZXhwbG9yZXIubGFiZWwtc29ydC1vbGQtdG8tbmV3XCIsXG4gIGJ5Q3JlYXRlZFRpbWU6IFwicGx1Z2lucy5maWxlLWV4cGxvcmVyLmxhYmVsLXNvcnQtY3JlYXRlZC1uZXctdG8tb2xkXCIsXG4gIGJ5Q3JlYXRlZFRpbWVSZXZlcnNlOiBcInBsdWdpbnMuZmlsZS1leHBsb3Jlci5sYWJlbC1zb3J0LWNyZWF0ZWQtb2xkLXRvLW5ld1wiLFxuICBjdXN0b206IFwiQ3VzdG9tXCIsXG59O1xuXG5jb25zdCBzb3J0T3B0aW9uR3JvdXBzID0gW1xuICBbXCJhbHBoYWJldGljYWxcIiwgXCJhbHBoYWJldGljYWxSZXZlcnNlXCJdLFxuICBbXCJieU1vZGlmaWVkVGltZVwiLCBcImJ5TW9kaWZpZWRUaW1lUmV2ZXJzZVwiXSxcbiAgW1wiYnlDcmVhdGVkVGltZVwiLCBcImJ5Q3JlYXRlZFRpbWVSZXZlcnNlXCJdLFxuICBbXCJjdXN0b21cIl0sXG5dO1xuXG5leHBvcnQgY29uc3QgZm9sZGVyU29ydCA9IGZ1bmN0aW9uIChvcmRlcjogc3RyaW5nW10sIGZvbGRlcnNPbkJvdHRvbT86IGJvb2xlYW4pIHtcbiAgbGV0IGZpbGVFeHBsb3JlciA9IHRoaXMudmlldyxcbiAgICBmb2xkZXJDb250ZW50cyA9IHRoaXMuZmlsZS5jaGlsZHJlbi5zbGljZSgpO1xuICBmb2xkZXJDb250ZW50cy5zb3J0KGZ1bmN0aW9uIChmaXJzdEVsOiBURmlsZSB8IFRGb2xkZXIsIHNlY29uZEVsOiBURmlsZSB8IFRGb2xkZXIpIHtcbiAgICBsZXQgZmlyc3RJc0ZvbGRlciwgc2Vjb25kSXNGb2xkZXI7XG4gICAgaWYgKFxuICAgICAgZm9sZGVyc09uQm90dG9tICYmXG4gICAgICAoKGZpcnN0SXNGb2xkZXIgPSBmaXJzdEVsIGluc3RhbmNlb2YgVEZvbGRlcikgfHwgKHNlY29uZElzRm9sZGVyID0gc2Vjb25kRWwgaW5zdGFuY2VvZiBURm9sZGVyKSlcbiAgICApIHtcbiAgICAgIHJldHVybiBmaXJzdElzRm9sZGVyICYmICFzZWNvbmRJc0ZvbGRlclxuICAgICAgICA/IDFcbiAgICAgICAgOiBzZWNvbmRJc0ZvbGRlciAmJiAhZmlyc3RJc0ZvbGRlclxuICAgICAgICA/IC0xXG4gICAgICAgIDogQ29sbGF0b3IoZmlyc3RFbC5uYW1lLCBzZWNvbmRFbC5uYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFvcmRlcikgcmV0dXJuIENvbGxhdG9yKGZpcnN0RWwubmFtZSwgc2Vjb25kRWwubmFtZSk7XG5cbiAgICAgIGNvbnN0IGluZGV4MSA9IG9yZGVyLmluZGV4T2YoZmlyc3RFbC5wYXRoKTtcbiAgICAgIGNvbnN0IGluZGV4MiA9IG9yZGVyLmluZGV4T2Yoc2Vjb25kRWwucGF0aCk7XG5cbiAgICAgIHJldHVybiAoaW5kZXgxID4gLTEgPyBpbmRleDEgOiBJbmZpbml0eSkgLSAoaW5kZXgyID4gLTEgPyBpbmRleDIgOiBJbmZpbml0eSk7XG4gICAgfVxuICB9KTtcbiAgY29uc3QgaXRlbXMgPSBmb2xkZXJDb250ZW50c1xuICAgIC5tYXAoKGNoaWxkOiBUQWJzdHJhY3RGaWxlKSA9PiBmaWxlRXhwbG9yZXIuZmlsZUl0ZW1zW2NoaWxkLnBhdGhdKVxuICAgIC5maWx0ZXIoKGY6IFRBYnN0cmFjdEZpbGUpID0+IGYpO1xuXG4gIGlmIChyZXF1aXJlQXBpVmVyc2lvbiAmJiByZXF1aXJlQXBpVmVyc2lvbihcIjAuMTUuMFwiKSkge1xuICAgIHRoaXMudkNoaWxkcmVuLnNldENoaWxkcmVuKGl0ZW1zKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmNoaWxkcmVuID0gaXRlbXM7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBhZGRTb3J0QnV0dG9uID0gZnVuY3Rpb24gKHNvcnRlckFycmF5OiBhbnksIHNvcnRPcHRpb246IGFueSwgc29ydGVyOmFueSxjdXJyZW50U29ydDphbnkpIHtcbiAgbGV0IHBsdWdpbiA9IHRoaXM7XG4gIGNvbnNvbGUubG9nKCdjdXJyZW50U29ydCcsY3VycmVudFNvcnQoKSlcbiAgbGV0IHNvcnRFbCA9IHRoaXMuYWRkTmF2QnV0dG9uKFxuICAgIFNvcnRHbHlwaCxcbiAgICBUcmFuc2xhdGUoXCJwbHVnaW5zLmZpbGUtZXhwbG9yZXIuYWN0aW9uLWNoYW5nZS1zb3J0XCIpLFxuICAgIGZ1bmN0aW9uIChldmVudDogTW91c2VFdmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGxldCBtZW51ID0gbmV3IE1lbnUocGx1Z2luLmFwcCk7XG4gICAgICBmb3IgKFxuICAgICAgICBsZXQgY3VycmVudFNvcnRPcHRpb24gPSBjdXJyZW50U29ydCgpLCBncm91cEluZGV4ID0gMCwgX3NvcnRPcHRpb25Hcm91cHMgPSBzb3J0T3B0aW9uR3JvdXBzO1xuICAgICAgICBncm91cEluZGV4IDwgX3NvcnRPcHRpb25Hcm91cHMubGVuZ3RoO1xuICAgICAgICBncm91cEluZGV4KytcbiAgICAgICkge1xuICAgICAgICBmb3IgKFxuICAgICAgICAgIGxldCBhZGRNZW51SXRlbSA9IGZ1bmN0aW9uIChfc29ydE9wdGlvbjoga2V5b2YgdHlwZW9mIHNvcnRPcHRpb25TdHJpbmdzKSB7XG4gICAgICAgICAgICAgIGxldCBsYWJlbCA9IFRyYW5zbGF0ZShzb3J0T3B0aW9uU3RyaW5nc1tfc29ydE9wdGlvbl0pO1xuICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVxuICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKGxhYmVsKVxuICAgICAgICAgICAgICAgICAgLnNldEFjdGl2ZShfc29ydE9wdGlvbiA9PT0gY3VycmVudFNvcnRPcHRpb24pXG4gICAgICAgICAgICAgICAgICAub25DbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfc29ydE9wdGlvbiAhPT0gY3VycmVudFNvcnRPcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICBzb3J0RWwuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0LW1ldGhvZFwiLCBfc29ydE9wdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmFwcC53b3Jrc3BhY2UudHJpZ2dlcihcImZpbGUtZXhwbG9yZXItc29ydC1jaGFuZ2VcIiwgX3NvcnRPcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNvcnRlcihfc29ydE9wdGlvbik7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaXRlbUluZGV4ID0gMCxcbiAgICAgICAgICAgIHNvcnRPcHRpb25Hcm91cCA9IF9zb3J0T3B0aW9uR3JvdXBzW2dyb3VwSW5kZXhdO1xuICAgICAgICAgIGl0ZW1JbmRleCA8IHNvcnRPcHRpb25Hcm91cC5sZW5ndGg7XG4gICAgICAgICAgaXRlbUluZGV4KytcbiAgICAgICAgKSB7XG4gICAgICAgICAgYWRkTWVudUl0ZW0oc29ydE9wdGlvbkdyb3VwW2l0ZW1JbmRleF0gYXMga2V5b2YgdHlwZW9mIHNvcnRPcHRpb25TdHJpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICBtZW51LmFkZFNlcGFyYXRvcigpO1xuICAgICAgfVxuICAgICAgbWVudS5zaG93QXRNb3VzZUV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICk7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHNvcnRFbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnQtbWV0aG9kXCIsIHNvcnRlcihjdXJyZW50U29ydCgpKSk7XG4gIH0sIDEwMCk7XG4gIHRoaXMuYWRkTmF2QnV0dG9uKFwidGhyZWUtaG9yaXpvbnRhbC1iYXJzXCIsIFwiRHJhZyB0byByZWFycmFuZ2VcIiwgZnVuY3Rpb24gKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgdmFsdWUgPSAhdGhpcy5oYXNDbGFzcyhcImlzLWFjdGl2ZVwiKTtcbiAgICB0aGlzLnRvZ2dsZUNsYXNzKFwiaXMtYWN0aXZlXCIsIHZhbHVlKTtcbiAgICBwbHVnaW4uYXBwLndvcmtzcGFjZS50cmlnZ2VyKFwiZmlsZS1leHBsb3Jlci1kcmFnZ2FibGUtY2hhbmdlXCIsIHZhbHVlKTtcbiAgfSkuYWRkQ2xhc3MoXCJkcmFnLXRvLXJlYXJyYW5nZVwiKTtcbiAgdGhpcy5hZGROYXZCdXR0b24oXCJzZWFyY2hcIiwgXCJGaWx0ZXIgaXRlbXNcIiwgZnVuY3Rpb24gKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgdmFsdWUgPSAhdGhpcy5oYXNDbGFzcyhcImlzLWFjdGl2ZVwiKTtcbiAgICB0aGlzLnRvZ2dsZUNsYXNzKFwiaXMtYWN0aXZlXCIsIHZhbHVlKTtcbiAgICBsZXQgZmlsdGVyRWwgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAnLndvcmtzcGFjZS1sZWFmLWNvbnRlbnRbZGF0YS10eXBlPVwiZmlsZS1leHBsb3JlclwiXSAuc2VhcmNoLWlucHV0LWNvbnRhaW5lciA+IGlucHV0J1xuICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgIGlmIChmaWx0ZXJFbCAmJiAhdmFsdWUpIHtcbiAgICAgIGZpbHRlckVsLnBhcmVudEVsZW1lbnQ/LmhpZGUoKTtcbiAgICAgIGZpbHRlckVsLnZhbHVlID0gXCJcIjtcbiAgICAgIGZpbHRlckVsLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiaW5wdXRcIikpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmaWx0ZXJFbD8ucGFyZW50RWxlbWVudD8uc2hvdygpO1xuICAgICAgZmlsdGVyRWw/LmZvY3VzKCk7XG4gICAgfVxuICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLnRyaWdnZXIoXCJmaWxlLWV4cGxvcmVyLWRyYWdnYWJsZS1jaGFuZ2VcIiwgdmFsdWUpO1xuICB9KTtcbiAgcmV0dXJuIHNvcnRFbDtcbn07XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQmFydGVuZGVyUGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFydGVuZGVyU2V0dGluZ3Mge1xuICBzdGF0dXNCYXJPcmRlcjogc3RyaW5nW107XG4gIHJpYmJvbkJhck9yZGVyOiBzdHJpbmdbXTtcbiAgZmlsZUV4cGxvcmVyT3JkZXI6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcbiAgYWN0aW9uQmFyT3JkZXI6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcbiAgYXV0b0hpZGU6IGJvb2xlYW47XG4gIGF1dG9IaWRlRGVsYXk6IG51bWJlcjtcbiAgZHJhZ0RlbGF5OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBCYXJ0ZW5kZXJTZXR0aW5ncyA9IHtcbiAgc3RhdHVzQmFyT3JkZXI6IFtdLFxuICByaWJib25CYXJPcmRlcjogW10sXG4gIGZpbGVFeHBsb3Jlck9yZGVyOiB7fSxcbiAgYWN0aW9uQmFyT3JkZXI6IHt9LFxuICBhdXRvSGlkZTogZmFsc2UsXG4gIGF1dG9IaWRlRGVsYXk6IDIwMDAsXG4gIGRyYWdEZWxheTogMjAwLFxufTtcblxuZXhwb3J0IGNsYXNzIFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgcGx1Z2luOiBCYXJ0ZW5kZXJQbHVnaW47XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQmFydGVuZGVyUGx1Z2luKSB7XG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICB9XG5cbiAgaGlkZSgpIHt9XG5cbiAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJBdXRvIENvbGxhcHNlXCIpXG4gICAgICAuc2V0RGVzYyhcIkF1dG9tYXRpY2FsbHkgaGlkZSByaWJib24gYW5kIHN0YXR1cyBiYXIgaXRlbXMgb25jZSB5b3VyIG1vdXNlIGxlYXZlcyB0aGUgaWNvbiBjb250YWluZXJcIilcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+XG4gICAgICAgIHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSGlkZSkub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9IaWRlID0gdmFsdWU7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkF1dG8gQ29sbGFwc2UgRGVsYXlcIilcbiAgICAgIC5zZXREZXNjKFwiSG93IGxvbmcgdG8gd2FpdCBiZWZvcmUgYXV0byBjb2xsYXBzaW5nIGhpZGRlbiBpY29ucyBvbiB0aGUgcmliYm9uIGFuZCBzdGF0dXMgYmFyXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ZmllbGQgPT4ge1xuICAgICAgICB0ZXh0ZmllbGQuc2V0UGxhY2Vob2xkZXIoU3RyaW5nKDIwMDApKTtcbiAgICAgICAgdGV4dGZpZWxkLmlucHV0RWwudHlwZSA9IFwibnVtYmVyXCI7XG4gICAgICAgIHRleHRmaWVsZC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b0hpZGVEZWxheSkpO1xuICAgICAgICB0ZXh0ZmllbGQub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9IaWRlRGVsYXkgPSBOdW1iZXIodmFsdWUpO1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkRyYWcgU3RhcnQgRGVsYXkgKG1zKVwiKVxuICAgICAgLnNldERlc2MoXCJIb3cgbG9uZyB0byB3YWl0IGJlZm9yZSB0cmlnZ2VyaW5nIHRoZSBkcmFnIGJlaGF2aW9yIGFmdGVyIGNsaWNraW5nLiBcdTI2QTBcdUZFMEYgUmVxdWlyZXMgYW4gYXBwIHJlc3RhcnQuXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ZmllbGQgPT4ge1xuICAgICAgICB0ZXh0ZmllbGQuc2V0UGxhY2Vob2xkZXIoU3RyaW5nKDIwMCkpO1xuICAgICAgICB0ZXh0ZmllbGQuaW5wdXRFbC50eXBlID0gXCJudW1iZXJcIjtcbiAgICAgICAgdGV4dGZpZWxkLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kcmFnRGVsYXkpKTtcbiAgICAgICAgdGV4dGZpZWxkLm9uQ2hhbmdlKGFzeW5jIHZhbHVlID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kcmFnRGVsYXkgPSBOdW1iZXIodmFsdWUpO1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IEZ1c2UgZnJvbSBcImZ1c2UuanNcIjtcbmltcG9ydCB7IENoaWxkRWxlbWVudCwgcmVxdWlyZUFwaVZlcnNpb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZXZpb3VzU2libGluZ3MoZWw6IEhUTUxFbGVtZW50LCBmaWx0ZXI/OiAoZWw6IEhUTUxFbGVtZW50KSA9PiBib29sZWFuKTogSFRNTEVsZW1lbnRbXSB7XG4gIHZhciBzaWJzID0gW107XG4gIHdoaWxlICgoZWwgPSBlbC5wcmV2aW91c1NpYmxpbmcgYXMgSFRNTEVsZW1lbnQpKSB7XG4gICAgaWYgKGVsLm5vZGVUeXBlID09PSAzKSBjb250aW51ZTsgLy8gdGV4dCBub2RlXG4gICAgaWYgKCFmaWx0ZXIgfHwgZmlsdGVyKGVsKSkgc2licy5wdXNoKGVsKTtcbiAgfVxuICByZXR1cm4gc2licztcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXROZXh0U2libGluZ3MoZWw6IEhUTUxFbGVtZW50LCBmaWx0ZXI/OiAoZWw6IEhUTUxFbGVtZW50KSA9PiBib29sZWFuKTogSFRNTEVsZW1lbnRbXSB7XG4gIHZhciBzaWJzID0gW107XG4gIHdoaWxlICgoZWwgPSBlbC5uZXh0U2libGluZyBhcyBIVE1MRWxlbWVudCkpIHtcbiAgICBpZiAoZWwubm9kZVR5cGUgPT09IDMpIGNvbnRpbnVlOyAvLyB0ZXh0IG5vZGVcbiAgICBpZiAoIWZpbHRlciB8fCBmaWx0ZXIoZWwpKSBzaWJzLnB1c2goZWwpO1xuICB9XG4gIHJldHVybiBzaWJzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlSWRPcHRpb25zIHtcbiAgdXNlVGFnPzogYm9vbGVhbjtcbiAgdXNlQXJpYT86IGJvb2xlYW47XG4gIHVzZUNsYXNzPzogYm9vbGVhbjtcbiAgdXNlSWNvbj86IGJvb2xlYW47XG4gIHVzZVRleHQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVJZChlbDogSFRNTEVsZW1lbnQsIG9wdGlvbnM/OiBHZW5lcmF0ZUlkT3B0aW9ucykge1xuICBsZXQgY2xhc3NlcyA9IG9wdGlvbnM/LnVzZUNsYXNzXG4gICAgPyBBcnJheS5mcm9tKGVsLmNsYXNzTGlzdClcbiAgICAgICAgLmZpbHRlcihjID0+ICFjLnN0YXJ0c1dpdGgoXCJpcy1cIikpXG4gICAgICAgIC5zb3J0KClcbiAgICAgICAgLmpvaW4oXCIgXCIpXG4gICAgOiBcIlwiO1xuICBsZXQgc3RyID1cbiAgICAob3B0aW9ucz8udXNlVGFnID8gZWwudGFnTmFtZSA6IFwiXCIpICtcbiAgICAob3B0aW9ucz8udXNlQ2xhc3MgPyBjbGFzc2VzIDogXCJcIikgK1xuICAgIChvcHRpb25zPy51c2VUZXh0ID8gZWwudGV4dENvbnRlbnQgOiBcIlwiKSArXG4gICAgKG9wdGlvbnM/LnVzZUFyaWEgPyBlbC5nZXRBdHRyKFwiYXJpYS1sYWJlbFwiKSA6IFwiXCIpICtcbiAgICAob3B0aW9ucz8udXNlSWNvbiA/IGVsLnF1ZXJ5U2VsZWN0b3IoXCJzdmdcIik/LmNsYXNzTmFtZT8uYmFzZVZhbCA6IFwiXCIpO1xuICByZXR1cm4gY3lyYjUzKHN0cik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBiYXNlMzYoc3RyOiBzdHJpbmcpIHtcbiAgbGV0IGkgPSBzdHIubGVuZ3RoO1xuICBsZXQgc3VtID0gMDtcblxuICB3aGlsZSAoaS0tKSB7XG4gICAgc3VtICs9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICB9XG4gIHJldHVybiBzdW0udG9TdHJpbmcoMzYpO1xufVxuXG5leHBvcnQgY29uc3QgY3lyYjUzID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nLCBzZWVkID0gMCkge1xuICBsZXQgaDEgPSAweGRlYWRiZWVmIF4gc2VlZCxcbiAgICBoMiA9IDB4NDFjNmNlNTcgXiBzZWVkO1xuICBmb3IgKGxldCBpID0gMCwgY2g7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICBjaCA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGgxID0gTWF0aC5pbXVsKGgxIF4gY2gsIDI2NTQ0MzU3NjEpO1xuICAgIGgyID0gTWF0aC5pbXVsKGgyIF4gY2gsIDE1OTczMzQ2NzcpO1xuICB9XG4gIGgxID0gTWF0aC5pbXVsKGgxIF4gKGgxID4+PiAxNiksIDIyNDY4MjI1MDcpIF4gTWF0aC5pbXVsKGgyIF4gKGgyID4+PiAxMyksIDMyNjY0ODk5MDkpO1xuICBoMiA9IE1hdGguaW11bChoMiBeIChoMiA+Pj4gMTYpLCAyMjQ2ODIyNTA3KSBeIE1hdGguaW11bChoMSBeIChoMSA+Pj4gMTMpLCAzMjY2NDg5OTA5KTtcbiAgcmV0dXJuIDQyOTQ5NjcyOTYgKiAoMjA5NzE1MSAmIGgyKSArIChoMSA+Pj4gMCkudG9TdHJpbmcoKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiByZW9yZGVyQXJyYXkoYXJyYXk6IGFueVtdLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIsIG9uID0gMSkge1xuICByZXR1cm4gYXJyYXkuc3BsaWNlKHRvLCAwLCAuLi5hcnJheS5zcGxpY2UoZnJvbSwgb24pKSwgYXJyYXk7XG59XG5cbi8vIGZsYXR0ZW4gaW5maW5pdHkgc2Nyb2xsIHJvb3QgZWxlbWVudHNcblxuZXhwb3J0IGNvbnN0IGdldEl0ZW1zID0gKGl0ZW1zOiBDaGlsZEVsZW1lbnRbXSk6IENoaWxkRWxlbWVudFtdID0+IHtcbiAgbGV0IGNoaWxkcmVuOiBhbnlbXSA9IFtdO1xuICBjb25zdCBzdXBwb3J0c1ZpcnR1YWxDaGlsZHJlbiA9IHJlcXVpcmVBcGlWZXJzaW9uICYmIHJlcXVpcmVBcGlWZXJzaW9uKFwiMC4xNS4wXCIpO1xuICBsZXQgX2l0ZW1zO1xuICBpZiAoc3VwcG9ydHNWaXJ0dWFsQ2hpbGRyZW4pIHtcbiAgICBfaXRlbXMgPSBpdGVtc1xuICAgICAgLnJlZHVjZSgocmVzLCBpdGVtKSA9PiB7XG4gICAgICAgIGlmIChpdGVtLnZDaGlsZHJlbj8uX2NoaWxkcmVuKSB7XG4gICAgICAgICAgY2hpbGRyZW4gPSBbLi4uY2hpbGRyZW4sIC4uLml0ZW0udkNoaWxkcmVuLl9jaGlsZHJlbl07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzLnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH0sIFtdIGFzIENoaWxkRWxlbWVudFtdKVxuICAgICAgLmNvbmNhdChjaGlsZHJlbi5sZW5ndGggPyBnZXRJdGVtcyhjaGlsZHJlbikgOiBjaGlsZHJlbik7XG4gIH0gZWxzZSB7XG4gICAgX2l0ZW1zID0gaXRlbXNcbiAgICAgIC5yZWR1Y2UoKHJlcywgaXRlbSkgPT4ge1xuICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbikge1xuICAgICAgICAgIGNoaWxkcmVuID0gWy4uLmNoaWxkcmVuLCAuLi5pdGVtLmNoaWxkcmVuXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfSwgW10gYXMgQ2hpbGRFbGVtZW50W10pXG4gICAgICAuY29uY2F0KGNoaWxkcmVuLmxlbmd0aCA/IGdldEl0ZW1zKGNoaWxkcmVuKSA6IGNoaWxkcmVuKTtcbiAgfVxuICByZXR1cm4gX2l0ZW1zO1xufTtcblxuLy8gaGlnaGxpZ2h0IGZ1enp5IGZpbHRlciBtYXRjaGVzXG5cbnR5cGUgTmVzdGVkT2JqZWN0ID0geyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfCBOZXN0ZWRPYmplY3QgfTtcblxuZXhwb3J0IGNvbnN0IGhpZ2hsaWdodCA9IChmdXNlU2VhcmNoUmVzdWx0OiBhbnksIGhpZ2hsaWdodENsYXNzTmFtZTogc3RyaW5nID0gXCJzdWdnZXN0aW9uLWhpZ2hsaWdodFwiKSA9PiB7XG4gIGNvbnN0IHNldCA9IChvYmo6IE5lc3RlZE9iamVjdCwgcGF0aDogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XG4gICAgY29uc3QgcGF0aFZhbHVlID0gcGF0aC5zcGxpdChcIi5cIik7XG4gICAgbGV0IGk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgcGF0aFZhbHVlLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgb2JqID0gb2JqW3BhdGhWYWx1ZVtpXV0gYXMgTmVzdGVkT2JqZWN0O1xuICAgIH1cblxuICAgIG9ialtwYXRoVmFsdWVbaV1dID0gdmFsdWU7XG4gIH07XG5cbiAgY29uc3QgZ2VuZXJhdGVIaWdobGlnaHRlZFRleHQgPSAoaW5wdXRUZXh0OiBzdHJpbmcsIHJlZ2lvbnM6IG51bWJlcltdW10gPSBbXSkgPT4ge1xuICAgIGxldCByZXN1bHQgPSByZWdpb25zXG4gICAgICAucmVkdWNlKChzdHIsIFtzdGFydCwgZW5kXSkgPT4ge1xuICAgICAgICBzdHJbc3RhcnRdID0gYDxzcGFuIGNsYXNzPVwiJHtoaWdobGlnaHRDbGFzc05hbWV9XCI+JHtzdHJbc3RhcnRdfWA7XG4gICAgICAgIHN0cltlbmRdID0gYCR7c3RyW2VuZF19PC9zcGFuPmA7XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgICB9LCBpbnB1dFRleHQuc3BsaXQoXCJcIikpXG4gICAgICAuam9pbihcIlwiKTsgLy8gLnJlcGxhY2UoLy5tZCQvLCBcIlwiKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgcmV0dXJuIGZ1c2VTZWFyY2hSZXN1bHRcbiAgICAuZmlsdGVyKCh7IG1hdGNoZXMgfTogYW55KSA9PiBtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoKVxuICAgIC5tYXAoKHsgaXRlbSwgbWF0Y2hlcyB9OiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IGhpZ2hsaWdodGVkSXRlbSA9IHsgLi4uaXRlbSB9O1xuICAgICAgbWF0Y2hlcy5mb3JFYWNoKChtYXRjaDogYW55KSA9PiB7XG4gICAgICAgIGlmICghaGlnaGxpZ2h0ZWRJdGVtLmlubmVyRWwub3JpZ0NvbnRlbnQpXG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJdGVtLmlubmVyRWwub3JpZ0NvbnRlbnQgPSBoaWdobGlnaHRlZEl0ZW0uaW5uZXJFbC50ZXh0Q29udGVudDtcbiAgICAgICAgc2V0KGhpZ2hsaWdodGVkSXRlbSwgXCJpbm5lckVsLmlubmVySFRNTFwiLCBnZW5lcmF0ZUhpZ2hsaWdodGVkVGV4dChtYXRjaC52YWx1ZSwgbWF0Y2guaW5kaWNlcykpO1xuICAgICAgICBoaWdobGlnaHRlZEl0ZW0uaW5uZXJFbD8uYWRkQ2xhc3MoXCJoYXMtbWF0Y2hlc1wiKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gaGlnaGxpZ2h0ZWRJdGVtO1xuICAgIH0pO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUV4dChvYmo6IGFueSkge1xuICBpZiAodHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIiB8fCBvYmogaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICByZXR1cm4gb2JqLnJlcGxhY2UoLy5tZCQvLCBcIlwiKTtcbiAgfVxuICByZXR1cm4gb2JqO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm4ob2JqOiBhbnksIHBhdGg6IHN0cmluZ1tdKSB7XG4gIHZhciB2YWx1ZSA9IEZ1c2UuY29uZmlnLmdldEZuKG9iaiwgcGF0aCk7XG4gIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHJldHVybiB2YWx1ZS5tYXAoZWwgPT4gcmVtb3ZlRXh0KGVsKSk7XG4gIH1cbiAgcmV0dXJuIHJlbW92ZUV4dCh2YWx1ZSk7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBOzs7QUNTQSxpQkFBaUIsT0FBTztBQUN0QixTQUFPLENBQUMsTUFBTSxVQUNWLE9BQU8sV0FBVyxtQkFDbEIsTUFBTSxRQUFRO0FBQUE7QUFJcEIsSUFBTSxXQUFXLElBQUk7QUFDckIsc0JBQXNCLE9BQU87QUFFM0IsTUFBSSxPQUFPLFNBQVMsVUFBVTtBQUM1QixXQUFPO0FBQUE7QUFFVCxNQUFJLFNBQVMsUUFBUTtBQUNyQixTQUFPLFVBQVUsT0FBTyxJQUFJLFNBQVMsQ0FBQyxXQUFXLE9BQU87QUFBQTtBQUcxRCxrQkFBa0IsT0FBTztBQUN2QixTQUFPLFNBQVMsT0FBTyxLQUFLLGFBQWE7QUFBQTtBQUczQyxrQkFBa0IsT0FBTztBQUN2QixTQUFPLE9BQU8s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
