---
title: "青龙"
linkTitle: "青龙"
weight: 20
---

# 概述

> 参考：
> 
> - [GitHub 项目，whyour/qinglong](https://github.com/whyour/qinglong)
> - [Faker 官网](https://www.fakerengine.com/)
> - [http://blog.mf0a.cn/?sort=3](http://blog.mf0a.cn/?sort=3)
> - [https://blog.csdn.net/m0_66043650](https://blog.csdn.net/m0_66043650)

一个支持 Python、JavaScript、Shell、TypeScript 代码编写的定时任务的管理平台。

## 关联文件与配置

**/ql/config/** # 

- **./auth.json** # 认证信息

# 安装

[https://github.com/zhangguanzhang/docker-compose/tree/master/qinglong](https://github.com/zhangguanzhang/docker-compose/tree/master/qinglong)

```bash
version: "3"
services:
  qinglong:
    image: whyour/qinglong:latest
    container_name: qinglong
    restart: unless-stopped
    tty: true
    ports:
      - 5700:5700
      - 5701:5701
    environment:
      - ENABLE_HANGUP=true
      - ENABLE_WEB_PANEL=true
    volumes:
      - ./qinglong/config:/ql/config
      - ./qinglong/log:/ql/log
      - ./qinglong/db:/ql/db
      - ./qinglong/repo:/ql/repo
      - ./qinglong/raw:/ql/raw
      - ./qinglong/scripts:/ql/scripts
      - ./qinglong/jbot:/ql/jbot
      - ./qinglong/ninja:/ql/ninja
```

```bash
docker-compose up -d

docker exec -it qinglong bash

apk add ca-certificates

cd /ql

(可选) pnpm config set registry https://registry.npmmirror.com
pnpm install
```

可以参考 [shufflewzc/QLDependency](https://github.com/shufflewzc/QLDependency) 项目中的脚本，以便安装未来可能用到的各种依赖。

## 添加各种依赖库

打开青龙页面后，惦记左侧的**依赖管理**，每次添加时选择**自动拆分**，下面是各种语言的依赖列表，直接复制即可：

nodejs

```
ts-md5
@types/node
prettytable
node-telegram-bot-api
tslib
ql
common
fs
typescript
axios
png-js
axios
ws@7.4.3
crypto-js
jieba
global-agent
jsdom -g
moment
form-data
date-fns
node-jsencrypt
require
js-base64
tough-cookie
json5
jsdom
dotenv
qs
```

Python

```text
ping3
canvas
requests
jieba
PyExecJS
httpx
```

Linxu

```text
lxml
bizMsg
bizCode
gcc
python-devel
aiohttp
magic
```

# 任务推荐

[https://github.com/shufflewzc/faker2](https://github.com/shufflewzc/faker2)

- 这里主要是京东的

[https://github.com/leafTheFish/DeathNote](https://github.com/leafTheFish/DeathNote)

- 这里还有美团和饿了么
- [https://blog.csdn.net/m0_66043650/article/details/127577400](https://blog.csdn.net/m0_66043650/article/details/127577400)
- [https://blog.csdn.net/m0_66043650/article/details/127577831](https://blog.csdn.net/m0_66043650/article/details/127577831)

# 京东任务

## 获取京东 cookie

chrome 浏览器去 https://bean.m.jd.com/bean/signIndex.action 获取 cookies：xx_key 然后 xx_pin，去仪表板添加环境 JD_COOKIE，值是 xx_key=xxx;xx_pin=xxx

### 注意

"Invalid character in header content [\"cookie\"]"

京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试京东资产变动通知 API请求失败，请检查网路重试

京东资产变动通知 API请求失败，请检查网路重试

未知情况：undefined

未知情况，跳出

NI OPENWR 下 docker 安装撸JD羊毛，始终是API请求失败。不管是桥接模式还是host模式都是显示API请求失败。后面换了VPS还是一样的效果，这真是头都大了。已经弄了2天了，还是失败，欲哭无泪啊

网上页看到很多API请求错误，都是没有能解决的。哪位兄弟已经解决的，帮忙看看，谢谢。

**如果有 jd 用户名是中文的，获取 CK 的时候不要使用网页版 F12，这样获取的 pin 是中文的，脚本没办法识别。**

## 加任务

转到 ip:5700，密码是 admin/admin，或者可以得到它：`docker exec qinglong jq .password /ql/config/auth.json`，在仪表板上添加一个 crontab：

`*/4 * * * * ql repo https://git.metauniverse-cn.com/https://github.com/shufflewzc/faker2.git "jd_|jx_|gua_|jddj_|jdCookie" "activity|backUp" "^jd[^_]|USER|function|utils|sendNotify|ZooFaker_Necklace.js|JDJRValidator_|sign_graphics_validate|ql|JDSignValidator|magic|depend|h5sts" "main"`

该命令可以从 [shufflewzc/faker2](https://github.com/shufflewzc/faker2.git) 项目获得。

添加的脚本运行日志报错的话，docker exec -it -w /ql/scripts/ qinglong pnpm install

### 其他

```bash
ql repo https://git.metauniverse-cn.com/https://github.com/shufflewzc/faker2.git "jd_|jx_|gua_|jddj_|jdCookie" "activity|backUp" "^jd[^_]|USER|function|utils|sendNotify|ZooFaker_Necklace.js|JDJRValidator_|sign_graphics_validate|ql|JDSignValidator|magic|depend" "main"
```

```bash
ql repo https://git.metauniverse-cn.com/https://github.com/shufflewzc/faker2.git "jd_|jx_|gua_|jddj_|jdCookie" "activity|backUp" "^jd[^_]|USER|function|utils|sendNotify|ZooFaker_Necklace.js|JDJRValidator_|sign_graphics_validate|ql|JDSignValidator|magic|depend|h5sts" "main"
```

## 问题

jing喜工厂啥的没激活的话下jing喜apk，然后进去激活下相关的

# 美团任务

## 获取认证信息

`*.meituan.com`，通常是从 https://passport.meituan.com/api/v3/account/mobilelogin 接口下获取 `token` 与 `userID`

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12851928/1669014201988-960614d3-48a8-4972-889a-4f3c5a1b2511.png#averageHue=%23fdfbf8&clientId=uc22ad544-6212-4&from=paste&height=164&id=ue6047f6b&originHeight=164&originWidth=373&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15947&status=done&style=none&taskId=u58bbfc75-5cdc-40ee-8f63-3cfd0e1a198&title=&width=373)

自行捉包把 token(一般在请求头里)填到变量 meituanCookie 中, 多账号换行或 `&` 或 `@` 隔开

export meituanCookie="AgGZIgsYHyxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

可用的连接

- i.meituan.com

## 加任务

```bash
ql raw https://ghproxy.com/https://raw.githubusercontent.com/leafTheFish/DeathNote/main/meituanV3.js
```

# 饿了么任务

安装

```bash
ql raw https://ghproxy.com/https://raw.githubusercontent.com/leafTheFish/DeathNote/main/elm.js
```

获取认证信息

[https://h5.ele.me](https://h5.ele.me)

在某个接口的请求头的 cookie 中获取 `SID` 与 `cookie2`，接口通常是：[https://waimai-guide.ele.me/h5/mtop.alsc.personal.queryminecenter](https://waimai-guide.ele.me/h5/mtop.alsc.personal.queryminecenter)

