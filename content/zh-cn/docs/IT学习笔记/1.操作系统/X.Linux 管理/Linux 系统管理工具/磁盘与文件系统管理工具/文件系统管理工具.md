---
title: "文件系统管理工具"
linkTitle: "文件系统管理工具"
weight: 20
---

# 概述

> 参考：
> -

mkfs 与 mke2fs 则是创建文件系统的工具，也就是格式化磁盘的工具。

dumpe2fs 与 xfs_info 是相似的工具，分别对应 ext 和 xfs 文件系统的信息查看

# mkfs

> 参考：
> - [Manual(手册)，mkfs(8)](https://man7.org/linux/man-pages/man8/mkfs.8.html)

纯 mkfs 已弃用，使用 mkfs.TYPE 来创建指定类型的文件系统而不用 -t 选项了。

**mkfs \[OPTIONS]**

OPTIONS

  - **-t** # 指定创建的文件系统的类型

EXAMPLE

  - mkfs.ext4 /dev/myvg/lv1 # 在 /dev/myvg/lv1 分区上创建 ext4 格式的文件系统
  - mkfs.xfs /dev/vdb1 # 在 /dev/sdb1 分区上创建 xfs 格式的文件系统

# mke2fs

**mke2fs \[OPTIONS]**

OPTIONS

  - -t 指定文件系统格式
  - -b 指定 block 的大小(支持 1024,2048,4096 三种)

EXAMPLE

# dumpe2fs

> 参考：
> - [Manual(手册)，dumpe2fs(8)](https://man7.org/linux/man-pages/man8/dumpe2fs.8.html)

转存 ext2/ext3/ext4 文件系统的信息。说白话就是显示指定设备上存在的各种 ext 格式的文件系统的信息（包括 超级块、块组、等 信息）。

## Syntax(语法)

**dumpe2fs [-bfghimxV] \[-o superblock=\<num>] [-o blocksize=\<num>] DEVICE**

**OPTIONS**

- **-h** # 仅显示超级块信息，不显示任何块组描述符详细信息。

# xfs_info

显示 XFS 文件系统的几何信息

xfs_info 显示有关现有 XFS 文件系统的几何信息。挂载点参数是挂载文件系统的目录的路径名。块设备或文件映像包含原始 XFS 文件系统。文件系统的现有内容不受干扰。

> 参考：
> - [manual,df](https://man7.org/linux/man-pages/man1/df.1.html)
> - [manual,du](https://man7.org/linux/man-pages/man1/du.1.html)
> - [manual,lsblk](https://man7.org/linux/man-pages/man8/lsblk.8.html)

# xfs_repair 命令行工具

> 参考：
> - 官方文档：[xfs_repair man 手册](https://man.cx/xfs_repair)

`xfs_repair` 用于修复 XFS 文件系统。

```bash
~]# xfs_info /dev/mapper/vg1-root
    meta-data=/dev/mapper/vg1-root   isize=512    agcount=4, agsize=32735744 blks
             =                       sectsz=512   attr=2, projid32bit=1
             =                       crc=1        finobt=1, sparse=1, rmapbt=0
             =                       reflink=1
    data     =                       bsize=4096   blocks=130942976, imaxpct=25
             =                       sunit=0      swidth=0 blks
    naming   =version 2              bsize=4096   ascii-ci=0, ftype=1
    log      =internal log           bsize=4096   blocks=63937, version=2
             =                       sectsz=512   sunit=0 blks, lazy-count=1
    realtime =none                   extsz=4096   blocks=0, rtextents=0
```


# df

查看文件系统的容量使用情况

### Syntax(语法)

**df \[OPTIONS]... \[FILE]...**

OPTIONS

- **-h, --human-readable** # 以人类可读的方式输出信息。磁盘容量以 1024 为除数。效果如下：
  - ![image.png](https://notes-learning.oss-cn-beijing.aliyuncs.com/zqtob4/1625708279949-ac083715-d7e8-4271-800e-6c5791aa3573.png)
- **-i, --inodes** # 列出 inode 信息
- **-T, --print-type** # 输出文件系统类型
- **-t, --type \<TYPE>** # 仅列出指定类型的文件系统。(文件系统类型可以通过 -T 选项看到)

### EXAMPLE

- **df -h /** # 以人类易读的方式显示挂载在/下的信息，可以显示容量是 M 还是 G 还是 K

# du

查看文件系统下当前目录以及子目录的容量

### Syntax(语法)

OPTIONS

- **-a** # 包括目录下的文件大小也一起显示
- **-s** # 仅列出当前目录的容量总计，不显示子目录
- **-h** # 把容量大小转换为人类易读的格式
- **-d, --maxdepth \<NUM>** # 仅列出目录深度 1 层的信息，即当前目录下的目录的大小，不往下列出子目录

EXAMPLE

- du -d 1 | sort -rn | head -n 2 # 列出不含子目录的当前目录下的目录大小，并以数字进行降序排列，且只显示前两行

# ncdu - 比 du 更快的工具

> 参考：
> - https://code.blicky.net/yorhel/ncdu/src/branch/zig/src
> - [官网](https://dev.yorhel.nl/ncdu)

## sn # 比 du 更快的工具

> 参考：
> - [GitHub 项目，vmchale/tin-summer](https://github.com/vmchale/tin-summer)

### Syntax(语法)

**sn \<SUBCOMMAND>**

sn 工具完全通过子命令来执行具体操作

SUBCOMMAND

- sort #

OPTIONS：

- **-d, --depth \<NUMBER>** # 目录深度

### EXAMPLE

- 显示根目录下一层深度的容量大小，并排序
  - sn sort -d 1 /
