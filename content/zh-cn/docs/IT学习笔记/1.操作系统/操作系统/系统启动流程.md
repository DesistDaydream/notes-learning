---
title: ç³»ç»Ÿå¯åŠ¨æµç¨‹
---

# æ¦‚è¿°

> å‚è€ƒï¼š
> - [å…¬ä¼—å·ï¼Œé©¬å“¥ Linux è¿ç»´-Linux ç³»ç»Ÿå¼€æœºåŠ ç”µåå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ](https://mp.weixin.qq.com/s/hItVJbvxN2DHkb1rwYSltA)
> - [å…¬ä¼—å·ï¼Œç å†œçš„è’å²›æ±‚ç”Ÿ-æ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•å¯åŠ¨èµ·æ¥çš„ï¼Ÿ](https://mp.weixin.qq.com/s/QDjAIzas5EXQ24-NfTU3TQ)

æ“ä½œç³»ç»Ÿè¢«ç§°ä¸º The first programme(ç¬¬ä¸€ä¸ªç¨‹åº)ï¼ŒåŸå› å¾ˆç®€å•ï¼Œåªæœ‰å½“æ“ä½œç³»ç»Ÿå¯åŠ¨èµ·æ¥åæ‰èƒ½è¿è¡Œæˆ‘ä»¬ç¼–å†™çš„ç¨‹åºï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿæ˜¯æ€æ ·å¯åŠ¨èµ·æ¥çš„å‘¢ï¼Ÿ**å®é™…ä¸Šè¿™ä¸ªè¿‡ç¨‹å°±åƒå‘å°„ç«ç®­ä¸€æ ·æœ‰è¶£**

## æ“ä½œç³»ç»Ÿä¹Ÿæ˜¯æ™®é€šç¨‹åº

é¦–å…ˆæˆ‘ä»¬å¿…é¡»æ„è¯†åˆ°è¿™æ ·ä¸¤ç‚¹ï¼š

- CPU æ‰§è¡Œçš„æ˜¯æœºå™¨æŒ‡ä»¤ï¼Œç¼–è¯‘å™¨å°†ç¨‹åºç¿»è¯‘åæˆäº†æœºå™¨æŒ‡ä»¤
- æ“ä½œç³»ç»Ÿæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç¨‹åºï¼Œè¿™ä¸ªç¨‹åºè¢«ç¼–è¯‘åä¹Ÿä¼šç”Ÿæˆä¸€å¤§å †æœºå™¨æŒ‡ä»¤

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ï¼Œæ“ä½œç³»ç»Ÿæœ¬èº«å…¶å®ä¹Ÿæ˜¯ä¸€å¤§å †æœºå™¨æŒ‡ä»¤ï¼Œæ—¢ç„¶æ˜¯æœºå™¨æŒ‡ä»¤é‚£ä¹ˆå®ƒå¿…é¡»å¾—å­˜æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹ã€‚

å­˜æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿ

æƒ³æƒ³æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºï¼Œç¼–è¯‘åç”Ÿæˆçš„æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯ä»¥â€œæ–‡ä»¶â€çš„å½¢å¼å­˜æ”¾çš„ï¼Œå¹¶ä¸”å­˜æ”¾åœ¨ç¡¬ç›˜ä¸Šï¼Œè€Œæ“ä½œç³»ç»Ÿä¹Ÿæ²¡ä»€ä¹ˆä¸åŒï¼Œç¼–è¯‘åç”Ÿæˆçš„æœºå™¨æŒ‡ä»¤åŒæ ·æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾çš„ï¼Œå­˜æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿå¯ä»¥å­˜æ”¾åœ¨ä»»ä½•èƒ½å­˜å‚¨æ•°æ®çš„ä»‹è´¨ï¼Œåƒ CDã€ç£ç›˜ä¹‹ç±»éƒ½å¯ä»¥ã€‚

æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºåœ¨å¯åŠ¨æ—¶è¢«åŠ è½½å™¨â€”â€”ä¹Ÿå°±æ˜¯ loaderï¼ŒåŠ è½½åˆ°å†…å­˜ï¼ŒåŠ è½½å™¨ä¹Ÿæ˜¯ä¸€ä¸ªç¨‹åºï¼Œè¿™æ˜¯ä¸€ä¸ªåŠ è½½å…¶å®ƒç¨‹åºçš„ç¨‹åºï¼›è¿™ä¹ˆè¯´å¯èƒ½æœ‰ç‚¹æ‹—å£ï¼Œä½†è®¡ç®—æœºç³»ç»Ÿä¸­æœ‰å¤§é‡ç±»ä¼¼çš„ç¨‹åºï¼Œç¼–è¯‘å™¨æ˜¯ä¸€ä¸ªç¿»è¯‘ç¨‹åºçš„ç¨‹åºã€æ“ä½œç³»ç»Ÿæ˜¯ä¸€ä¸ªè¿è¡Œå…¶å®ƒç¨‹åºçš„ç¨‹åºã€é“¾æ¥å™¨æ˜¯ä¸€ä¸ªé“¾æ¥ç¨‹åºçš„ç¨‹åºã€è§£é‡Šå™¨æ˜¯ä¸€ä¸ªæ‰§è¡Œè„šæœ¬ç¨‹åºçš„ç¨‹åºç­‰ç­‰ã€‚
**é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„é—®é¢˜**

å›åˆ°æˆ‘ä»¬çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬å†™çš„ä»£ç æ˜¯ loader åŠ è½½åˆ°å†…å­˜åè¿è¡Œçš„ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿè¿™ä¸ªç¨‹åºæ˜¯ä¹ŸåŒæ ·çš„é“ç†ï¼Œå¿…é¡»å¾—æœ‰ä¸ªä»€ä¹ˆä¸œè¥¿ä¹Ÿè¦æŠŠæ“ä½œç³»ç»ŸåŠ è½½åˆ°å†…å­˜ä¸­è¿è¡Œæ‰å¯ä»¥ï¼Œè¿™ä¸ªä¸œè¥¿ä¸å« loaderï¼Œè€Œæ˜¯å« boot loaderï¼Œå…¶æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç¨‹åºï¼Œ**å®ƒçš„ä»»åŠ¡å°±æ˜¯åŠ è½½ä¸€ä¸ªæ›´å¤§çš„ç¨‹åº**ï¼Œå°±åƒè¿™é‡Œçš„æ“ä½œç³»ç»Ÿã€‚

![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429100745-ceca564f-ccaf-4249-83c4-03637c50eb6f.png)

æ­¤æ—¶è¿™é‡Œä¼šå‡ºç°ä¸€ä¸ªé¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„ï¼Œæ—¢ç„¶æˆ‘ä»¬çš„ç¨‹åºæ˜¯è¢«åŠ è½½å™¨ loader(æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†)åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œæ“ä½œç³»ç»Ÿåˆæ˜¯è¢« boot loader è¿™ä¸ªåŠ è½½ç¨‹åºåŠ è½½åˆ°å†…å­˜ä¸­çš„ï¼Œé‚£ä¹ˆåˆæ˜¯ä»€ä¹ˆåŠ è½½å™¨æŠŠ boot loader è¿™ä¸ªåŠ è½½ç¨‹åºåŠ è½½åˆ°å†…å­˜ä¸­å‘¢ï¼Ÿè€Œåˆåˆæ˜¯ä»€ä¹ˆåŠ è½½å™¨æŠŠä¸Šä¸€å¥ä¸­çš„ä»€ä¹ˆåŠ è½½å™¨åŠ è½½å†…å­˜ä¸­å‘¢ï¼Ÿè€Œåˆåˆåˆæ˜¯ä»€ä¹ˆã€‚ã€‚ï¼Ÿ

![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429100748-550bd283-9b49-4e33-9791-a47013d74bca.png)

ä½ ä¼šå‘ç°è¿™ä¸ªä¸€ä¸ªæ²¡æœ‰å‡ºå£çš„æ— ç©·é€’å½’å•Šæœ‰æ²¡æœ‰ï¼Œæ€»å¾—æœ‰ä¸ªä»€ä¹ˆæŠŠå‰ä¸€ä¸ªç¨‹åºåŠ è½½åˆ°å†…å­˜ï¼Œ**å°±å¥½æ¯”ä»Šå¤©çš„å‰ä¸€å¤©æ˜¯æ˜¨å¤©ã€æ˜¨å¤©çš„å‰ä¸€å¤©æ˜¯å‰å¤©ã€å‰å¤©çš„å‰ä¸€å¤©æ˜¯å¤§å‰å¤©ï¼Œå¦‚æœä¸€ç›´è¿™æ ·æ€è€ƒä¸‹å»é‚£ä¹ˆæ—¶é—´åˆ°åº•åœ¨å“ªé‡Œå¼€å§‹çš„å‘¢**ï¼Ÿæ—¶é—´åˆ°åº•æœ‰æ²¡æœ‰å¼€å§‹(å‚è€ƒæ—¶é—´ç®€å²æˆ–ç›¸å¯¹è®º)ï¼Ÿ

æ—¶é—´æœ‰æ²¡æœ‰å¼€å§‹è¿™ä¸ªé—®é¢˜æˆ‘ä¸æ¸…æ¥šï¼Œä½†æ“ä½œç³»ç»Ÿå¯åŠ¨çš„è¿™ä¸ªé—®é¢˜æˆ‘çŸ¥é“ã€‚

ä¸Šè¿°å…³äºåŠ è½½å™¨ä»¥åŠåŠ è½½åŠ è½½å™¨ç­‰é—®é¢˜å…¨éƒ¨æŒ‡å‘äº†å†…å­˜ï¼Œè®©æˆ‘ä»¬å¥½å¥½æƒ³ä¸€æƒ³å†…å­˜æœ‰ä»€ä¹ˆç‰¹æ®Šæ€§ï¼Ÿ

## å†…å­˜æ–­ç”µåæ˜¯æ— æ³•ä¿å­˜æ•°æ®

ç¨‹åºå‘˜éƒ½çŸ¥é“å†…å­˜åªæœ‰åœ¨åŠ ç”µçš„æƒ…å†µä¸‹æ‰å¯ä»¥ä¿å­˜æ•°æ®(å…³äºå†…å­˜çš„å®ç°åŸç†ä½ å¯ä»¥å‚è€ƒè¿™ç¯‡ã€Š[ä½ ç®¡è¿™ç ´ç©æ„å« CPUï¼Ÿ](http://mp.weixin.qq.com/s?__biz=Mzg4OTYzODM4Mw==&mid=2247485736&idx=1&sn=a70558b5200e840ef251e19a2eef099b&chksm=cfe995a8f89e1cbe8fab1240515f35ec90fb520d122ec60761b71a8664ae3af390689be370aa&scene=21#wechat_redirect)ã€‹)ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œ**å½“æ–­ç”µåå†…å­˜ä¸­çš„å†…å®¹å°±ä¸¢å¤±äº†**ï¼Œé‚£ä¹ˆåˆå¾ˆæ˜¾ç„¶çš„ï¼Œå½“ä½ åœ¨æŒ‰ä¸‹è®¡ç®—æœºå¼€å…³é€šç”µæ—¶ï¼Œå†…å­˜ä¸­çš„å†…å®¹æ˜¯æœªè¢«åˆå§‹åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å†…å­˜ä¸­çš„å†…å®¹æ˜¯æ— æ•ˆçš„ï¼Œ**æ­¤æ—¶çš„å†…å­˜é‡Œè¿˜æ˜¯ä¸€ç‰‡è’èŠœ**ï¼Œè¿™é‡Œæ²¡æœ‰ä»»ä½•ä¸œè¥¿å¯ä¾› CPU æ¥æ‰§è¡Œï¼Œè¿™å°±å¥½æ¯”å¤§çˆ†ç‚¸ä¹‹å‰çš„å®‡å®™ã€‚
![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429100787-22b14442-38f8-43b5-9e92-0cd8bc048d40.png)
ä½†æˆ‘ä»¬çš„è®¡ç®—æœºæ€»æ˜¯èƒ½å¯åŠ¨èµ·æ¥ï¼ŒCPU å¿…é¡»å¾—æ‰§è¡Œâ€œä¸€æ®µä»€ä¹ˆç¨‹åºâ€æŠŠç¬¬ä¸€ä¸ª boot loader åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œ**ç”±äºæ­¤æ—¶å†…å­˜ä¸­è¿˜ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆè¿™æ®µç¨‹åºä¸€å®šè¢«ä¿å­˜åœ¨äº†å…¶å®ƒåœ°æ–¹**ã€‚

ä¿å­˜åœ¨äº†å“ªé‡Œå‘¢ï¼Ÿ

æ²¡é”™ï¼Œè¿™æ®µç¨‹åºå°±è¢«ä¿å­˜åœ¨äº† BIOS çš„éæ˜“å¤±æ€§å­˜å‚¨ ROM æˆ–è€… flash å­˜å‚¨ä¸­äº†ï¼Œè¿™é‡Œçš„ä»£ç åœ¨å³ä½¿æ–­ç”µåä¹Ÿä¼šä¿å­˜ä¸‹æ¥ï¼ŒåŠ ç”µå CPU å¼€å§‹æ‰§è¡Œè¿™é‡Œä»£ç ï¼ŒæŠŠ boot loader åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç°åœ¨ä½ åº”è¯¥æ˜ç™½ç¬¬ä¸€ä¸ª boot loader æ˜¯æ€æ ·è¢«åŠ è½½åˆ°å†…å­˜çš„äº†å§ã€‚
![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429100774-74b706fc-5218-4dda-b30c-eeb9ab95e7a7.png)
åœ¨æ—©æœŸçš„è®¡ç®—æœºä¸Šç”šè‡³ä¸“é—¨æœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œè®©ç”¨æˆ·è‡ªå·±é€‰æ‹©è¯¥ä»å“ªé‡Œï¼Œæ¯”å¦‚æ‰“å­”çº¸å¸¦ã€æ‰“å­”å¡ç‰‡æˆ–è€…ç¡¬ç›˜ï¼ŒåŠ è½½ä¸€ä¸ªæ›´å¤æ‚çš„ç¨‹åºæ¥è¿è¡Œï¼Œæ“ä½œé¢æ¿ä¸Šçš„æ—‹é’®å¯ä»¥æ§åˆ¶æŠŠè¿™äº›ç¨‹åºåŠ è½½åˆ°å†…å­˜çš„ä»€ä¹ˆä½ç½®ä¸Šå»ï¼š
![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429100742-3d35999a-6920-47f7-afd0-07403a3ba21c.jpeg)

## ç«ç®­ä¸æ“ä½œç³»ç»Ÿå¯åŠ¨

ç„¶è€Œç°å®æƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬åˆšæ‰æåˆ°çš„ boot loader è¿™æ®µå°ç¨‹åºåŠŸèƒ½å®åœ¨æ˜¯å¤ªå¼±äº†ï¼Œæ­¤æ—¶å…¶èƒ½è®¿é—®çš„ç£ç›˜åœ°å€ç©ºé—´æœ‰é™ï¼Œä¸èƒ½æŠŠå®Œæ•´çš„å†…æ ¸å…¨éƒ¨åŠ è½½åˆ°æ“ä½œç³»ç»Ÿä¸­ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

æ—¢ç„¶ boot loader æ¯”è¾ƒå¼±é‚£ä¹ˆå°±æ¢ä¸€ä¸ªæ¯”è¾ƒç‰›çš„ loader ç¨‹åºæ¥ï¼Œå°±è¿™æ ·å‡ºç°äº†äºŒé˜¶ boot loaderï¼Œsecond stage loaderï¼š
![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429101226-b5e1f5bb-da1d-43a2-932d-10265a2f2bb1.png)
äºŒé˜¶ boot loader åŠŸèƒ½æ›´ä¸ºä¸°å¯Œï¼Œæ¯”å¦‚å¯¹ç¡¬ä»¶è¿›è¡Œæ£€æŸ¥ã€ç»™ç”¨æˆ·æä¾›é€‰é¡¹åŠ è½½å“ªä¸ªæ“ä½œç³»ç»Ÿç­‰ç­‰ï¼Œå®‰è£…å¤šç³»ç»Ÿçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œå¯åŠ¨æ—¶ä¼šç»™ä½ ä¸€ä¸ªé€‰é¡¹åˆ°åº•æ˜¯å¯åŠ¨ windows è¿˜æ˜¯ linuxï¼Œè¿™å°±æ˜¯äºŒé˜¶ boot loader çš„ä½œç”¨ã€‚
![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429101278-dd790173-0a36-429f-9be3-be5699d90f5a.png)
æœ€ç»ˆï¼Œæ“ä½œç³»ç»Ÿè¢«äºŒé˜¶ boot loader åŠ è½½åˆ°å†…å­˜ä¸­å¼€å§‹è¿è¡Œã€‚

ä½ ä¼šå‘ç°è¿™ä¸ªè¿‡ç¨‹å°±å’Œå‘å°„ä¸‰çº§ç«ç®­ä¸€æ ·ï¼Œæœ€åˆä¸€çº§ç«ç®­å¯åŠ¨ï¼Œç‡ƒæ–™ç”¨å°½åäºŒçº§ç«ç®­å¯åŠ¨ï¼ŒäºŒçº§ç«ç®­å®Œæˆä½¿å‘½åä¸‰çº§ç«ç®­å¯åŠ¨ï¼Œæœ€ç»ˆæŠŠå«æ˜Ÿé€åˆ°å¤ªç©ºï¼Œè€Œè®¡ç®—æœºçš„å¯åŠ¨è¿‡ç¨‹ä¹Ÿç±»ä¼¼ã€‚

æœ€åˆæ˜¯ CPU è¿è¡Œ BIOS ä¸­çš„ä¸€æ®µä»£ç æŠŠä¸€çº§ boot loader åŠ è½½åˆ°å†…å­˜ä¸­è¿è¡Œï¼Œè¯¥ç¨‹åºåˆä¼šæŠŠäºŒçº§ boot loader åŠ è½½åˆ°å†…å­˜è¿è¡Œï¼Œè€ŒäºŒçº§ boot loader åˆä¼šæŠŠæ“ä½œç³»ç»ŸåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ­¤åæ§åˆ¶æƒè¢«è½¬ç§»åˆ°æ“ä½œç³»ç»Ÿï¼Œ(æ‰€è°“æ§åˆ¶æƒæ˜¯æŒ‡ CPU è·³è½¬åˆ°æ“ä½œç³»ç»Ÿçš„ä»£ç )ï¼Œæ“ä½œç³»ç»Ÿå¼€å§‹è¿è¡Œï¼Œç»è¿‡ä¸€ç³»åˆ—çš„åˆå§‹åŒ–ï¼Œæ¯”å¦‚ç¡¬ä»¶æ£€æµ‹ã€å¼€å¯å¿…è¦çš„åå°è¿›ç¨‹ç­‰ç­‰ï¼Œæœ€ç»ˆå›¾å½¢ç•Œé¢æˆ–è€…å‘½ä»¤è¡Œç•Œé¢å‘ˆç°å‡ºæ¥ã€‚
![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429101302-750c6a86-5693-4248-858e-d0e1a3884a8e.png)
æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹ç»†åŒ–ä¸€ä¸‹ã€‚

## æ›´è¯¦ç»†çš„å¯åŠ¨è¿‡ç¨‹

ä½ åœ¨æŒ‰ä¸‹ç”µæºçš„ç¬é—´ç›¸å½“äºç«ç®­ç‚¹ç«ï¼Œæ­¤æ—¶ä¸€çº§å‘åŠ¨æœºå¼€å§‹å·¥ä½œã€‚

åŠ ç”µ CPU é‡ç½®åå¼€å§‹åœ¨åœ°å€ 0xffff0 å¤„å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤ï¼Œè¿™ä¸ªåœ°å€å…¶å®æ˜¯ BIOS ROM çš„æœ«å°¾å¤„ï¼Œè¯¥ä½ç½®å…¶å®æ˜¯ä¸€ä¸ªè·³è½¬æŒ‡ä»¤ï¼Œè·³è½¬åˆ° ROM çš„ä¸€æ®µå¯åŠ¨ä»£ç ä¸Šï¼Œè¯¥ä»£ç ä¼šè¿›è¡Œå¿…è¦çš„è‡ªæ£€ï¼ŒPower-on self-test (POST)ï¼Œå±•ç¤º BIOS å¯åŠ¨ç•Œé¢ç­‰ç­‰ï¼Œæœ€é‡è¦çš„ä¸€æ­¥æ˜¯æ‰¾åˆ°å¯åŠ¨è®¾å¤‡ï¼Œæ‰€è°“å¯åŠ¨è®¾å¤‡å°±æ˜¯æŒ‡ä»å“ªé‡ŒåŠ è½½æ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚ CD-ROMã€æˆ–è€…ç£ç›˜ã€ç”šè‡³ U ç›˜ç­‰éƒ½å¯ä»¥ä½œä¸ºå¯åŠ¨è®¾å¤‡ï¼Œæ—©äº›å¹´æµè¡Œç”¨ U ç›˜é‡æ–°å®‰è£…ç³»ç»Ÿï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰ BIOS çš„è¿™æ®µä»£ç ä» U ç›˜ä¸­åŠ è½½æ“ä½œç³»ç»Ÿã€‚

é€šå¸¸ BIOS ä¼šæŠŠç£ç›˜å½“åšå¯åŠ¨è®¾å¤‡(å¤§éƒ¨åˆ†æƒ…å†µä¸‹)ï¼Œæ­¤æ—¶ BIOS ä¸­çš„è¿™æ®µä»£ç å¼€å§‹å°†ç£ç›˜çš„ç¬¬ 0 å·å—åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œé‚£ä¹ˆè¿™ç¬¬ 0 å·å—ä¸­æœ‰ä»€ä¹ˆå‘¢ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯ç¬¬ä¸€é˜¶æ®µ boot loader ç¨‹åºï¼Œè¿™ç¬¬ 0 å·å—ä¹Ÿè¢«ç§°ä¹‹ä¸º Master Boot Recordï¼ŒMBRï¼Œè‚¯å®šæœ‰ä¸å°‘åŒå­¦å¬è¯´è¿‡ã€‚

![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429101348-dbe515f5-8c00-4f46-91c8-b8944d6a12d9.png)

åˆ°è¿™é‡Œï¼Œç«ç®­çš„ä¸€çº§å‘åŠ¨æœºç‡ƒæ–™ç”¨å°½ï¼ŒäºŒçº§å‘åŠ¨æœºå¼€å§‹ç‚¹ç«ï¼ŒBIOS ä¸­çš„è¿™æ®µä»£ç æŠŠæ§åˆ¶æƒäº¤ç»™åŠ è½½åˆ°å†…å­˜ boot loaderï¼Œæ‰€è°“æ§åˆ¶æƒå°±æ˜¯è·³è½¬åˆ° boot loader ç¨‹åºï¼Œè¿™æ · CPU ç»ˆäºå¼€å§‹ç›´æ¥ä¸å†…å­˜äº¤äº’äº†ï¼ŒCPU å¼€å§‹ä»å†…å­˜ä¸­å–å‡ºæŒ‡ä»¤ç„¶åæ‰§è¡Œã€‚

MBR ä¸­é™¤äº†åŒ…å«ä¸€æ®µå¯æ‰§è¡Œä»£ç ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªåˆ†åŒºè¡¨ï¼Œpartition tableï¼Œè¿™ä¸ªè¡¨çš„ä¸­çš„æ¯ä¸€ä¸ªæ¡ç›®æœ¬è´¨ä¸Šåœ¨è¯´ï¼šâ€œæ“ä½œç³»ç»Ÿæ˜¯å¦åœ¨æˆ‘è¿™ä¸ªåˆ†åŒºï¼Œæˆ‘è¿™ä¸ªåˆ†åŒºæœ‰å¤šå¤§â€ï¼ŒCPU åœ¨æ‰§è¡Œ MBR ä¸­çš„ä»£ç æ—¶ä¼šå»æ£€æŸ¥æ“ä½œç³»ç»Ÿå­˜åœ¨å“ªä¸ªåˆ†åŒºä¸­ï¼Œå®šä½åå¼€å§‹ä»ç›¸åº”åˆ†åŒºçš„èµ·å§‹ä½ç½®è¯»å–ç£ç›˜æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œè¿™æ—¶çš„ç£ç›˜æ•°æ®ä¸­ä¿å­˜çš„å°±æ˜¯äºŒé˜¶ boot loaderï¼Œsecond-stage boot loaderï¼Œæ­¤æ—¶ä¸€é˜¶ boot loader æŠŠæ§åˆ¶æƒè½¬äº¤ç»™äºŒé˜¶ boot loaderï¼Œç«ç®­ä¸‰çº§å‘åŠ¨æœºå¼€å§‹å·¥ä½œã€‚

2_boot loader çš„ä¸»è¦å·¥ä½œå°†æ“ä½œç³»ç»ŸåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ­¤åæ§åˆ¶æƒè½¬äº¤ç»™æ“ä½œç³»ç»Ÿï¼Œç«ç®­çš„ä¸‰çº§å‘åŠ¨æœºå®Œæˆä½¿å‘½ï¼Œ**åˆ°è¿™ä¸€æ—¶åˆ»ï¼Œæ“ä½œç³»ç»Ÿå¼€å§‹æ¥ç®¡è®¡ç®—æœº**ï¼Œæ“ä½œç³»ç»Ÿç»è¿‡ä¸€ç³»åˆ—è‡ªèº«çš„åˆå§‹åŒ–ååˆ›å»ºå‡ºè‹¥å¹²å¿…è¦è¿›ç¨‹ï¼Œè‡³æ­¤è®¡ç®—æœºå¯åŠ¨å®Œæ¯•ï¼Œå«æ˜Ÿè¢«æˆåŠŸé€åˆ°äº†å¤–å¤ªç©ºä¸­ã€‚

![](https://notes-learning.oss-cn-beijing.aliyuncs.com/id9gn1/1648429101351-eb22ccb7-7957-4f8c-b88e-854522e1a60c.png)

ç„¶è€Œé™äºç¯‡å¹…è¿™é‡Œä¾ç„¶æ²¡æœ‰è¿‡å¤šæ¶‰åŠç»†èŠ‚ï¼Œæ“ä½œç³»ç»Ÿæœ¬èº«çš„åˆå§‹åŒ–ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„è¿‡ç¨‹ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»ç¿»é˜…ç›¸å…³æ“ä½œç³»ç»Ÿçš„èµ„æ–™ã€‚

# ç³»ç»Ÿå¯åŠ¨æµç¨‹

- **Power-on self-test(POST)** # åŠ ç”µè‡ªæ£€é€šè¿‡ ROM èŠ¯ç‰‡æ¥æ£€æµ‹
- **ROM èŠ¯ç‰‡** # CMOS ç„¶åå¯åŠ¨ BIOS ç¨‹åº
- **Basic Input and Output System(BIOS)** # åŸºæœ¬è¾“å‡ºè¾“å‡ºç³»ç»Ÿ
- **Boot Sequence** # æŒ‰æ¬¡åºæŸ¥æ‰¾å„å¼•å¯¼è®¾å¤‡ï¼Œç¬¬ä¸€ä¸ªæœ‰å¼•å¯¼ç¨‹åºçš„è®¾å¤‡å‡†å¤‡æœ¬æ¬¡å¯åŠ¨ç”¨åˆ°çš„è®¾å¤‡ï¼Œä¸ç®¡è¯¥å¼•å¯¼ç¨‹åºæ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œåªè¦æœ‰å¼•å¯¼ç¨‹åºï¼Œå°±ä¸å†æ‰¾ä¸‹ä¸€ä¸ªè®¾å¤‡äº†ã€‚
  - è¯»å–ç¡¬ç›˜çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œè¿™ä¸ªæ‰‡åŒºè¢«ç§°ä¸º MBRï¼è¿™ä¸ªæ‰‡åŒºä¸­å­˜å‚¨äº†ä¸€ä¸ªå°ç¨‹åºï¼Œå«åš boot loaderï¼MBR å¾ˆå°ï¼Œåªæœ‰ 446B. æœ€å¸¸è§çš„ä¸€ç§ boot loader å« grub.
  - MBRï¼Œå‰ 446 å­—èŠ‚ä¸º bootloaderï¼Œåé¢ 64 å­—èŠ‚ä¸º fat(ç£ç›˜åˆ†åŒºè¡¨)ï¼Œåé¢ 2 å­—èŠ‚ä¸º 55AA æ ‡è®°
- **Bootloader** # å¼•å¯¼åŠ è½½å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªç¨‹åºã€‚åŠŸèƒ½ï¼šæä¾›ä¸€ä¸ªèœå•ï¼Œä¾›ç”¨æˆ·é€‰æ‹©è¦å¯åŠ¨çš„ç³»ç»Ÿæˆ–ä¸åŒçš„å†…æ ¸ç‰ˆæœ¬ï¼ŒæŠŠç”¨æˆ·é€‰å®šçš„å†…æ ¸è£…è½½åˆ°å†…å­˜ä¸­çš„ç‰¹å®šç©ºé—´ä¸­ï¼Œè§£å‹ï¼Œå±•å¼€ï¼Œå¹¶æŠŠç³»ç»Ÿæ§åˆ¶æƒç§»äº¤ç»™å†…æ ¸
  - boot loader ç¨‹åºä¸»è¦åšä¸¤ä»¶äº‹ï¼Œä¸€ä¸ªæ˜¯å°†å†…æ ¸åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¦ä¸€ä¸ªæ˜¯å¯åŠ¨ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼å†…æ ¸æ–‡ä»¶æ˜¯ /boot/vmlinuz*,è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶æ˜¯ /boot/initrd*ï¼
  - GRUB(GRand Uniform BootLoader)ç”¨æ¥æ‰¾åˆ°æ“ä½œç³»ç»Ÿæ‰€åœ¨çš„ç£ç›˜åˆ†åŒºï¼ŒæŠŠå†…æ ¸åŠ è½½è‡³å†…å­˜ä¸­ï¼Œè¿˜èƒ½æŠŠæ§åˆ¶æƒæ­£å¸¸è½¬äº¤ç»™å†…æ ¸çš„ç¨‹åº
    - GRUB 0.x ç‰ˆï¼šGRUB Legacy
    - GRUB 1.X ç‰ˆï¼šGRUB2
- Kernel
  - åˆå§‹åŒ–ï¼š
    - æ¢æµ‹ç¡¬ä»¶
    - è£…è½½ç¡¬ä»¶çš„é©±åŠ¨ç¨‹åº(æœ‰å¯èƒ½ä¼šå€ŸåŠ©äº ramdisk åŠ è½½é©±åŠ¨ç¨‹åº)
    - æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿåˆ° / ç›®å½•ä¸‹
- è¿è¡Œç”¨æˆ·ç©ºé—´çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº
  - init(åˆå§‹åŒ–)ç¨‹åºçš„ç±»å‹
    - SysVï¼šç¬¬ä¸€ä¸ªè¿›ç¨‹å init æ—©æœŸçš„ç³»ç»Ÿç”¨çš„è¿™ä¸ªç¨‹åºï¼Œé€šè¿‡è„šæœ¬å¯åŠ¨ç¨‹åºï¼Œä¸€ä¸ªå¯åŠ¨å®Œäº†æ‰èƒ½å¯åŠ¨ä¸‹ä¸€ä¸ª
    - é…ç½®æ–‡ä»¶/etc/inittab
  - Upstartï¼šç¬¬ä¸€ä¸ªè¿›ç¨‹å init
    - é…ç½®æ–‡ä»¶/etc/inittabã€/etc/init/\*.conf
  - Systemdï¼šç¬¬ä¸€ä¸ªè¿›ç¨‹å systemd æ‰€æœ‰ç¨‹åºå¯ä»¥å¹¶è¡ŒåŒæ—¶å¯åŠ¨
    - é…ç½®æ–‡ä»¶ï¼š/lib/systemd/systemï¼Œ/etc/systemd/system
  - ramdisk

POST --> BootSequence(BIOS) --> Bootloader(MBR) --> kernel(ramdisk) --> rootfs --> init(systemd)

## ä¸Šç”µã€å¼•å¯¼

æŒ‰ä¸‹å¼€å…³é”®ï¼Œè§¦å‘ä¸»æ¿å¼•è„šï¼Œå¼€å¯ç”µæºï¼Œä¸ºä¸»æ¿é€šç”µ

## è£…è½½å†…æ ¸

vmlinuz åˆ†æ
a. mkdir /tmp/vmlinuz&\&cp /boot/vmlinuz-4.4.0-21-genericÂ  /tmp/vmlinuz/
b. cd /tmp/vmlinuz/
c. od -t x1 -A d vmlinuz-4.4.0-21-generic | grep "1f 8b 08"
æœ¬è´¨ä¸Šï¼Œvmlinuz-4.4.0-21-genericÂ  æ˜¯ä¸€ä¸ª gzip å‹ç¼©æ–‡ä»¶ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ç”¨ gzip æŒ‡ä»¤è§£å‹ï¼Œå› ä¸ºåœ¨è¿™ä¸ªæ–‡ä»¶çš„å¼€å¤´åµŒå…¥äº† gzip çš„ä»£ç ï¼
æ‰€ä»¥é¦–å…ˆç”¨æŒ‡ä»¤ c æ‰¾åˆ°çœŸæ­£çš„å‹ç¼©æ–‡ä»¶çš„å¤´éƒ¨ï¼è¿™ä¸ªæŒ‡ä»¤çš„è¾“å‡ºå½¢å¦‚:
0018864 ac fe ff ff 1f 8b 08 00 00 00 00 00 02 03 ec fd
ç„¶åæ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼Œå…¶ä¸­çš„ 18868 å°±æ˜¯ 18864+4ï¼Œè¿™é‡Œ 4 æ˜¯æŒ‡ 1f 8b 08 å‰é¢æœ‰ 4 ä¸ªå­—èŠ‚ï¼
dd if=vmlinuz-4.4.0-21-generic bs=1 skip=18868 | zcat > vmlinuz-gakki
objdump -D vmlinuz-gakki >> result
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆå¾—åˆ°çš„ result å°±æ˜¯ä¸€ä¸ªæ±‡ç¼–æ–‡ä»¶ï¼è€Œ vmlinuz-gakki æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼å¯ä»¥å°è¯•
æ‰§è¡Œä»–ï¼Œchmod +x vmlinuz-gakki &&./vmlinuz-gakki ï¼
æ˜¾ç¤º Segmentation fault

intrid åˆ†æ
é¦–å…ˆå°†/boot/intird.img æ–‡ä»¶å¤åˆ¶åˆ°/tmp æ–‡ä»¶å¤¹ä¸‹
æ‰§è¡Œ file /tmp/initrd.img-4.4.0-21-genericï¼Œå¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š
/tmp/initrd.img-4.4.0-21-generic: gzip compressed data, last modified: Fri Jun 15 13:57:43 2018, from Unix
å¯ä»¥çœ‹åˆ°æœ¬è´¨ä¸Šè¿™æ˜¯ä¸€ä¸ª gzip æ ¼å¼çš„å‹ç¼©æ–‡ä»¶
cd /tmp
mv initrd.img-4.4.0-21-generic initrd.img-4.4.0-21-generic.gz
gzip -d initrd.img-4.4.0-21-generic.gz
file initrd.img-4.4.0-21-generic
å¾—åˆ°çš„ç»“æœä¸ºï¼š
initrd.img-4.4.0-21-generic: ASCII cpio archive (SVR4 with no CRC)
è¿™æ˜¯ä¸€ä¸ª cpio æ–‡ä»¶
æ‰§è¡Œ cpio -idmv < initrd.img-4.4.0-21-generic
è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæœ€ç»ˆç”Ÿæˆäº†ä¸€ä¸ªå°å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼

## Systemd è¿è¡Œ

è¯¦è§ ã€Š[Systemd è¿è¡Œæµç¨‹](âœIT å­¦ä¹ ç¬”è®°/ğŸ“„1.æ“ä½œç³»ç»Ÿ/3.Systemd%20 ç³»ç»Ÿå®ˆæŠ¤ç¨‹åº/Systemd%20 è¿è¡Œæµç¨‹.md ç³»ç»Ÿå®ˆæŠ¤ç¨‹åº/Systemd è¿è¡Œæµç¨‹.md)ã€‹ç« èŠ‚
