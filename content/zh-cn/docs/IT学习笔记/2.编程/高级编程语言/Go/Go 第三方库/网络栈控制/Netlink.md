---
title: Netlink
---

# æ¦‚è¿°

> å‚è€ƒï¼š
> - [GitHub é¡¹ç›®ï¼Œvishvananda/netlink](https://github.com/vishvananda/netlink)

netlink åŒ…ä¸º go æä¾›äº†ä¸€ä¸ªç®€å•çš„ netlink åº“ã€‚[Netlink](âœIT å­¦ä¹ ç¬”è®°/ğŸ“„1.æ“ä½œç³»ç»Ÿ/2.Kernel(å†…æ ¸)/8.Network%20 ç®¡ç†/Linux%20 ç½‘ç»œæ ˆç®¡ç†/Netlink.md ç®¡ç†/Linux ç½‘ç»œæ ˆç®¡ç†/Netlink.md) æ˜¯ Linux ä¸­çš„ç”¨æˆ·ç©ºé—´ç¨‹åºç”¨æ¥ä¸å†…æ ¸è¿›è¡Œé€šä¿¡çš„ç•Œé¢ã€‚å®ƒå¯ä»¥ç”¨äºæ·»åŠ å’Œåˆ é™¤æ¥å£ï¼Œè®¾ç½® ip åœ°å€å’Œè·¯ç”±ä»¥åŠé…ç½® ipsecã€‚Netlink é€šä¿¡éœ€è¦æå‡çš„æƒé™ï¼Œå› æ­¤åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ­¤ä»£ç éœ€è¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œã€‚ç”±äºä½çº§ netlink æ¶ˆæ¯å……å…¶é‡æ˜¯éš¾ä»¥ç†è§£çš„ï¼Œå› æ­¤è¯¥åº“è¯•å›¾æä¾›ä¸€ä¸ªä»¥ iproute2 æä¾›çš„ CLI ä¸ºæ¾æ•£å»ºæ¨¡çš„ apiã€‚ip é“¾æ¥æ·»åŠ ä¹‹ç±»çš„æ“ä½œå°†é€šè¿‡ç±»ä¼¼åç§°çš„å‡½æ•° (ä¾‹å¦‚ AddLink()) æ¥å®Œæˆã€‚è¯¥åº“çš„ç”Ÿå‘½å¼€å§‹äº docker/libcontainer ä¸­çš„ netlink åŠŸèƒ½åˆ†æ”¯ï¼Œä½†ç»è¿‡å¤§é‡é‡å†™ä»¥æé«˜å¯æµ‹è¯•æ€§ï¼Œæ€§èƒ½å¹¶æ·»åŠ  ipsec xfrm å¤„ç†ç­‰æ–°åŠŸèƒ½ã€‚

# Hello World

```go
package main

import (
	"fmt"

	"github.com/vishvananda/netlink"
)

func main() {
	// å®ä¾‹åŒ–ä¸€ä¸ª LinkAttrs,LinkAttrs åŒ…å«ä¸€ä¸ªç½‘ç»œè®¾å¤‡çš„ç»å¤§éƒ¨åˆ†å±æ€§
	linkAttrs := netlink.NewLinkAttrs()
	// è®¾å®š link çš„åç§°
	linkAttrs.Name = "br0"
	// å°†å®ä¾‹åŒ–çš„ LinkAttrs ä¿¡æ¯èµ‹å€¼ç»™ Bridge ç»“æ„ä½“
	mybridge := &netlink.Bridge{LinkAttrs: linkAttrs}
	// è¿™é‡Œå°±ç®—çœŸæ­£å®Œæˆäº†ä¸€ä¸ªç½‘ç»œè®¾å¤‡çš„å®šä¹‰ï¼Œnetlink åº“ä¸­åŒ…å«å¤šç§ç½‘ç»œè®¾å¤‡ç»“æ„ä½“
	// æ¯ç§ç½‘ç»œè®¾å¤‡ç»“æ„ä½“éƒ½å®ç°äº† Link æ¥å£
	// Link æ¥å£åªæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼ŒAttrs() ç”¨æ¥è¿”å› LinkAttrs ç»“æ„ä½“ï¼ŒType() ç”¨æ¥è¿”å›è¯¥ç½‘ç»œè®¾å¤‡çš„ç±»å‹ã€‚
	// è€Œå¯¹å„ç§ç±»å‹çš„ç½‘ç»œè®¾å¤‡å®ç°å¢åˆ æ”¹æŸ¥çš„å‡½æ•°ï¼Œå…¶æ¥å—çš„å‚æ•°å°±æ˜¯ Link æ¥å£ç±»å‹
	// æ‰€ä»¥ Link æ¥å£çš„ä¸»è¦ä½œç”¨ï¼Œå°±æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒç±»å‹çš„ç½‘ç»œè®¾å¤‡ï¼Œä»¥ä¾¿å¯ä»¥åœ¨è°ƒç”¨æ—¶ç»Ÿä¸€ã€‚å¯¹ç½‘ç»œè®¾å¤‡çš„ä»»ä½•æ“ä½œï¼Œéƒ½å¯ä»¥å°† Link æ¥å£ä½œä¸ºå‚æ•°äº’ç›¸ä¼ é€’ã€‚

	// ä½¿ç”¨ Bridge ç»“æ„ä½“çš„ä¿¡æ¯åˆ›å»ºä¸€ä¸ªç½‘ç»œè®¾å¤‡
	err := netlink.LinkAdd(mybridge)
	if err != nil {
		fmt.Printf("could not add %s: %v\n", linkAttrs.Name, err)
	}
	// eth1, _ := netlink.LinkByName("eth1")
	// netlink.LinkSetMaster(eth1, mybridge)
}
```
