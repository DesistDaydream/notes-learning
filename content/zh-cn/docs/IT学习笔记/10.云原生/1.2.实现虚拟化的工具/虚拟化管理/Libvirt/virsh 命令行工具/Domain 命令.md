---
title: Domain 命令
---

# 概述

[autostart](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#autostart)
[blkdeviotune](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blkdeviotune)
[blkiotune](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blkiotune)
[blockcommit](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blockcommit)
[blockcopy](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blockcopy)
[blockjob](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blockjob)
[blockpull](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blockpull)
[blockresize](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#blockresize)
[console](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#console)
[cpu-stats](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#cpu-stats)
[create](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#create)
[define](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#define)
[desc](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#desc)
[destroy](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#destroy)
[domblkerror](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domblkerror)
[domblkinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domblkinfo)
[domblklist](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domblklist)
[domblkstat](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domblkstat)
[domblkthreshold](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domblkthreshold)
[domcontrol](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domcontrol)
[domdirtyrate-calc](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domdirtyrate-calc)
[domdisplay](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domdisplay)
[domfsfreeze](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domfsfreeze)
[domfsinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domfsinfo)
[domfsthaw](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domfsthaw)
[domfstrim](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domfstrim)
[domhostname](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domhostname)
[domid](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domid)
[domif-getlink](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domif-getlink)
[domif-setlink](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domif-setlink)
[domifaddr](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domifaddr)
[backup-begin](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#backup-begin)
[backup-dumpxml](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#backup-dumpxml)
[domiflist](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domiflist)
[domifstat](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domifstat)
[domiftune](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domiftune)
[dominfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#dominfo)
[domjobabort](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domjobabort)
[domjobinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domjobinfo)
[domlaunchsecinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domlaunchsecinfo)
[domsetlaunchsecstate](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domsetlaunchsecstate)
[dommemstat](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#dommemstat)
[domname](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domname)
[dompmsuspend](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#dompmsuspend)
[dompmwakeup](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#dompmwakeup)
[domrename](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domrename)
[domstate](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domstate)
[domstats](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domstats)
[domtime](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domtime)
[domuuid](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domuuid)
[domxml-from-native](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domxml-from-native)
[domxml-to-native](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#domxml-to-native)
[dump](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#dump)
[dumpxml](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#dumpxml)
[edit](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#edit)
[emulatorpin](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#emulatorpin)
[event](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#event)
[get-user-sshkeys](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#get-user-sshkeys)
[guest-agent-timeout](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#guest-agent-timeout)
[guestinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#guestinfo)
[guestvcpus](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#guestvcpus)
[iothreadadd](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#iothreadadd)
[iothreaddel](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#iothreaddel)
[iothreadinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#iothreadinfo)
[iothreadpin](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#iothreadpin)
[iothreadset](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#iothreadset)
[managedsave](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#managedsave)
[managedsave-define](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#managedsave-define)
[managedsave-dumpxml](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#managedsave-dumpxml)
[managedsave-edit](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#managedsave-edit)
[managedsave-remove](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#managedsave-remove)
[maxvcpus](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#maxvcpus)
[memtune](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#memtune)
[metadata](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#metadata)
[migrate](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate)
[migrate-compcache](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate-compcache)
[migrate-getmaxdowntime](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate-getmaxdowntime)
[migrate-getspeed](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate-getspeed)
[migrate-postcopy](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate-postcopy)
[migrate-setmaxdowntime](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate-setmaxdowntime)
[migrate-setspeed](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#migrate-setspeed)
[numatune](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#numatune)
[perf](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#perf)
[reboot](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#reboot)
[reset](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#reset)
[restore](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#restore)
[resume](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#resume)
[save](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#save)
[save-image-define](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#save-image-define)
[save-image-dumpxml](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#save-image-dumpxml)
[save-image-edit](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#save-image-edit)
[schedinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#schedinfo)
[screenshot](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#screenshot)
[send-key](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#send-key)
[send-process-signal](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#send-process-signal)
[set-lifecycle-action](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#set-lifecycle-action)
[set-user-password](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#set-user-password)
[set-user-sshkeys](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#set-user-sshkeys)
[setmaxmem](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#setmaxmem)
[setmem](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#setmem)
[setvcpus](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#setvcpus)
[setvcpu](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#setvcpu)
[shutdown](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#shutdown)
[start](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#start)
[suspend](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#suspend)
[ttyconsole](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#ttyconsole)
[undefine](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#undefine)
[vcpucount](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#vcpucount)
[vcpuinfo](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#vcpuinfo)
[vcpupin](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#vcpupin)
[vncdisplay](https://github.com/libvirt/libvirt/blob/master/docs/manpages/virsh.rst#vncdisplay)

blkdeviotune Set or query a block device I/O tuning parameters.

blkiotune Get or set blkio parameters

blockcommit Start a block commit operation.

blockcopy Start a block copy operation.

blockjob Manage active block operations

blockpull Populate a disk from its backing image.

blockresize Resize block device of domain.

# console # 连接到 VM 的终端

console 用于把虚拟机屏幕上的信息投射到宿主机上，可以直接在宿主机的终端上操作虚拟机。
注意：如果无法通过 console 连接到 VM，则需要在 VM 上启动 serial-getty@.service 服务并在开启服务的时候指定一个终端。e.g.**systemctl enable serial-getty@ttyS0.service --now**

# cpu-stats # 显示 Domain 的 CPU 统计信息

默认显示所有 CPU 的统计信息和总数。仅使用 --total 获取总统计信息，仅使用 start 获取从 --start 开始的 CPU 的 per-cpu 统计信息，仅使用 --count CPU 的统计信息。

# create # 从一个 XML 文件里创建一个 domain

通过 XML 直接启动一台 VM，VM 关闭后，virsh list 列表中该 VM 会消失。

# define # 从一个 XML 文件里定义一个 domain(仅定义不启动)

通过 XML 文件创建一台 VM。

## Syntax(语法)

**define <file> \[--validate]**
EXAMPLE

- virsh define cirros.xml # 通过 cirros.xml 来定义一个 VM 的属性，如果 VM 不存在则创建

# desc # 显示或者设置一个 domain 的 description 或 title

desc <domain> \[--live] \[--config] \[--current] \[--title] \[--edit] \[\[--new-desc] <STRING>]...

Note：

- 当不指定--title 时，desc 命令默认修改或查看 domain 的 description
- description 和 title 有三种状态，live、config、current，当修改或者显示的时候，默认为 live 状态
- config 的状态指的是，修改或查看 domain 的 xml 文件。

OPTIONS

- \[--domain] <string> domain name, id or uuid
- --live # 指定当前操作为，运行时状态
- --config # 指定当前操作为，持久配置状态
- --current # 指定当前操作为，当前状态
- --title \[STRING] # 修改或显示 title。指定 STRING 时则会将 domain 的 title 修改为 STRING，不指定则显示 domain 的 title
- --edit #打开一个编辑器来修改 description 或 title
- \[--new-desc] <STRING> message

EXAMPLE

- virsh desc lchTest # 显示 lchTest 这台虚拟机的当前状态的描述信息
- virsh desc lchTest 10.10.100.200 --config # 为 lchTest 这台 VM 设定描述信息为 10.10.100.200，并将信息写入到 xml 文件中
- virsh desc lchTest --title 10.10.100.200 --config # 指定 lchTest 这台虚拟机的 title 为 10.10.100.200，并将该信息写入到 xml 配置中

# destroy # 摧毁一个 domain，类似于直接拔掉电源

domblkerror Show errors on block devices

domblkinfo domain block device size information

# domblklist # 列出 domain 的所有 blocks(块设备)

列出 Domain 的所有 blocks(块设备)。i.e.指定 domain 所使用的磁盘文件

## Syntax(语法)

**domblklist <DOMAIN> \[OPTIONS]**
OPTIONS

- --inactive #
- --details # 列出的信息还包括类型和设备

domblkstat get device block stats for a domain

domcontrol domain control interface state

domif-getlink get link state of a virtual interface

# domifaddr # 从正在运行的 domain 中获取网络接口的 IP 地址

domifaddr <domain> \[--interface <string>] \[--full] \[--source <string>]

该信息包括：Name MAC address Protocol Address

# domiflist # 列出 domain 所有的虚拟接口

domiflist <domain> \[--inactive]

该信息包括：Interface Type Source Model MAC

EXAMPLE

- virsh domiflist testvm # 列出名为 testvm 这台虚拟机的虚拟接口信息

# domifstat # 获取指定的 domain 的网络接口状态信息

domifstat <domain> <interface>

EXAMPLE

# dominfo # 返回指定 domain 的基本信息，包括该 domain 的 name、uuid、mem、cpu 等

# [dommemstat](https://libvirt.org/manpages/virsh.html#dommemstat) # 获取指定 domain 的内存状态信息

dommemstat 会获取正在运行的 domain 的内存统计信息。可以获取到如下信息：

- swap_in - The amount of data read from swap space (in KiB)
- swap_out - The amount of memory written out to swap space (in KiB)
- major_fault - The number of page faults where disk IO was required
- minor_fault - The number of other page faults
- unused - The amount of memory left unused by the system (in KiB)
- available - The amount of usable memory as seen by the domain (in KiB)
- actual # 当前 Current balloon value (in KiB)
- rss - Resident Set Size of the running domain's process (in KiB)
- usable - The amount of memory which can be reclaimed by balloon without causing host swapping (in KiB)
- last-update - Timestamp of the last update of statistics (in seconds)
- disk_caches - The amount of memory that can be reclaimed without additional I/O, typically disk caches (in KiB)
- hugetlb_pgalloc - The number of successful huge page allocations initiated from within the domain
- hugetlb_pgfail - The number of failed huge page allocations initiated from within the domain

上述这些字段的可用性取决于管理程序。输出中缺少不支持的字段。如果与更新版本的 libvirtd 通信，可能会出现其他字段。

## Syntax(语法)

**dommemstat domain \[--period seconds] \[\[--config] \[--live] | \[--current]]**

domstate domain state

domstats get statistics about one or multiple domains

domtime domain time

domdisplay domain display connection URI

domfsfreeze Freeze domain's mounted filesystems.

domfsthaw Thaw domain's mounted filesystems.

domfsinfo Get information of domain's mounted filesystems.

domfstrim Invoke fstrim on domain's mounted filesystems.

domhostname print the domain's hostname

domid convert a domain name or UUID to domain id 将域名或 UUID 转换为域 ID

# domif-setlink # 设定 domain 网卡的状态

可以控制 VM 网卡的开关，关闭 VM 的 link，则开机不会自动启动网卡

EXAMPLE

1. virsh domif-setlink lichenhao--interface 52:54:00:6a:86:89 --state down # 关闭 lichenhao 这台虚拟机的指定网卡

domiftune get/set parameters of a virtual interface

domjobabort abort active domain job

domjobinfo domain job information

domname convert a domain id or UUID to domain name 将域 id 或 UUID 转换为域名

# domrename # 重命名一个 domain

dompmsuspend suspend a domain gracefully using power management functions

dompmwakeup wakeup a domain from pmsuspended state

domuuid # UUID 将 domain 名称 或 id 转换为 domain 的 UUID

domxml-from-native Convert native config to domain XML

# domxml-to-native # 根据 domain 的 XML 描述文件，转换成 qemu-kvm 创建虚拟机的命令

**domxml-to-native <FORMAT> \[OPTIONS]**

FORMAT

1. qemu-argv # QEMU/KVM 类型虚拟化，必须使用此格式

OPTIONS

1. \--domain <STRING> domain name, id or uuid
2. \--xml <STRING> xml data file to export from

EXAMPLE

1. **virsh domxml-to-native qemu-argv --domain lichenhao.bj-net**# 根据 lichenhao.bj-net 虚拟机的 xml 文件，生成 qemu-kvm 命令行
2. lichenhao.bj-net.xml 该文件会转换成如下内容

    LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
    QEMU_AUDIO_DRV=none
    /usr/libexec/qemu-kvm -name lichenhao.bj-net \
    -machine pc-i440fx-rhel7.0.0,accel=kvm,usb=off,dump-guest-core=off \
    -cpu Skylake-Server-IBRS,-ds,-acpi,+ss,-ht,-tm,-pbe,-dtes64,-monitor,-ds_cpl,-vmx,-smx,-est,-tm2,-xtpr,-pdcm,-dca,-osxsave,-tsc_adjust,+clflushopt,-intel-pt,+pku,-ospke,+avx512vnni,+md-clear,+stibp,+ssbd,+hypervisor,-arat \
    -m 4096 \
    -realtime mlock=off
    \
    -smp 2,sockets=2,cores=1,threads=1 \
    -uuid 51b47472-5564-424e-90b5-19e9eecfd671 \
    -no-user-config -nodefaults \

    -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/domain--1-lichenhao.bj-net/monitor.sock,server,nowait \
    -mon chardev=charmonitor,id=monitor,mode=control \

    -rtc base=utc,driftfix=slew \
    -global kvm-pit.lost_tick_policy=delay \
    -no-hpet -no-shutdown \
    -global PIIX4_PM.disable_s3=1 \
    -global PIIX4_PM.disable_s4=1 \
    -boot strict=on \
    -device ich9-usb-ehci1,id=usb,bus=pci.0,addr=0x4.0x7 \
    -device ich9-usb-uhci1,masterbus=usb.0,firstport=0,bus=pci.0,multifunction=on,addr=0x4 \
    -device ich9-usb-uhci2,masterbus=usb.0,firstport=2,bus=pci.0,addr=0x4.0x1 \
    -device ich9-usb-uhci3,masterbus=usb.0,firstport=4,bus=pci.0,addr=0x4.0x2 \
    -device virtio-serial-pci,id=virtio-serial0,bus=pci.0,addr=0x5 \

    -drive file=/var/lib/libvirt/images/lichenhao.bj-net.qcow2,format=qcow2,if=none,id=drive-virtio-disk0 \
    -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x6,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 \

    -drive if=none,id=drive-ide0-0-0,readonly=on \
    -device ide-cd,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 \

    -netdev tap,fd=28,id=hostnet0 \
    -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:6d:fa:f0,bus=pci.0,addr=0x3 \

    -chardev pty,id=charserial0 \
    -device isa-serial,chardev=charserial0,id=serial0 \

    -chardev socket,id=charchannel0,path=/var/lib/libvirt/qemu/channel/target/domain--1-lichenhao.bj-net/org.qemu.guest_agent.0,server,nowait \
    -device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=org.qemu.guest_agent.0 \

    -chardev spicevmc,id=charchannel1,name=vdagent \
    -device virtserialport,bus=virtio-serial0.0,nr=2,chardev=charchannel1,id=channel1,name=com.redhat.spice.0 \

    -device usb-tablet,id=input0,bus=usb.0,port=1 \
    -vnc 127.0.0.1:0 \
    -vga qxl \
    -global qxl-vga.ram_size=67108864 \
    -global qxl-vga.vram_size=67108864 \
    -global qxl-vga.vgamem_mb=16 \
    -global qxl-vga.max_outputs=1 \

    -chardev spicevmc,id=charredir0,name=usbredir \
    -device usb-redir,chardev=charredir0,id=redir0,bus=usb.0,port=2 \

    -chardev spicevmc,id=charredir1,name=usbredir \
    -device usb-redir,chardev=charredir1,id=redir1,bus=usb.0,port=3 \

    -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x7 \

    -object rng-random,id=objrng0,filename=/dev/urandom \
    -device virtio-rng-pci,rng=objrng0,id=rng0,bus=pci.0,addr=0x8 \

    -msg timestamp=on

dump dump the core of a domain to a file for analysis

# dumpxml # 显示 domain 的 XML 格式的信息

EXAMLPE

- virsh dumpxml lchTest # 显示 lchTest 这个虚拟机的 xml 信息

# edit # 编辑一个 domain 的 XML 配置

event Domain Events

inject-nmi Inject NMI to the guest

iothreadinfo view domain IOThreads

iothreadpin control domain IOThread affinity

iothreadadd add an IOThread to the guest domain

iothreaddel delete an IOThread from the guest domain

send-key Send keycodes to the guest

send-process-signal Send signals to processes

lxc-enter-namespace LXC Guest Enter Namespace

managedsave managed save of a domain state

managedsave-remove Remove managed save of a domain

memtune Get or set memory parameters

metadata show or set domain's custom XML metadata

migrate migrate domain to another host

migrate-setmaxdowntime set maximum tolerable downtime

migrate-compcache get/set compression cache size

migrate-setspeed Set the maximum migration bandwidth

migrate-getspeed Get the maximum migration bandwidth

numatune Get or set numa parameters

qemu-attach QEMU Attach

qemu-monitor-command QEMU Monitor Command

qemu-monitor-event QEMU Monitor Events

# qemu-agent-command # 向 domain 中执行 QEMU Guest Agent 命令

可用的 QGA 命令详见：[QEMU Monitor Protocol 命令参考](https://www.yuque.com/go/doc/33175114)

## Syntax(语法)

**qemu-agent-command DOMAIN \[OPTIONS] CMD**

命令示例详见：应用示例

# reboot # 重新启动一个 domainre

reset reset a domain

restore restore a domain from a saved state in a file

resume resume a domain

save save a domain state to a file

save-image-define redefine the XML for a domain's saved state file

save-image-dumpxml saved state domain information in XML

save-image-edit edit XML for a domain's saved state file

schedinfo show/set scheduler parameters

screenshot take a screenshot of a current domain console and store it into a file

set-user-password set the user password inside the domain

setmaxmem change maximum memory limit

setmem change memory allocation

setvcpus change number of virtual CPUs

# shutdown # 优雅得关闭 domain

# start # 启动一个 domain

suspend suspend a domain

ttyconsole tty console

# undefine # 取消定义一个 domain。i.e.删除一台虚拟机

该命令会删除 /etc/libvirt/qemu/ 目录下描述该 domain 的 xml 文件

## Syntax(语法)

**undefine <domain> \[OPTIONS]**

OPTIONS

- --managed-save remove domain managed state file
- --storage <string> remove associated storage volumes (comma separated list of targets or source paths) (see domblklist)
- **--remove-all-storage** # 移除所有与该 domain 关联的存储卷。(谨慎使用)
- **--delete-snapshots** # 删除与卷关联的快照，需要--remove-all-storage（必须由存储驱动程序支持）
- --wipe-storage wipe data on the removed volumes
- **--snapshots-metadata** # 删除 domain 所有快照元数据（如果不活动）
- --nvram remove nvram file, if inactive
- --keep-nvram keep nvram file, if inactive

vcpucount domain vcpu counts
vcpuinfo detailed domain vcpu information
vcpupin control or query domain vcpu affinity

emulatorpin control or query domain emulator affinity

vncdisplay vnc display
