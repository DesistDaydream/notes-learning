---
title: 反向解析原理
linkTitle: 反向解析原理
weight: 20
---


# 概述

> 参考：
>
> - 



我们都知道DNS解析是把域名解析到IP，你知道怎么把IP解析到域名吗？知道反向解析的工作原理吗？

上一篇博客DNS解析原理讲解了域名到IP的解析流程，本篇着重讲解一下从IP到域名的解析流程。

首先，简单聊一下反向解析的使用场景，当前使用最多的是用于邮箱服务器IP配置反向解析指向邮箱域名。比如一个邮箱服务器，每天会收到来自互联网IP发送大量邮件，并不是每封邮件都要接收的，否则邮箱会被垃圾邮件刷爆的。所以邮箱服务器通常都有自己的反垃圾邮件规则。比如收到某个IP服务器发过来的邮件，首先会判断此IP是否在反垃圾邮件联盟的黑名单里，如果IP在黑名单就直接拒收邮件了。然后会判断邮箱域名信誉度是否良好，是否在黑名单。怎么获取邮箱域名呢，就是通过检测IP的反向解析来获取邮箱域名。所以说，对于自己搭建邮箱服务器，IP设置反向解析指向域名是重要的一步。

那IP的解析流程是怎样的呢？

要知道这个答案首先要知道IP在全球是怎么管理分配的。ICANN负责全球IP地址的编号分配，将部分商用IP分配给RIR(Regional Internet Registry，地区性 Internet 注册机构)来负责管理。全球一共有5个RIR：

ARIN 主要负责北美地区业务

RIPE 主要负责欧洲地区业务

LACNIC 主要负责拉丁美洲美洲业务

AfriNIC 负责非洲地区业务

APNIC 负责亚太地区业务

RIR 再授权给国家级注册机构负责管理各国家内的 IP 管理，比如 APNIC 下面的 CNNIC，JPNIC 等。CNNIC 再把 IP 授权给不同服务商，比如华为云，其他运营商等等。

对于一个域名，例如www.huawei.com，我们知道是com顶级域，那假如一个IP 117.78.61.19，是怎么判断是哪个顶级域呢？

反向解析也有一个顶级域是in-addr.arpa，对于IP  117.78.61.19实际对应的反向域名是19.61.78.117.in-addr.arpa，反向顶级域把117.in-addr.arpa这个A类授权给APNIC来管理，APNIC把78.117.in-addr.arpa这个B类授权给CNNIC来管理，CNNIC把下面的部分C类地址给华为云；

通过dig命令加 -x参数可以查看反向解析流程，大致类似于域名的解析流程。

![](https://notes-learning.oss-cn-beijing.aliyuncs.com/pg3qpr/1616160967075-291efb58-74ef-4ca6-bc37-929f11410605.jpeg)

知道了域名，IP的解析流程，对于我们定位解析不生效判断就更好理解了。可以查看是到哪一步中断，具体再去分析。希望以上分享对你有一定帮助
